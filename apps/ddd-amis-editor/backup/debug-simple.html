<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple.html è°ƒè¯•é¡µé¢</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .btn { padding: 10px 20px; background: #1890ff; color: white; border: none; border-radius: 4px; cursor: pointer; margin: 10px; }
        .result { margin-top: 20px; padding: 15px; background: #f5f5f5; border-radius: 4px; white-space: pre-wrap; max-height: 400px; overflow-y: auto; }
        .card { background: white; border: 1px solid #e8e8e8; border-radius: 8px; padding: 20px; margin: 10px 0; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .panel-card { border-left: 4px solid #1890ff; }
        .service-card { background: #f8f9fa; }
        .debug-info { background: #e6f7ff; border: 1px solid #91d5ff; padding: 10px; margin: 10px 0; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>ğŸ› Simple.html è°ƒè¯•é¡µé¢</h1>
    
    <div class="debug-info">
        <strong>å½“å‰é…ç½®:</strong><br>
        - åç«¯åœ°å€: http://localhost:8100/amis/dashboard<br>
        - å‰ç«¯åœ°å€: http://localhost:3000/simple.html<br>
        - æµ‹è¯•ç›®æ ‡: æ£€æŸ¥ä¸ºä»€ä¹ˆç»„ä»¶ç±»å‹æ˜¾ç¤ºä¸º undefined
    </div>
    
    <button class="btn" onclick="testConnection()">ğŸ”Œ æµ‹è¯•åç«¯è¿æ¥</button>
    <button class="btn" onclick="testFirstComponent()">ğŸ§© æµ‹è¯•ç¬¬ä¸€ä¸ªç»„ä»¶</button>
    <button class="btn" onclick="clearConsole()">ğŸ§¹ æ¸…ç©ºæ§åˆ¶å°</button>
    
    <div id="result" class="result">ç­‰å¾…æµ‹è¯•...</div>
    <div id="preview"></div>

    <script>
        let responseData = null;

        function clearConsole() {
            console.clear();
            document.getElementById('result').textContent = 'æ§åˆ¶å°å·²æ¸…ç©º';
        }

        async function testConnection() {
            const result = document.getElementById('result');
            try {
                result.textContent = 'æ­£åœ¨è¿æ¥åç«¯...';
                console.log('ğŸ”Œ å¼€å§‹æµ‹è¯•åç«¯è¿æ¥');
                
                const response = await fetch('http://localhost:8100/amis/dashboard');
                console.log('ğŸ“¡ æ”¶åˆ°å“åº”:', response);
                
                if (response.ok) {
                    const data = await response.json();
                    console.log('ğŸ“¦ è§£æåçš„æ•°æ®:', data);
                    
                    responseData = data;
                    
                    result.textContent = `âœ… è¿æ¥æˆåŠŸï¼
çŠ¶æ€ç : ${response.status}
æ•°æ®æ ¼å¼: ${typeof data}
æ˜¯å¦æœ‰codeå­—æ®µ: ${data.code !== undefined}
æ˜¯å¦æœ‰dataå­—æ®µ: ${data.data !== undefined}
dataç±»å‹: ${typeof data.data}

å®Œæ•´å“åº”æ•°æ®ç»“æ„:
${JSON.stringify(data, null, 2)}`;
                    
                } else {
                    result.textContent = `âŒ è¿æ¥å¤±è´¥
çŠ¶æ€ç : ${response.status}
çŠ¶æ€æ–‡æœ¬: ${response.statusText}`;
                }
            } catch (error) {
                result.textContent = `âŒ è¿æ¥é”™è¯¯: ${error.message}`;
                console.error('ğŸš« è¿æ¥é”™è¯¯:', error);
            }
        }

        function testFirstComponent() {
            const result = document.getElementById('result');
            const preview = document.getElementById('preview');
            
            if (!responseData) {
                result.textContent = 'âŒ è¯·å…ˆæµ‹è¯•åç«¯è¿æ¥è·å–æ•°æ®';
                return;
            }
            
            try {
                console.log('ğŸ§© å¼€å§‹æµ‹è¯•ç¬¬ä¸€ä¸ªç»„ä»¶æ¸²æŸ“');
                
                // æ¨¡æ‹Ÿ simple.html çš„æ•°æ®æå–é€»è¾‘
                let schema;
                if (responseData.code === 200 && responseData.data) {
                    schema = responseData.data;
                    console.log('ğŸ“‹ ä½¿ç”¨ responseData.data:', schema);
                } else if (responseData.schema) {
                    schema = responseData.schema;
                    console.log('ğŸ“‹ ä½¿ç”¨ responseData.schema:', schema);
                } else {
                    schema = responseData;
                    console.log('ğŸ“‹ ä½¿ç”¨ responseData:', schema);
                }
                
                result.textContent = `ğŸ§© å¼€å§‹æµ‹è¯•ç»„ä»¶æ¸²æŸ“
Schemaç±»å‹: ${typeof schema}
Schema.type: ${schema.type}
Schema.bodyé•¿åº¦: ${schema.body ? schema.body.length : 'æ— body'}

ç¬¬ä¸€å±‚ç»“æ„:`;
                
                if (schema.type === 'page') {
                    result.textContent += `\nâœ… é¡¶å±‚æ˜¯pageç»„ä»¶`;
                    
                    if (schema.body && schema.body.length > 0) {
                        const firstChild = schema.body[0];
                        result.textContent += `\n\nç¬¬ä¸€ä¸ªå­ç»„ä»¶:
ç±»å‹: ${firstChild.type}
å®Œæ•´ç»“æ„: ${JSON.stringify(firstChild, null, 2)}`;
                        
                        console.log('ğŸ” ç¬¬ä¸€ä¸ªå­ç»„ä»¶è¯¦æƒ…:', firstChild);
                        
                        // æµ‹è¯•ç¬¬ä¸€ä¸ªå­ç»„ä»¶çš„æ¸²æŸ“
                        if (firstChild.type === 'grid' && firstChild.columns) {
                            result.textContent += `\n\nç½‘æ ¼ç»„ä»¶åˆ†æ:
åˆ—æ•°: ${firstChild.columns.length}`;
                            
                            firstChild.columns.forEach((col, index) => {
                                if (col.body && col.body[0]) {
                                    result.textContent += `\nç¬¬${index+1}åˆ—ç¬¬ä¸€ä¸ªç»„ä»¶: ${col.body[0].type}`;
                                    console.log(`ğŸ“Š ç¬¬${index+1}åˆ—ç¬¬ä¸€ä¸ªç»„ä»¶:`, col.body[0]);
                                }
                            });
                        }
                    }
                } else {
                    result.textContent += `\nâŒ é¡¶å±‚ä¸æ˜¯pageç»„ä»¶ï¼Œè€Œæ˜¯: ${schema.type}`;
                }
                
            } catch (error) {
                result.textContent = `âŒ æµ‹è¯•é”™è¯¯: ${error.message}`;
                console.error('ğŸš« æµ‹è¯•é”™è¯¯:', error);
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆåæç¤º
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸš€ è°ƒè¯•é¡µé¢åŠ è½½å®Œæˆ');
            console.log('ğŸ’¡ å»ºè®®æ“ä½œæ­¥éª¤:');
            console.log('1. ç‚¹å‡»"æµ‹è¯•åç«¯è¿æ¥"æŸ¥çœ‹æ•°æ®ç»“æ„');
            console.log('2. ç‚¹å‡»"æµ‹è¯•ç¬¬ä¸€ä¸ªç»„ä»¶"åˆ†æç»„ä»¶ç»“æ„');
            console.log('3. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·æŸ¥çœ‹è¯¦ç»†æ—¥å¿—');
        });
    </script>
</body>
</html>
