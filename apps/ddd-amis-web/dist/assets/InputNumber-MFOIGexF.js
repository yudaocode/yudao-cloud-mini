import{a as Z,c as E,d as w,F as pt,be as I,bf as R,ap as ct,bg as dt,bh as ft,f as J,h as K,M as Q,o as ht,R as O,Q as z,J as G,an as mt,K as H,b5 as vt,q as D,s as d,aV as gt,bi as X,bj as yt}from"./index-SNKBwPMT.js";var Y=(function(S){Z(o,S);function o(e){var n=S.call(this,e)||this;n.handleChange=n.handleChange.bind(n),n.handleChangeUnit=n.handleChangeUnit.bind(n);var t=n.getUnit(),s=I(e.unitOptions),u=e.formItem,r=e.value;return u&&n.formatNumber(r,!0),n.state={unit:t,unitOptions:s},n}return o.prototype.doAction=function(e,n,t,s){var u,r,a=e?.actionType,i=this.props,l=i.min,b=i.max,x=i.precision,C=i.step,v=i.resetValue,_=i.big,g=i.onChange,f=i.clearValueOnEmpty,h=i.formStore,N=i.store,m=i.name;if(a==="clear")g?.(f?void 0:"");else if(a==="reset"){var M=R.normalizePrecision(this.filterNum(x),this.filterNum(C)),y=(r=ct((u=h?.pristine)!==null&&u!==void 0?u:N?.pristine,m))!==null&&r!==void 0?r:v,c=R.normalizeValue(y??"",this.filterNum(l,_),this.filterNum(b,_),M,y??"",f,_);g?.(f&&c===""?void 0:c)}},o.prototype.formatNumber=function(e,n){n===void 0&&(n=!1);var t=this.props,s=t.showAsPercent,u=t.suffix,r=t.step,a=t.big,i=t.setPrinstineValue,l=this.props.precision;s&&u==="%"&&(l=(l||0)+2);var b=this.getUnit(),x=I(this.props.unitOptions),C=R.normalizePrecision(this.filterNum(l),this.filterNum(r));if(e!=null&&C!=null&&(!b||x.length===0)&&a!==!0){var v=parseFloat(dt(e.toString(),".",C));!isNaN(v)&&v!==e&&(e=v,n&&i(v))}return e},o.prototype.getUnit=function(){var e,n,t=this.props;if(t.unitOptions&&t.unitOptions.length){var s=I(t.unitOptions).map(function(l){return l.value});if(t.value&&typeof t.value=="string"){var u=s[0];s.sort(function(l,b){return b.length-l.length});try{for(var r=ft(s),a=r.next();!a.done;a=r.next()){var i=a.value;if(t.value.endsWith(i)){u=i;break}}}catch(l){e={error:l}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return u}else return s[0]}},o.prototype.getValue=function(e){var n=this.props,t=n.resetValue,s=n.unitOptions;if(!(e&&typeof e!="number"&&typeof e!="string"))return e!==null&&s&&this.state.unit&&(e=e+String(this.state.unit)),e===null?t??null:e},o.prototype.dispatchEvent=function(e){return J(this,void 0,void 0,function(){var n,t,s;return K(this,function(u){return n=this.props,t=n.dispatchEvent,s=n.value,t(e,Q(this.props,{value:s})),[2]})})},o.prototype.handleChange=function(e){return J(this,void 0,void 0,function(){var n,t,s,u,r,a,i;return K(this,function(l){switch(l.label){case 0:return n=this.props,t=n.onChange,s=n.dispatchEvent,u=n.clearValueOnEmpty,r=this.getValue(e),a=u&&r===""?void 0:r,a=this.formatNumber(a),[4,s("change",Q(this.props,{value:a}))];case 1:return i=l.sent(),i?.prevented?[2]:(t(a),[2])}})})},o.prototype.changeCursorPos=function(e){var n,t;if(!isNaN(e)){var s=this.props,u=s.kilobitSeparator,r=s.prefix,a=e>0?Math.floor(e):Math.ceil(e),i="".concat(e).length;if(r&&(i+=r.length),u){var l=Math.floor(("".concat(Math.abs(a)).length-1)/3);l>0&&(i+=l)}this.input&&(u||r)&&((t=(n=this.input).setSelectionRange)===null||t===void 0||t.call(n,i,i))}},o.prototype.filterNum=function(e,n){if(n===void 0&&(n=!1),!(typeof e>"u"))return typeof e!="number"&&(e=ht(e,this.props.data),e=/^[-]?\d+/.test(e)?n?e:+e:void 0),e},o.prototype.handleChangeUnit=function(e){var n=this,t=this.props.value,s=this.state.unit;this.setState({unit:e.value},function(){t&&(t=t.toString().replace(s,""),n.props.onChange(t+n.state.unit))})},o.prototype.componentDidUpdate=function(e){var n=this.getUnit(),t=this.props,s=t.value,u=t.formInited,r=t.onChange,a=t.setPrinstineValue;if(s!=null&&(typeof s=="string"||typeof s=="number")&&n&&!String(s).endsWith(n)){var i=this.getValue(s);u===!1?a?.(i):r?.(i)}var l=/^([-+]?(([1-9]\d*\.?\d*)|(0\.\d*[1-9]))[^\d\.]*)$/;this.props.value!==e.value&&l.test(this.props.value)&&this.setState({unit:n}),this.props.unitOptions!==e.unitOptions&&this.setState({unitOptions:I(this.props.unitOptions)})},o.prototype.inputRef=function(e){this.input=e},o.prototype.focus=function(){this.input&&this.input.focus()},o.prototype.render=function(){var e,n=this,t=this.props,s=t.className,u=t.style,r=t.classPrefix,a=t.value,i=t.step,l=t.precision,b=t.max,x=t.min,C=t.disabled,v=t.placeholder,_=t.showSteps,g=t.borderMode,f=t.suffix,h=t.prefix,N=t.kilobitSeparator,m=t.unitOptions,M=t.readOnly,y=t.keyboard,c=t.displayMode,k=t.big,L=t.resetValue,tt=t.clearValueOnEmpty,U=t.css,F=t.themeCss,et=t.inputControlClassName,P=t.id,V=t.env,nt=t.name,rt=t.showAsPercent,it=t.testIdBuilder,st=t.popOverContainer,A=this.state.unit,W=this.filterNum(l),at=N||h||f?function(p,$){var T,B,q=$.userTyping,lt=$.input;if(N&&p)if((q||n.input===document.activeElement)&&X(p)===X((T=n.input)===null||T===void 0?void 0:T.value)){var j=p.toString().split(".");j[0]=j[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),p=j.join(".")}else p=yt(p,W);return f&&q&&((B=n.input)===null||B===void 0?void 0:B.selectionStart)===lt.length?"".concat(h||"").concat(p):"".concat(h||"").concat(p).concat(f||"")}:void 0,ot=function(p){return p&&(h&&(p=p.replace(h,"")),f&&(p=p.replace(f,"")),N&&(p=p.replace(/,/g,""))),p},ut=A&&a&&typeof a=="string"?a.replace(A,""):isNaN(a)?void 0:a;return O.createElement("div",{className:z("".concat(r,"NumberControl"),(e={},e["".concat(r,"NumberControl--withUnit")]=m,e),s),style:u},O.createElement(R,{name:nt,inputControlClassName:z(et,G(E(E({},this.props),{name:"inputControlClassName",id:P,themeCss:F||U})),G(E(E({},this.props),{name:"inputControlClassName",id:P,themeCss:F||U,extra:"inner"}))),inputRef:this.inputRef,value:ut,resetValue:L,step:i,max:this.filterNum(b,k),min:this.filterNum(x,k),formatter:at,parser:ot,onChange:this.handleChange,disabled:C,placeholder:v,precision:W,showSteps:_,borderMode:g,readOnly:M,suffix:f,showAsPercent:rt,onFocus:function(){return n.dispatchEvent("focus")},onBlur:function(){return n.dispatchEvent("blur")},keyboard:y,displayMode:c,big:k,clearValueOnEmpty:tt,testIdBuilder:it}),Array.isArray(m)&&m.length!==0?m.length>1?O.createElement(mt,{value:A,clearable:!1,options:this.state.unitOptions||[],onChange:this.handleChangeUnit,className:"".concat(r,"NumberControl-unit"),disabled:C,popOverContainer:st}):O.createElement("div",{className:z("".concat(r,"NumberControl-unit"),"".concat(r,"NumberControl-single-unit"),"".concat(r,"Select"),"".concat(M?"".concat(r,"NumberControl-readonly"):""))},typeof m[0]=="string"?m[0]:m[0].label):null,O.createElement(H,E({},this.props,{config:{themeCss:F||U,classNames:[{key:"inputControlClassName",weights:{focused:{pre:"".concat(r,"Number-").concat(c?c+"-":"","focused.")},disabled:{pre:"".concat(r,"Number-").concat(c?c+"-":"","disabled.")}}}],id:P},env:V})),O.createElement(H,E({},this.props,{config:{themeCss:vt(F||U),classNames:[{key:"inputControlClassName",weights:{default:{inner:"input"},hover:{inner:"input"},focused:{pre:"".concat(r,"Number-").concat(c?c+"-":"","focused."),inner:"input"},disabled:{pre:"".concat(r,"Number-").concat(c?c+"-":"","disabled."),inner:"input"}}}],id:P&&P+"-inner"},env:V})))},o.defaultProps={step:1,resetValue:"",clearValueOnEmpty:!1},w([D,d("design:type",Function),d("design:paramtypes",[String]),d("design:returntype",Promise)],o.prototype,"dispatchEvent",null),w([D,d("design:type",Function),d("design:paramtypes",[Number]),d("design:returntype",void 0)],o.prototype,"changeCursorPos",null),w([D,d("design:type",Function),d("design:paramtypes",[Object]),d("design:returntype",void 0)],o.prototype,"inputRef",null),w([gt(),d("design:type",Function),d("design:paramtypes",[]),d("design:returntype",void 0)],o.prototype,"render",null),o})(O.Component),Ct=(function(S){Z(o,S);function o(){return S!==null&&S.apply(this,arguments)||this}return o.defaultProps=E({validations:"isNumeric"},Y.defaultProps),o=w([pt({type:"input-number",detectProps:["unitOptions","precision","suffix"]})],o),o})(Y);export{Ct as NumberControlRenderer,Y as default};
