import{d as K,u as L,D as M,g as O,r as m,f as R,ba as z,C as A,G,U as H,ar as j,_ as J,X,o as n,c,k as l,w as r,Y as I,m as u,F as q,n as T,q as y,I as S,t as V,ah as Z,Z as $,L as W,z as ee,N as ae,J as le,K as te,M as re,dF as oe,O as se,P as ne,b8 as ie,Q as ue,R as pe}from"./index-BaY5TDP-.js";import{_ as de}from"./index-avjYFQiD.js";import{_ as me}from"./DictTag-QtcI9ZjC.js";import{_ as ce}from"./ContentWrap-DKQn7kZm.js";import{_ as ye}from"./index-BAz6Gqim.js";import{d as fe}from"./formatTime-Dr6TiYYc.js";import{h as he,d as _e}from"./index-BJQN17A_.js";import{C as be}from"./index-D7iZxFey.js";import{a as ge}from"./index-5lnhJJF7.js";import"./index-DrSdAlug.js";import"./color-BN7ZL7BD.js";const we={key:0,class:"flex flex-col"},Pe=J(K({name:"BpmProcessInstanceMy",__name:"index",setup(U,{expose:a}){a();const b=L(),e=M(),{t:g}=O(),w=m(!0),P=m(0),f=m([]),s=R({pageNo:1,pageSize:10,name:"",processDefinitionKey:void 0,category:void 0,status:void 0,createTime:[]}),h=m(),i=m([]),p=async()=>{w.value=!0;try{const o=await he(s);f.value=o.list,P.value=o.total}finally{w.value=!1}},v=m(!1),C=()=>{s.pageNo=1,p()};z(()=>{p()}),A(async()=>{await p(),i.value=await be.getCategorySimpleList()});const x={router:b,message:e,t:g,loading:w,total:P,list:f,queryParams:s,queryFormRef:h,categoryList:i,getList:p,showPopover:v,handleQuery:C,resetQuery:()=>{h.value.resetFields(),C()},handleCreate:async o=>{if(o!=null&&o.id&&(await ge(o.processDefinitionId)).formType===20)return void e.error("\u91CD\u65B0\u53D1\u8D77\u6D41\u7A0B\u5931\u8D25\uFF0C\u539F\u56E0\uFF1A\u8BE5\u6D41\u7A0B\u4F7F\u7528\u4E1A\u52A1\u8868\u5355\uFF0C\u4E0D\u652F\u6301\u91CD\u65B0\u53D1\u8D77");await b.push({name:"BpmProcessInstanceCreate",query:{processInstanceId:o==null?void 0:o.id}})},handleDetail:o=>{b.push({name:"BpmProcessInstanceDetail",query:{id:o.id}})},handleCancel:async o=>{const{value:k}=await j.prompt("\u8BF7\u8F93\u5165\u53D6\u6D88\u539F\u56E0","\u53D6\u6D88\u6D41\u7A0B",{confirmButtonText:g("common.ok"),cancelButtonText:g("common.cancel"),inputPattern:/^[\s\S]*.*\S[\s\S]*$/,inputErrorMessage:"\u53D6\u6D88\u539F\u56E0\u4E0D\u80FD\u4E3A\u7A7A"});await _e(o.id,k),e.success("\u53D6\u6D88\u6210\u529F"),await p()},get DICT_TYPE(){return G},get getIntDictOptions(){return H},get dateFormatter(){return fe}};return Object.defineProperty(x,"__isScriptSetup",{enumerable:!1,value:!0}),x}}),[["render",function(U,a,b,e,g,w){const P=ye,f=$,s=W,h=ee,i=ae,p=le,v=te,C=re,x=oe,o=se,k=ce,d=ne,N=ie,Q=me,E=ue,F=de,D=X("hasPermi"),Y=pe;return n(),c(q,null,[l(P,{title:"\u6D41\u7A0B\u53D1\u8D77\u3001\u53D6\u6D88\u3001\u91CD\u65B0\u53D1\u8D77",url:"https://doc.iocoder.cn/bpm/process-instance/"}),l(k,null,{default:r(()=>[l(o,{class:"-mb-15px",model:e.queryParams,ref:"queryFormRef",inline:!0,"label-width":"68px"},{default:r(()=>[l(s,{label:"",prop:"name"},{default:r(()=>[l(f,{modelValue:e.queryParams.name,"onUpdate:modelValue":a[0]||(a[0]=t=>e.queryParams.name=t),placeholder:"\u8BF7\u8F93\u5165\u6D41\u7A0B\u540D\u79F0",clearable:"",onKeyup:I(e.handleQuery,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),l(s,null,{default:r(()=>[l(i,{onClick:e.handleQuery},{default:r(()=>[l(h,{icon:"ep:search",class:"mr-5px"}),a[9]||(a[9]=u(" \u641C\u7D22"))]),_:1})]),_:1}),l(s,{label:"",prop:"category",style:{position:"absolute",right:"300px"}},{default:r(()=>[l(v,{modelValue:e.queryParams.category,"onUpdate:modelValue":a[1]||(a[1]=t=>e.queryParams.category=t),placeholder:"\u8BF7\u9009\u62E9\u6D41\u7A0B\u5206\u7C7B",clearable:"",class:"!w-155px",onChange:e.handleQuery},{default:r(()=>[(n(!0),c(q,null,T(e.categoryList,t=>(n(),y(p,{key:t.code,label:t.name,value:t.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(s,{label:"",prop:"status",style:{position:"absolute",right:"130px"}},{default:r(()=>[l(v,{modelValue:e.queryParams.status,"onUpdate:modelValue":a[2]||(a[2]=t=>e.queryParams.status=t),placeholder:"\u8BF7\u9009\u62E9\u6D41\u7A0B\u72B6\u6001",clearable:"",class:"!w-155px",onChange:e.handleQuery},{default:r(()=>[(n(!0),c(q,null,T(e.getIntDictOptions(e.DICT_TYPE.BPM_PROCESS_INSTANCE_STATUS),t=>(n(),y(p,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(s,{style:{position:"absolute",right:"0px"}},{default:r(()=>[l(x,{visible:e.showPopover,persistent:"",width:400,"show-arrow":!1,placement:"bottom-end"},{reference:r(()=>[l(i,{onClick:a[3]||(a[3]=t=>e.showPopover=!e.showPopover)},{default:r(()=>[l(h,{icon:"ep:plus",class:"mr-5px"}),a[10]||(a[10]=u("\u9AD8\u7EA7\u7B5B\u9009 "))]),_:1})]),default:r(()=>[l(s,{label:"\u6240\u5C5E\u6D41\u7A0B",class:"bold-label","label-position":"top",prop:"processDefinitionKey"},{default:r(()=>[l(f,{modelValue:e.queryParams.processDefinitionKey,"onUpdate:modelValue":a[4]||(a[4]=t=>e.queryParams.processDefinitionKey=t),placeholder:"\u8BF7\u8F93\u5165\u6D41\u7A0B\u5B9A\u4E49\u7684\u6807\u8BC6",clearable:"",onKeyup:I(e.handleQuery,["enter"]),class:"!w-390px"},null,8,["modelValue"])]),_:1}),l(s,{label:"\u53D1\u8D77\u65F6\u95F4",class:"bold-label","label-position":"top",prop:"createTime"},{default:r(()=>[l(C,{modelValue:e.queryParams.createTime,"onUpdate:modelValue":a[5]||(a[5]=t=>e.queryParams.createTime=t),"value-format":"YYYY-MM-DD HH:mm:ss",type:"daterange","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F","default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],class:"!w-240px"},null,8,["modelValue","default-time"])]),_:1}),l(s,{class:"bold-label","label-position":"top"},{default:r(()=>[l(i,{onClick:e.handleQuery},{default:r(()=>a[11]||(a[11]=[u(" \u786E\u8BA4")])),_:1}),l(i,{onClick:a[6]||(a[6]=t=>e.showPopover=!1)},{default:r(()=>a[12]||(a[12]=[u(" \u53D6\u6D88")])),_:1}),l(i,{onClick:e.resetQuery},{default:r(()=>a[13]||(a[13]=[u(" \u6E05\u7A7A")])),_:1})]),_:1})]),_:1},8,["visible"])]),_:1})]),_:1},8,["model"])]),_:1}),l(k,null,{default:r(()=>[S((n(),y(E,{data:e.list},{default:r(()=>[l(d,{label:"\u6D41\u7A0B\u540D\u79F0",align:"center",prop:"name","min-width":"200px",fixed:"left"}),l(d,{label:"\u6458\u8981",prop:"summary","min-width":"180",fixed:"left"},{default:r(t=>[t.row.summary&&t.row.summary.length>0?(n(),c("div",we,[(n(!0),c(q,null,T(t.row.summary,(_,B)=>(n(),c("div",{key:B},[l(N,{type:"info"},{default:r(()=>[u(V(_.key)+" : "+V(_.value),1)]),_:2},1024)]))),128))])):Z("",!0)]),_:1}),l(d,{label:"\u6D41\u7A0B\u5206\u7C7B",align:"center",prop:"categoryName","min-width":"100",fixed:"left"}),l(d,{label:"\u6D41\u7A0B\u72B6\u6001",prop:"status",width:"120"},{default:r(t=>[l(Q,{type:e.DICT_TYPE.BPM_PROCESS_INSTANCE_STATUS,value:t.row.status},null,8,["type","value"])]),_:1}),l(d,{label:"\u53D1\u8D77\u65F6\u95F4",align:"center",prop:"startTime",width:"180",formatter:e.dateFormatter},null,8,["formatter"]),l(d,{label:"\u7ED3\u675F\u65F6\u95F4",align:"center",prop:"endTime",width:"180",formatter:e.dateFormatter},null,8,["formatter"]),l(d,{label:"\u64CD\u4F5C",align:"center",fixed:"right",width:"180"},{default:r(t=>[S((n(),y(i,{link:"",type:"primary",onClick:_=>e.handleDetail(t.row)},{default:r(()=>a[14]||(a[14]=[u(" \u8BE6\u60C5 ")])),_:2},1032,["onClick"])),[[D,["bpm:process-instance:cancel"]]]),t.row.status===1?S((n(),y(i,{key:0,link:"",type:"primary",onClick:_=>e.handleCancel(t.row)},{default:r(()=>a[15]||(a[15]=[u(" \u53D6\u6D88 ")])),_:2},1032,["onClick"])),[[D,["bpm:process-instance:query"]]]):(n(),y(i,{key:1,link:"",type:"primary",onClick:_=>e.handleCreate(t.row)},{default:r(()=>a[16]||(a[16]=[u(" \u91CD\u65B0\u53D1\u8D77 ")])),_:2},1032,["onClick"]))]),_:1})]),_:1},8,["data"])),[[Y,e.loading]]),l(F,{total:e.total,page:e.queryParams.pageNo,"onUpdate:page":a[7]||(a[7]=t=>e.queryParams.pageNo=t),limit:e.queryParams.pageSize,"onUpdate:limit":a[8]||(a[8]=t=>e.queryParams.pageSize=t),onPagination:e.getList},null,8,["total","page","limit"])]),_:1})],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/bpm/processInstance/index.vue"]]);export{Pe as default};
