import{d as Y,D as k,r as m,f as h,C as x,U as E,G as C,_ as F,X as M,o as c,c as w,k as a,w as s,m as v,F as U,n as R,q as P,I,M as L,L as V,z as Q,N as z,O as A,A as j,B as H,P as B,Q as G,R as K}from"./index-BaY5TDP-.js";import{_ as X}from"./index-avjYFQiD.js";import{_ as J}from"./DictTag-QtcI9ZjC.js";import{_ as W}from"./ContentWrap-DKQn7kZm.js";import{g as Z,d as $}from"./coupon-C8Edebvp.js";import{d as ee}from"./formatTime-Dr6TiYYc.js";import"./index-DrSdAlug.js";import"./color-BN7ZL7BD.js";const ae=F(Y({name:"UserCouponList",__name:"UserCouponList",props:{userId:{type:Number,required:!0}},setup(O,{expose:l}){l();const f=k(),e=m(!0),y=m(0),g=m([]),o=h({pageNo:1,pageSize:10,createTime:[],status:void 0,userIds:void 0}),d=m(),_=m("all"),i=h([{label:"\u5168\u90E8",value:"all"}]),u=async()=>{e.value=!0;try{o.userIds=O.userId;const r=await Z(o);g.value=r.list,y.value=r.total}finally{e.value=!1}},p=()=>{o.pageNo=1,u()};x(()=>{u();for(const r of E(C.PROMOTION_COUPON_STATUS))i.push({label:r.label,value:r.value})});const T={message:f,loading:e,total:y,list:g,queryParams:o,queryFormRef:d,activeTab:_,statusTabs:i,getList:u,handleQuery:p,resetQuery:()=>{var r;(r=d.value)==null||r.resetFields(),p()},handleDelete:async r=>{try{await f.confirm("\u56DE\u6536\u5C06\u4F1A\u6536\u56DE\u4F1A\u5458\u9886\u53D6\u7684\u5F85\u4F7F\u7528\u7684\u4F18\u60E0\u5238\uFF0C\u5DF2\u4F7F\u7528\u7684\u5C06\u65E0\u6CD5\u56DE\u6536\uFF0C\u786E\u5B9A\u8981\u56DE\u6536\u6240\u9009\u4F18\u60E0\u5238\u5417\uFF1F"),await $(r),f.notifySuccess("\u56DE\u6536\u6210\u529F"),await u()}catch{}},onTabChange:r=>{o.status=r==="all"?void 0:r,u()},get DICT_TYPE(){return C},get dateFormatter(){return ee}};return Object.defineProperty(T,"__isScriptSetup",{enumerable:!1,value:!0}),T}}),[["render",function(O,l,f,e,y,g){const o=L,d=V,_=Q,i=z,u=A,p=W,T=j,r=H,n=B,b=J,N=G,q=X,D=M("hasPermi"),S=K;return c(),w(U,null,[a(p,null,{default:s(()=>[a(u,{ref:"queryFormRef",inline:!0,model:e.queryParams,class:"-mb-15px","label-width":"68px"},{default:s(()=>[a(d,{label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime"},{default:s(()=>[a(o,{modelValue:e.queryParams.createTime,"onUpdate:modelValue":l[0]||(l[0]=t=>e.queryParams.createTime=t),"value-format":"YYYY-MM-DD HH:mm:ss",type:"daterange","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F","default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],class:"!w-240px"},null,8,["modelValue","default-time"])]),_:1}),a(d,null,{default:s(()=>[a(i,{onClick:e.handleQuery},{default:s(()=>[a(_,{icon:"ep:search",class:"mr-5px"}),l[4]||(l[4]=v("\u641C\u7D22 "))]),_:1}),a(i,{onClick:e.resetQuery},{default:s(()=>[a(_,{icon:"ep:refresh",class:"mr-5px"}),l[5]||(l[5]=v("\u91CD\u7F6E "))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(p,null,{default:s(()=>[a(r,{modelValue:e.activeTab,"onUpdate:modelValue":l[1]||(l[1]=t=>e.activeTab=t),type:"card",onTabChange:e.onTabChange},{default:s(()=>[(c(!0),w(U,null,R(e.statusTabs,t=>(c(),P(T,{key:t.value,label:t.label,name:t.value},null,8,["label","name"]))),128))]),_:1},8,["modelValue"]),I((c(),P(N,{data:e.list},{default:s(()=>[a(n,{label:"\u4F18\u60E0\u52B5",align:"center",prop:"name"}),a(n,{label:"\u4F18\u60E0\u5238\u7C7B\u578B",align:"center",prop:"discountType"},{default:s(t=>[a(b,{type:e.DICT_TYPE.PROMOTION_DISCOUNT_TYPE,value:t.row.discountType},null,8,["type","value"])]),_:1}),a(n,{label:"\u9886\u53D6\u65B9\u5F0F",align:"center",prop:"takeType"},{default:s(t=>[a(b,{type:e.DICT_TYPE.PROMOTION_COUPON_TAKE_TYPE,value:t.row.takeType},null,8,["type","value"])]),_:1}),a(n,{label:"\u72B6\u6001",align:"center",prop:"status"},{default:s(t=>[a(b,{type:e.DICT_TYPE.PROMOTION_COUPON_STATUS,value:t.row.status},null,8,["type","value"])]),_:1}),a(n,{label:"\u9886\u53D6\u65F6\u95F4",align:"center",prop:"createTime",formatter:e.dateFormatter,width:"180"},null,8,["formatter"]),a(n,{label:"\u4F7F\u7528\u65F6\u95F4",align:"center",prop:"useTime",formatter:e.dateFormatter,width:"180"},null,8,["formatter"]),a(n,{label:"\u64CD\u4F5C",align:"center","class-name":"small-padding fixed-width"},{default:s(t=>[I((c(),P(i,{type:"danger",link:"",onClick:te=>e.handleDelete(t.row.id)},{default:s(()=>l[6]||(l[6]=[v(" \u56DE\u6536 ")])),_:2},1032,["onClick"])),[[D,["promotion:coupon:delete"]]])]),_:1})]),_:1},8,["data"])),[[S,e.loading]]),a(q,{limit:e.queryParams.pageSize,"onUpdate:limit":l[2]||(l[2]=t=>e.queryParams.pageSize=t),page:e.queryParams.pageNo,"onUpdate:page":l[3]||(l[3]=t=>e.queryParams.pageNo=t),total:e.total,onPagination:e.getList},null,8,["limit","page","total"])]),_:1})],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/member/user/detail/UserCouponList.vue"]]);export{ae as default};
