import{d as k,f as C,e as B,r as m,b as Q,au as U,C as F,G as L,U as Y,_ as E,o as y,c as R,k as a,w as u,F as D,n as P,q as g,m as S,M as z,L as O,J as A,K as M,z as j,N as H,O as N,A as G,B as J,v as K}from"./index-BaY5TDP-.js";import{_ as W}from"./ContentWrap-DKQn7kZm.js";import{E as X}from"./el-tree-select-DphqCDCz.js";import{g as Z}from"./index-dK17nfjs.js";import{g as $}from"./index-CuAlllbQ.js";import{f as V,e as ee,g as ae,h as se}from"./formatTime-Dr6TiYYc.js";import{h as w,d as le}from"./tree-z7HkrWVC.js";import ue from"./FunnelBusiness-C29VSC4v.js";import te from"./BusinessSummary-BovcYMv5.js";import re from"./BusinessInversionRateSummary-CSwBTXtL.js";import"./DictTag-QtcI9ZjC.js";import"./color-BN7ZL7BD.js";import"./el-skeleton-item-BYAIkmCs.js";import"./Echart-BQxFkezy.js";import"./echarts-DpbyC_6K.js";import"./funnel-B8h2f-tZ.js";import"./index-avjYFQiD.js";import"./index-DrSdAlug.js";const ne=E(k({name:"CrmStatisticsFunnel",__name:"index",setup(x,{expose:l}){l();const c=C({interval:2,deptId:B().getUser.deptId,userId:void 0,times:[V(ee(new Date(new Date().getTime()-6048e5))),V(ae(new Date(new Date().getTime()-864e5)))]}),e=m(),I=m([]),v=m([]),q=Q(()=>c.deptId?v.value.filter(r=>r.deptId===c.deptId):[]),t=m("funnelRef"),i=m(),p=m(),b=m(),d=()=>{var r,_,n,h,o,s;switch(t.value){case"funnelRef":(_=(r=i.value)==null?void 0:r.loadData)==null||_.call(r);break;case"businessSummaryRef":(h=(n=p.value)==null?void 0:n.loadData)==null||h.call(n);break;case"businessInversionRateSummaryRef":(s=(o=b.value)==null?void 0:o.loadData)==null||s.call(o)}};U(t,()=>{d()}),F(async()=>{I.value=w(await Z()),v.value=w(await $())});const f={queryParams:c,queryFormRef:e,deptList:I,userList:v,userListByDeptId:q,activeTab:t,funnelRef:i,businessSummaryRef:p,businessInversionRateSummaryRef:b,handleQuery:d,resetQuery:()=>{e.value.resetFields(),d()},get defaultShortcuts(){return se},get defaultProps(){return le},FunnelBusiness:ue,BusinessSummary:te,BusinessInversionRateSummary:re,get DICT_TYPE(){return L},get getIntDictOptions(){return Y}};return Object.defineProperty(f,"__isScriptSetup",{enumerable:!1,value:!0}),f}}),[["render",function(x,l,c,e,I,v){const q=z,t=O,i=A,p=M,b=X,d=j,f=H,r=N,_=W,n=G,h=J,o=K;return y(),R(D,null,[a(_,null,{default:u(()=>[a(r,{ref:"queryFormRef",inline:!0,model:e.queryParams,class:"-mb-15px","label-width":"68px"},{default:u(()=>[a(t,{label:"\u65F6\u95F4\u8303\u56F4",prop:"orderDate"},{default:u(()=>[a(q,{modelValue:e.queryParams.times,"onUpdate:modelValue":l[0]||(l[0]=s=>e.queryParams.times=s),"default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],shortcuts:e.defaultShortcuts,class:"!w-240px","end-placeholder":"\u7ED3\u675F\u65E5\u671F","start-placeholder":"\u5F00\u59CB\u65E5\u671F",type:"daterange","value-format":"YYYY-MM-DD HH:mm:ss",onChange:e.handleQuery},null,8,["modelValue","default-time","shortcuts"])]),_:1}),a(t,{label:"\u65F6\u95F4\u95F4\u9694",prop:"interval"},{default:u(()=>[a(p,{modelValue:e.queryParams.interval,"onUpdate:modelValue":l[1]||(l[1]=s=>e.queryParams.interval=s),class:"!w-240px",placeholder:"\u95F4\u9694\u7C7B\u578B",onChange:e.handleQuery},{default:u(()=>[(y(!0),R(D,null,P(e.getIntDictOptions(e.DICT_TYPE.DATE_INTERVAL),s=>(y(),g(i,{key:s.value,label:s.label,value:s.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(t,{label:"\u5F52\u5C5E\u90E8\u95E8",prop:"deptId"},{default:u(()=>[a(b,{modelValue:e.queryParams.deptId,"onUpdate:modelValue":l[2]||(l[2]=s=>e.queryParams.deptId=s),data:e.deptList,props:e.defaultProps,"check-strictly":"",class:"!w-240px","node-key":"id",placeholder:"\u8BF7\u9009\u62E9\u5F52\u5C5E\u90E8\u95E8",onChange:l[3]||(l[3]=s=>(e.queryParams.userId=void 0,e.handleQuery()))},null,8,["modelValue","data","props"])]),_:1}),a(t,{label:"\u5458\u5DE5",prop:"userId"},{default:u(()=>[a(p,{modelValue:e.queryParams.userId,"onUpdate:modelValue":l[4]||(l[4]=s=>e.queryParams.userId=s),class:"!w-240px",clearable:"",placeholder:"\u5458\u5DE5",onChange:e.handleQuery},{default:u(()=>[(y(!0),R(D,null,P(e.userListByDeptId,(s,T)=>(y(),g(i,{key:T,label:s.nickname,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(t,null,{default:u(()=>[a(f,{onClick:e.handleQuery},{default:u(()=>[a(d,{class:"mr-5px",icon:"ep:search"}),l[6]||(l[6]=S(" \u67E5\u8BE2 "))]),_:1}),a(f,{onClick:e.resetQuery},{default:u(()=>[a(d,{class:"mr-5px",icon:"ep:refresh"}),l[7]||(l[7]=S(" \u91CD\u7F6E "))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(o,null,{default:u(()=>[a(h,{modelValue:e.activeTab,"onUpdate:modelValue":l[5]||(l[5]=s=>e.activeTab=s)},{default:u(()=>[a(n,{label:"\u9500\u552E\u6F0F\u6597\u5206\u6790",lazy:"",name:"funnelRef"},{default:u(()=>[a(e.FunnelBusiness,{ref:"funnelRef","query-params":e.queryParams},null,8,["query-params"])]),_:1}),a(n,{label:"\u65B0\u589E\u5546\u673A\u5206\u6790",lazy:"",name:"businessSummaryRef"},{default:u(()=>[a(e.BusinessSummary,{ref:"businessSummaryRef","query-params":e.queryParams},null,8,["query-params"])]),_:1}),a(n,{label:"\u5546\u673A\u8F6C\u5316\u7387\u5206\u6790",lazy:"",name:"businessInversionRateSummaryRef"},{default:u(()=>[a(e.BusinessInversionRateSummary,{ref:"businessInversionRateSummaryRef","query-params":e.queryParams},null,8,["query-params"])]),_:1})]),_:1},8,["modelValue"])]),_:1})],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/crm/statistics/funnel/index.vue"]]);export{ne as default};
