import{d as O,eQ as R,r as g,C as S,ao as k,aI as v,G as I,_ as E,o as f,c as T,k as s,w as x,m as n,F as h,n as P,j as m,t as w,N as b,Z as V}from"./index-BaY5TDP-.js";import{_ as j}from"./DictTag-QtcI9ZjC.js";import"./Dialog-CZSXtzfQ.js";import"./index-avjYFQiD.js";import{e as D}from"./couponTemplate-C5oFUT2R.js";import{d as N}from"./formatter-DYGBdQzW.js";import{h as U}from"./constants-CEEr2azc.js";import G from"./CouponSelect-InTFkI3y.js";import"./color-BN7ZL7BD.js";import"./index-DrSdAlug.js";import"./formatTime-Dr6TiYYc.js";import"./ContentWrap-DKQn7kZm.js";const Y={class:"coupon-list-item-left flex items-center flex-wrap"},F={class:"mr-10px"},L={class:"mr-10px"},M={class:"flex items-center"},A={class:"coupon-list-item-right"},q=E(O({name:"RewardRuleCouponSelect",__name:"RewardRuleCouponSelect",props:{modelValue:{type:Object,required:!0}},emits:["update:modelValue"],setup(y,{expose:e,emit:_}){const o=y,C=_,a=R(o,"modelValue",C),l=g([]),i=g(),c=async()=>{if(v(a.value)||v(a.value.giveCouponTemplateCounts))return;const t=Object.keys(a.value.giveCouponTemplateCounts).map(p=>parseInt(p)),r=await D(t);r&&r.forEach(p=>{l.value.push({...p,giveCount:a.value.giveCouponTemplateCounts[p.id]})})},u=()=>{v(a.value)||v(l.value)||l.value.forEach(t=>{a.value.giveCouponTemplateCounts||(a.value.giveCouponTemplateCounts={}),a.value.giveCouponTemplateCounts[t.id]=t.giveCount})};e({setGiveCouponList:u}),S(async()=>{await k(),await c()});const d={props:o,emits:C,rewardRule:a,list:l,couponSelectRef:i,selectCoupon:()=>{var t;(t=i.value)==null||t.open()},handleCouponChange:t=>{for(const r of t)l.value.some(p=>p.id===r.id)||l.value.push(r)},deleteCoupon:t=>{l.value.splice(t,1)},initGiveCouponList:c,setGiveCouponList:u,get CouponSelect(){return G},get DICT_TYPE(){return I},get CouponTemplateTakeTypeEnum(){return U},get discountFormat(){return N}};return Object.defineProperty(d,"__isScriptSetup",{enumerable:!1,value:!0}),d}}),[["render",function(y,e,_,o,C,a){const l=b,i=j,c=V;return f(),T(h,null,[s(l,{class:"ml-10px",type:"text",onClick:o.selectCoupon},{default:x(()=>e[0]||(e[0]=[n("\u6DFB\u52A0\u4F18\u60E0\u52B5")])),_:1}),(f(!0),T(h,null,P(o.list,(u,d)=>(f(),T("div",{key:u.id,class:"coupon-list-item p-x-10px mb-10px flex justify-between"},[m("div",Y,[m("div",F," \u4F18\u60E0\u5238\u540D\u79F0\uFF1A"+w(u.name),1),m("div",L,[e[1]||(e[1]=n(" \u8303\u56F4\uFF1A ")),s(i,{type:o.DICT_TYPE.PROMOTION_PRODUCT_SCOPE,value:u.productScope},null,8,["type","value"])]),m("div",M,[e[2]||(e[2]=n(" \u4F18\u60E0\uFF1A ")),s(i,{type:o.DICT_TYPE.PROMOTION_DISCOUNT_TYPE,value:u.discountType},null,8,["type","value"]),n(" "+w(o.discountFormat(u)),1)])]),m("div",A,[e[4]||(e[4]=n(" \u9001 ")),s(c,{modelValue:u.giveCount,"onUpdate:modelValue":t=>u.giveCount=t,class:"w-150px! p-x-20px!",placeholder:"",type:"number"},null,8,["modelValue","onUpdate:modelValue"]),e[5]||(e[5]=n(" \u5F20 ")),s(l,{class:"ml-20px",link:"",type:"danger",onClick:t=>o.deleteCoupon(d)},{default:x(()=>[...e[3]||(e[3]=[n("\u5220\u9664")])]),_:2},1032,["onClick"])])]))),128)),s(o.CouponSelect,{ref:"couponSelectRef","take-type":o.CouponTemplateTakeTypeEnum.ADMIN.type,onChange:o.handleCouponChange},null,8,["take-type"])],64)}],["__scopeId","data-v-682aa940"],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/mall/promotion/rewardActivity/components/RewardRuleCouponSelect.vue"]]);export{q as default};
