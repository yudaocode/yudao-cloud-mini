import{d as V,D as z,r as m,f as R,C as A,_ as K,X as O,o as i,c as w,k as a,w as r,Y as x,m as c,I as P,q as g,F as I,n as W,t as j,L as D,Z as M,z as T,N as X,O as Y,P as Z,an as B,Q as E,R as G}from"./index-BaY5TDP-.js";import{_ as H}from"./index-avjYFQiD.js";import{_ as J}from"./ContentWrap-DKQn7kZm.js";import{_ as $}from"./index-BAz6Gqim.js";import{d as ee}from"./formatTime-Dr6TiYYc.js";import{a as ae,s as te}from"./index-DAG8aKkl.js";import{b as re}from"./index-CFEI7Byd.js";import ne from"./main-DuOfDTOL.js";import oe from"./UserForm-BHY8hQ5F.js";import"./index-DrSdAlug.js";import"./index-C1v7IUC9.js";import"./tagsView-lnAkwTv2.js";import"./Dialog-CZSXtzfQ.js";const le=K(V({name:"MpUser",__name:"index",setup(C,{expose:t}){t();const _=z(),e=m(!0),h=m(0),k=m([]),l=R({pageNo:1,pageSize:10,accountId:-1,openid:"",nickname:""}),p=m(null),f=m([]),u=async()=>{try{e.value=!0;const n=await ae(l);k.value=n.list,h.value=n.total}finally{e.value=!1}},d=()=>{l.pageNo=1,u()},b=m(null);A(async()=>{f.value=await re()});const y={message:_,loading:e,total:h,list:k,queryParams:l,queryFormRef:p,tagList:f,onAccountChanged:n=>{l.accountId=n,l.pageNo=1,u()},getList:u,handleQuery:d,resetQuery:()=>{var s;const n=l.accountId;(s=p.value)==null||s.resetFields(),l.accountId=n,d()},formRef:b,openForm:n=>{var s;(s=b.value)==null||s.open(n)},handleSync:async()=>{try{await _.confirm("\u662F\u5426\u786E\u8BA4\u540C\u6B65\u7C89\u4E1D\uFF1F"),await te(l.accountId),_.success("\u5F00\u59CB\u4ECE\u5FAE\u4FE1\u516C\u4F17\u53F7\u540C\u6B65\u7C89\u4E1D\u4FE1\u606F\uFF0C\u540C\u6B65\u9700\u8981\u4E00\u6BB5\u65F6\u95F4\uFF0C\u5EFA\u8BAE\u7A0D\u540E\u518D\u67E5\u8BE2"),await u()}catch{}},get dateFormatter(){return ee},get WxAccountSelect(){return ne},UserForm:oe};return Object.defineProperty(y,"__isScriptSetup",{enumerable:!1,value:!0}),y}}),[["render",function(C,t,_,e,h,k){const l=$,p=D,f=M,u=T,d=X,b=Y,y=J,n=Z,s=B,F=E,U=H,q=O("hasPermi"),Q=G;return i(),w(I,null,[a(l,{title:"\u516C\u4F17\u53F7\u7C89\u4E1D",url:"https://doc.iocoder.cn/mp/user/"}),a(y,null,{default:r(()=>[a(b,{class:"-mb-15px",model:e.queryParams,ref:"queryFormRef",inline:!0,"label-width":"68px"},{default:r(()=>[a(p,{label:"\u516C\u4F17\u53F7",prop:"accountId"},{default:r(()=>[a(e.WxAccountSelect,{onChange:e.onAccountChanged})]),_:1}),a(p,{label:"\u7528\u6237\u6807\u8BC6",prop:"openid"},{default:r(()=>[a(f,{modelValue:e.queryParams.openid,"onUpdate:modelValue":t[0]||(t[0]=o=>e.queryParams.openid=o),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u6807\u8BC6",clearable:"",onKeyup:x(e.handleQuery,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),a(p,{label:"\u6635\u79F0",prop:"nickname"},{default:r(()=>[a(f,{modelValue:e.queryParams.nickname,"onUpdate:modelValue":t[1]||(t[1]=o=>e.queryParams.nickname=o),placeholder:"\u8BF7\u8F93\u5165\u6635\u79F0",clearable:"",onKeyup:x(e.handleQuery,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),a(p,null,{default:r(()=>[a(d,{onClick:e.handleQuery},{default:r(()=>[a(u,{icon:"ep:search"}),t[4]||(t[4]=c("\u641C\u7D22 "))]),_:1}),a(d,{onClick:e.resetQuery},{default:r(()=>[a(u,{icon:"ep:refresh"}),t[5]||(t[5]=c("\u91CD\u7F6E "))]),_:1}),P((i(),g(d,{type:"success",plain:"",onClick:e.handleSync,disabled:e.queryParams.accountId===0},{default:r(()=>[a(u,{icon:"ep:refresh",class:"mr-5px"}),t[6]||(t[6]=c(" \u540C\u6B65 "))]),_:1},8,["disabled"])),[[q,["mp:user:sync"]]])]),_:1})]),_:1},8,["model"])]),_:1}),a(y,null,{default:r(()=>[P((i(),g(F,{data:e.list},{default:r(()=>[a(n,{label:"\u7F16\u53F7",align:"center",prop:"id"}),a(n,{label:"\u7528\u6237\u6807\u8BC6",align:"center",prop:"openid",width:"260"}),a(n,{label:"\u6635\u79F0",align:"center",prop:"nickname"}),a(n,{label:"\u5907\u6CE8",align:"center",prop:"remark"}),a(n,{label:"\u6807\u7B7E",align:"center",prop:"tagIds",width:"200"},{default:r(o=>[(i(!0),w(I,null,W(o.row.tagIds,(v,L)=>(i(),w("span",{key:L},[a(s,null,{default:r(()=>{var S;return[c(j((S=e.tagList.find(N=>N.tagId===v))==null?void 0:S.name),1)]}),_:2},1024),t[7]||(t[7]=c("\xA0 "))]))),128))]),_:1}),a(n,{label:"\u8BA2\u9605\u72B6\u6001",align:"center",prop:"subscribeStatus"},{default:r(o=>[o.row.subscribeStatus===0?(i(),g(s,{key:0,type:"success"},{default:r(()=>t[8]||(t[8]=[c("\u5DF2\u8BA2\u9605")])),_:1})):(i(),g(s,{key:1,type:"danger"},{default:r(()=>t[9]||(t[9]=[c("\u672A\u8BA2\u9605")])),_:1}))]),_:1}),a(n,{label:"\u8BA2\u9605\u65F6\u95F4",align:"center",prop:"subscribeTime",width:"180",formatter:e.dateFormatter},null,8,["formatter"]),a(n,{label:"\u64CD\u4F5C",align:"center"},{default:r(o=>[P((i(),g(d,{type:"primary",link:"",onClick:v=>e.openForm(o.row.id)},{default:r(()=>t[10]||(t[10]=[c(" \u4FEE\u6539 ")])),_:2},1032,["onClick"])),[[q,["mp:user:update"]]])]),_:1})]),_:1},8,["data"])),[[Q,e.loading]]),a(U,{total:e.total,page:e.queryParams.pageNo,"onUpdate:page":t[2]||(t[2]=o=>e.queryParams.pageNo=o),limit:e.queryParams.pageSize,"onUpdate:limit":t[3]||(t[3]=o=>e.queryParams.pageSize=o),onPagination:e.getList},null,8,["total","page","limit"])]),_:1}),a(e.UserForm,{ref:"formRef",onSuccess:e.getList},null,512)],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/mp/user/index.vue"]]);export{le as default};
