import{d as M,u as R,D as U,r as m,f as B,ba as z,ay as k,_ as I,am as j,X as A,o as c,c as F,k as o,w as r,j as V,q as D,a_ as G,Y as N,I as P,m as g,F as O,z as Q,Z as K,L as T,N as J,d6 as W,d7 as X,d8 as Y,O as Z,x as E,R as H}from"./index-BaY5TDP-.js";import{_ as $}from"./Dialog-CZSXtzfQ.js";import{_ as ee}from"./ContentWrap-DKQn7kZm.js";import{V as ae}from"./vuedraggable.umd-CVSuxhJW.js";import{C as q}from"./index-D7iZxFey.js";import{h as oe}from"./index-CnMIW1kt.js";import re from"./CategoryForm-Dl0HrKrz.js";import le from"./CategoryDraggableModel-BI9EQjVe.js";import"./constants-CEEr2azc.js";import"./el-collapse-transition-l0sNRNKZ.js";import"./el-image-Bg-CwbDE.js";import"./formatTime-Dr6TiYYc.js";import"./index-BeYJ8u62.js";import"./formCreate-Dy2BGZHq.js";import"./permission-DVIdBhA5.js";import"./useTagsView-BVSrkD2Z.js";import"./tagsView-lnAkwTv2.js";const te={class:"flex justify-between pl-20px items-center"},se={key:1,class:"mr-20px"},ie={class:"px-15px"},ne=I(M({name:"BpmModel",__name:"index",setup(L,{expose:e}){e();const{push:x}=R(),a=U(),y=m(!0),p=m(!1),i=B({name:void 0}),S=m(),t=m([]),n=m([]),f=m(!1),w=m({rule:[],option:{}}),C=m(),_=()=>{C.value.open("create")},h=()=>{n.value=k(t.value),p.value=!0},d=async()=>{y.value=!0;try{const s=await oe(i.name),u=await q.getCategorySimpleList();t.value=u.map(v=>({...v,modelList:s.filter(l=>l.categoryName==v.name)}))}finally{y.value=!1}};z(()=>{d()});const b={push:x,message:a,loading:y,isCategorySorting:p,queryParams:i,queryFormRef:S,categoryGroup:t,originalData:n,handleQuery:()=>{d()},openForm:(s,u)=>{x(s==="create"?{name:"BpmModelCreate"}:{name:"BpmModelUpdate",params:{id:u}})},formDetailVisible:f,formDetailPreview:w,handleCommand:s=>{switch(s){case"handleCategoryAdd":_();break;case"handleCategorySort":h()}},categoryFormRef:C,handleCategoryAdd:_,handleCategorySort:h,handleCategorySortCancel:()=>{t.value=k(n.value),p.value=!1},handleCategorySortSubmit:async()=>{const s=t.value.map(u=>u.id);await q.updateCategorySortBatch(s),p.value=!1,a.success("\u6392\u5E8F\u5206\u7C7B\u6210\u529F"),await d()},getList:d,get draggable(){return ae},CategoryForm:re,CategoryDraggableModel:le};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}}),[["render",function(L,e,x,a,y,p){const i=Q,S=K,t=T,n=J,f=W,w=X,C=Y,_=Z,h=E,d=ee,b=j("form-create"),s=$,u=A("hasPermi"),v=H;return c(),F(O,null,[o(d,null,{default:r(()=>[V("div",te,[e[11]||(e[11]=V("h3",{class:"font-extrabold"},"\u6D41\u7A0B\u6A21\u578B",-1)),a.isCategorySorting?(c(),F("div",se,[o(n,{onClick:a.handleCategorySortCancel},{default:r(()=>e[9]||(e[9]=[g(" \u53D6 \u6D88 ")])),_:1}),o(n,{type:"primary",onClick:a.handleCategorySortSubmit},{default:r(()=>e[10]||(e[10]=[g(" \u4FDD\u5B58\u6392\u5E8F ")])),_:1})])):(c(),D(_,{key:0,class:"-mb-15px flex mr-10px",model:a.queryParams,ref:"queryFormRef",inline:!0,"label-width":"68px",onSubmit:e[3]||(e[3]=G(()=>{},["prevent"]))},{default:r(()=>[o(t,{prop:"name",class:"ml-auto"},{default:r(()=>[o(S,{modelValue:a.queryParams.name,"onUpdate:modelValue":e[0]||(e[0]=l=>a.queryParams.name=l),placeholder:"\u641C\u7D22\u6D41\u7A0B",clearable:"",onKeyup:N(a.handleQuery,["enter"]),class:"!w-240px"},{prefix:r(()=>[o(i,{icon:"ep:search",class:"mx-10px"})]),_:1},8,["modelValue"])]),_:1}),o(t,null,{default:r(()=>[P((c(),D(n,{type:"primary",onClick:e[1]||(e[1]=l=>a.openForm("create"))},{default:r(()=>[o(i,{icon:"ep:plus",class:"mr-5px"}),e[6]||(e[6]=g(" \u65B0\u5EFA\u6A21\u578B "))]),_:1})),[[u,["bpm:model:create"]]])]),_:1}),o(t,null,{default:r(()=>[o(C,{onCommand:e[2]||(e[2]=l=>a.handleCommand(l)),placement:"bottom-end"},{dropdown:r(()=>[o(w,null,{default:r(()=>[o(f,{command:"handleCategoryAdd"},{default:r(()=>[o(i,{icon:"ep:circle-plus",size:13,class:"mr-5px"}),e[7]||(e[7]=g(" \u65B0\u5EFA\u5206\u7C7B "))]),_:1}),o(f,{command:"handleCategorySort"},{default:r(()=>[o(i,{icon:"fa:sort-amount-desc",size:13,class:"mr-5px"}),e[8]||(e[8]=g(" \u5206\u7C7B\u6392\u5E8F "))]),_:1})]),_:1})]),default:r(()=>[o(n,{class:"w-30px",plain:""},{default:r(()=>[o(i,{icon:"ep:setting"})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]))]),o(h),V("div",ie,[o(a.draggable,{disabled:!a.isCategorySorting,modelValue:a.categoryGroup,"onUpdate:modelValue":e[4]||(e[4]=l=>a.categoryGroup=l),"item-key":"id",animation:400},{item:r(({element:l})=>[P((c(),D(d,{class:"rounded-lg transition-all duration-300 ease-in-out hover:shadow-xl","body-style":{padding:0},key:l.id},{default:r(()=>[o(a.CategoryDraggableModel,{isCategorySorting:a.isCategorySorting,categoryInfo:l,onSuccess:a.getList},null,8,["isCategorySorting","categoryInfo"])]),_:2},1024)),[[v,a.loading]])]),_:1},8,["disabled","modelValue"])])]),_:1}),o(a.CategoryForm,{ref:"categoryFormRef",onSuccess:a.getList},null,512),o(s,{title:"\u8868\u5355\u8BE6\u60C5",modelValue:a.formDetailVisible,"onUpdate:modelValue":e[5]||(e[5]=l=>a.formDetailVisible=l),width:"800"},{default:r(()=>[o(b,{rule:a.formDetailPreview.rule,option:a.formDetailPreview.option},null,8,["rule","option"])]),_:1},8,["modelValue"])],64)}],["__scopeId","data-v-cbdeeacc"],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/bpm/model/index.vue"]]);export{ne as default};
