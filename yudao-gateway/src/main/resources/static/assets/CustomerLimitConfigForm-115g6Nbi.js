import{bz as p,d as D,g as R,D as h,r as u,f as x,_ as k,o as _,q as L,w as l,k as s,m as w,I as F,c as j,F as K,n as N,ah as A,J as P,K as Q,L as Y,cf as q,ch as z,O as J,N as B,R as G}from"./index-BaY5TDP-.js";import{_ as H}from"./Dialog-CZSXtzfQ.js";import{E as W}from"./el-tree-select-DphqCDCz.js";import{g as X}from"./index-dK17nfjs.js";import{h as Z,d as $}from"./tree-z7HkrWVC.js";import{g as ee}from"./index-CuAlllbQ.js";var g=(o=>(o[o.CUSTOMER_QUANTITY_LIMIT=1]="CUSTOMER_QUANTITY_LIMIT",o[o.CUSTOMER_LOCK_LIMIT=2]="CUSTOMER_LOCK_LIMIT",o))(g||{});const ae=async o=>await p.get({url:"/crm/customer-limit-config/page",params:o}),te=async o=>await p.delete({url:"/crm/customer-limit-config/delete?id="+o}),E=k(D({__name:"CustomerLimitConfigForm",emits:["success"],setup(o,{expose:a,emit:M}){const{t:e}=R(),v=h(),C=u(!1),T=u(""),d=u(!1),r=u(""),m=u({id:void 0,type:g.CUSTOMER_LOCK_LIMIT,userIds:void 0,deptIds:void 0,maxCount:void 0,dealCountEnabled:!1}),V=x({type:[{required:!0,message:"\u89C4\u5219\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],maxCount:[{required:!0,message:"\u6570\u91CF\u4E0A\u9650\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),n=u(),b=u(),c=u([]),y=async(i,f,U)=>{if(C.value=!0,T.value=e("action."+i),r.value=i,t(),U){d.value=!0;try{m.value=await(async S=>await p.get({url:"/crm/customer-limit-config/get?id="+S}))(U)}finally{d.value=!1}}else m.value.type=f;b.value=Z(await X()),c.value=await ee()};a({open:y});const I=M,t=()=>{var i;m.value={id:void 0,type:g.CUSTOMER_LOCK_LIMIT,userIds:void 0,deptIds:void 0,maxCount:void 0,dealCountEnabled:!1},(i=n.value)==null||i.resetFields()},O={t:e,message:v,dialogVisible:C,dialogTitle:T,formLoading:d,formType:r,formData:m,formRules:V,formRef:n,deptTree:b,userOptions:c,open:y,emit:I,submitForm:async()=>{if(n&&await n.value.validate()){d.value=!0;try{const i=m.value;r.value==="create"?(await(async f=>await p.post({url:"/crm/customer-limit-config/create",data:f}))(i),v.success(e("common.createSuccess"))):(await(async f=>await p.put({url:"/crm/customer-limit-config/update",data:f}))(i),v.success(e("common.updateSuccess"))),C.value=!1,I("success")}finally{d.value=!1}}},resetForm:t,get defaultProps(){return $},get LimitConfType(){return g}};return Object.defineProperty(O,"__isScriptSetup",{enumerable:!1,value:!0}),O}}),[["render",function(o,a,M,e,v,C){const T=P,d=Q,r=Y,m=W,V=q,n=z,b=J,c=B,y=H,I=G;return _(),L(y,{title:e.dialogTitle,modelValue:e.dialogVisible,"onUpdate:modelValue":a[5]||(a[5]=t=>e.dialogVisible=t)},{footer:l(()=>[s(c,{onClick:e.submitForm,type:"primary",disabled:e.formLoading},{default:l(()=>a[6]||(a[6]=[w("\u786E \u5B9A")])),_:1},8,["disabled"]),s(c,{onClick:a[4]||(a[4]=t=>e.dialogVisible=!1)},{default:l(()=>a[7]||(a[7]=[w("\u53D6 \u6D88")])),_:1})]),default:l(()=>[F((_(),L(b,{ref:"formRef",model:e.formData,rules:e.formRules,"label-width":"200px"},{default:l(()=>[s(r,{label:"\u89C4\u5219\u9002\u7528\u4EBA\u7FA4",prop:"userIds"},{default:l(()=>[s(d,{multiple:"",filterable:"",modelValue:e.formData.userIds,"onUpdate:modelValue":a[0]||(a[0]=t=>e.formData.userIds=t)},{default:l(()=>[(_(!0),j(K,null,N(e.userOptions,t=>(_(),L(T,{key:t.id,label:t.nickname,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(r,{label:"\u89C4\u5219\u9002\u7528\u90E8\u95E8",prop:"deptIds"},{default:l(()=>[s(m,{modelValue:e.formData.deptIds,"onUpdate:modelValue":a[1]||(a[1]=t=>e.formData.deptIds=t),data:e.deptTree,props:e.defaultProps,multiple:"",filterable:"","check-strictly":"","node-key":"id",placeholder:"\u8BF7\u9009\u62E9\u89C4\u5219\u9002\u7528\u90E8\u95E8"},null,8,["modelValue","data","props"])]),_:1}),s(r,{label:e.formData.type===e.LimitConfType.CUSTOMER_QUANTITY_LIMIT?"\u62E5\u6709\u5BA2\u6237\u6570\u4E0A\u9650":"\u9501\u5B9A\u5BA2\u6237\u6570\u4E0A\u9650",prop:"maxCount"},{default:l(()=>[s(V,{modelValue:e.formData.maxCount,"onUpdate:modelValue":a[2]||(a[2]=t=>e.formData.maxCount=t),placeholder:"\u8BF7\u8F93\u5165\u6570\u91CF\u4E0A\u9650"},null,8,["modelValue"])]),_:1},8,["label"]),e.formData.type===e.LimitConfType.CUSTOMER_QUANTITY_LIMIT?(_(),L(r,{key:0,label:"\u6210\u4EA4\u5BA2\u6237\u662F\u5426\u5360\u7528\u62E5\u6709\u5BA2\u6237\u6570",prop:"dealCountEnabled"},{default:l(()=>[s(n,{modelValue:e.formData.dealCountEnabled,"onUpdate:modelValue":a[3]||(a[3]=t=>e.formData.dealCountEnabled=t)},null,8,["modelValue"])]),_:1})):A("",!0)]),_:1},8,["model","rules"])),[[I,e.formLoading]])]),_:1},8,["title","modelValue"])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/crm/customer/limitConfig/CustomerLimitConfigForm.vue"]]),oe=Object.freeze(Object.defineProperty({__proto__:null,default:E},Symbol.toStringTag,{value:"Module"}));export{E as C,g as L,oe as a,te as d,ae as g};
