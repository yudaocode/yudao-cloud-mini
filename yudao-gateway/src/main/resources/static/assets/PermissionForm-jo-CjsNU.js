import{d as F,g as L,D as U,r as m,f as M,C as N,G as h,U as q,a as B,_ as x,o as r,q as f,w as u,k as i,m as v,I as j,c as I,F as O,n as P,ah as k,t as A,J as Y,K as G,L as J,ak as K,al as W,ai as H,cd as Q,O as X,N as Z,R as $}from"./index-BaY5TDP-.js";import{_ as ee}from"./Dialog-CZSXtzfQ.js";import{g as ae}from"./index-CuAlllbQ.js";import{B as le,P as ue,c as te,u as oe}from"./index-BlslFSYd.js";const re=x(F({name:"CrmPermissionForm",__name:"PermissionForm",emits:["success"],setup(S,{expose:a,emit:z}){const{t:e}=L(),V=U(),c=m(!1),p=m(""),_=m(!1),s=m(""),C=m([]),t=m({}),y=M({userId:[{required:!0,message:"\u4EBA\u5458\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],level:[{required:!0,message:"\u6743\u9650\u7EA7\u522B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),n=m(),E=async(o,T,d,R)=>{c.value=!0,p.value=e("action."+o)+"\u56E2\u961F\u6210\u5458",s.value=o,b(T,d),R&&(t.value.ids=R)},g=async(o,T,d,R,w)=>{c.value=!0,p.value=e("action."+o)+"\u56E2\u961F\u6210\u5458",s.value=o,b(T,d),t.value.level=w,t.value.ids=[R]};a({open:E,open0:g});const D=z,b=(o,T)=>{var d;(d=n.value)==null||d.resetFields(),t.value={},t.value={...t.value,bizType:o,bizId:T}};N(async()=>{C.value=await ae()});const l={t:e,message:V,dialogVisible:c,dialogTitle:p,formLoading:_,formType:s,userOptions:C,formData:t,formRules:y,formRef:n,open:E,open0:g,emit:D,submitForm:async()=>{if(n&&await n.value.validate()){_.value=!0;try{const o=t.value;s.value==="create"?(await te(B(o)),V.success(e("common.createSuccess"))):(await oe(B(o)),V.success(e("common.updateSuccess"))),c.value=!1,D("success")}finally{_.value=!1}}},resetForm:b,get BizTypeEnum(){return le},get PermissionLevelEnum(){return ue},get DICT_TYPE(){return h},get getIntDictOptions(){return q}};return Object.defineProperty(l,"__isScriptSetup",{enumerable:!1,value:!0}),l}}),[["render",function(S,a,z,e,V,c){const p=Y,_=G,s=J,C=K,t=W,y=H,n=Q,E=X,g=Z,D=ee,b=$;return r(),f(D,{modelValue:e.dialogVisible,"onUpdate:modelValue":a[4]||(a[4]=l=>e.dialogVisible=l),title:e.dialogTitle,width:"30%"},{footer:u(()=>[i(g,{disabled:e.formLoading,type:"primary",onClick:e.submitForm},{default:u(()=>a[8]||(a[8]=[v("\u786E \u5B9A")])),_:1},8,["disabled"]),i(g,{onClick:a[3]||(a[3]=l=>e.dialogVisible=!1)},{default:u(()=>a[9]||(a[9]=[v("\u53D6 \u6D88")])),_:1})]),default:u(()=>[j((r(),f(E,{ref:"formRef",model:e.formData,rules:e.formRules,"label-width":"100px"},{default:u(()=>[e.formType==="create"?(r(),f(s,{key:0,label:"\u9009\u62E9\u4EBA\u5458",prop:"userId"},{default:u(()=>[i(_,{modelValue:e.formData.userId,"onUpdate:modelValue":a[0]||(a[0]=l=>e.formData.userId=l)},{default:u(()=>[(r(!0),I(O,null,P(e.userOptions,l=>(r(),f(p,{key:l.id,label:l.nickname,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):k("",!0),i(s,{label:"\u6743\u9650\u7EA7\u522B",prop:"level"},{default:u(()=>[i(t,{modelValue:e.formData.level,"onUpdate:modelValue":a[1]||(a[1]=l=>e.formData.level=l)},{default:u(()=>[(r(!0),I(O,null,P(e.getIntDictOptions(e.DICT_TYPE.CRM_PERMISSION_LEVEL),l=>(r(),I(O,{key:l.value},[l.value!=e.PermissionLevelEnum.OWNER?(r(),f(C,{key:0,value:l.value},{default:u(()=>[v(A(l.label),1)]),_:2},1032,["value"])):k("",!0)],64))),128))]),_:1},8,["modelValue"])]),_:1}),e.formType==="create"&&e.formData.bizType===e.BizTypeEnum.CRM_CUSTOMER?(r(),f(s,{key:1,label:"\u540C\u65F6\u6DFB\u52A0\u81F3"},{default:u(()=>[i(n,{modelValue:e.formData.toBizTypes,"onUpdate:modelValue":a[2]||(a[2]=l=>e.formData.toBizTypes=l)},{default:u(()=>[i(y,{value:e.BizTypeEnum.CRM_CONTACT},{default:u(()=>a[5]||(a[5]=[v("\u8054\u7CFB\u4EBA")])),_:1},8,["value"]),i(y,{value:e.BizTypeEnum.CRM_BUSINESS},{default:u(()=>a[6]||(a[6]=[v("\u5546\u673A")])),_:1},8,["value"]),i(y,{value:e.BizTypeEnum.CRM_CONTRACT},{default:u(()=>a[7]||(a[7]=[v("\u5408\u540C")])),_:1},8,["value"])]),_:1},8,["modelValue"])]),_:1})):k("",!0)]),_:1},8,["model","rules"])),[[b,e.formLoading]])]),_:1},8,["modelValue","title"])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/crm/permission/components/PermissionForm.vue"]]);export{re as default};
