import{bz as h,d as R,D as V,r as u,f as A,_ as F,X as S,o as C,c as k,k as l,w as r,I as K,q as W,m as f,ah as N,F as O,L as P,O as j,z,N as H,v as L,E as B,A as E,B as Q,cK as X}from"./index-BaY5TDP-.js";import{_ as G}from"./index-BAz6Gqim.js";import J from"./ReplyForm-DBmauSoA.js";import{R as x}from"./TabNews-CsSL-hHj.js";import"./index-avjYFQiD.js";import"./main-KjNEjHxK.js";import"./useUpload-Dg-sFRn3.js";import"./TabImage-dEaedJeg.js";import"./main-BdArqmip.js";import"./TabVoice-C2wi4dha.js";import"./main-DeQxN6ve.js";import"./TabVideo-DsHofe_N.js";import"./el-image-Bg-CwbDE.js";import"./main-BdcmYikv.js";import"./main-US54NKSx.js";import Y from"./main-DuOfDTOL.js";import{_ as Z}from"./ContentWrap-DKQn7kZm.js";import $ from"./ReplyTable-D2hqRWR2.js";import{M as I}from"./types-CAO1T7C7.js";import"./index-DrSdAlug.js";import"./index-Ci6jvA8Q.js";import"./index-D0l0uLV-.js";import"./formatTime-Dr6TiYYc.js";import"./TabText-BH6wUfdj.js";import"./TabMusic-B3V30vcB.js";import"./index-C1v7IUC9.js";import"./tagsView-lnAkwTv2.js";import"./DictTag-QtcI9ZjC.js";import"./color-BN7ZL7BD.js";import"./main-D_67skOp.js";const ee=F(R({name:"MpAutoReply",__name:"index",setup(q,{expose:o}){o();const y=V(),e=u(-1),v=u(I.Keyword),T=u(!0),_=u(0),b=u([]),M=u(null),n=A({pageNo:1,pageSize:10,accountId:e}),d=u(!1),m=u(!1),p=u({}),t=u({type:x.Text,accountId:-1}),c=async()=>{T.value=!0;try{const s=await(a={...n,type:v.value},h.get({url:"/mp/auto-reply/page",params:a}));b.value=s.list,_.value=s.total}finally{T.value=!1}var a},U=()=>{n.pageNo=1,c()},g=()=>{var a;p.value={id:void 0,accountId:n.accountId,type:v.value,requestKeyword:void 0,requestMatch:v.value===I.Keyword?1:void 0,requestMessageType:void 0},(a=M.value)==null||a.resetFields()},i={message:y,accountId:e,msgType:v,loading:T,total:_,list:b,formRef:M,queryParams:n,isCreating:d,showDialog:m,replyForm:p,reply:t,onAccountChanged:a=>{e.value=a,t.value.accountId=a,n.pageNo=1,c()},getList:c,handleQuery:U,onTabChange:a=>{v.value=a,U()},onCreate:()=>{g(),t.value={type:x.Text,accountId:n.accountId},d.value=!0,m.value=!0},onUpdate:async a=>{g();const s=await(w=>h.get({url:"/mp/auto-reply/get?id="+w}))(a);p.value={...s},delete p.value.responseMessageType,delete p.value.responseContent,delete p.value.responseMediaId,delete p.value.responseMediaUrl,delete p.value.responseDescription,delete p.value.responseArticles,t.value={type:s.responseMessageType,accountId:n.accountId,content:s.responseContent,mediaId:s.responseMediaId,url:s.responseMediaUrl,title:s.responseTitle,description:s.responseDescription,thumbMediaId:s.responseThumbMediaId,thumbMediaUrl:s.responseThumbMediaUrl,articles:s.responseArticles,musicUrl:s.responseMusicUrl,hqMusicUrl:s.responseHqMusicUrl},d.value=!1,m.value=!0},onDelete:async a=>{await y.confirm("\u662F\u5426\u786E\u8BA4\u5220\u9664\u6B64\u6570\u636E?"),await(s=>h.delete({url:"/mp/auto-reply/delete?id="+s}))(a),await c(),y.success("\u5220\u9664\u6210\u529F")},onSubmit:async()=>{var w;await((w=M.value)==null?void 0:w.validate());const a={...p.value};var s;a.responseMessageType=t.value.type,a.responseContent=t.value.content,a.responseMediaId=t.value.mediaId,a.responseMediaUrl=t.value.url,a.responseTitle=t.value.title,a.responseDescription=t.value.description,a.responseThumbMediaId=t.value.thumbMediaId,a.responseThumbMediaUrl=t.value.thumbMediaUrl,a.responseArticles=t.value.articles,a.responseMusicUrl=t.value.musicUrl,a.responseHqMusicUrl=t.value.hqMusicUrl,p.value.id!==void 0?(await(s=a,h.put({url:"/mp/auto-reply/update",data:s})),y.success("\u4FEE\u6539\u6210\u529F")):(await(D=>h.post({url:"/mp/auto-reply/create",data:D}))(a),y.success("\u65B0\u589E\u6210\u529F")),m.value=!1,await c()},reset:g,cancel:()=>{m.value=!1,g()},ReplyForm:J,get WxAccountSelect(){return Y},get ContentWrap(){return Z},ReplyTable:$,get MsgType(){return I}};return Object.defineProperty(i,"__isScriptSetup",{enumerable:!1,value:!0}),i}}),[["render",function(q,o,y,e,v,T){const _=G,b=P,M=j,n=z,d=H,m=L,p=B,t=E,c=Q,U=X,g=S("hasPermi");return C(),k(O,null,[l(_,{title:"\u81EA\u52A8\u56DE\u590D",url:"https://doc.iocoder.cn/mp/auto-reply/"}),l(e.ContentWrap,null,{default:r(()=>[l(M,{class:"-mb-15px",model:e.queryParams,inline:!0,"label-width":"68px"},{default:r(()=>[l(b,{label:"\u516C\u4F17\u53F7",prop:"accountId"},{default:r(()=>[l(e.WxAccountSelect,{onChange:e.onAccountChanged})]),_:1})]),_:1},8,["model"])]),_:1}),l(e.ContentWrap,null,{default:r(()=>[l(c,{modelValue:e.msgType,"onUpdate:modelValue":o[0]||(o[0]=i=>e.msgType=i),onTabChange:e.onTabChange},{default:r(()=>[l(p,{gutter:10,class:"mb8"},{default:r(()=>[l(m,{span:1.5},{default:r(()=>[e.msgType!==e.MsgType.Follow||e.list.length<=0?K((C(),W(d,{key:0,type:"primary",plain:"",onClick:e.onCreate},{default:r(()=>[l(n,{icon:"ep:plus"}),o[4]||(o[4]=f("\u65B0\u589E "))]),_:1})),[[g,["mp:auto-reply:create"]]]):N("",!0)]),_:1})]),_:1}),l(t,{name:e.MsgType.Follow},{label:r(()=>[l(p,{align:"middle"},{default:r(()=>[l(n,{icon:"ep:star",class:"mr-2px"}),o[5]||(o[5]=f(" \u5173\u6CE8\u65F6\u56DE\u590D"))]),_:1})]),_:1},8,["name"]),l(t,{name:e.MsgType.Message},{label:r(()=>[l(p,{align:"middle"},{default:r(()=>[l(n,{icon:"ep:chat-line-round",class:"mr-2px"}),o[6]||(o[6]=f(" \u6D88\u606F\u56DE\u590D"))]),_:1})]),_:1},8,["name"]),l(t,{name:e.MsgType.Keyword},{label:r(()=>[l(p,{align:"middle"},{default:r(()=>[l(n,{icon:"fa:newspaper-o",class:"mr-2px"}),o[7]||(o[7]=f(" \u5173\u952E\u8BCD\u56DE\u590D"))]),_:1})]),_:1},8,["name"])]),_:1},8,["modelValue"]),l(e.ReplyTable,{loading:e.loading,list:e.list,"msg-type":e.msgType,onOnUpdate:e.onUpdate,onOnDelete:e.onDelete},null,8,["loading","list","msg-type"]),l(U,{title:e.isCreating?"\u65B0\u589E\u81EA\u52A8\u56DE\u590D":"\u4FEE\u6539\u81EA\u52A8\u56DE\u590D",modelValue:e.showDialog,"onUpdate:modelValue":o[3]||(o[3]=i=>e.showDialog=i),width:"800px","destroy-on-close":""},{footer:r(()=>[l(d,{onClick:e.cancel},{default:r(()=>o[8]||(o[8]=[f("\u53D6 \u6D88")])),_:1}),l(d,{type:"primary",onClick:e.onSubmit},{default:r(()=>o[9]||(o[9]=[f("\u786E \u5B9A")])),_:1})]),default:r(()=>[l(e.ReplyForm,{modelValue:e.replyForm,"onUpdate:modelValue":o[1]||(o[1]=i=>e.replyForm=i),reply:e.reply,"onUpdate:reply":o[2]||(o[2]=i=>e.reply=i),"msg-type":e.msgType,ref:"formRef"},null,8,["modelValue","reply","msg-type"])]),_:1},8,["title","modelValue"])]),_:1})],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/mp/autoReply/index.vue"]]);export{ee as default};
