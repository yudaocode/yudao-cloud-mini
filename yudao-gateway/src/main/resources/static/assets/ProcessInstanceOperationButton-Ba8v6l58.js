import{d as ye,u as be,D as Fe,as as Re,r as c,f as v,b as ue,au as ke,_ as xe,am as he,o as i,c as f,j as V,q as m,w as o,k as t,m as u,t as y,I,ah as _,F as E,n as q,z as Se,N as _e,l as Te,Z as we,L as Ue,O as Ve,dF as Ie,J as Be,K as Oe,R as Ce}from"./index-BaY5TDP-.js";import{E as Pe}from"./el-image-Bg-CwbDE.js";import{b as De}from"./formCreate-Dy2BGZHq.js";import{a as Ne,b as Ee,r as Ae,c as Le,t as qe,d as je,s as Ke,e as ze,f as Ge,T as He}from"./index-ZFL2ufyC.js";import{d as Je}from"./index-BJQN17A_.js";import{y as Ye,O as Ze}from"./consts-vgsb8q48.js";import{B as $e,e as ae}from"./constants-CEEr2azc.js";import Me from"./SignDialog-CdrG8uN_.js";import"./download-oWiM5xVU.js";const Qe={class:"h-50px bottom-10 text-14px flex items-center color-#32373c dark:color-#fff font-bold btn-container"},We={class:"flex flex-col flex-1 pt-20px px-20px"},Xe={class:"el-icon-picture-outline"},el={class:"flex flex-col flex-1 pt-20px px-20px"},ll={class:"flex flex-col flex-1 pt-20px px-20px"},al={class:"flex flex-col flex-1 pt-20px px-20px"},ol={class:"flex flex-col flex-1 pt-20px px-20px"},tl={class:"flex flex-col flex-1 pt-20px px-20px"},sl={class:"flex flex-col flex-1 pt-20px px-20px"},nl={class:"flex flex-col flex-1 pt-20px px-20px"},rl={class:"flex flex-col flex-1 pt-20px px-20px"},il=xe(ye({name:"ProcessInstanceBtnContainer",__name:"ProcessInstanceOperationButton",props:{processInstance:{type:null,required:!0},processDefinition:{type:null,required:!0},userOptions:{type:Array,required:!0},normalForm:{type:null,required:!0},normalFormApi:{type:null,required:!0},writableFields:{type:Array,required:!0}},emits:["success"],setup(oe,{expose:l,emit:U}){const e=be(),x=Fe(),te=Re().getUser.id,h=U,d=oe,p=c(!1),b=c({approve:!1,reject:!1,transfer:!1,delegate:!1,addSign:!1,return:!1,copy:!1,cancel:!1,deleteSign:!1}),S=c([]),n=c(),P=c({}),R=c({}),k=c(),B=c(),O=c(),T=c(),D=v({reason:"",signPicUrl:""}),z=ue(()=>({reason:[{required:k.value,message:"\u5BA1\u6279\u610F\u89C1\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],signPicUrl:[{required:!0,message:"\u7B7E\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}]})),G=c(),j=v({reason:""}),H=ue(()=>({reason:[{required:k.value,message:"\u5BA1\u6279\u610F\u89C1\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]})),N=c(),A=v({copyUserIds:[],copyReason:""}),J=v({copyUserIds:[{required:!0,message:"\u6284\u9001\u4EBA\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}]}),a=c(),F=v({assigneeUserId:void 0,reason:""}),pe=v({assigneeUserId:[{required:!0,message:"\u65B0\u5BA1\u6279\u4EBA\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],reason:[{required:!0,message:"\u5BA1\u6279\u610F\u89C1\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),Y=c(),W=v({delegateUserId:void 0,reason:""}),ce=v({delegateUserId:[{required:!0,message:"\u63A5\u6536\u4EBA\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],reason:[{required:!0,message:"\u5BA1\u6279\u610F\u89C1\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),Z=c(),X=v({addSignUserIds:void 0,reason:""}),me=v({addSignUserIds:[{required:!0,message:"\u52A0\u7B7E\u5904\u7406\u4EBA\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],reason:[{required:!0,message:"\u5BA1\u6279\u610F\u89C1\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),$=c(),ee=v({deleteSignTaskId:void 0,reason:""}),ge=v({deleteSignTaskId:[{required:!0,message:"\u51CF\u7B7E\u4EBA\u5458\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],reason:[{required:!0,message:"\u5BA1\u6279\u610F\u89C1\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),M=c(),le=v({targetTaskDefinitionKey:void 0,returnReason:""}),fe=v({targetTaskDefinitionKey:[{required:!0,message:"\u9000\u56DE\u8282\u70B9\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],returnReason:[{required:!0,message:"\u9000\u56DE\u7406\u7531\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),Q=c(),se=v({cancelReason:""}),ve=v({cancelReason:[{required:!0,message:"\u53D6\u6D88\u7406\u7531\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]});ke(()=>R.value,s=>{var r,g;(r=s==null?void 0:s.btn)==null||r.show(!1),(g=s==null?void 0:s.resetBtn)==null||g.show(!1)},{deep:!0});const C=()=>{h("success")},ne=s=>{if(P.value={},R.value={},n.value=s,k.value=(s==null?void 0:s.reasonRequire)??!1,s&&s.formId&&s.formConf){const r={};De(r,s.formConf,s.formFields,s.formVariables),P.value=r}else P.value={}},re=async()=>{var s,r;if(((s=d.processDefinition)==null?void 0:s.formType)===$e.NORMAL){let g=!0;try{await((r=d.normalFormApi)==null?void 0:r.validate())}catch{g=!1}return g}return!0},ie=()=>{const s={};return d.writableFields.forEach(r=>{s[r]=d.normalFormApi.getValue(r)}),s};l({loadTodoTask:ne});const de={router:e,message:x,userId:te,emit:h,props:d,formLoading:p,popOverVisible:b,returnList:S,runningTask:n,approveForm:P,approveFormFApi:R,reasonRequire:k,approveFormRef:B,signRef:O,approveSignFormRef:T,approveReasonForm:D,approveReasonRule:z,rejectFormRef:G,rejectReasonForm:j,rejectReasonRule:H,copyFormRef:N,copyForm:A,copyFormRule:J,transferFormRef:a,transferForm:F,transferFormRule:pe,delegateFormRef:Y,delegateForm:W,delegateFormRule:ce,addSignFormRef:Z,addSignForm:X,addSignFormRule:me,deleteSignFormRef:$,deleteSignForm:ee,deleteSignFormRule:ge,returnFormRef:M,returnForm:le,returnFormRule:fe,cancelFormRef:Q,cancelForm:se,cancelFormRule:ve,openPopover:async s=>{if(s==="approve"&&!await re())return void x.warning("\u8868\u5355\u6821\u9A8C\u4E0D\u901A\u8FC7\uFF0C\u8BF7\u5148\u5B8C\u5584\u8868\u5355!!");s!=="return"||(S.value=await Ne(n.value.id),S.value.length!==0)?Object.keys(b.value).forEach(r=>{b.value[r]=r===s}):x.warning("\u5F53\u524D\u6CA1\u6709\u53EF\u9000\u56DE\u7684\u8282\u70B9")},closePropover:(s,r)=>{r&&r.resetFields(),b.value[s]=!1},handleAudit:async(s,r)=>{var g;p.value=!0;try{if(!r)return;if(await r.validate(),s){const w=ie(),L={id:n.value.id,reason:D.reason,variables:w};n.value.signEnable&&(L.signPicUrl=D.signPicUrl);const K=R.value;((g=Object.keys(K))==null?void 0:g.length)>0&&(await K.validate(),L.variables=P.value.value),await Ee(L),b.value.approve=!1,x.success("\u5BA1\u6279\u901A\u8FC7\u6210\u529F")}else{const w={id:n.value.id,reason:j.reason};await Ae(w),b.value.reject=!1,x.success("\u5BA1\u6279\u4E0D\u901A\u8FC7\u6210\u529F")}r.resetFields(),C()}finally{p.value=!1}},handleCopy:async()=>{p.value=!0;try{if(!N.value)return;await N.value.validate();const s={id:n.value.id,reason:A.copyReason,copyUserIds:A.copyUserIds};await Le(s),N.value.resetFields(),b.value.copy=!1,x.success("\u64CD\u4F5C\u6210\u529F")}finally{p.value=!1}},handleTransfer:async()=>{p.value=!0;try{if(!a.value)return;await a.value.validate();const s={id:n.value.id,reason:F.reason,assigneeUserId:F.assigneeUserId};await qe(s),a.value.resetFields(),b.value.transfer=!1,x.success("\u64CD\u4F5C\u6210\u529F"),C()}finally{p.value=!1}},handleDelegate:async()=>{p.value=!0;try{if(!Y.value)return;await Y.value.validate();const s={id:n.value.id,reason:W.reason,delegateUserId:W.delegateUserId};await je(s),b.value.delegate=!1,Y.value.resetFields(),x.success("\u64CD\u4F5C\u6210\u529F"),C()}finally{p.value=!1}},handlerAddSign:async s=>{p.value=!0;try{if(!Z.value)return;await Z.value.validate();const r={id:n.value.id,type:s,reason:X.reason,userIds:X.addSignUserIds};await Ke(r),x.success("\u64CD\u4F5C\u6210\u529F"),Z.value.resetFields(),b.value.addSign=!1,C()}finally{p.value=!1}},handleReturn:async()=>{p.value=!0;try{if(!M.value)return;await M.value.validate();const s={id:n.value.id,reason:le.returnReason,targetTaskDefinitionKey:le.targetTaskDefinitionKey};await ze(s),b.value.return=!1,M.value.resetFields(),x.success("\u64CD\u4F5C\u6210\u529F"),C()}finally{p.value=!1}},handleCancel:async()=>{p.value=!0;try{if(!Q.value)return;await Q.value.validate(),await Je(d.processInstance.id,se.cancelReason),b.value.return=!1,x.success("\u64CD\u4F5C\u6210\u529F"),Q.value.resetFields(),C()}finally{p.value=!1}},handleReCreate:async()=>{var s;await e.push({name:"BpmProcessInstanceCreate",query:{processInstanceId:(s=d.processInstance)==null?void 0:s.id}})},getDeleteSignUserLabel:s=>{var g,w,L,K;const r=((g=s==null?void 0:s.assigneeUser)==null?void 0:g.deptName)||((w=s==null?void 0:s.ownerUser)==null?void 0:w.deptName);return`${((L=s==null?void 0:s.assigneeUser)==null?void 0:L.nickname)||((K=s==null?void 0:s.ownerUser)==null?void 0:K.nickname)} ( \u6240\u5C5E\u90E8\u95E8\uFF1A${r} )`},handlerDeleteSign:async()=>{p.value=!0;try{if(!$.value)return;await $.value.validate();const s={id:ee.deleteSignTaskId,reason:ee.reason};await Ge(s),x.success("\u51CF\u7B7E\u6210\u529F"),$.value.resetFields(),b.value.deleteSign=!1,C()}finally{p.value=!1}},reload:C,isHandleTaskStatus:()=>{var r;let s=!1;return He.RUNNING===((r=n.value)==null?void 0:r.status)&&(s=!0),s},isEndProcessStatus:s=>{let r=!1;return ae.APPROVE!==s&&ae.REJECT!==s&&ae.CANCEL!==s||(r=!0),r},isShowButton:s=>{var g,w;let r=!0;return(g=n.value)!=null&&g.buttonsSetting&&((w=n.value)!=null&&w.buttonsSetting[s])&&(r=n.value.buttonsSetting[s].enable),r},getButtonDisplayName:s=>{var g,w;let r=Ze.get(s);return(g=n.value)!=null&&g.buttonsSetting&&((w=n.value)!=null&&w.buttonsSetting[s])&&(r=n.value.buttonsSetting[s].displayName),r},loadTodoTask:ne,validateNormalForm:re,getUpdatedProcessInstanceVariables:ie,handleSignFinish:s=>{D.signPicUrl=s,T.value.validate("change")},get OperationButtonType(){return Ye},SignDialog:Me};return Object.defineProperty(de,"__isScriptSetup",{enumerable:!1,value:!0}),de}}),[["render",function(oe,l,U,e,x,te){var D,z,G,j,H,N,A,J;const h=Se,d=_e,p=he("form-create"),b=Te,S=we,n=Ue,P=Pe,R=Ve,k=Ie,B=Be,O=Oe,T=Ce;return i(),f(E,null,[V("div",Qe,[e.runningTask&&e.isHandleTaskStatus()&&e.isShowButton(e.OperationButtonType.APPROVE)?(i(),m(k,{key:0,visible:e.popOverVisible.approve,placement:"top-end",width:420,trigger:"click"},{reference:o(()=>[t(d,{plain:"",type:"success",onClick:l[0]||(l[0]=a=>e.openPopover("approve"))},{default:o(()=>[t(h,{icon:"ep:select"}),u("\xA0 "+y(e.getButtonDisplayName(e.OperationButtonType.APPROVE)),1)]),_:1})]),default:o(()=>[I((i(),f("div",We,[t(R,{"label-position":"top",class:"mb-auto",ref:"approveFormRef",model:e.approveReasonForm,rules:e.approveReasonRule,"label-width":"100px"},{default:o(()=>{var a;return[((a=e.runningTask)==null?void 0:a.formId)>0?(i(),m(b,{key:0,class:"mb-15px !-mt-10px"},{header:o(()=>{var F;return[V("span",Xe," \u586B\u5199\u8868\u5355\u3010"+y((F=e.runningTask)==null?void 0:F.formName)+"\u3011 ",1)]}),default:o(()=>[t(p,{modelValue:e.approveForm.value,"onUpdate:modelValue":l[1]||(l[1]=F=>e.approveForm.value=F),api:e.approveFormFApi,"onUpdate:api":l[2]||(l[2]=F=>e.approveFormFApi=F),option:e.approveForm.option,rule:e.approveForm.rule},null,8,["modelValue","api","option","rule"])]),_:1})):_("",!0),t(n,{label:"\u5BA1\u6279\u610F\u89C1",prop:"reason"},{default:o(()=>[t(S,{modelValue:e.approveReasonForm.reason,"onUpdate:modelValue":l[3]||(l[3]=F=>e.approveReasonForm.reason=F),placeholder:"\u8BF7\u8F93\u5165\u5BA1\u6279\u610F\u89C1",type:"textarea",rows:4},null,8,["modelValue"])]),_:1}),e.runningTask.signEnable?(i(),m(n,{key:1,label:"\u7B7E\u540D",prop:"signPicUrl",ref:"approveSignFormRef"},{default:o(()=>[t(d,{onClick:l[4]||(l[4]=F=>e.signRef.open())},{default:o(()=>l[46]||(l[46]=[u("\u70B9\u51FB\u7B7E\u540D")])),_:1}),e.approveReasonForm.signPicUrl?(i(),m(P,{key:0,class:"w-90px h-40px ml-5px",src:e.approveReasonForm.signPicUrl,"preview-src-list":[e.approveReasonForm.signPicUrl]},null,8,["src","preview-src-list"])):_("",!0)]),_:1},512)):_("",!0),t(n,null,{default:o(()=>[t(d,{disabled:e.formLoading,type:"success",onClick:l[5]||(l[5]=F=>e.handleAudit(!0,e.approveFormRef))},{default:o(()=>[u(y(e.getButtonDisplayName(e.OperationButtonType.APPROVE)),1)]),_:1},8,["disabled"]),t(d,{onClick:l[6]||(l[6]=F=>e.closePropover("approve",e.approveFormRef))},{default:o(()=>l[47]||(l[47]=[u(" \u53D6\u6D88 ")])),_:1})]),_:1})]}),_:1},8,["model","rules"])])),[[T,e.formLoading]])]),_:1},8,["visible"])):_("",!0),e.runningTask&&e.isHandleTaskStatus()&&e.isShowButton(e.OperationButtonType.REJECT)?(i(),m(k,{key:1,visible:e.popOverVisible.reject,placement:"top-end",width:420,trigger:"click"},{reference:o(()=>[t(d,{class:"mr-20px",plain:"",type:"danger",onClick:l[7]||(l[7]=a=>e.openPopover("reject"))},{default:o(()=>[t(h,{icon:"ep:close"}),u("\xA0 "+y(e.getButtonDisplayName(e.OperationButtonType.REJECT)),1)]),_:1})]),default:o(()=>[I((i(),f("div",el,[t(R,{"label-position":"top",class:"mb-auto",ref:"rejectFormRef",model:e.rejectReasonForm,rules:e.rejectReasonRule,"label-width":"100px"},{default:o(()=>[t(n,{label:"\u5BA1\u6279\u610F\u89C1",prop:"reason"},{default:o(()=>[t(S,{modelValue:e.rejectReasonForm.reason,"onUpdate:modelValue":l[8]||(l[8]=a=>e.rejectReasonForm.reason=a),placeholder:"\u8BF7\u8F93\u5165\u5BA1\u6279\u610F\u89C1",type:"textarea",rows:4},null,8,["modelValue"])]),_:1}),t(n,null,{default:o(()=>[t(d,{disabled:e.formLoading,type:"danger",onClick:l[9]||(l[9]=a=>e.handleAudit(!1,e.rejectFormRef))},{default:o(()=>[u(y(e.getButtonDisplayName(e.OperationButtonType.REJECT)),1)]),_:1},8,["disabled"]),t(d,{onClick:l[10]||(l[10]=a=>e.closePropover("reject",e.rejectFormRef))},{default:o(()=>l[48]||(l[48]=[u(" \u53D6\u6D88 ")])),_:1})]),_:1})]),_:1},8,["model","rules"])])),[[T,e.formLoading]])]),_:1},8,["visible"])):_("",!0),e.runningTask&&e.isHandleTaskStatus()&&e.isShowButton(e.OperationButtonType.COPY)?(i(),m(k,{key:2,visible:e.popOverVisible.copy,placement:"top-start",width:420,trigger:"click"},{reference:o(()=>[V("div",{onClick:l[11]||(l[11]=a=>e.openPopover("copy")),class:"hover-bg-gray-100 rounded-xl p-6px"},[t(h,{size:14,icon:"svg-icon:send"}),u("\xA0 "+y(e.getButtonDisplayName(e.OperationButtonType.COPY)),1)])]),default:o(()=>[I((i(),f("div",ll,[t(R,{"label-position":"top",class:"mb-auto",ref:"copyFormRef",model:e.copyForm,rules:e.copyFormRule,"label-width":"100px"},{default:o(()=>[t(n,{label:"\u6284\u9001\u4EBA",prop:"copyUserIds"},{default:o(()=>[t(O,{modelValue:e.copyForm.copyUserIds,"onUpdate:modelValue":l[12]||(l[12]=a=>e.copyForm.copyUserIds=a),clearable:"",style:{width:"100%"},multiple:"",placeholder:"\u8BF7\u9009\u62E9\u6284\u9001\u4EBA"},{default:o(()=>[(i(!0),f(E,null,q(U.userOptions,a=>(i(),m(B,{key:a.id,label:a.nickname,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(n,{label:"\u6284\u9001\u610F\u89C1",prop:"copyReason"},{default:o(()=>[t(S,{modelValue:e.copyForm.copyReason,"onUpdate:modelValue":l[13]||(l[13]=a=>e.copyForm.copyReason=a),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u6284\u9001\u610F\u89C1",type:"textarea",rows:3},null,8,["modelValue"])]),_:1}),t(n,null,{default:o(()=>[t(d,{disabled:e.formLoading,type:"primary",onClick:e.handleCopy},{default:o(()=>[u(y(e.getButtonDisplayName(e.OperationButtonType.COPY)),1)]),_:1},8,["disabled"]),t(d,{onClick:l[14]||(l[14]=a=>e.closePropover("copy",e.copyFormRef))},{default:o(()=>l[49]||(l[49]=[u(" \u53D6\u6D88 ")])),_:1})]),_:1})]),_:1},8,["model","rules"])])),[[T,e.formLoading]])]),_:1},8,["visible"])):_("",!0),e.runningTask&&e.isHandleTaskStatus()&&e.isShowButton(e.OperationButtonType.TRANSFER)?(i(),m(k,{key:3,visible:e.popOverVisible.transfer,placement:"top-start",width:420,trigger:"click"},{reference:o(()=>[V("div",{onClick:l[15]||(l[15]=a=>e.openPopover("transfer")),class:"hover-bg-gray-100 rounded-xl p-6px"},[t(h,{size:14,icon:"fa:share-square-o"}),u("\xA0 "+y(e.getButtonDisplayName(e.OperationButtonType.TRANSFER)),1)])]),default:o(()=>[I((i(),f("div",al,[t(R,{"label-position":"top",class:"mb-auto",ref:"transferFormRef",model:e.transferForm,rules:e.transferFormRule,"label-width":"100px"},{default:o(()=>[t(n,{label:"\u65B0\u5BA1\u6279\u4EBA",prop:"assigneeUserId"},{default:o(()=>[t(O,{modelValue:e.transferForm.assigneeUserId,"onUpdate:modelValue":l[16]||(l[16]=a=>e.transferForm.assigneeUserId=a),clearable:"",style:{width:"100%"}},{default:o(()=>[(i(!0),f(E,null,q(U.userOptions,a=>(i(),m(B,{key:a.id,label:a.nickname,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(n,{label:"\u5BA1\u6279\u610F\u89C1",prop:"reason"},{default:o(()=>[t(S,{modelValue:e.transferForm.reason,"onUpdate:modelValue":l[17]||(l[17]=a=>e.transferForm.reason=a),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u5BA1\u6279\u610F\u89C1",type:"textarea",rows:3},null,8,["modelValue"])]),_:1}),t(n,null,{default:o(()=>[t(d,{disabled:e.formLoading,type:"primary",onClick:l[18]||(l[18]=a=>e.handleTransfer())},{default:o(()=>[u(y(e.getButtonDisplayName(e.OperationButtonType.TRANSFER)),1)]),_:1},8,["disabled"]),t(d,{onClick:l[19]||(l[19]=a=>e.closePropover("transfer",e.transferFormRef))},{default:o(()=>l[50]||(l[50]=[u(" \u53D6\u6D88 ")])),_:1})]),_:1})]),_:1},8,["model","rules"])])),[[T,e.formLoading]])]),_:1},8,["visible"])):_("",!0),e.runningTask&&e.isHandleTaskStatus()&&e.isShowButton(e.OperationButtonType.DELEGATE)?(i(),m(k,{key:4,visible:e.popOverVisible.delegate,placement:"top-start",width:420,trigger:"click"},{reference:o(()=>[V("div",{onClick:l[20]||(l[20]=a=>e.openPopover("delegate")),class:"hover-bg-gray-100 rounded-xl p-6px"},[t(h,{size:14,icon:"ep:position"}),u("\xA0 "+y(e.getButtonDisplayName(e.OperationButtonType.DELEGATE)),1)])]),default:o(()=>[I((i(),f("div",ol,[t(R,{"label-position":"top",class:"mb-auto",ref:"delegateFormRef",model:e.delegateForm,rules:e.delegateFormRule,"label-width":"100px"},{default:o(()=>[t(n,{label:"\u63A5\u6536\u4EBA",prop:"delegateUserId"},{default:o(()=>[t(O,{modelValue:e.delegateForm.delegateUserId,"onUpdate:modelValue":l[21]||(l[21]=a=>e.delegateForm.delegateUserId=a),clearable:"",style:{width:"100%"}},{default:o(()=>[(i(!0),f(E,null,q(U.userOptions,a=>(i(),m(B,{key:a.id,label:a.nickname,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(n,{label:"\u5BA1\u6279\u610F\u89C1",prop:"reason"},{default:o(()=>[t(S,{modelValue:e.delegateForm.reason,"onUpdate:modelValue":l[22]||(l[22]=a=>e.delegateForm.reason=a),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u5BA1\u6279\u610F\u89C1",type:"textarea",rows:3},null,8,["modelValue"])]),_:1}),t(n,null,{default:o(()=>[t(d,{disabled:e.formLoading,type:"primary",onClick:l[23]||(l[23]=a=>e.handleDelegate())},{default:o(()=>[u(y(e.getButtonDisplayName(e.OperationButtonType.DELEGATE)),1)]),_:1},8,["disabled"]),t(d,{onClick:l[24]||(l[24]=a=>e.closePropover("delegate",e.delegateFormRef))},{default:o(()=>l[51]||(l[51]=[u(" \u53D6\u6D88 ")])),_:1})]),_:1})]),_:1},8,["model","rules"])])),[[T,e.formLoading]])]),_:1},8,["visible"])):_("",!0),e.runningTask&&e.isHandleTaskStatus()&&e.isShowButton(e.OperationButtonType.ADD_SIGN)?(i(),m(k,{key:5,visible:e.popOverVisible.addSign,placement:"top-start",width:420,trigger:"click"},{reference:o(()=>[V("div",{onClick:l[25]||(l[25]=a=>e.openPopover("addSign")),class:"hover-bg-gray-100 rounded-xl p-6px"},[t(h,{size:14,icon:"ep:plus"}),u("\xA0 "+y(e.getButtonDisplayName(e.OperationButtonType.ADD_SIGN)),1)])]),default:o(()=>[I((i(),f("div",tl,[t(R,{"label-position":"top",class:"mb-auto",ref:"addSignFormRef",model:e.addSignForm,rules:e.addSignFormRule,"label-width":"100px"},{default:o(()=>[t(n,{label:"\u52A0\u7B7E\u5904\u7406\u4EBA",prop:"addSignUserIds"},{default:o(()=>[t(O,{modelValue:e.addSignForm.addSignUserIds,"onUpdate:modelValue":l[26]||(l[26]=a=>e.addSignForm.addSignUserIds=a),multiple:"",clearable:"",style:{width:"100%"}},{default:o(()=>[(i(!0),f(E,null,q(U.userOptions,a=>(i(),m(B,{key:a.id,label:a.nickname,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(n,{label:"\u5BA1\u6279\u610F\u89C1",prop:"reason"},{default:o(()=>[t(S,{modelValue:e.addSignForm.reason,"onUpdate:modelValue":l[27]||(l[27]=a=>e.addSignForm.reason=a),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u5BA1\u6279\u610F\u89C1",type:"textarea",rows:3},null,8,["modelValue"])]),_:1}),t(n,null,{default:o(()=>[t(d,{disabled:e.formLoading,type:"primary",onClick:l[28]||(l[28]=a=>e.handlerAddSign("before"))},{default:o(()=>[u(" \u5411\u524D"+y(e.getButtonDisplayName(e.OperationButtonType.ADD_SIGN)),1)]),_:1},8,["disabled"]),t(d,{disabled:e.formLoading,type:"primary",onClick:l[29]||(l[29]=a=>e.handlerAddSign("after"))},{default:o(()=>[u(" \u5411\u540E"+y(e.getButtonDisplayName(e.OperationButtonType.ADD_SIGN)),1)]),_:1},8,["disabled"]),t(d,{onClick:l[30]||(l[30]=a=>e.closePropover("addSign",e.addSignFormRef))},{default:o(()=>l[52]||(l[52]=[u(" \u53D6\u6D88 ")])),_:1})]),_:1})]),_:1},8,["model","rules"])])),[[T,e.formLoading]])]),_:1},8,["visible"])):_("",!0),((D=e.runningTask)==null?void 0:D.children.length)>0?(i(),m(k,{key:6,visible:e.popOverVisible.deleteSign,placement:"top-start",width:420,trigger:"click"},{reference:o(()=>[V("div",{onClick:l[31]||(l[31]=a=>e.openPopover("deleteSign")),class:"hover-bg-gray-100 rounded-xl p-6px"},[t(h,{size:14,icon:"ep:semi-select"}),l[53]||(l[53]=u("\xA0 \u51CF\u7B7E "))])]),default:o(()=>[I((i(),f("div",sl,[t(R,{"label-position":"top",class:"mb-auto",ref:"deleteSignFormRef",model:e.deleteSignForm,rules:e.deleteSignFormRule,"label-width":"100px"},{default:o(()=>[t(n,{label:"\u51CF\u7B7E\u4EBA\u5458",prop:"deleteSignTaskId"},{default:o(()=>[t(O,{modelValue:e.deleteSignForm.deleteSignTaskId,"onUpdate:modelValue":l[32]||(l[32]=a=>e.deleteSignForm.deleteSignTaskId=a),clearable:"",style:{width:"100%"}},{default:o(()=>[(i(!0),f(E,null,q(e.runningTask.children,a=>(i(),m(B,{key:a.id,label:e.getDeleteSignUserLabel(a),value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(n,{label:"\u5BA1\u6279\u610F\u89C1",prop:"reason"},{default:o(()=>[t(S,{modelValue:e.deleteSignForm.reason,"onUpdate:modelValue":l[33]||(l[33]=a=>e.deleteSignForm.reason=a),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u5BA1\u6279\u610F\u89C1",type:"textarea",rows:3},null,8,["modelValue"])]),_:1}),t(n,null,{default:o(()=>[t(d,{disabled:e.formLoading,type:"primary",onClick:l[34]||(l[34]=a=>e.handlerDeleteSign())},{default:o(()=>l[54]||(l[54]=[u(" \u51CF\u7B7E ")])),_:1},8,["disabled"]),t(d,{onClick:l[35]||(l[35]=a=>e.closePropover("deleteSign",e.deleteSignFormRef))},{default:o(()=>l[55]||(l[55]=[u(" \u53D6\u6D88 ")])),_:1})]),_:1})]),_:1},8,["model","rules"])])),[[T,e.formLoading]])]),_:1},8,["visible"])):_("",!0),e.runningTask&&e.isHandleTaskStatus()&&e.isShowButton(e.OperationButtonType.RETURN)?(i(),m(k,{key:7,visible:e.popOverVisible.return,placement:"top-start",width:420,trigger:"click"},{reference:o(()=>[V("div",{onClick:l[36]||(l[36]=a=>e.openPopover("return")),class:"hover-bg-gray-100 rounded-xl p-6px"},[t(h,{size:14,icon:"ep:back"}),u("\xA0 "+y(e.getButtonDisplayName(e.OperationButtonType.RETURN)),1)])]),default:o(()=>[I((i(),f("div",nl,[t(R,{"label-position":"top",class:"mb-auto",ref:"returnFormRef",model:e.returnForm,rules:e.returnFormRule,"label-width":"100px"},{default:o(()=>[t(n,{label:"\u9000\u56DE\u8282\u70B9",prop:"targetTaskDefinitionKey"},{default:o(()=>[t(O,{modelValue:e.returnForm.targetTaskDefinitionKey,"onUpdate:modelValue":l[37]||(l[37]=a=>e.returnForm.targetTaskDefinitionKey=a),clearable:"",style:{width:"100%"}},{default:o(()=>[(i(!0),f(E,null,q(e.returnList,a=>(i(),m(B,{key:a.taskDefinitionKey,label:a.name,value:a.taskDefinitionKey},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(n,{label:"\u9000\u56DE\u7406\u7531",prop:"returnReason"},{default:o(()=>[t(S,{modelValue:e.returnForm.returnReason,"onUpdate:modelValue":l[38]||(l[38]=a=>e.returnForm.returnReason=a),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u9000\u56DE\u7406\u7531",type:"textarea",rows:3},null,8,["modelValue"])]),_:1}),t(n,null,{default:o(()=>[t(d,{disabled:e.formLoading,type:"primary",onClick:l[39]||(l[39]=a=>e.handleReturn())},{default:o(()=>[u(y(e.getButtonDisplayName(e.OperationButtonType.RETURN)),1)]),_:1},8,["disabled"]),t(d,{onClick:l[40]||(l[40]=a=>e.closePropover("return",e.returnFormRef))},{default:o(()=>l[56]||(l[56]=[u(" \u53D6\u6D88 ")])),_:1})]),_:1})]),_:1},8,["model","rules"])])),[[T,e.formLoading]])]),_:1},8,["visible"])):_("",!0),e.userId!==((G=(z=U.processInstance)==null?void 0:z.startUser)==null?void 0:G.id)||e.isEndProcessStatus((j=U.processInstance)==null?void 0:j.status)?_("",!0):(i(),m(k,{key:8,visible:e.popOverVisible.cancel,placement:"top-start",width:420,trigger:"click"},{reference:o(()=>[V("div",{onClick:l[41]||(l[41]=a=>e.openPopover("cancel")),class:"hover-bg-gray-100 rounded-xl p-6px"},[t(h,{size:14,icon:"fa:mail-reply"}),l[57]||(l[57]=u("\xA0 \u53D6\u6D88 "))])]),default:o(()=>[I((i(),f("div",rl,[t(R,{"label-position":"top",class:"mb-auto",ref:"cancelFormRef",model:e.cancelForm,rules:e.cancelFormRule,"label-width":"100px"},{default:o(()=>[t(n,{label:"\u53D6\u6D88\u7406\u7531",prop:"cancelReason"},{default:o(()=>[l[58]||(l[58]=V("span",{class:"text-#878c93 text-12px"},"\xA0 \u53D6\u6D88\u540E\uFF0C\u8BE5\u5BA1\u6279\u6D41\u7A0B\u5C06\u81EA\u52A8\u7ED3\u675F",-1)),t(S,{modelValue:e.cancelForm.cancelReason,"onUpdate:modelValue":l[42]||(l[42]=a=>e.cancelForm.cancelReason=a),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u53D6\u6D88\u7406\u7531",type:"textarea",rows:3},null,8,["modelValue"])]),_:1}),t(n,null,{default:o(()=>[t(d,{disabled:e.formLoading,type:"primary",onClick:l[43]||(l[43]=a=>e.handleCancel())},{default:o(()=>l[59]||(l[59]=[u(" \u786E\u8BA4 ")])),_:1},8,["disabled"]),t(d,{onClick:l[44]||(l[44]=a=>e.closePropover("cancel",e.cancelFormRef))},{default:o(()=>l[60]||(l[60]=[u(" \u53D6\u6D88 ")])),_:1})]),_:1})]),_:1},8,["model","rules"])])),[[T,e.formLoading]])]),_:1},8,["visible"])),e.userId===((N=(H=U.processInstance)==null?void 0:H.startUser)==null?void 0:N.id)&&e.isEndProcessStatus((A=U.processInstance)==null?void 0:A.status)&&((J=U.processDefinition)==null?void 0:J.formType)===10?(i(),f("div",{key:9,onClick:l[45]||(l[45]=a=>e.handleReCreate()),class:"hover-bg-gray-100 rounded-xl p-6px"},[t(h,{size:14,icon:"ep:refresh"}),l[61]||(l[61]=u("\xA0 \u518D\u6B21\u63D0\u4EA4 "))])):_("",!0)]),t(e.SignDialog,{ref:"signRef",onSuccess:e.handleSignFinish},null,512)],64)}],["__scopeId","data-v-bf740ba7"],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/bpm/processInstance/detail/ProcessInstanceOperationButton.vue"]]);export{il as default};
