import{_ as X}from"./ContentWrap-DKQn7kZm.js";import{d as K,p as N,r as T,S as M,u as j,C as q,a as B,aA as G,G as L,aB as H,D as Q,aC as z,_ as J,X as x,c as f,k as t,w as a,F as b,o as d,m as o,t as u,q as n,ah as p,I as V,j as D,n as k,aF as W,N as Z,an as $,P as ee,Q as ae,v as te,E as re,y as le}from"./index-BaY5TDP-.js";import{E as oe,a as se}from"./el-timeline-item-BFYwlQ-d.js";import{E as ue,a as de}from"./el-descriptions-item-CRF_CO88.js";import{_ as ie}from"./DictTag-QtcI9ZjC.js";import{g as ne,a as pe,p as me}from"./index-B6VQ3j6W.js";import{f as fe}from"./formatTime-Dr6TiYYc.js";import ce from"./OrderUpdateRemarkForm-DFb8OYLH.js";import ye from"./OrderDeliveryForm-qOqRbOq-.js";import _e from"./OrderUpdateAddressForm-C6NV58p8.js";import De from"./OrderUpdatePriceForm-xnJ7vqWL.js";import{g as ve}from"./index-MboYiMOx.js";import{u as Te}from"./tagsView-lnAkwTv2.js";import{D as h,T as be}from"./constants-CEEr2azc.js";import{g as Ee}from"./index-BuoBEkWu.js";import"./color-BN7ZL7BD.js";import"./Dialog-CZSXtzfQ.js";import"./el-tree-select-DphqCDCz.js";import"./index-Qzz5HSIB.js";import"./tree-z7HkrWVC.js";const ke=K({name:"TradeOrderDetail",__name:"index",props:{id:N.number.def(void 0),showPickUp:N.bool.def(!0)},setup(O,{expose:s}){s();const E=Q(),e=T({logs:[]}),Y=T(),F=T(),l=T(),c=T(),{params:y}=M(),v=O,P=y.id||v.id,_=async()=>{if(P){const i=await pe(P);i||(E.error("\u4EA4\u6613\u8BA2\u5355\u4E0D\u5B58\u5728"),I()),e.value=i}},{delView:C}=Te(),{push:S,currentRoute:U}=j(),I=()=>{C(B(U)),S({name:"TradeOrder"})},g=T([]),R=T([]),A=T({});q(async()=>{await _(),e.value.deliveryType===h.EXPRESS.type?(g.value=await ve(),e.value.logisticsId&&(R.value=await ne(e.value.id))):e.value.deliveryType===h.PICK_UP.type&&e.value.pickUpStoreId&&(A.value=await Ee(e.value.pickUpStoreId))});const w={message:E,getUserTypeColor:i=>{const r=z(L.USER_TYPE,i);switch(r==null?void 0:r.colorType){case"success":return"#67C23A";case"info":return"#909399";case"warning":return"#E6A23C";case"danger":return"#F56C6C"}return"#409EFF"},formData:e,updateRemarkForm:Y,remark:()=>{var i;(i=Y.value)==null||i.open(e.value)},deliveryFormRef:F,delivery:()=>{var i;(i=F.value)==null||i.open(e.value)},updateAddressFormRef:l,updateAddress:()=>{var i;(i=l.value)==null||i.open(e.value)},updatePriceFormRef:c,updatePrice:()=>{var i;(i=c.value)==null||i.open(e.value)},handlePickUp:async()=>{try{await E.confirm("\u786E\u8BA4\u6838\u9500\u8BA2\u5355\u5417\uFF1F"),await me(e.value.id),E.success("\u6838\u9500\u6210\u529F"),await _()}catch{}},params:y,props:v,id:P,getDetail:_,delView:C,push:S,currentRoute:U,close:I,clipboardSuccess:()=>{E.success("\u590D\u5236\u6210\u529F")},deliveryExpressList:g,expressTrackList:R,pickUpStore:A,get fenToYuan(){return G},get formatDate(){return fe},get DICT_TYPE(){return L},get getDictLabel(){return H},OrderUpdateRemarkForm:ce,OrderDeliveryForm:ye,OrderUpdateAddressForm:_e,OrderUpdatePriceForm:De,get DeliveryTypeEnum(){return h},get TradeOrderStatusEnum(){return be}};return Object.defineProperty(w,"__isScriptSetup",{enumerable:!1,value:!0}),w}}),Pe={key:0},Se={key:1},ge={class:"el-timeline-right-content"},Re=J(ke,[["render",function(O,s,E,e,Y,F){const l=ue,c=ie,y=de,v=Z,P=$,_=ee,C=ae,S=te,U=re,I=le,g=oe,R=se,A=X,w=x("hasPermi"),i=x("clipboard");return d(),f(b,null,[t(A,null,{default:a(()=>[t(y,{title:"\u8BA2\u5355\u4FE1\u606F"},{default:a(()=>[t(l,{label:"\u8BA2\u5355\u53F7: "},{default:a(()=>[o(u(e.formData.no),1)]),_:1}),t(l,{label:"\u4E70\u5BB6: "},{default:a(()=>{var r,m;return[o(u((m=(r=e.formData)==null?void 0:r.user)==null?void 0:m.nickname),1)]}),_:1}),t(l,{label:"\u8BA2\u5355\u7C7B\u578B: "},{default:a(()=>[t(c,{type:e.DICT_TYPE.TRADE_ORDER_TYPE,value:e.formData.type},null,8,["type","value"])]),_:1}),t(l,{label:"\u8BA2\u5355\u6765\u6E90: "},{default:a(()=>[t(c,{type:e.DICT_TYPE.TERMINAL,value:e.formData.terminal},null,8,["type","value"])]),_:1}),t(l,{label:"\u4E70\u5BB6\u7559\u8A00: "},{default:a(()=>[o(u(e.formData.userRemark),1)]),_:1}),t(l,{label:"\u5546\u5BB6\u5907\u6CE8: "},{default:a(()=>[o(u(e.formData.remark),1)]),_:1}),t(l,{label:"\u652F\u4ED8\u5355\u53F7: "},{default:a(()=>[o(u(e.formData.payOrderId),1)]),_:1}),t(l,{label:"\u4ED8\u6B3E\u65B9\u5F0F: "},{default:a(()=>[t(c,{type:e.DICT_TYPE.PAY_CHANNEL_CODE,value:e.formData.payChannelCode},null,8,["type","value"])]),_:1}),e.formData.brokerageUser?(d(),n(l,{key:0,label:"\u63A8\u5E7F\u7528\u6237: "},{default:a(()=>{var r;return[o(u((r=e.formData.brokerageUser)==null?void 0:r.nickname),1)]}),_:1})):p("",!0)]),_:1}),t(y,{column:1,title:"\u8BA2\u5355\u72B6\u6001"},{default:a(()=>[t(l,{label:"\u8BA2\u5355\u72B6\u6001: "},{default:a(()=>[t(c,{type:e.DICT_TYPE.TRADE_ORDER_STATUS,value:e.formData.status},null,8,["type","value"])]),_:1}),V((d(),n(l,{"label-class-name":"no-colon"},{default:a(()=>[e.formData.status===e.TradeOrderStatusEnum.UNPAID.status?(d(),n(v,{key:0,type:"primary",onClick:e.updatePrice},{default:a(()=>s[0]||(s[0]=[o(" \u8C03\u6574\u4EF7\u683C ")])),_:1})):p("",!0),t(v,{type:"primary",onClick:e.remark},{default:a(()=>s[1]||(s[1]=[o("\u5907\u6CE8")])),_:1}),e.formData.status===e.TradeOrderStatusEnum.UNDELIVERED.status?(d(),f(b,{key:1},[e.formData.deliveryType===e.DeliveryTypeEnum.EXPRESS.type?(d(),n(v,{key:0,type:"primary",onClick:e.delivery},{default:a(()=>s[2]||(s[2]=[o(" \u53D1\u8D27 ")])),_:1})):p("",!0),e.formData.deliveryType===e.DeliveryTypeEnum.EXPRESS.type?(d(),n(v,{key:1,type:"primary",onClick:e.updateAddress},{default:a(()=>s[3]||(s[3]=[o(" \u4FEE\u6539\u5730\u5740 ")])),_:1})):p("",!0),e.formData.deliveryType===e.DeliveryTypeEnum.PICK_UP.type&&E.showPickUp?(d(),n(v,{key:2,type:"primary",onClick:e.handlePickUp},{default:a(()=>s[4]||(s[4]=[o(" \u6838\u9500 ")])),_:1})):p("",!0)],64)):p("",!0)]),_:1})),[[w,["trade:order:update"]]]),t(l,null,{label:a(()=>s[5]||(s[5]=[D("span",{style:{color:"red"}},"\u63D0\u9192: ",-1)])),default:a(()=>[s[6]||(s[6]=o(" \u4E70\u5BB6\u4ED8\u6B3E\u6210\u529F\u540E\uFF0C\u8D27\u6B3E\u5C06\u76F4\u63A5\u8FDB\u5165\u60A8\u7684\u5546\u6237\u53F7\uFF08\u5FAE\u4FE1\u3001\u652F\u4ED8\u5B9D\uFF09")),s[7]||(s[7]=D("br",null,null,-1)),s[8]||(s[8]=o(" \u8BF7\u53CA\u65F6\u5173\u6CE8\u4F60\u53D1\u51FA\u7684\u5305\u88F9\u72B6\u6001\uFF0C\u786E\u4FDD\u53EF\u4EE5\u914D\u9001\u81F3\u4E70\u5BB6\u624B\u4E2D ")),s[9]||(s[9]=D("br",null,null,-1)),s[10]||(s[10]=o(" \u5982\u679C\u4E70\u5BB6\u8868\u793A\u6CA1\u6536\u5230\u8D27\u6216\u8D27\u7269\u6709\u95EE\u9898\uFF0C\u8BF7\u53CA\u65F6\u8054\u7CFB\u4E70\u5BB6\u5904\u7406\uFF0C\u53CB\u597D\u534F\u5546 "))]),_:1})]),_:1}),t(y,{title:"\u5546\u54C1\u4FE1\u606F"},{default:a(()=>[t(l,{labelClassName:"no-colon"},{default:a(()=>[t(U,{gutter:20},{default:a(()=>[t(S,{span:15},{default:a(()=>[t(C,{data:e.formData.items,border:""},{default:a(()=>[t(_,{label:"\u5546\u54C1",prop:"spuName",width:"auto"},{default:a(({row:r})=>[o(u(r.spuName)+" ",1),(d(!0),f(b,null,k(r.properties,m=>(d(),n(P,{key:m.propertyId},{default:a(()=>[o(u(m.propertyName)+": "+u(m.valueName),1)]),_:2},1024))),128))]),_:1}),t(_,{label:"\u5546\u54C1\u539F\u4EF7",prop:"price",width:"150"},{default:a(({row:r})=>[o(u(e.fenToYuan(r.price))+"\u5143",1)]),_:1}),t(_,{label:"\u6570\u91CF",prop:"count",width:"100"}),t(_,{label:"\u5408\u8BA1",prop:"payPrice",width:"150"},{default:a(({row:r})=>[o(u(e.fenToYuan(r.payPrice))+"\u5143",1)]),_:1}),t(_,{label:"\u552E\u540E\u72B6\u6001",prop:"afterSaleStatus",width:"120"},{default:a(({row:r})=>[t(c,{type:e.DICT_TYPE.TRADE_ORDER_ITEM_AFTER_SALE_STATUS,value:r.afterSaleStatus},null,8,["type","value"])]),_:1})]),_:1},8,["data"])]),_:1}),t(S,{span:10})]),_:1})]),_:1})]),_:1}),t(y,{column:4},{default:a(()=>[t(l,{label:"\u5546\u54C1\u603B\u989D: "},{default:a(()=>[o(u(e.fenToYuan(e.formData.totalPrice))+" \u5143 ",1)]),_:1}),t(l,{label:"\u8FD0\u8D39\u91D1\u989D: "},{default:a(()=>[o(u(e.fenToYuan(e.formData.deliveryPrice))+" \u5143 ",1)]),_:1}),t(l,{label:"\u8BA2\u5355\u8C03\u4EF7: "},{default:a(()=>[o(u(e.fenToYuan(e.formData.adjustPrice))+" \u5143 ",1)]),_:1}),(d(),f(b,null,k(1,r=>t(l,{key:r,"label-class-name":"no-colon"})),64)),t(l,null,{label:a(()=>s[11]||(s[11]=[D("span",{style:{color:"red"}},"\u4F18\u60E0\u52B5\u4F18\u60E0: ",-1)])),default:a(()=>[o(" "+u(e.fenToYuan(e.formData.couponPrice))+" \u5143 ",1)]),_:1}),t(l,null,{label:a(()=>s[12]||(s[12]=[D("span",{style:{color:"red"}},"VIP \u4F18\u60E0: ",-1)])),default:a(()=>[o(" "+u(e.fenToYuan(e.formData.vipPrice))+" \u5143 ",1)]),_:1}),t(l,null,{label:a(()=>s[13]||(s[13]=[D("span",{style:{color:"red"}},"\u6D3B\u52A8\u4F18\u60E0: ",-1)])),default:a(()=>[o(" "+u(e.fenToYuan(e.formData.discountPrice))+" \u5143 ",1)]),_:1}),t(l,null,{label:a(()=>s[14]||(s[14]=[D("span",{style:{color:"red"}},"\u79EF\u5206\u62B5\u6263: ",-1)])),default:a(()=>[o(" "+u(e.fenToYuan(e.formData.pointPrice))+" \u5143 ",1)]),_:1}),(d(),f(b,null,k(3,r=>t(l,{key:r,"label-class-name":"no-colon"})),64)),t(l,{label:"\u5E94\u4ED8\u91D1\u989D: "},{default:a(()=>[o(u(e.fenToYuan(e.formData.payPrice))+" \u5143 ",1)]),_:1})]),_:1}),t(y,{column:4,title:"\u6536\u8D27\u4FE1\u606F"},{default:a(()=>[t(l,{label:"\u914D\u9001\u65B9\u5F0F: "},{default:a(()=>[t(c,{type:e.DICT_TYPE.TRADE_DELIVERY_TYPE,value:e.formData.deliveryType},null,8,["type","value"])]),_:1}),t(l,{label:"\u6536\u8D27\u4EBA: "},{default:a(()=>[o(u(e.formData.receiverName),1)]),_:1}),t(l,{label:"\u8054\u7CFB\u7535\u8BDD: "},{default:a(()=>[o(u(e.formData.receiverMobile),1)]),_:1}),e.formData.deliveryType===e.DeliveryTypeEnum.EXPRESS.type?(d(),f("div",Pe,[e.formData.receiverDetailAddress?(d(),n(l,{key:0,label:"\u6536\u8D27\u5730\u5740: "},{default:a(()=>[o(u(e.formData.receiverAreaName)+" "+u(e.formData.receiverDetailAddress)+" ",1),V(t(I,{icon:"ep:document-copy",type:"primary"},null,512),[[i,e.formData.receiverAreaName+" "+e.formData.receiverDetailAddress,"copy"],[i,e.clipboardSuccess,"success"]])]),_:1})):p("",!0),e.formData.logisticsId?(d(),n(l,{key:1,label:"\u7269\u6D41\u516C\u53F8: "},{default:a(()=>{var r;return[o(u((r=e.deliveryExpressList.find(m=>m.id===e.formData.logisticsId))==null?void 0:r.name),1)]}),_:1})):p("",!0),e.formData.logisticsId?(d(),n(l,{key:2,label:"\u8FD0\u5355\u53F7: "},{default:a(()=>[o(u(e.formData.logisticsNo),1)]),_:1})):p("",!0),e.formatDate.deliveryTime?(d(),n(l,{key:3,label:"\u53D1\u8D27\u65F6\u95F4: "},{default:a(()=>[o(u(e.formatDate(e.formData.deliveryTime)),1)]),_:1})):p("",!0),(d(),f(b,null,k(2,r=>t(l,{key:r,"label-class-name":"no-colon"})),64)),e.expressTrackList.length>0?(d(),n(l,{key:4,label:"\u7269\u6D41\u8BE6\u60C5: "},{default:a(()=>[t(R,null,{default:a(()=>[(d(!0),f(b,null,k(e.expressTrackList,(r,m)=>(d(),n(g,{key:m,timestamp:e.formatDate(r.time)},{default:a(()=>[o(u(r.content),1)]),_:2},1032,["timestamp"]))),128))]),_:1})]),_:1})):p("",!0)])):p("",!0),e.formData.deliveryType===e.DeliveryTypeEnum.PICK_UP.type?(d(),f("div",Se,[e.formData.pickUpStoreId?(d(),n(l,{key:0,label:"\u81EA\u63D0\u95E8\u5E97: "},{default:a(()=>{var r;return[o(u((r=e.pickUpStore)==null?void 0:r.name),1)]}),_:1})):p("",!0)])):p("",!0)]),_:1}),t(y,{title:"\u8BA2\u5355\u64CD\u4F5C\u65E5\u5FD7"},{default:a(()=>[t(l,{labelClassName:"no-colon"},{default:a(()=>[t(R,null,{default:a(()=>[(d(!0),f(b,null,k(e.formData.logs,(r,m)=>(d(),n(g,{key:m,timestamp:e.formatDate(r.createTime),placement:"top"},{dot:a(()=>[D("span",{style:W({backgroundColor:e.getUserTypeColor(r.userType)}),class:"dot-node-style"},u(e.getDictLabel(e.DICT_TYPE.USER_TYPE,r.userType)[0]),5)]),default:a(()=>[D("div",ge,u(r.content),1)]),_:2},1032,["timestamp"]))),128))]),_:1})]),_:1})]),_:1})]),_:1}),t(e.OrderDeliveryForm,{ref:"deliveryFormRef",onSuccess:e.getDetail},null,512),t(e.OrderUpdateRemarkForm,{ref:"updateRemarkForm",onSuccess:e.getDetail},null,512),t(e.OrderUpdateAddressForm,{ref:"updateAddressFormRef",onSuccess:e.getDetail},null,512),t(e.OrderUpdatePriceForm,{ref:"updatePriceFormRef",onSuccess:e.getDetail},null,512)],64)}],["__scopeId","data-v-61c53d16"],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/mall/trade/order/detail/index.vue"]]);export{Re as default};
