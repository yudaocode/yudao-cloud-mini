import{d as b,r as h,f as C,C as P,eu as v,e2 as _,_ as A,o as x,c as S,k as r,w as l,I,q as D,m as p,t as g,F as q,l as F,P as O,Q as T,R as U}from"./index-BaY5TDP-.js";import{E as B}from"./el-skeleton-item-BYAIkmCs.js";import{_ as L}from"./Echart-BQxFkezy.js";import{S as w}from"./customer-DKZgktXn.js";import"./echarts-DpbyC_6K.js";const j=A(b({name:"CustomerSummary",__name:"CustomerSummary",props:{queryParams:{type:null,required:!0}},setup(y,{expose:f}){const m=y,e=h(!1),d=h([]),a=C({grid:{left:20,right:30,bottom:20,containLabel:!0},legend:{},series:[{name:"\u65B0\u589E\u5BA2\u6237\u6570",type:"bar",yAxisIndex:0,data:[]},{name:"\u6210\u4EA4\u5BA2\u6237\u6570",type:"bar",yAxisIndex:1,data:[]}],toolbox:{feature:{dataZoom:{xAxisIndex:!1},brush:{type:["lineX","clear"]},saveAsImage:{show:!0,name:"\u5BA2\u6237\u603B\u91CF\u5206\u6790"}}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},yAxis:[{type:"value",name:"\u65B0\u589E\u5BA2\u6237\u6570",min:0,minInterval:1},{type:"value",name:"\u6210\u4EA4\u5BA2\u6237\u6570",min:0,minInterval:1,splitLine:{lineStyle:{type:"dotted",opacity:.7}}}],xAxis:{type:"category",name:"\u65E5\u671F",data:[]}}),u=async()=>{const t=await w.getCustomerSummaryByDate(m.queryParams),c=await w.getCustomerSummaryByUser(m.queryParams);a.xAxis&&a.xAxis.data&&(a.xAxis.data=t.map(s=>s.time)),a.series&&a.series[0]&&a.series[0].data&&(a.series[0].data=t.map(s=>s.customerCreateCount)),a.series&&a.series[1]&&a.series[1].data&&(a.series[1].data=t.map(s=>s.customerDealCount)),d.value=c},n=async()=>{e.value=!0;try{await u()}finally{e.value=!1}};f({loadData:n}),P(()=>{n()});const o={props:m,loading:e,list:d,echartsOption:a,fetchAndFill:u,loadData:n,get erpCalculatePercentage(){return v},get erpPriceTableColumnFormatter(){return _}};return Object.defineProperty(o,"__isScriptSetup",{enumerable:!1,value:!0}),o}}),[["render",function(y,f,m,e,d,a){const u=L,n=B,o=F,t=O,c=T,s=U;return x(),S(q,null,[r(o,{shadow:"never"},{default:l(()=>[r(n,{loading:e.loading,animated:""},{default:l(()=>[r(u,{height:500,options:e.echartsOption},null,8,["options"])]),_:1},8,["loading"])]),_:1}),r(o,{shadow:"never",class:"mt-16px"},{default:l(()=>[I((x(),D(c,{data:e.list},{default:l(()=>[r(t,{label:"\u5E8F\u53F7",align:"center",type:"index",width:"80",fixed:"left"}),r(t,{label:"\u5458\u5DE5\u59D3\u540D",prop:"ownerUserName","min-width":"100",fixed:"left"}),r(t,{label:"\u65B0\u589E\u5BA2\u6237\u6570",align:"right",prop:"customerCreateCount","min-width":"200"}),r(t,{label:"\u6210\u4EA4\u5BA2\u6237\u6570",align:"right",prop:"customerDealCount","min-width":"200"}),r(t,{label:"\u5BA2\u6237\u6210\u4EA4\u7387(%)",align:"right","min-width":"200"},{default:l(i=>[p(g(e.erpCalculatePercentage(i.row.customerDealCount,i.row.customerCreateCount)),1)]),_:1}),r(t,{label:"\u5408\u540C\u603B\u91D1\u989D",align:"right",prop:"contractPrice","min-width":"200",formatter:e.erpPriceTableColumnFormatter},null,8,["formatter"]),r(t,{label:"\u56DE\u6B3E\u91D1\u989D",align:"right",prop:"receivablePrice","min-width":"200",formatter:e.erpPriceTableColumnFormatter},null,8,["formatter"]),r(t,{label:"\u672A\u56DE\u6B3E\u91D1\u989D",align:"right","min-width":"200"},{default:l(i=>[p(g(e.erpCalculatePercentage(i.row.receivablePrice,i.row.contractPrice)),1)]),_:1}),r(t,{label:"\u56DE\u6B3E\u5B8C\u6210\u7387(%)",align:"right","min-width":"200",fixed:"right"},{default:l(i=>[p(g(e.erpCalculatePercentage(i.row.receivablePrice,i.row.contractPrice)),1)]),_:1})]),_:1},8,["data"])),[[s,e.loading]])]),_:1})],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/crm/statistics/customer/components/CustomerSummary.vue"]]);export{j as default};
