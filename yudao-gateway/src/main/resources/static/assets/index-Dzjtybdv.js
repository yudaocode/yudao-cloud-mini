import{d as L,u as Y,D as B,g as F,r as f,f as O,ba as Q,C as R,G as z,U as A,ar as K,_ as H,X as j,o,c as g,k as l,w as t,F as _,n as I,q as p,Y as C,m as b,I as T,t as U,j as G,ah as J,J as W,K as X,L as Z,Z as $,M as ee,z as ae,N as le,O as re,P as te,Q as se,R as oe}from"./index-BaY5TDP-.js";import{_ as ne}from"./index-avjYFQiD.js";import{_ as ie}from"./DictTag-QtcI9ZjC.js";import{_ as ue}from"./ContentWrap-DKQn7kZm.js";import{_ as de}from"./index-BAz6Gqim.js";import{d as me,a as pe}from"./formatTime-Dr6TiYYc.js";import{b as ce,c as fe}from"./index-BJQN17A_.js";import{C as ye}from"./index-D7iZxFey.js";import{g as ge}from"./index-CuAlllbQ.js";import"./index-DrSdAlug.js";import"./color-BN7ZL7BD.js";const _e=H(L({name:"BpmProcessInstanceManager",__name:"index",setup(V,{expose:r}){r();const k=Y(),e=B(),{t:w}=F(),h=f(!0),P=f(0),c=f([]),m=O({pageNo:1,pageSize:10,startUserId:void 0,name:"",processDefinitionId:void 0,category:void 0,status:void 0,createTime:[]}),n=f(),y=f([]),v=f([]),u=async()=>{h.value=!0;try{const i=await ce(m);c.value=i.list,P.value=i.total}finally{h.value=!1}},d=()=>{m.pageNo=1,u()};Q(()=>{u()}),R(async()=>{await u(),y.value=await ye.getCategorySimpleList(),v.value=await ge()});const q={router:k,message:e,t:w,loading:h,total:P,list:c,queryParams:m,queryFormRef:n,categoryList:y,userList:v,getList:u,handleQuery:d,resetQuery:()=>{n.value.resetFields(),d()},handleDetail:i=>{k.push({name:"BpmProcessInstanceDetail",query:{id:i.id}})},handleCancel:async i=>{const{value:s}=await K.prompt("\u8BF7\u8F93\u5165\u53D6\u6D88\u539F\u56E0","\u53D6\u6D88\u6D41\u7A0B",{confirmButtonText:w("common.ok"),cancelButtonText:w("common.cancel"),inputPattern:/^[\s\S]*.*\S[\s\S]*$/,inputErrorMessage:"\u53D6\u6D88\u539F\u56E0\u4E0D\u80FD\u4E3A\u7A7A"});await fe(i.id,s),e.success("\u53D6\u6D88\u6210\u529F"),await u()},get DICT_TYPE(){return z},get getIntDictOptions(){return A},get dateFormatter(){return me},get formatPast2(){return pe}};return Object.defineProperty(q,"__isScriptSetup",{enumerable:!1,value:!0}),q}}),[["render",function(V,r,k,e,w,h){const P=de,c=W,m=X,n=Z,y=$,v=ee,u=ae,d=le,q=re,i=ue,s=te,D=ie,N=se,M=ne,S=j("hasPermi"),E=oe;return o(),g(_,null,[l(P,{title:"\u5DE5\u4F5C\u6D41\u624B\u518C",url:"https://doc.iocoder.cn/bpm/"}),l(i,null,{default:t(()=>[l(q,{class:"-mb-15px",model:e.queryParams,ref:"queryFormRef",inline:!0,"label-width":"68px"},{default:t(()=>[l(n,{label:"\u53D1\u8D77\u4EBA",prop:"startUserId"},{default:t(()=>[l(m,{modelValue:e.queryParams.startUserId,"onUpdate:modelValue":r[0]||(r[0]=a=>e.queryParams.startUserId=a),placeholder:"\u8BF7\u9009\u62E9\u53D1\u8D77\u4EBA",class:"!w-240px"},{default:t(()=>[(o(!0),g(_,null,I(e.userList,a=>(o(),p(c,{key:a.id,label:a.nickname,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"\u6D41\u7A0B\u540D\u79F0",prop:"name"},{default:t(()=>[l(y,{modelValue:e.queryParams.name,"onUpdate:modelValue":r[1]||(r[1]=a=>e.queryParams.name=a),placeholder:"\u8BF7\u8F93\u5165\u6D41\u7A0B\u540D\u79F0",clearable:"",onKeyup:C(e.handleQuery,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),l(n,{label:"\u6240\u5C5E\u6D41\u7A0B",prop:"processDefinitionId"},{default:t(()=>[l(y,{modelValue:e.queryParams.processDefinitionId,"onUpdate:modelValue":r[2]||(r[2]=a=>e.queryParams.processDefinitionId=a),placeholder:"\u8BF7\u8F93\u5165\u6D41\u7A0B\u5B9A\u4E49\u7684\u7F16\u53F7",clearable:"",onKeyup:C(e.handleQuery,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),l(n,{label:"\u6D41\u7A0B\u5206\u7C7B",prop:"category"},{default:t(()=>[l(m,{modelValue:e.queryParams.category,"onUpdate:modelValue":r[3]||(r[3]=a=>e.queryParams.category=a),placeholder:"\u8BF7\u9009\u62E9\u6D41\u7A0B\u5206\u7C7B",clearable:"",class:"!w-240px"},{default:t(()=>[(o(!0),g(_,null,I(e.categoryList,a=>(o(),p(c,{key:a.code,label:a.name,value:a.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"\u6D41\u7A0B\u72B6\u6001",prop:"status"},{default:t(()=>[l(m,{modelValue:e.queryParams.status,"onUpdate:modelValue":r[4]||(r[4]=a=>e.queryParams.status=a),placeholder:"\u8BF7\u9009\u62E9\u6D41\u7A0B\u72B6\u6001",clearable:"",class:"!w-240px"},{default:t(()=>[(o(!0),g(_,null,I(e.getIntDictOptions(e.DICT_TYPE.BPM_PROCESS_INSTANCE_STATUS),a=>(o(),p(c,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"\u53D1\u8D77\u65F6\u95F4",prop:"createTime"},{default:t(()=>[l(v,{modelValue:e.queryParams.createTime,"onUpdate:modelValue":r[5]||(r[5]=a=>e.queryParams.createTime=a),"value-format":"YYYY-MM-DD HH:mm:ss",type:"daterange","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F","default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],class:"!w-240px"},null,8,["modelValue","default-time"])]),_:1}),l(n,null,{default:t(()=>[l(d,{onClick:e.handleQuery},{default:t(()=>[l(u,{icon:"ep:search",class:"mr-5px"}),r[8]||(r[8]=b(" \u641C\u7D22"))]),_:1}),l(d,{onClick:e.resetQuery},{default:t(()=>[l(u,{icon:"ep:refresh",class:"mr-5px"}),r[9]||(r[9]=b(" \u91CD\u7F6E"))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),l(i,null,{default:t(()=>[T((o(),p(N,{data:e.list},{default:t(()=>[l(s,{label:"\u6D41\u7A0B\u540D\u79F0",align:"center",prop:"name","min-width":"200px",fixed:"left"}),l(s,{label:"\u6D41\u7A0B\u5206\u7C7B",align:"center",prop:"categoryName","min-width":"100",fixed:"left"}),l(s,{label:"\u6D41\u7A0B\u53D1\u8D77\u4EBA",align:"center",prop:"startUser.nickname",width:"120"}),l(s,{label:"\u53D1\u8D77\u90E8\u95E8",align:"center",prop:"startUser.deptName",width:"120"}),l(s,{label:"\u6D41\u7A0B\u72B6\u6001",prop:"status",width:"120"},{default:t(a=>[l(D,{type:e.DICT_TYPE.BPM_PROCESS_INSTANCE_STATUS,value:a.row.status},null,8,["type","value"])]),_:1}),l(s,{label:"\u53D1\u8D77\u65F6\u95F4",align:"center",prop:"startTime",width:"180",formatter:e.dateFormatter},null,8,["formatter"]),l(s,{label:"\u7ED3\u675F\u65F6\u95F4",align:"center",prop:"endTime",width:"180",formatter:e.dateFormatter},null,8,["formatter"]),l(s,{align:"center",label:"\u8017\u65F6",prop:"durationInMillis",width:"169"},{default:t(a=>[b(U(a.row.durationInMillis>0?e.formatPast2(a.row.durationInMillis):"-"),1)]),_:1}),l(s,{label:"\u5F53\u524D\u5BA1\u6279\u4EFB\u52A1",align:"center",prop:"tasks","min-width":"120px"},{default:t(a=>[(o(!0),g(_,null,I(a.row.tasks,x=>(o(),p(d,{type:"primary",key:x.id,link:""},{default:t(()=>[G("span",null,U(x.name),1)]),_:2},1024))),128))]),_:1}),l(s,{label:"\u6D41\u7A0B\u7F16\u53F7",align:"center",prop:"id","min-width":"320px"}),l(s,{label:"\u64CD\u4F5C",align:"center",fixed:"right",width:"180"},{default:t(a=>[T((o(),p(d,{link:"",type:"primary",onClick:x=>e.handleDetail(a.row)},{default:t(()=>r[10]||(r[10]=[b(" \u8BE6\u60C5 ")])),_:2},1032,["onClick"])),[[S,["bpm:process-instance:cancel"]]]),a.row.status===1?T((o(),p(d,{key:0,link:"",type:"primary",onClick:x=>e.handleCancel(a.row)},{default:t(()=>r[11]||(r[11]=[b(" \u53D6\u6D88 ")])),_:2},1032,["onClick"])),[[S,["bpm:process-instance:query"]]]):J("",!0)]),_:1})]),_:1},8,["data"])),[[E,e.loading]]),l(M,{total:e.total,page:e.queryParams.pageNo,"onUpdate:page":r[6]||(r[6]=a=>e.queryParams.pageNo=a),limit:e.queryParams.pageSize,"onUpdate:limit":r[7]||(r[7]=a=>e.queryParams.pageSize=a),onPagination:e.getList},null,8,["total","page","limit"])]),_:1})],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/bpm/processInstance/manager/index.vue"]]);export{_e as default};
