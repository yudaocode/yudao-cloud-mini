import{d as h,D as x,g as E,r as b,f as S,u as B,au as q,G as N,_ as L,o as n,c as C,k as a,w as l,m as w,I as M,q as c,F as T,n as F,t as v,ah as P,z as O,N as j,E as Y,P as $,y as G,Q,R as W}from"./index-BaY5TDP-.js";import{_ as A}from"./ContentWrap-DKQn7kZm.js";import{_ as H}from"./index-avjYFQiD.js";import{_ as J}from"./DictTag-QtcI9ZjC.js";import{d as K}from"./formatTime-Dr6TiYYc.js";import{F as D,a as V}from"./FollowUpRecordForm-C2CG18-w.js";import{B as X}from"./index-BlslFSYd.js";import"./index-DrSdAlug.js";import"./color-BN7ZL7BD.js";import"./Dialog-CZSXtzfQ.js";import"./FollowUpRecordBusinessForm-B1oFy6Z2.js";import"./FollowUpRecordContactForm-BevYD0eZ.js";import"./BusinessListModal-6XoY13Ne.js";import"./index-6-r4wYJE.js";import"./BusinessForm-DKlvsT4o.js";import"./index-n6shePIl.js";import"./index-h6ObHKtQ.js";import"./index-CuAlllbQ.js";import"./BusinessProductForm-FoZjzksq.js";import"./index-D4G-Yxr7.js";import"./ContactListModal-DsE0FODx.js";import"./index-DiJG1eDb.js";import"./ContactForm-DLuG_ZcF.js";import"./index-Qzz5HSIB.js";import"./tree-z7HkrWVC.js";const Z=L(h({name:"FollowUpRecord",__name:"index",props:{bizType:{type:Number,required:!0},bizId:{type:Number,required:!0}},setup(k,{expose:o}){o();const p=k,e=x(),{t:z}=E(),y=b(!0),f=b([]),d=b(0),m=S({pageNo:1,pageSize:10,bizType:0,bizId:0}),r=async()=>{y.value=!0;try{const t=await D.getFollowUpRecordPage(m);f.value=t.list,d.value=t.total}finally{y.value=!1}},g=b(),{push:u}=B();q(()=>p.bizId,()=>{m.bizType=p.bizType,m.bizId=p.bizId,r()});const _={props:p,message:e,t:z,loading:y,list:f,total:d,queryParams:m,getList:r,formRef:g,openForm:()=>{var t;(t=g.value)==null||t.open(p.bizType,p.bizId)},handleDelete:async t=>{try{await e.delConfirm(),await D.deleteFollowUpRecord(t),e.success(z("common.delSuccess")),await r()}catch{}},push:u,openContactDetail:t=>{u({name:"CrmContactDetail",params:{id:t}})},openBusinessDetail:t=>{u({name:"CrmBusinessDetail",params:{id:t}})},get dateFormatter(){return K},get DICT_TYPE(){return N},FollowUpRecordForm:V,get BizTypeEnum(){return X}};return Object.defineProperty(_,"__isScriptSetup",{enumerable:!1,value:!0}),_}}),[["render",function(k,o,p,e,z,y){const f=O,d=j,m=Y,r=$,g=J,u=G,_=Q,t=H,I=A,R=W;return n(),C(T,null,[a(m,{class:"mb-10px",justify:"end"},{default:l(()=>[a(d,{onClick:e.openForm},{default:l(()=>[a(f,{class:"mr-5px",icon:"ep:edit"}),o[2]||(o[2]=w(" \u5199\u8DDF\u8FDB "))]),_:1})]),_:1}),a(I,null,{default:l(()=>[M((n(),c(_,{data:e.list,"show-overflow-tooltip":!0,stripe:!0},{default:l(()=>[a(r,{formatter:e.dateFormatter,align:"center",label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime",width:"180px"},null,8,["formatter"]),a(r,{align:"center",label:"\u8DDF\u8FDB\u4EBA",prop:"creatorName"}),a(r,{align:"center",label:"\u8DDF\u8FDB\u7C7B\u578B",prop:"type"},{default:l(i=>[a(g,{type:e.DICT_TYPE.CRM_FOLLOW_UP_TYPE,value:i.row.type},null,8,["type","value"])]),_:1}),a(r,{align:"center",label:"\u8DDF\u8FDB\u5185\u5BB9",prop:"content"}),a(r,{formatter:e.dateFormatter,align:"center",label:"\u4E0B\u6B21\u8054\u7CFB\u65F6\u95F4",prop:"nextTime",width:"180px"},null,8,["formatter"]),p.bizType===e.BizTypeEnum.CRM_CUSTOMER?(n(),c(r,{key:0,align:"center",label:"\u5173\u8054\u8054\u7CFB\u4EBA",prop:"contactIds"},{default:l(i=>[(n(!0),C(T,null,F(i.row.contacts,s=>(n(),c(u,{key:`key-${s.id}`,underline:!1,type:"primary",onClick:U=>e.openContactDetail(s.id),class:"ml-5px"},{default:l(()=>[w(v(s.name),1)]),_:2},1032,["onClick"]))),128))]),_:1})):P("",!0),p.bizType===e.BizTypeEnum.CRM_CUSTOMER?(n(),c(r,{key:1,align:"center",label:"\u5173\u8054\u5546\u673A",prop:"businessIds"},{default:l(i=>[(n(!0),C(T,null,F(i.row.businesses,s=>(n(),c(u,{key:`key-${s.id}`,underline:!1,type:"primary",onClick:U=>e.openBusinessDetail(s.id),class:"ml-5px"},{default:l(()=>[w(v(s.name),1)]),_:2},1032,["onClick"]))),128))]),_:1})):P("",!0),a(r,{align:"center",label:"\u64CD\u4F5C"},{default:l(i=>[a(d,{link:"",type:"danger",onClick:s=>e.handleDelete(i.row.id)},{default:l(()=>o[3]||(o[3]=[w(" \u5220\u9664 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[R,e.loading]]),a(t,{limit:e.queryParams.pageSize,"onUpdate:limit":o[0]||(o[0]=i=>e.queryParams.pageSize=i),page:e.queryParams.pageNo,"onUpdate:page":o[1]||(o[1]=i=>e.queryParams.pageNo=i),total:e.total,onPagination:e.getList},null,8,["limit","page","total"])]),_:1}),a(e.FollowUpRecordForm,{ref:"formRef",onSuccess:e.getList},null,512)],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/crm/followup/index.vue"]]);export{Z as default};
