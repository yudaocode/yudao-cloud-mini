import{d as w,g as I,D as P,r as n,f as O,ao as U,G as F,U as A,_ as N,o as h,q as x,w as d,k as s,m as u,I as R,t as C,c as L,F as M,n as j,ah as Y,an as q,L as K,J as G,K as J,O as z,ch as B,cC as H,l as Q,N as W,R as X}from"./index-BaY5TDP-.js";import{_ as Z}from"./Dialog-CZSXtzfQ.js";import{h as $,d as ee}from"./tree-z7HkrWVC.js";import{q as E}from"./constants-CEEr2azc.js";import{g as ae}from"./index-dK17nfjs.js";import{b as te}from"./index-CBoTGgba.js";const oe=N(w({name:"SystemRoleDataPermissionForm",__name:"RoleDataPermissionForm",emits:["success"],setup(T,{expose:a,emit:V}){const{t:e}=I(),g=P(),S=n(!1),c=n(!1),o=O({id:void 0,name:"",code:"",dataScope:void 0,dataScopeDeptIds:[]}),_=n(),p=n([]),m=n(!0),i=n(),f=n(!1),y=n(!0),v=async l=>{var r;S.value=!0,b(),p.value=$(await ae()),o.id=l.id,o.name=l.name,o.code=l.code,o.dataScope=l.dataScope,await U(),(r=l.dataScopeDeptIds)==null||r.forEach(k=>{i.value.setChecked(k,!0,!1)})};a({open:v});const D=V,b=()=>{var l,r;f.value=!1,m.value=!0,y.value=!0,o.value={id:void 0,name:"",code:"",dataScope:void 0,dataScopeDeptIds:[]},(l=i.value)==null||l.setCheckedNodes([]),(r=_.value)==null||r.resetFields()},t={t:e,message:g,dialogVisible:S,formLoading:c,formData:o,formRef:_,deptOptions:p,deptExpand:m,treeRef:i,treeNodeAll:f,checkStrictly:y,open:v,emit:D,submitForm:async()=>{c.value=!0;try{const l={roleId:o.id,dataScope:o.dataScope,dataScopeDeptIds:o.dataScope!==E.DEPT_CUSTOM?[]:i.value.getCheckedKeys(!1)};await te(l),g.success(e("common.updateSuccess")),S.value=!1,D("success")}finally{c.value=!1}},resetForm:b,handleCheckedTreeNodeAll:()=>{i.value.setCheckedNodes(f.value?p.value:[])},handleCheckedTreeExpand:()=>{var r;const l=(r=i.value)==null?void 0:r.store.nodesMap;for(let k in l)l[k].expanded!==m.value&&(l[k].expanded=m.value)},get DICT_TYPE(){return F},get getIntDictOptions(){return A},get defaultProps(){return ee},get SystemDataScopeEnum(){return E}};return Object.defineProperty(t,"__isScriptSetup",{enumerable:!1,value:!0}),t}}),[["render",function(T,a,V,e,g,S){const c=q,o=K,_=G,p=J,m=z,i=B,f=H,y=Q,v=W,D=Z,b=X;return h(),x(D,{modelValue:e.dialogVisible,"onUpdate:modelValue":a[6]||(a[6]=t=>e.dialogVisible=t),title:"\u6570\u636E\u6743\u9650",width:"800"},{footer:d(()=>[s(v,{disabled:e.formLoading,type:"primary",onClick:e.submitForm},{default:d(()=>a[10]||(a[10]=[u("\u786E \u5B9A")])),_:1},8,["disabled"]),s(v,{onClick:a[5]||(a[5]=t=>e.dialogVisible=!1)},{default:d(()=>a[11]||(a[11]=[u("\u53D6 \u6D88")])),_:1})]),default:d(()=>[R((h(),x(m,{ref:"formRef",model:e.formData,"label-width":"80px"},{default:d(()=>[s(o,{label:"\u89D2\u8272\u540D\u79F0"},{default:d(()=>[s(c,null,{default:d(()=>[u(C(e.formData.name),1)]),_:1})]),_:1}),s(o,{label:"\u89D2\u8272\u6807\u8BC6"},{default:d(()=>[s(c,null,{default:d(()=>[u(C(e.formData.code),1)]),_:1})]),_:1}),s(o,{label:"\u6743\u9650\u8303\u56F4"},{default:d(()=>[s(p,{modelValue:e.formData.dataScope,"onUpdate:modelValue":a[0]||(a[0]=t=>e.formData.dataScope=t)},{default:d(()=>[(h(!0),L(M,null,j(e.getIntDictOptions(e.DICT_TYPE.SYSTEM_DATA_SCOPE),t=>(h(),x(_,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])),[[b,e.formLoading]]),e.formData.dataScope===e.SystemDataScopeEnum.DEPT_CUSTOM?(h(),x(o,{key:0,label:"\u6743\u9650\u8303\u56F4","label-width":"80px"},{default:d(()=>[s(y,{class:"w-full h-400px !overflow-y-scroll",shadow:"never"},{header:d(()=>[a[7]||(a[7]=u(" \u5168\u9009/\u5168\u4E0D\u9009: ")),s(i,{modelValue:e.treeNodeAll,"onUpdate:modelValue":a[1]||(a[1]=t=>e.treeNodeAll=t),"active-text":"\u662F","inactive-text":"\u5426","inline-prompt":"",onChange:a[2]||(a[2]=t=>e.handleCheckedTreeNodeAll())},null,8,["modelValue"]),a[8]||(a[8]=u(" \u5168\u90E8\u5C55\u5F00/\u6298\u53E0: ")),s(i,{modelValue:e.deptExpand,"onUpdate:modelValue":a[3]||(a[3]=t=>e.deptExpand=t),"active-text":"\u5C55\u5F00","inactive-text":"\u6298\u53E0","inline-prompt":"",onChange:e.handleCheckedTreeExpand},null,8,["modelValue"]),a[9]||(a[9]=u(" \u7236\u5B50\u8054\u52A8(\u9009\u4E2D\u7236\u8282\u70B9\uFF0C\u81EA\u52A8\u9009\u62E9\u5B50\u8282\u70B9): ")),s(i,{modelValue:e.checkStrictly,"onUpdate:modelValue":a[4]||(a[4]=t=>e.checkStrictly=t),"active-text":"\u662F","inactive-text":"\u5426","inline-prompt":""},null,8,["modelValue"])]),default:d(()=>[s(f,{ref:"treeRef","check-strictly":!e.checkStrictly,data:e.deptOptions,props:e.defaultProps,"default-expand-all":"","empty-text":"\u52A0\u8F7D\u4E2D\uFF0C\u8BF7\u7A0D\u540E","node-key":"id","show-checkbox":""},null,8,["check-strictly","data","props"])]),_:1})]),_:1})):Y("",!0)]),_:1},8,["modelValue"])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/system/role/RoleDataPermissionForm.vue"]]);export{oe as default};
