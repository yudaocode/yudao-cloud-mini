import{d as h,D as T,g as k,r as b,f as F,au as N,G as q,e2 as x,_ as E,X as L,o as I,c as S,k as t,w as c,m as y,I as w,q as P,F as D,z as U,N as z,E as j,P as Y,Q,R as A}from"./index-BaY5TDP-.js";import{_ as B}from"./ContentWrap-DKQn7kZm.js";import{_ as G}from"./index-avjYFQiD.js";import{_ as M}from"./DictTag-QtcI9ZjC.js";import{g as O,d as V}from"./index-DcQDDeHJ.js";import X from"./ReceivableForm-C0pIMqYw.js";import{b as H}from"./formatTime-Dr6TiYYc.js";import"./index-DrSdAlug.js";import"./color-BN7ZL7BD.js";import"./Dialog-CZSXtzfQ.js";import"./index-ndAUlMgd.js";import"./index-CuAlllbQ.js";import"./index-h6ObHKtQ.js";import"./index-B97LdofC.js";const J=E(h({name:"CrmReceivableList",__name:"ReceivableList",props:{customerId:{type:Number,required:!1},contractId:{type:Number,required:!1}},setup(R,{expose:a}){const r=R,e=T(),{t:_}=k(),u=b(!0),d=b(0),s=b([]),i=F({pageNo:1,pageSize:10,customerId:void 0,contractId:void 0}),o=async()=>{u.value=!0;try{r.customerId&&!r.contractId?i.customerId=r.customerId:r.customerId&&r.contractId&&(i.customerId=r.customerId,i.contractId=r.contractId);const l=await O(i);s.value=l.list,d.value=l.total}finally{u.value=!1}},f=()=>{i.pageNo=1,i.customerId=void 0,i.contractId=void 0,o()},m=b(),g=l=>{const p=l;m.value.open("create",void 0,p)};a({createReceivable:g}),N(()=>[r.customerId,r.contractId],l=>{l[0]&&f()},{immediate:!0,deep:!0});const v={props:r,message:e,t:_,loading:u,total:d,list:s,queryParams:i,getList:o,handleQuery:f,formRef:m,openForm:(l,p)=>{m.value.open(l,p,{customerId:r.customerId,contractId:r.contractId})},handleDelete:async l=>{try{await e.delConfirm(),await V(l),e.success(_("common.delSuccess")),await o()}catch{}},createReceivable:g,ReceivableForm:X,get dateFormatter2(){return H},get DICT_TYPE(){return q},get erpPriceTableColumnFormatter(){return x}};return Object.defineProperty(v,"__isScriptSetup",{enumerable:!1,value:!0}),v}}),[["render",function(R,a,r,e,_,u){const d=U,s=z,i=j,o=Y,f=M,m=Q,g=G,v=B,l=L("hasPermi"),p=A;return I(),S(D,null,[t(i,{justify:"end"},{default:c(()=>[t(s,{onClick:a[0]||(a[0]=n=>e.openForm("create"))},{default:c(()=>[t(d,{class:"mr-5px",icon:"icon-park:income-one"}),a[3]||(a[3]=y(" \u521B\u5EFA\u56DE\u6B3E "))]),_:1})]),_:1}),t(v,{class:"mt-10px"},{default:c(()=>[w((I(),P(m,{data:e.list,"show-overflow-tooltip":!0,stripe:!0},{default:c(()=>[t(o,{align:"center",label:"\u56DE\u6B3E\u7F16\u53F7",prop:"no"}),t(o,{align:"center",label:"\u5BA2\u6237",prop:"customerName"}),t(o,{align:"center",label:"\u5408\u540C",prop:"contract.no"}),t(o,{formatter:e.dateFormatter2,align:"center",label:"\u56DE\u6B3E\u65E5\u671F",prop:"returnTime",width:"150px"},null,8,["formatter"]),t(o,{align:"center",label:"\u56DE\u6B3E\u65B9\u5F0F",prop:"returnType",width:"130px"},{default:c(n=>[t(f,{type:e.DICT_TYPE.CRM_RECEIVABLE_RETURN_TYPE,value:n.row.returnType},null,8,["type","value"])]),_:1}),t(o,{align:"center",label:"\u56DE\u6B3E\u91D1\u989D(\u5143)",prop:"price",formatter:e.erpPriceTableColumnFormatter},null,8,["formatter"]),t(o,{align:"center",label:"\u8D1F\u8D23\u4EBA",prop:"ownerUserName"}),t(o,{align:"center",label:"\u5907\u6CE8",prop:"remark"}),t(o,{align:"center",fixed:"right",label:"\u64CD\u4F5C",width:"130px"},{default:c(n=>[w((I(),P(s,{link:"",type:"primary",onClick:C=>e.openForm("update",n.row.id)},{default:c(()=>a[4]||(a[4]=[y(" \u7F16\u8F91 ")])),_:2},1032,["onClick"])),[[l,["crm:receivable:update"]]]),w((I(),P(s,{link:"",type:"danger",onClick:C=>e.handleDelete(n.row.id)},{default:c(()=>a[5]||(a[5]=[y(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[l,["crm:receivable:delete"]]])]),_:1})]),_:1},8,["data"])),[[p,e.loading]]),t(g,{limit:e.queryParams.pageSize,"onUpdate:limit":a[1]||(a[1]=n=>e.queryParams.pageSize=n),page:e.queryParams.pageNo,"onUpdate:page":a[2]||(a[2]=n=>e.queryParams.pageNo=n),total:e.total,onPagination:e.getList},null,8,["limit","page","total"])]),_:1}),t(e.ReceivableForm,{ref:"formRef",onSuccess:e.getList},null,512)],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/crm/receivable/components/ReceivableList.vue"]]);export{J as default};
