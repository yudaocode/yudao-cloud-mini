import{d as D,D as Q,g as T,r as y,f as U,C as R,eC as L,eD as N,eE as Y,_ as M,X as E,o as c,c as H,k as a,w as r,Y as x,m as p,I as P,q as h,F as I,Z as K,L as j,M as O,z as X,N as Z,O as A,P as B,y as G,Q as J,R as W}from"./index-BaY5TDP-.js";import{_ as $}from"./index-avjYFQiD.js";import{E as ee}from"./el-image-Bg-CwbDE.js";import{_ as ae}from"./ContentWrap-DKQn7kZm.js";import{_ as le}from"./index-BAz6Gqim.js";import{d as te}from"./formatTime-Dr6TiYYc.js";import re from"./FileForm-D-zbgOTO.js";import"./index-DrSdAlug.js";import"./Dialog-CZSXtzfQ.js";const oe=M(D({name:"InfraFile",__name:"index",setup(k,{expose:l}){l();const f=Q(),{t:e}=T(),g=y(!0),b=y(0),w=y([]),u=U({pageNo:1,pageSize:10,name:void 0,type:void 0,path:void 0,createTime:[]}),n=y(),d=async()=>{g.value=!0;try{const o=await L(u);w.value=o.list,b.value=o.total}finally{g.value=!1}},m=()=>{u.pageNo=1,d()},i=y();R(()=>{d()});const _={message:f,t:e,loading:g,total:b,list:w,queryParams:u,queryFormRef:n,getList:d,handleQuery:m,resetQuery:()=>{n.value.resetFields(),m()},formRef:i,openForm:()=>{i.value.open()},copyToClipboard:o=>{navigator.clipboard.writeText(o).then(()=>{f.success("\u590D\u5236\u6210\u529F")})},handleDelete:async o=>{try{await f.delConfirm(),await Y(o),f.success(e("common.delSuccess")),await d()}catch{}},get fileSizeFormatter(){return N},get dateFormatter(){return te},FileForm:re};return Object.defineProperty(_,"__isScriptSetup",{enumerable:!1,value:!0}),_}}),[["render",function(k,l,f,e,g,b){const w=le,u=K,n=j,d=O,m=X,i=Z,_=A,o=ae,s=B,q=ee,v=G,F=J,C=$,S=E("hasPermi"),V=W;return c(),H(I,null,[a(w,{title:"\u4E0A\u4F20\u4E0B\u8F7D",url:"https://doc.iocoder.cn/file/"}),a(o,null,{default:r(()=>[a(_,{class:"-mb-15px",model:e.queryParams,ref:"queryFormRef",inline:!0,"label-width":"68px"},{default:r(()=>[a(n,{label:"\u6587\u4EF6\u8DEF\u5F84",prop:"path"},{default:r(()=>[a(u,{modelValue:e.queryParams.path,"onUpdate:modelValue":l[0]||(l[0]=t=>e.queryParams.path=t),placeholder:"\u8BF7\u8F93\u5165\u6587\u4EF6\u8DEF\u5F84",clearable:"",onKeyup:x(e.handleQuery,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),a(n,{label:"\u6587\u4EF6\u7C7B\u578B",prop:"type",width:"80"},{default:r(()=>[a(u,{modelValue:e.queryParams.type,"onUpdate:modelValue":l[1]||(l[1]=t=>e.queryParams.type=t),placeholder:"\u8BF7\u8F93\u5165\u6587\u4EF6\u7C7B\u578B",clearable:"",onKeyup:x(e.handleQuery,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),a(n,{label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime"},{default:r(()=>[a(d,{modelValue:e.queryParams.createTime,"onUpdate:modelValue":l[2]||(l[2]=t=>e.queryParams.createTime=t),"value-format":"YYYY-MM-DD HH:mm:ss",type:"daterange","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F","default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],class:"!w-240px"},null,8,["modelValue","default-time"])]),_:1}),a(n,null,{default:r(()=>[a(i,{onClick:e.handleQuery},{default:r(()=>[a(m,{icon:"ep:search",class:"mr-5px"}),l[5]||(l[5]=p(" \u641C\u7D22"))]),_:1}),a(i,{onClick:e.resetQuery},{default:r(()=>[a(m,{icon:"ep:refresh",class:"mr-5px"}),l[6]||(l[6]=p(" \u91CD\u7F6E"))]),_:1}),a(i,{type:"primary",plain:"",onClick:e.openForm},{default:r(()=>[a(m,{icon:"ep:upload",class:"mr-5px"}),l[7]||(l[7]=p(" \u4E0A\u4F20\u6587\u4EF6 "))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(o,null,{default:r(()=>[P((c(),h(F,{data:e.list},{default:r(()=>[a(s,{label:"\u6587\u4EF6\u540D",align:"center",prop:"name","show-overflow-tooltip":!0}),a(s,{label:"\u6587\u4EF6\u8DEF\u5F84",align:"center",prop:"path","show-overflow-tooltip":!0}),a(s,{label:"URL",align:"center",prop:"url","show-overflow-tooltip":!0}),a(s,{label:"\u6587\u4EF6\u5927\u5C0F",align:"center",prop:"size",width:"120",formatter:e.fileSizeFormatter},null,8,["formatter"]),a(s,{label:"\u6587\u4EF6\u7C7B\u578B",align:"center",prop:"type",width:"180px"}),a(s,{label:"\u6587\u4EF6\u5185\u5BB9",align:"center",prop:"url",width:"110px"},{default:r(({row:t})=>[t.type.includes("image")?(c(),h(q,{key:0,class:"h-80px w-80px",lazy:"",src:t.url,"preview-src-list":[t.url],"preview-teleported":"",fit:"cover"},null,8,["src","preview-src-list"])):t.type.includes("pdf")?(c(),h(v,{key:1,type:"primary",href:t.url,underline:!1,target:"_blank"},{default:r(()=>l[8]||(l[8]=[p("\u9884\u89C8")])),_:2},1032,["href"])):(c(),h(v,{key:2,type:"primary",download:"",href:t.url,underline:!1,target:"_blank"},{default:r(()=>l[9]||(l[9]=[p("\u4E0B\u8F7D")])),_:2},1032,["href"]))]),_:1}),a(s,{label:"\u4E0A\u4F20\u65F6\u95F4",align:"center",prop:"createTime",width:"180",formatter:e.dateFormatter},null,8,["formatter"]),a(s,{label:"\u64CD\u4F5C",align:"center"},{default:r(t=>[a(i,{link:"",type:"primary",onClick:z=>e.copyToClipboard(t.row.url)},{default:r(()=>l[10]||(l[10]=[p(" \u590D\u5236\u94FE\u63A5 ")])),_:2},1032,["onClick"]),P((c(),h(i,{link:"",type:"danger",onClick:z=>e.handleDelete(t.row.id)},{default:r(()=>l[11]||(l[11]=[p(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[S,["infra:file:delete"]]])]),_:1})]),_:1},8,["data"])),[[V,e.loading]]),a(C,{total:e.total,page:e.queryParams.pageNo,"onUpdate:page":l[3]||(l[3]=t=>e.queryParams.pageNo=t),limit:e.queryParams.pageSize,"onUpdate:limit":l[4]||(l[4]=t=>e.queryParams.pageSize=t),onPagination:e.getList},null,8,["total","page","limit"])]),_:1}),a(e.FileForm,{ref:"formRef",onSuccess:e.getList},null,512)],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/infra/file/index.vue"]]);export{oe as default};
