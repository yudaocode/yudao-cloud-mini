import{bd as ee,au as H,ao as E,cB as L,ca as U,K as B,bI as V,b as x,d as I,J as G,bQ as te,b$ as P,c3 as le,cC as R,c8 as ae,c6 as se,cD as oe,cE as ce,b4 as de,cF as ne,bO as re,r as W,f as _,C as ue,h as $,bf as ie,bl as he}from"./index-BaY5TDP-.js";const pe=I({extends:G,setup(a,r){const u=G.setup(a,r);delete u.selectOptionClick;const v=te().proxy;return E(()=>{u.select.states.cachedOptions.get(v.value)||u.select.onOptionCreate(v)}),H(()=>r.attrs.visible,n=>{u.states.visible=n},{immediate:!0}),u},methods:{selectOptionClick(){this.$el.parentElement.click()}}});function q(a){return a||a===0}function F(a){return P(a)&&a.length}function O(a){return P(a)?a:q(a)?[a]:[]}function j(a,r,u,v,n){for(let i=0;i<a.length;i++){const f=a[i];if(r(f,i,a,n))return v?v(f,i,a,n):f;{const M=u(f);if(F(M)){const S=j(M,r,u,v,f);if(S)return S}}}}function z(a,r,u,v){for(let n=0;n<a.length;n++){const i=a[n];r(i,n,a,v);const f=u(i);F(f)&&z(f,r,u,i)}}var ve=I({props:{data:{type:Array,default:()=>[]}},setup(a){const r=de(ne);return H(()=>a.data,()=>{var u;a.data.forEach(n=>{r.states.cachedOptions.has(n.value)||r.states.cachedOptions.set(n.value,n)});const v=((u=r.selectRef)==null?void 0:u.querySelectorAll("input"))||[];re&&!Array.from(v).includes(document.activeElement)&&r.setSelected()},{flush:"post",immediate:!0}),()=>{}}});const fe=I({name:"ElTreeSelect",inheritAttrs:!1,props:{...B.props,...R.props,cacheData:{type:Array,default:()=>[]}},setup(a,r){const{slots:u,expose:v}=r,n=W(),i=W(),f=x(()=>a.nodeKey||a.valueKey||"value"),M=((e,{attrs:C,emit:A},{select:K,tree:b,key:h})=>{const w=ee("tree-select");return H(()=>e.data,()=>{e.filterable&&E(()=>{var p,s;(s=b.value)==null||s.filter((p=K.value)==null?void 0:p.states.inputValue)})},{flush:"post"}),{...L(U(e),Object.keys(B.props)),...C,"onUpdate:modelValue":p=>A(V,p),valueKey:h,popperClass:x(()=>{const p=[w.e("popper")];return e.popperClass&&p.push(e.popperClass),p.join(" ")}),filterMethod:(p="")=>{var s;e.filterMethod?e.filterMethod(p):e.remoteMethod?e.remoteMethod(p):(s=b.value)==null||s.filter(p)}}})(a,r,{select:n,tree:i,key:f}),{cacheOptions:S,...X}=((e,{attrs:C,slots:A,emit:K},{select:b,tree:h,key:w})=>{H(()=>e.modelValue,()=>{e.showCheckbox&&E(()=>{const t=h.value;t&&!le(t.getCheckedKeys(),O(e.modelValue))&&t.setCheckedKeys(O(e.modelValue))})},{immediate:!0,deep:!0});const p=x(()=>({value:w.value,label:"label",children:"children",disabled:"disabled",isLeaf:"isLeaf",...e.props})),s=(t,l)=>{var o;const d=p.value[t];return se(d)?d(l,(o=h.value)==null?void 0:o.getNode(s("value",l))):l[d]},Q=O(e.modelValue).map(t=>j(e.data||[],l=>s("value",l)===t,l=>s("children",l),(l,o,d,k)=>k&&s("value",k))).filter(t=>q(t)),Y=x(()=>{if(!e.renderAfterExpand&&!e.lazy)return[];const t=[];return z(e.data.concat(e.cacheData),l=>{const o=s("value",l);t.push({value:o,currentLabel:s("label",l),isDisabled:s("disabled",l)})},l=>s("children",l)),t}),T=()=>{var t;return(t=h.value)==null?void 0:t.getCheckedKeys().filter(l=>{var o;const d=(o=h.value)==null?void 0:o.getNode(l);return!oe(d)&&ce(d.childNodes)})};return{...L(U(e),Object.keys(R.props)),...C,nodeKey:w,expandOnClickNode:x(()=>!e.checkStrictly&&e.expandOnClickNode),defaultExpandedKeys:x(()=>e.defaultExpandedKeys?e.defaultExpandedKeys.concat(Q):Q),renderContent:(t,{node:l,data:o,store:d})=>t(pe,{value:s("value",o),label:s("label",o),disabled:s("disabled",o),visible:l.visible},e.renderContent?()=>e.renderContent(t,{node:l,data:o,store:d}):A.default?()=>A.default({node:l,data:o,store:d}):void 0),filterNodeMethod:(t,l,o)=>e.filterNodeMethod?e.filterNodeMethod(t,l,o):!t||new RegExp(ae(t),"i").test(s("label",l)||""),onNodeClick:(t,l,o)=>{var d,k,m,N;if((d=C.onNodeClick)==null||d.call(C,t,l,o),!e.showCheckbox||!e.checkOnClickNode){if(e.showCheckbox||!e.checkStrictly&&!l.isLeaf)e.expandOnClickNode&&o.proxy.handleExpandIconClick();else if(!s("disabled",t)){const g=(k=b.value)==null?void 0:k.states.options.get(s("value",t));(m=b.value)==null||m.handleOptionSelect(g)}(N=b.value)==null||N.focus()}},onCheck:(t,l)=>{var o;if(!e.showCheckbox)return;const d=s("value",t),k={};z([h.value.store.root],c=>k[c.key]=c,c=>c.childNodes);const m=l.checkedKeys,N=e.multiple?O(e.modelValue).filter(c=>!(c in k)&&!m.includes(c)):[],g=N.concat(m);if(e.checkStrictly)K(V,e.multiple?g:g.includes(d)?d:void 0);else if(e.multiple){const c=T();K(V,N.concat(c))}else{const c=j([t],y=>!F(s("children",y))&&!s("disabled",y),y=>s("children",y)),D=c?s("value",c):void 0,Z=q(e.modelValue)&&!!j([t],y=>s("value",y)===e.modelValue,y=>s("children",y));K(V,D===e.modelValue||Z?void 0:D)}E(()=>{var c;const D=O(e.modelValue);h.value.setCheckedKeys(D),(c=C.onCheck)==null||c.call(C,t,{checkedKeys:h.value.getCheckedKeys(),checkedNodes:h.value.getCheckedNodes(),halfCheckedKeys:h.value.getHalfCheckedKeys(),halfCheckedNodes:h.value.getHalfCheckedNodes()})}),(o=b.value)==null||o.focus()},onNodeExpand:(t,l,o)=>{var d;(d=C.onNodeExpand)==null||d.call(C,t,l,o),E(()=>{if(!e.checkStrictly&&e.lazy&&e.multiple&&l.checked){const k={},m=h.value.getCheckedKeys();z([h.value.store.root],c=>k[c.key]=c,c=>c.childNodes);const N=O(e.modelValue).filter(c=>!(c in k)&&!m.includes(c)),g=T();K(V,N.concat(g))}})},cacheOptions:Y}})(a,r,{select:n,tree:i,key:f}),J=_({});return v(J),ue(()=>{Object.assign(J,{...L(i.value,["filter","updateKeyChildren","getCheckedNodes","setCheckedNodes","getCheckedKeys","setCheckedKeys","setChecked","getHalfCheckedNodes","getHalfCheckedKeys","getCurrentKey","getCurrentNode","setCurrentKey","setCurrentNode","getNode","remove","append","insertBefore","insertAfter"]),...L(n.value,["focus","blur","selectedLabel"])})}),()=>$(B,_({...M,ref:e=>n.value=e}),{...u,default:()=>[$(ve,{data:S.value}),$(R,_({...X,ref:e=>i.value=e}))]})}}),ke=he(ie(fe,[["__file","tree-select.vue"]]));export{ke as E};
