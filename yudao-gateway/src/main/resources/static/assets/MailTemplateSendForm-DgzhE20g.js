import{d as P,D,r as v,f as w,_ as F,o as g,q as _,w as s,k as u,m as y,I as h,c as C,F as S,n as x,cn as M,L as R,Z as U,O as k,N as q,R as L}from"./index-BaY5TDP-.js";import{_ as T}from"./Dialog-CZSXtzfQ.js";import{g as O,s as j}from"./index-CY__hSuf.js";const I=F(P({name:"SystemMailTemplateSendForm",__name:"MailTemplateSendForm",setup(V,{expose:l}){const b=D(),e=v(!1),d=v(!1),r=v({content:"",params:{},mail:"",templateCode:"",templateParams:new Map}),n=w({mail:[{required:!0,message:"\u90AE\u7BB1\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],templateCode:[{required:!0,message:"\u6A21\u7248\u7F16\u53F7\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],templateParams:{}}),t=v(),p=async o=>{e.value=!0,c(),d.value=!0;try{const m=await O(o);r.value.content=m.content,r.value.params=m.params,r.value.templateCode=m.code,r.value.templateParams=m.params.reduce((a,i)=>(a[i]="",a),{}),n.templateParams=m.params.reduce((a,i)=>(a[i]={required:!0,message:"\u53C2\u6570 "+i+" \u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},a),{})}finally{d.value=!1}};l({open:p});const c=()=>{var o;r.value={content:"",params:{},mail:"",templateCode:"",templateParams:new Map},n.templateParams={},(o=t.value)==null||o.resetFields()},f={message:b,dialogVisible:e,formLoading:d,formData:r,formRules:n,formRef:t,open:p,submitForm:async()=>{if(t&&await t.value.validate()){d.value=!0;try{const o=r.value,m=await j(o);m&&b.success("\u63D0\u4EA4\u53D1\u9001\u6210\u529F\uFF01\u53D1\u9001\u7ED3\u679C\uFF0C\u89C1\u53D1\u9001\u65E5\u5FD7\u7F16\u53F7\uFF1A"+m),e.value=!1}finally{d.value=!1}}},resetForm:c};return Object.defineProperty(f,"__isScriptSetup",{enumerable:!1,value:!0}),f}}),[["render",function(V,l,b,e,d,r){const n=M,t=R,p=U,c=k,f=q,o=T,m=L;return g(),_(o,{modelValue:e.dialogVisible,"onUpdate:modelValue":l[2]||(l[2]=a=>e.dialogVisible=a),title:"\u6D4B\u8BD5"},{footer:s(()=>[u(f,{disabled:e.formLoading,type:"primary",onClick:e.submitForm},{default:s(()=>l[3]||(l[3]=[y("\u786E \u5B9A")])),_:1},8,["disabled"]),u(f,{onClick:l[1]||(l[1]=a=>e.dialogVisible=!1)},{default:s(()=>l[4]||(l[4]=[y("\u53D6 \u6D88")])),_:1})]),default:s(()=>[h((g(),_(c,{ref:"formRef",model:e.formData,rules:e.formRules,"label-width":"120px"},{default:s(()=>[u(t,{label:"\u6A21\u677F\u5185\u5BB9",prop:"content"},{default:s(()=>[u(n,{"model-value":e.formData.content,height:"150px",readonly:""},null,8,["model-value"])]),_:1}),u(t,{label:"\u6536\u4EF6\u90AE\u7BB1",prop:"mail"},{default:s(()=>[u(p,{modelValue:e.formData.mail,"onUpdate:modelValue":l[0]||(l[0]=a=>e.formData.mail=a),placeholder:"\u8BF7\u8F93\u5165\u6536\u4EF6\u90AE\u7BB1"},null,8,["modelValue"])]),_:1}),(g(!0),C(S,null,x(e.formData.params,a=>(g(),_(t,{key:a,label:"\u53C2\u6570 {"+a+"}",prop:"templateParams."+a},{default:s(()=>[u(p,{modelValue:e.formData.templateParams[a],"onUpdate:modelValue":i=>e.formData.templateParams[a]=i,placeholder:"\u8BF7\u8F93\u5165 "+a+" \u53C2\u6570"},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label","prop"]))),128))]),_:1},8,["model","rules"])),[[m,e.formLoading]])]),_:1},8,["modelValue"])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/system/mail/template/MailTemplateSendForm.vue"]]);export{I as default};
