import{d as L,g as R,D as S,r as s,f as U,C as x,_ as P,o as _,q as V,w as d,k as t,m as h,I as C,c as Z,F as j,n as q,J as z,K as A,L as E,Z as O,O as $,N as J,R as K}from"./index-BaY5TDP-.js";import{_ as B}from"./Dialog-CZSXtzfQ.js";import{D as y}from"./index-B4zhmfOC.js";import{P as G}from"./index-DK5ShDMH.js";const H=P(L({name:"IoTDeviceForm",__name:"DeviceForm",emits:["success"],setup(T,{expose:a,emit:k}){const{t:e}=R(),n=S(),f=s(!1),v=s(""),o=s(!1),r=s(""),u=s({id:void 0,productId:void 0,deviceName:void 0,nickname:void 0}),D=U({productId:[{required:!0,message:"\u4EA7\u54C1\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],deviceName:[{pattern:/^[a-zA-Z0-9_.\-:@]{4,32}$/,message:"\u652F\u6301\u82F1\u6587\u5B57\u6BCD\u3001\u6570\u5B57\u3001\u4E0B\u5212\u7EBF\uFF08_\uFF09\u3001\u4E2D\u5212\u7EBF\uFF08-\uFF09\u3001\u70B9\u53F7\uFF08.\uFF09\u3001\u534A\u89D2\u5192\u53F7\uFF08:\uFF09\u548C\u7279\u6B8A\u5B57\u7B26@\uFF0C\u957F\u5EA6\u9650\u5236\u4E3A 4~32 \u4E2A\u5B57\u7B26",trigger:"blur"}],nickname:[{validator:(i,c,g)=>{if(c==null)return void g();const I=c.replace(/[\u4e00-\u9fa5\u3040-\u30ff]/g,"aa").length;I<4||I>64?g(new Error("\u5907\u6CE8\u540D\u79F0\u957F\u5EA6\u9650\u5236\u4E3A 4~64 \u4E2A\u5B57\u7B26\uFF0C\u4E2D\u6587\u53CA\u65E5\u6587\u7B97 2 \u4E2A\u5B57\u7B26")):/^[\u4e00-\u9fa5\u3040-\u30ff_a-zA-Z0-9]+$/.test(c)?g():g(new Error("\u5907\u6CE8\u540D\u79F0\u53EA\u80FD\u5305\u542B\u4E2D\u6587\u3001\u82F1\u6587\u5B57\u6BCD\u3001\u65E5\u6587\u3001\u6570\u5B57\u548C\u4E0B\u5212\u7EBF\uFF08_\uFF09"))},trigger:"blur"}]}),m=s(),p=async(i,c)=>{if(f.value=!0,v.value=e("action."+i),r.value=i,l(),c){o.value=!0;try{u.value=await y.getDevice(c)}finally{o.value=!1}}};a({open:p});const b=k,l=()=>{var i;u.value={id:void 0,productId:void 0,deviceName:void 0,nickname:void 0},(i=m.value)==null||i.resetFields()},w=s(),N=async()=>{w.value=await G.getSimpleProductList()};x(()=>{N()});const F={t:e,message:n,dialogVisible:f,dialogTitle:v,formLoading:o,formType:r,formData:u,formRules:D,formRef:m,open:p,emit:b,submitForm:async()=>{await m.value.validate(),o.value=!0;try{const i=u.value;r.value==="create"?(await y.createDevice(i),n.success(e("common.createSuccess"))):(await y.updateDevice(i),n.success(e("common.updateSuccess"))),f.value=!1,b("success")}finally{o.value=!1}},resetForm:l,products:w,getProducts:N};return Object.defineProperty(F,"__isScriptSetup",{enumerable:!1,value:!0}),F}}),[["render",function(T,a,k,e,n,f){const v=z,o=A,r=E,u=O,D=$,m=J,p=B,b=K;return _(),V(p,{title:e.dialogTitle,modelValue:e.dialogVisible,"onUpdate:modelValue":a[4]||(a[4]=l=>e.dialogVisible=l)},{footer:d(()=>[t(m,{onClick:e.submitForm,type:"primary",disabled:e.formLoading},{default:d(()=>a[5]||(a[5]=[h("\u786E \u5B9A")])),_:1},8,["disabled"]),t(m,{onClick:a[3]||(a[3]=l=>e.dialogVisible=!1)},{default:d(()=>a[6]||(a[6]=[h("\u53D6 \u6D88")])),_:1})]),default:d(()=>[C((_(),V(D,{ref:"formRef",model:e.formData,rules:e.formRules,"label-width":"100px"},{default:d(()=>[t(r,{label:"\u4EA7\u54C1",prop:"productId"},{default:d(()=>[t(o,{modelValue:e.formData.productId,"onUpdate:modelValue":a[0]||(a[0]=l=>e.formData.productId=l),placeholder:"\u8BF7\u9009\u62E9\u4EA7\u54C1",disabled:e.formType==="update",clearable:""},{default:d(()=>[(_(!0),Z(j,null,q(e.products,l=>(_(),V(v,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),t(r,{label:"DeviceName",prop:"deviceName"},{default:d(()=>[t(u,{modelValue:e.formData.deviceName,"onUpdate:modelValue":a[1]||(a[1]=l=>e.formData.deviceName=l),placeholder:"\u8BF7\u8F93\u5165 DeviceName",disabled:e.formType==="update"},null,8,["modelValue","disabled"])]),_:1}),t(r,{label:"\u5907\u6CE8\u540D\u79F0",prop:"nickname"},{default:d(()=>[t(u,{modelValue:e.formData.nickname,"onUpdate:modelValue":a[2]||(a[2]=l=>e.formData.nickname=l),placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8\u540D\u79F0"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[b,e.formLoading]])]),_:1},8,["title","modelValue"])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/iot/device/DeviceForm.vue"]]);export{H as default};
