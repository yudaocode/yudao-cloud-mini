import{d as O,p as E,r as u,C as M,G as N,U as F,aA as Q,bJ as q,_ as z,o as f,q as b,cc as L,w as o,k as l,m as p,Y as j,c as J,F as K,n as R,I as B,t as x,Z as G,L as Z,J as $,K as W,z as H,N as X,O as ee,ai as ae,P as le,ak as te,Q as ie,R as re}from"./index-BaY5TDP-.js";import{_ as oe}from"./Dialog-CZSXtzfQ.js";import{_ as ue}from"./ContentWrap-DKQn7kZm.js";import{_ as se}from"./index-avjYFQiD.js";import{_ as ne}from"./DictTag-QtcI9ZjC.js";import{E as de}from"./el-image-Bg-CwbDE.js";import{h as me}from"./tree-z7HkrWVC.js";import{g as pe}from"./category-B7jjsMOS.js";import{a as ce}from"./seckillActivity-Cs09fUfF.js";import{f as ve}from"./formatter-DdccBgw4.js";import{d as he,f as fe}from"./formatTime-Dr6TiYYc.js";import"./index-DrSdAlug.js";import"./color-BN7ZL7BD.js";const ge=z(O({name:"SeckillTableSelect",__name:"SeckillTableSelect",props:{multiple:E.bool.def(!1)},emits:["change"],setup(D,{expose:t,emit:k}){const a=u(0),m=u([]),C=u(!1),c=u(!1),d=u({pageNo:1,pageSize:10,name:null,status:void 0}),S=e=>{n.value=[],i.value={},s.value=!1,h.value=!1,e&&e.length>0&&(n.value=[...e],i.value=Object.fromEntries(e.map(r=>[r.id,!0]))),c.value=!0,g()};t({open:S});const v=async()=>{C.value=!0;try{const e=await ce(d.value);m.value=e.list,a.value=e.total,m.value.forEach(r=>i.value[r.id]=i.value[r.id]||!1),w()}finally{C.value=!1}},g=()=>{d.value={pageNo:1,pageSize:10,name:void 0,createTime:[]},v()},s=u(!1),h=u(!1),n=u([]),i=u({}),V=u(),y=k,P=(e,r,Y)=>{if(e)n.value.push(r),i.value[r.id]=!0;else{const A=T(r);A>-1&&(n.value.splice(A,1),i.value[r.id]=!1,s.value=!1)}Y&&w()},T=e=>n.value.findIndex(r=>r.id===e.id),w=()=>{s.value=m.value.every(e=>i.value[e.id]),h.value=!s.value&&m.value.some(e=>i.value[e.id])},_=u(),I=u();M(async()=>{await v(),_.value=await pe({}),I.value=me(_.value,"id","parentId")});const U={total:a,list:m,loading:C,dialogVisible:c,queryParams:d,open:S,getList:v,handleQuery:()=>{d.value.pageNo=1,v()},resetQuery:g,formatSeckillPrice:e=>{const r=Math.min(...e.map(Y=>Y.seckillPrice));return`\uFFE5${Q(r)}`},isCheckAll:s,isIndeterminate:h,checkedActivitys:n,checkedStatus:i,selectedActivityId:V,handleSingleSelected:e=>{y(q,e),c.value=!1,V.value=e.id},handleEmitChange:()=>{c.value=!1,y(q,[...n.value])},emits:y,handleCheckAll:e=>{s.value=e,h.value=!1,m.value.forEach(r=>P(e,r,!1))},handleCheckOne:P,findCheckedIndex:T,calculateIsCheckAll:w,categoryList:_,categoryTreeList:I,get fenToYuanFormat(){return ve},get DICT_TYPE(){return N},get getIntDictOptions(){return F},get dateFormatter(){return he},get formatDate(){return fe}};return Object.defineProperty(U,"__isScriptSetup",{enumerable:!1,value:!0}),U}}),[["render",function(D,t,k,a,m,C){const c=G,d=Z,S=$,v=W,g=H,s=X,h=ee,n=ae,i=le,V=te,y=de,P=ne,T=ie,w=se,_=ue,I=oe,U=re;return f(),b(I,{modelValue:a.dialogVisible,"onUpdate:modelValue":t[7]||(t[7]=e=>a.dialogVisible=e),appendToBody:!0,title:"\u9009\u62E9\u6D3B\u52A8",width:"70%"},L({default:o(()=>[l(_,null,{default:o(()=>[l(h,{ref:"queryFormRef",inline:!0,model:a.queryParams,class:"-mb-15px","label-width":"68px"},{default:o(()=>[l(d,{label:"\u6D3B\u52A8\u540D\u79F0",prop:"name"},{default:o(()=>[l(c,{modelValue:a.queryParams.name,"onUpdate:modelValue":t[0]||(t[0]=e=>a.queryParams.name=e),placeholder:"\u8BF7\u8F93\u5165\u6D3B\u52A8\u540D\u79F0",clearable:"",onKeyup:j(a.handleQuery,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),l(d,{label:"\u6D3B\u52A8\u72B6\u6001",prop:"status"},{default:o(()=>[l(v,{modelValue:a.queryParams.status,"onUpdate:modelValue":t[1]||(t[1]=e=>a.queryParams.status=e),placeholder:"\u8BF7\u9009\u62E9\u6D3B\u52A8\u72B6\u6001",clearable:"",class:"!w-240px"},{default:o(()=>[(f(!0),J(K,null,R(a.getIntDictOptions(a.DICT_TYPE.COMMON_STATUS),e=>(f(),b(S,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,null,{default:o(()=>[l(s,{onClick:a.handleQuery},{default:o(()=>[l(g,{class:"mr-5px",icon:"ep:search"}),t[8]||(t[8]=p(" \u641C\u7D22 "))]),_:1}),l(s,{onClick:a.resetQuery},{default:o(()=>[l(g,{class:"mr-5px",icon:"ep:refresh"}),t[9]||(t[9]=p(" \u91CD\u7F6E "))]),_:1})]),_:1})]),_:1},8,["model"]),B((f(),b(T,{data:a.list,"show-overflow-tooltip":""},{default:o(()=>[k.multiple?(f(),b(i,{key:0,width:"55"},{header:o(()=>[l(n,{modelValue:a.isCheckAll,"onUpdate:modelValue":t[2]||(t[2]=e=>a.isCheckAll=e),indeterminate:a.isIndeterminate,onChange:a.handleCheckAll},null,8,["modelValue","indeterminate"])]),default:o(({row:e})=>[l(n,{modelValue:a.checkedStatus[e.id],"onUpdate:modelValue":r=>a.checkedStatus[e.id]=r,onChange:r=>a.handleCheckOne(r,e,!0)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})):(f(),b(i,{key:1,label:"#",width:"55"},{default:o(({row:e})=>[l(V,{value:e.id,modelValue:a.selectedActivityId,"onUpdate:modelValue":t[3]||(t[3]=r=>a.selectedActivityId=r),onChange:r=>a.handleSingleSelected(e)},{default:o(()=>t[10]||(t[10]=[p(" \xA0 ")])),_:2},1032,["value","modelValue","onChange"])]),_:1})),l(i,{label:"\u6D3B\u52A8\u7F16\u53F7",prop:"id","min-width":"80"}),l(i,{label:"\u6D3B\u52A8\u540D\u79F0",prop:"name","min-width":"140"}),l(i,{label:"\u6D3B\u52A8\u65F6\u95F4","min-width":"210"},{default:o(e=>[p(x(a.formatDate(e.row.startTime,"YYYY-MM-DD"))+" ~ "+x(a.formatDate(e.row.endTime,"YYYY-MM-DD")),1)]),_:1}),l(i,{label:"\u5546\u54C1\u56FE\u7247",prop:"spuName","min-width":"80"},{default:o(e=>[l(y,{src:e.row.picUrl,class:"h-40px w-40px","preview-src-list":[e.row.picUrl],"preview-teleported":""},null,8,["src","preview-src-list"])]),_:1}),l(i,{label:"\u5546\u54C1\u6807\u9898",prop:"spuName","min-width":"300"}),l(i,{label:"\u539F\u4EF7",prop:"marketPrice","min-width":"100",formatter:a.fenToYuanFormat},null,8,["formatter"]),l(i,{label:"\u62FC\u56E2\u4EF7",prop:"seckillPrice","min-width":"100"},{default:o(e=>[p(x(a.formatSeckillPrice(e.row.products)),1)]),_:1}),l(i,{label:"\u5F00\u56E2\u7EC4\u6570",prop:"groupCount","min-width":"100"}),l(i,{label:"\u6210\u56E2\u7EC4\u6570",prop:"groupSuccessCount","min-width":"100"}),l(i,{label:"\u8D2D\u4E70\u6B21\u6570",prop:"recordCount","min-width":"100"}),l(i,{label:"\u6D3B\u52A8\u72B6\u6001",align:"center",prop:"status","min-width":"100"},{default:o(e=>[l(P,{type:a.DICT_TYPE.COMMON_STATUS,value:e.row.status},null,8,["type","value"])]),_:1}),l(i,{label:"\u521B\u5EFA\u65F6\u95F4",align:"center",prop:"createTime",formatter:a.dateFormatter,width:"180px"},null,8,["formatter"])]),_:1},8,["data"])),[[U,a.loading]]),l(w,{limit:a.queryParams.pageSize,"onUpdate:limit":t[4]||(t[4]=e=>a.queryParams.pageSize=e),page:a.queryParams.pageNo,"onUpdate:page":t[5]||(t[5]=e=>a.queryParams.pageNo=e),total:a.total,onPagination:a.getList},null,8,["limit","page","total"])]),_:1})]),_:2},[k.multiple?{name:"footer",fn:o(()=>[l(s,{type:"primary",onClick:a.handleEmitChange},{default:o(()=>t[11]||(t[11]=[p("\u786E \u5B9A")])),_:1}),l(s,{onClick:t[6]||(t[6]=e=>a.dialogVisible=!1)},{default:o(()=>t[12]||(t[12]=[p("\u53D6 \u6D88")])),_:1})]),key:"0"}:void 0]),1032,["modelValue"])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/mall/promotion/seckill/components/SeckillTableSelect.vue"]]);export{ge as default};
