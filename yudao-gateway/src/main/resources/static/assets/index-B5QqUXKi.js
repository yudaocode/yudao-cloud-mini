import{d as Y,D as U,g as E,r as m,f as I,C as L,G as O,U as N,_ as Q,X as A,o as n,c as T,k as a,w as s,Y as q,F as D,n as z,q as p,m as u,I as y,Z as K,L as H,J as j,K as G,M as J,z as X,N as Z,O as B,P as W,Q as $,R as ee}from"./index-BaY5TDP-.js";import{_ as ae}from"./index-avjYFQiD.js";import{_ as le}from"./DictTag-QtcI9ZjC.js";import{_ as re}from"./ContentWrap-DKQn7kZm.js";import{_ as oe}from"./index-BAz6Gqim.js";import{d as se}from"./formatTime-Dr6TiYYc.js";import{d as te}from"./download-oWiM5xVU.js";import{b as ne,d as ie,e as me}from"./index-C7Vgvn4F.js";import pe from"./RoleForm-BSJIBg6j.js";import ue from"./RoleAssignMenuForm-CwlLLPe6.js";import de from"./RoleDataPermissionForm-DdkmudeP.js";import"./index-DrSdAlug.js";import"./color-BN7ZL7BD.js";import"./Dialog-CZSXtzfQ.js";import"./constants-CEEr2azc.js";import"./tree-z7HkrWVC.js";import"./index-cImR9iDp.js";import"./index-CBoTGgba.js";import"./index-dK17nfjs.js";const ce=Q(Y({name:"SystemRole",__name:"index",setup(R,{expose:l}){l();const _=U(),{t:e}=E(),h=m(!0),C=m(0),P=m([]),d=I({pageNo:1,pageSize:10,code:"",name:"",status:void 0,createTime:[]}),i=m(),b=m(!1),f=async()=>{h.value=!0;try{const o=await ne(d);P.value=o.list,C.value=o.total}finally{h.value=!1}},w=()=>{d.pageNo=1,f()},c=m(),t=m(),F=m();L(()=>{f()});const v={message:_,t:e,loading:h,total:C,list:P,queryParams:d,queryFormRef:i,exportLoading:b,getList:f,handleQuery:w,resetQuery:()=>{i.value.resetFields(),w()},formRef:c,openForm:(o,x)=>{c.value.open(o,x)},dataPermissionFormRef:t,openDataPermissionForm:async o=>{t.value.open(o)},assignMenuFormRef:F,openAssignMenuForm:async o=>{F.value.open(o)},handleDelete:async o=>{try{await _.delConfirm(),await ie(o),_.success(e("common.delSuccess")),await f()}catch{}},handleExport:async()=>{try{await _.exportConfirm(),b.value=!0;const o=await me(d);te.excel(o,"\u89D2\u8272\u5217\u8868.xls")}catch{}finally{b.value=!1}},get DICT_TYPE(){return O},get getIntDictOptions(){return N},get dateFormatter(){return se},RoleForm:pe,RoleAssignMenuForm:ue,RoleDataPermissionForm:de};return Object.defineProperty(v,"__isScriptSetup",{enumerable:!1,value:!0}),v}}),[["render",function(R,l,_,e,h,C){const P=oe,d=K,i=H,b=j,f=G,w=J,c=X,t=Z,F=B,v=re,o=W,x=le,S=$,M=ae,g=A("hasPermi"),V=ee;return n(),T(D,null,[a(P,{title:"\u529F\u80FD\u6743\u9650",url:"https://doc.iocoder.cn/resource-permission"}),a(P,{title:"\u6570\u636E\u6743\u9650",url:"https://doc.iocoder.cn/data-permission"}),a(v,null,{default:s(()=>[a(F,{ref:"queryFormRef",inline:!0,model:e.queryParams,class:"-mb-15px","label-width":"68px"},{default:s(()=>[a(i,{label:"\u89D2\u8272\u540D\u79F0",prop:"name"},{default:s(()=>[a(d,{modelValue:e.queryParams.name,"onUpdate:modelValue":l[0]||(l[0]=r=>e.queryParams.name=r),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0",onKeyup:q(e.handleQuery,["enter"])},null,8,["modelValue"])]),_:1}),a(i,{label:"\u89D2\u8272\u6807\u8BC6",prop:"code"},{default:s(()=>[a(d,{modelValue:e.queryParams.code,"onUpdate:modelValue":l[1]||(l[1]=r=>e.queryParams.code=r),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u6807\u8BC6",onKeyup:q(e.handleQuery,["enter"])},null,8,["modelValue"])]),_:1}),a(i,{label:"\u72B6\u6001",prop:"status"},{default:s(()=>[a(f,{modelValue:e.queryParams.status,"onUpdate:modelValue":l[2]||(l[2]=r=>e.queryParams.status=r),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u72B6\u6001"},{default:s(()=>[(n(!0),T(D,null,z(e.getIntDictOptions(e.DICT_TYPE.COMMON_STATUS),r=>(n(),p(b,{key:r.value,label:r.label,value:r.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(i,{label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime"},{default:s(()=>[a(w,{modelValue:e.queryParams.createTime,"onUpdate:modelValue":l[3]||(l[3]=r=>e.queryParams.createTime=r),"default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],class:"!w-240px","end-placeholder":"\u7ED3\u675F\u65E5\u671F","start-placeholder":"\u5F00\u59CB\u65E5\u671F",type:"daterange","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue","default-time"])]),_:1}),a(i,null,{default:s(()=>[a(t,{onClick:e.handleQuery},{default:s(()=>[a(c,{class:"mr-5px",icon:"ep:search"}),l[7]||(l[7]=u(" \u641C\u7D22 "))]),_:1}),a(t,{onClick:e.resetQuery},{default:s(()=>[a(c,{class:"mr-5px",icon:"ep:refresh"}),l[8]||(l[8]=u(" \u91CD\u7F6E "))]),_:1}),y((n(),p(t,{plain:"",type:"primary",onClick:l[4]||(l[4]=r=>e.openForm("create"))},{default:s(()=>[a(c,{class:"mr-5px",icon:"ep:plus"}),l[9]||(l[9]=u(" \u65B0\u589E "))]),_:1})),[[g,["system:role:create"]]]),y((n(),p(t,{loading:e.exportLoading,plain:"",type:"success",onClick:e.handleExport},{default:s(()=>[a(c,{class:"mr-5px",icon:"ep:download"}),l[10]||(l[10]=u(" \u5BFC\u51FA "))]),_:1},8,["loading"])),[[g,["system:role:export"]]])]),_:1})]),_:1},8,["model"])]),_:1}),a(v,null,{default:s(()=>[y((n(),p(S,{data:e.list},{default:s(()=>[a(o,{align:"center",label:"\u89D2\u8272\u7F16\u53F7",prop:"id"}),a(o,{align:"center",label:"\u89D2\u8272\u540D\u79F0",prop:"name"}),a(o,{label:"\u89D2\u8272\u7C7B\u578B",align:"center",prop:"type"},{default:s(r=>[a(x,{type:e.DICT_TYPE.SYSTEM_ROLE_TYPE,value:r.row.type},null,8,["type","value"])]),_:1}),a(o,{align:"center",label:"\u89D2\u8272\u6807\u8BC6",prop:"code"}),a(o,{align:"center",label:"\u663E\u793A\u987A\u5E8F",prop:"sort"}),a(o,{align:"center",label:"\u5907\u6CE8",prop:"remark"}),a(o,{align:"center",label:"\u72B6\u6001",prop:"status"},{default:s(r=>[a(x,{type:e.DICT_TYPE.COMMON_STATUS,value:r.row.status},null,8,["type","value"])]),_:1}),a(o,{formatter:e.dateFormatter,align:"center",label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime",width:"180"},null,8,["formatter"]),a(o,{width:300,align:"center",label:"\u64CD\u4F5C"},{default:s(r=>[y((n(),p(t,{link:"",type:"primary",onClick:k=>e.openForm("update",r.row.id)},{default:s(()=>l[11]||(l[11]=[u(" \u7F16\u8F91 ")])),_:2},1032,["onClick"])),[[g,["system:role:update"]]]),y((n(),p(t,{link:"",preIcon:"ep:basketball",title:"\u83DC\u5355\u6743\u9650",type:"primary",onClick:k=>e.openAssignMenuForm(r.row)},{default:s(()=>l[12]||(l[12]=[u(" \u83DC\u5355\u6743\u9650 ")])),_:2},1032,["onClick"])),[[g,["system:permission:assign-role-menu"]]]),y((n(),p(t,{link:"",preIcon:"ep:coin",title:"\u6570\u636E\u6743\u9650",type:"primary",onClick:k=>e.openDataPermissionForm(r.row)},{default:s(()=>l[13]||(l[13]=[u(" \u6570\u636E\u6743\u9650 ")])),_:2},1032,["onClick"])),[[g,["system:permission:assign-role-data-scope"]]]),y((n(),p(t,{link:"",type:"danger",onClick:k=>e.handleDelete(r.row.id)},{default:s(()=>l[14]||(l[14]=[u(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[g,["system:role:delete"]]])]),_:1})]),_:1},8,["data"])),[[V,e.loading]]),a(M,{limit:e.queryParams.pageSize,"onUpdate:limit":l[5]||(l[5]=r=>e.queryParams.pageSize=r),page:e.queryParams.pageNo,"onUpdate:page":l[6]||(l[6]=r=>e.queryParams.pageNo=r),total:e.total,onPagination:e.getList},null,8,["limit","page","total"])]),_:1}),a(e.RoleForm,{ref:"formRef",onSuccess:e.getList},null,512),a(e.RoleAssignMenuForm,{ref:"assignMenuFormRef",onSuccess:e.getList},null,512),a(e.RoleDataPermissionForm,{ref:"dataPermissionFormRef",onSuccess:e.getList},null,512)],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/system/role/index.vue"]]);export{ce as default};
