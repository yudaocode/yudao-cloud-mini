import{dl as q,_ as re,g as se,ca as G,r,f as D,b as de,au as he,C as ne,o as P,c as N,aF as k,j as u,I as oe,ag as le,k as ge,w as ve,a2 as Q,t as J,ah as U,a4 as fe,bQ as ce,ao as ue,dm as Y,dn as Z,F as me,n as ye,by as be,m as Se,q as xe,aZ as ke}from"./index-BaY5TDP-.js";function R(n,o="XwKsGlMcdPMEhR1B"){const a=q.enc.Utf8.parse(o),t=q.enc.Utf8.parse(n);return q.AES.encrypt(t,a,{mode:q.mode.ECB,padding:q.pad.Pkcs7}).toString()}function ee(n){let o,a,t,g;const h=window,s=n.$el.parentNode.offsetWidth||h.offsetWidth,l=n.$el.parentNode.offsetHeight||h.offsetHeight;return o=n.imgSize.width.indexOf("%")!=-1?parseInt(n.imgSize.width)/100*s+"px":n.imgSize.width,a=n.imgSize.height.indexOf("%")!=-1?parseInt(n.imgSize.height)/100*l+"px":n.imgSize.height,t=n.barSize.width.indexOf("%")!=-1?parseInt(n.barSize.width)/100*s+"px":n.barSize.width,g=n.barSize.height.indexOf("%")!=-1?parseInt(n.barSize.height)/100*l+"px":n.barSize.height,{imgWidth:o,imgHeight:a,barWidth:t,barHeight:g}}const we={style:{position:"relative"}},ze=["src"],Be=["textContent"],Ce=["textContent"],Te=["src"],We={style:{position:"relative"}},Ie={class:"verify-img-out"},He=["src"],$e={class:"verify-msg"},Oe={key:0,class:"verifybox-top"},Pe=re({name:"Vue3Verify",components:{VerifySlide:re({__name:"VerifySlide",props:{captchaType:{type:String},type:{type:String,default:"1"},mode:{type:String,default:"fixed"},vSpace:{type:Number,default:5},explain:{type:String,default:""},imgSize:{type:Object,default:()=>({width:"310px",height:"155px"})},blockSize:{type:Object,default:()=>({width:"50px",height:"50px"})},barSize:{type:Object,default:()=>({width:"310px",height:"30px"})}},setup(n,{expose:o}){o();const a=n,{t}=se(),{mode:g,captchaType:h,type:s,blockSize:l,explain:w}=G(a),{proxy:d}=ce();let c=r(""),f=r(""),M=r(""),E=r(""),y=r(""),b=r(""),T=r(""),m=r(""),S=r(""),_=r(""),z=D({imgHeight:0,imgWidth:0,barHeight:0,barWidth:0}),W=r(void 0),j=r(void 0),B=r(void 0),C=r("#ddd"),I=r(void 0),L=r("icon-right"),H=r(!1),$=r(!1),A=r(!0),i=r(""),p=r(""),x=r(0);const V=de(()=>d.$el.querySelector(".verify-bar-area")),K=()=>{w.value===""?S.value=t("captcha.slide"):S.value=w.value,ie(),ue(()=>{let{imgHeight:e,imgWidth:v,barHeight:O,barWidth:ae}=ee(d);z.imgHeight=e,z.imgWidth=v,z.barHeight=O,z.barWidth=ae,d.$parent.$emit("ready",d)}),window.removeEventListener("touchmove",function(e){F(e)}),window.removeEventListener("mousemove",function(e){F(e)}),window.removeEventListener("touchend",function(){X()}),window.removeEventListener("mouseup",function(){X()}),window.addEventListener("touchmove",function(e){F(e)}),window.addEventListener("mousemove",function(e){F(e)}),window.addEventListener("touchend",function(){X()}),window.addEventListener("mouseup",function(){X()})};he(s,()=>{K()}),ne(()=>{K(),d.$el.onselectstart=function(){return!1}});const F=e=>{if(e=e||window.event,H.value&&$.value==0){if(e.touches)v=e.touches[0].pageX;else var v=e.clientX;var O=v-V.value.getBoundingClientRect().left;O>=V.value.offsetWidth-parseInt(parseInt(l.value.width)/2)-2&&(O=V.value.offsetWidth-parseInt(parseInt(l.value.width)/2)-2),O<=0&&(O=parseInt(parseInt(l.value.width)/2)),W.value=O-x.value+"px",j.value=O-x.value+"px"}},X=()=>{if(T.value=+new Date,H.value&&$.value==0){var e=parseInt((W.value||"0").replace("px",""));e=310*e/parseInt(z.imgWidth);let v={captchaType:h.value,pointJson:c.value?R(JSON.stringify({x:e,y:5}),c.value):JSON.stringify({x:e,y:5}),token:y.value};Y(v).then(O=>{if(O.repCode=="0000"){B.value="#5cb85c",C.value="#5cb85c",I.value="#fff",L.value="icon-check",A.value=!1,$.value=!0,g.value=="pop"&&setTimeout(()=>{d.$parent.clickShow=!1,te()},1500),f.value=!0,m.value=`${((T.value-b.value)/1e3).toFixed(2)}s
            ${t("captcha.success")}`;var ae=c.value?R(y.value+"---"+JSON.stringify({x:e,y:5}),c.value):y.value+"---"+JSON.stringify({x:e,y:5});setTimeout(()=>{m.value="",d.$parent.closeBox(),d.$parent.$emit("success",{captchaVerification:ae})},1e3)}else B.value="#d9534f",C.value="#d9534f",I.value="#fff",L.value="icon-close",f.value=!1,setTimeout(function(){te()},1e3),d.$parent.$emit("error",d),m.value=t("captcha.fail"),setTimeout(()=>{m.value=""},1e3)}),H.value=!1}},te=async()=>{A.value=!0,_.value="",i.value="left .3s",W.value=0,j.value=void 0,p.value="width .3s",C.value="#ddd",B.value="#fff",I.value="#000",L.value="icon-right",$.value=!1,await ie(),setTimeout(()=>{p.value="",i.value="",S.value=w.value},300)},ie=async()=>{let e={captchaType:h.value};const v=await Z(e);v.repCode=="0000"?(M.value=v.repData.originalImageBase64,E.value=v.repData.jigsawImageBase64,y.value=v.repData.token,c.value=v.repData.secretKey):m.value=v.repMsg},pe={props:a,t,mode:g,captchaType:h,type:s,blockSize:l,explain:w,proxy:d,get secretKey(){return c},set secretKey(e){c=e},get passFlag(){return f},set passFlag(e){f=e},get backImgBase(){return M},set backImgBase(e){M=e},get blockBackImgBase(){return E},set blockBackImgBase(e){E=e},get backToken(){return y},set backToken(e){y=e},get startMoveTime(){return b},set startMoveTime(e){b=e},get endMovetime(){return T},set endMovetime(e){T=e},get tipWords(){return m},set tipWords(e){m=e},get text(){return S},set text(e){S=e},get finishText(){return _},set finishText(e){_=e},get setSize(){return z},set setSize(e){z=e},get moveBlockLeft(){return W},set moveBlockLeft(e){W=e},get leftBarWidth(){return j},set leftBarWidth(e){j=e},get moveBlockBackgroundColor(){return B},set moveBlockBackgroundColor(e){B=e},get leftBarBorderColor(){return C},set leftBarBorderColor(e){C=e},get iconColor(){return I},set iconColor(e){I=e},get iconClass(){return L},set iconClass(e){L=e},get status(){return H},set status(e){H=e},get isEnd(){return $},set isEnd(e){$=e},get showRefresh(){return A},set showRefresh(e){A=e},get transitionLeft(){return i},set transitionLeft(e){i=e},get transitionWidth(){return p},set transitionWidth(e){p=e},get startLeft(){return x},set startLeft(e){x=e},barArea:V,init:K,start:e=>{if((e=e||window.event).touches)v=e.touches[0].pageX;else var v=e.clientX;x.value=Math.floor(v-V.value.getBoundingClientRect().left),b.value=+new Date,$.value==0&&(S.value="",B.value="#337ab7",C.value="#337AB7",I.value="#fff",e.stopPropagation(),H.value=!0)},move:F,end:X,refresh:te,getPictrue:ie,get aesEncrypt(){return R},get resetSize(){return ee},get getCode(){return Z},get reqCheck(){return Y}};return Object.defineProperty(pe,"__isScriptSetup",{enumerable:!1,value:!0}),pe}},[["render",function(n,o,a,t,g,h){return P(),N("div",we,[t.type==="2"?(P(),N("div",{key:0,style:k({height:parseInt(t.setSize.imgHeight)+a.vSpace+"px"}),class:"verify-img-out"},[u("div",{style:k({width:t.setSize.imgWidth,height:t.setSize.imgHeight}),class:"verify-img-panel"},[u("img",{src:"data:image/png;base64,"+t.backImgBase,alt:"",style:{display:"block",width:"100%",height:"100%"}},null,8,ze),oe(u("div",{class:"verify-refresh",onClick:t.refresh},o[0]||(o[0]=[u("i",{class:"iconfont icon-refresh"},null,-1)]),512),[[le,t.showRefresh]]),ge(fe,{name:"tips"},{default:ve(()=>[t.tipWords?(P(),N("span",{key:0,class:Q([t.passFlag?"suc-bg":"err-bg","verify-tips"])},J(t.tipWords),3)):U("",!0)]),_:1})],4)],4)):U("",!0),u("div",{style:k({width:t.setSize.imgWidth,height:a.barSize.height,"line-height":a.barSize.height}),class:"verify-bar-area"},[u("span",{class:"verify-msg",textContent:J(t.text)},null,8,Be),u("div",{style:k({width:t.leftBarWidth!==void 0?t.leftBarWidth:a.barSize.height,height:a.barSize.height,"border-color":t.leftBarBorderColor,transaction:t.transitionWidth}),class:"verify-left-bar"},[u("span",{class:"verify-msg",textContent:J(t.finishText)},null,8,Ce),u("div",{style:k({width:a.barSize.height,height:a.barSize.height,"background-color":t.moveBlockBackgroundColor,left:t.moveBlockLeft,transition:t.transitionLeft}),class:"verify-move-block",onMousedown:t.start,onTouchstart:t.start},[u("i",{class:Q(["verify-icon iconfont",t.iconClass]),style:k({color:t.iconColor})},null,6),t.type==="2"?(P(),N("div",{key:0,style:k({width:Math.floor(47*parseInt(t.setSize.imgWidth)/310)+"px",height:t.setSize.imgHeight,top:"-"+(parseInt(t.setSize.imgHeight)+a.vSpace)+"px","background-size":t.setSize.imgWidth+" "+t.setSize.imgHeight}),class:"verify-sub-block"},[u("img",{src:"data:image/png;base64,"+t.blockBackImgBase,alt:"",style:{display:"block",width:"100%",height:"100%","-webkit-user-drag":"none"}},null,8,Te)],4)):U("",!0)],36)],4)],4)])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/components/Verifition/src/Verify/VerifySlide.vue"]]),VerifyPoints:re({__name:"VerifyPoints",props:{mode:{type:String,default:"fixed"},captchaType:{type:String},vSpace:{type:Number,default:5},imgSize:{type:Object,default:()=>({width:"310px",height:"155px"})},barSize:{type:Object,default:()=>({width:"310px",height:"40px"})}},setup(n,{expose:o}){o();const a=n,{t}=se(),{mode:g,captchaType:h}=G(a),{proxy:s}=ce();let l=r(""),w=r(3),d=D([]),c=D([]),f=r(1),M=r(""),E=D([]),y=r(""),b=D({imgHeight:0,imgWidth:0,barHeight:0,barWidth:0}),T=D([]),m=r(""),S=r(void 0),_=r(void 0),z=r(!0),W=r(!0);const j=()=>{d.splice(0,d.length),c.splice(0,c.length),f.value=1,H(),ue(()=>{let{imgHeight:i,imgWidth:p,barHeight:x,barWidth:V}=ee(s);b.imgHeight=i,b.imgWidth=p,b.barHeight=x,b.barWidth=V,s.$parent.$emit("ready",s)})};ne(()=>{j(),s.$el.onselectstart=function(){return!1}});const B=r(null),C=function(i,p){return{x:p.offsetX,y:p.offsetY}},I=function(i){return T.push(Object.assign({},i)),f.value+1},L=async function(){T.splice(0,T.length),S.value="#000",_.value="#ddd",W.value=!0,d.splice(0,d.length),c.splice(0,c.length),f.value=1,await H(),z.value=!0},H=async()=>{let i={captchaType:h.value};const p=await Z(i);p.repCode=="0000"?(M.value=p.repData.originalImageBase64,y.value=p.repData.token,l.value=p.repData.secretKey,E.value=p.repData.wordList,m.value=t("captcha.point")+"\u3010"+E.value.join(",")+"\u3011"):m.value=p.repMsg},$=function(i,p){return i.map(x=>({x:Math.round(310*x.x/parseInt(p.imgWidth)),y:Math.round(155*x.y/parseInt(p.imgHeight))}))},A={props:a,t,mode:g,captchaType:h,proxy:s,get secretKey(){return l},set secretKey(i){l=i},get checkNum(){return w},set checkNum(i){w=i},get fontPos(){return d},set fontPos(i){d=i},get checkPosArr(){return c},set checkPosArr(i){c=i},get num(){return f},set num(i){f=i},get pointBackImgBase(){return M},set pointBackImgBase(i){M=i},get poinTextList(){return E},set poinTextList(i){E=i},get backToken(){return y},set backToken(i){y=i},get setSize(){return b},set setSize(i){b=i},get tempPoints(){return T},set tempPoints(i){T=i},get text(){return m},set text(i){m=i},get barAreaColor(){return S},set barAreaColor(i){S=i},get barAreaBorderColor(){return _},set barAreaBorderColor(i){_=i},get showRefresh(){return z},set showRefresh(i){z=i},get bindingClick(){return W},set bindingClick(i){W=i},init:j,canvas:B,canvasClick:i=>{if(c.push(C(B,i)),f.value==w.value){f.value=I(C(B,i));let p=$(c,b);c.length=0,c.push(...p),setTimeout(()=>{var x=l.value?R(y.value+"---"+JSON.stringify(c),l.value):y.value+"---"+JSON.stringify(c);let V={captchaType:h.value,pointJson:l.value?R(JSON.stringify(c),l.value):JSON.stringify(c),token:y.value};Y(V).then(K=>{K.repCode=="0000"?(S.value="#4cae4c",_.value="#5cb85c",m.value=t("captcha.success"),W.value=!1,g.value=="pop"&&setTimeout(()=>{s.$parent.clickShow=!1,L()},1500),s.$parent.$emit("success",{captchaVerification:x})):(s.$parent.$emit("error",s),S.value="#d9534f",_.value="#d9534f",m.value=t("captcha.fail"),setTimeout(()=>{L()},700))})},400)}f.value<w.value&&(f.value=I(C(B,i)))},getMousePos:C,createPoint:I,refresh:L,getPictrue:H,pointTransfrom:$,get resetSize(){return ee},get aesEncrypt(){return R},get getCode(){return Z},get reqCheck(){return Y},getCurrentInstance:ce,nextTick:ue,onMounted:ne,reactive:D,ref:r,toRefs:G};return Object.defineProperty(A,"__isScriptSetup",{enumerable:!1,value:!0}),A}},[["render",function(n,o,a,t,g,h){return P(),N("div",We,[u("div",Ie,[u("div",{style:k({width:t.setSize.imgWidth,height:t.setSize.imgHeight,"background-size":t.setSize.imgWidth+" "+t.setSize.imgHeight,"margin-bottom":a.vSpace+"px"}),class:"verify-img-panel"},[oe(u("div",{class:"verify-refresh",style:{"z-index":"3"},onClick:t.refresh},o[1]||(o[1]=[u("i",{class:"iconfont icon-refresh"},null,-1)]),512),[[le,t.showRefresh]]),u("img",{ref:"canvas",src:"data:image/png;base64,"+t.pointBackImgBase,alt:"",style:{display:"block",width:"100%",height:"100%"},onClick:o[0]||(o[0]=s=>t.bindingClick?t.canvasClick(s):void 0)},null,8,He),(P(!0),N(me,null,ye(t.tempPoints,(s,l)=>(P(),N("div",{key:l,style:k({"background-color":"#1abd6c",color:"#fff","z-index":9999,width:"20px",height:"20px","text-align":"center","line-height":"20px","border-radius":"50%",position:"absolute",top:parseInt(s.y-10)+"px",left:parseInt(s.x-10)+"px"}),class:"point-area"},J(l+1),5))),128))],4)]),u("div",{style:k({width:t.setSize.imgWidth,color:t.barAreaColor,"border-color":t.barAreaBorderColor,"line-height":a.barSize.height}),class:"verify-bar-area"},[u("span",$e,J(t.text),1)],4)])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/components/Verifition/src/Verify/VerifyPoints.vue"]])},props:{captchaType:{type:String,required:!0},figure:{type:Number},arith:{type:Number},mode:{type:String,default:"pop"},vSpace:{type:Number},explain:{type:String},imgSize:{type:Object,default:()=>({width:"310px",height:"155px"})},blockSize:{type:Object},barSize:{type:Object}},setup(n){const{t:o}=se(),{captchaType:a,mode:t}=G(n),g=r(!1),h=r(void 0),s=r(void 0),l=r({}),w=de(()=>t.value!="pop"||g.value);return be(()=>{switch(a.value){case"blockPuzzle":h.value="2",s.value="VerifySlide";break;case"clickWord":h.value="",s.value="VerifyPoints"}}),{t:o,clickShow:g,verifyType:h,componentType:s,instance:l,showBox:w,closeBox:()=>{g.value=!1,l.value.refresh&&l.value.refresh()},show:()=>{t.value=="pop"&&(g.value=!0)}}}},[["render",function(n,o,a,t,g,h){return oe((P(),N("div",{class:Q(a.mode=="pop"?"mask":"")},[u("div",{class:Q(a.mode=="pop"?"verifybox":""),style:k({"max-width":parseInt(a.imgSize.width)+20+"px"})},[a.mode=="pop"?(P(),N("div",Oe,[Se(J(t.t("captcha.verification"))+" ",1),u("span",{class:"verifybox-close",onClick:o[0]||(o[0]=(...s)=>t.closeBox&&t.closeBox(...s))},o[1]||(o[1]=[u("i",{class:"iconfont icon-close"},null,-1)]))])):U("",!0),u("div",{style:k({padding:a.mode=="pop"?"10px":"0"}),class:"verifybox-bottom"},[t.componentType?(P(),xe(ke(t.componentType),{key:0,ref:"instance",arith:a.arith,barSize:a.barSize,blockSize:a.blockSize,captchaType:a.captchaType,explain:a.explain,figure:a.figure,imgSize:a.imgSize,mode:a.mode,type:t.verifyType,vSpace:a.vSpace},null,8,["arith","barSize","blockSize","captchaType","explain","figure","imgSize","mode","type","vSpace"])):U("",!0)],4)],6)],2)),[[le,t.showBox]])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/components/Verifition/src/Verify.vue"]]);export{Pe as _};
