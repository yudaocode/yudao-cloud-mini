import{d as V,k as a,z as U,G as D,ch as A,m as s,N as x,F as b,eW as L,g as N,D as Q,r as u,f as j,C as G,U as Y,eX as F,_ as H,X,o as g,c as q,w as r,Y as z,n as J,q as O,I as W,Z,L as $,J as ee,K as ae,O as te}from"./index-BaY5TDP-.js";import"./el-empty-wTPt5q4m.js";import"./el-virtual-list-Cbbiio1P.js";import{F as I,E as le,a as ne}from"./el-table-v2-cHNvyjHH.js";import{_ as oe}from"./ContentWrap-DKQn7kZm.js";import{_ as re}from"./index-BAz6Gqim.js";import{h as se}from"./tree-z7HkrWVC.js";import{d as ue,u as ie,b as de}from"./index-cImR9iDp.js";import me from"./MenuForm-r68Nur7r.js";import{_ as ce}from"./DictTag-QtcI9ZjC.js";import{c as C}from"./permission-DVIdBhA5.js";import{C as P}from"./constants-CEEr2azc.js";import"./Dialog-CZSXtzfQ.js";import"./Tooltip-BVOSXOHc.js";import"./index-DrSdAlug.js";import"./el-tree-select-DphqCDCz.js";import"./color-BN7ZL7BD.js";const pe=H(V({name:"SystemMenu",__name:"index",setup(M,{expose:l}){l();const S=[{key:"name",title:"\u83DC\u5355\u540D\u79F0",dataKey:"name",width:250,fixed:I.LEFT},{key:"icon",title:"\u56FE\u6807",dataKey:"icon",width:100,align:"center",cellRenderer:({cellData:t})=>a(U,{icon:t},null)},{key:"sort",title:"\u6392\u5E8F",dataKey:"sort",width:60},{key:"permission",title:"\u6743\u9650\u6807\u8BC6",dataKey:"permission",width:300},{key:"component",title:"\u7EC4\u4EF6\u8DEF\u5F84",dataKey:"component",width:500},{key:"componentName",title:"\u7EC4\u4EF6\u540D\u79F0",dataKey:"componentName",width:200},{key:"status",title:"\u72B6\u6001",dataKey:"status",width:60,fixed:I.RIGHT,cellRenderer:({rowData:t})=>C(["system:menu:update"])?a(A,{modelValue:t.status,"onUpdate:modelValue":o=>t.status=o,"active-value":P.ENABLE,"inactive-value":P.DISABLE,loading:_[t.id],class:"ml-4px",onChange:o=>K(t,o)},null):a(ce,{type:D.COMMON_STATUS,value:t.status},null)},{key:"operations",title:"\u64CD\u4F5C",align:"center",width:160,fixed:I.RIGHT,cellRenderer:({rowData:t})=>{const o=[];return C(["system:menu:update"])&&o.push(a(x,{key:"edit",link:!0,type:"primary",onClick:()=>n("update",t.id)},{default:()=>[s("\u4FEE\u6539")]})),C(["system:menu:create"])&&o.push(a(x,{key:"create",link:!0,type:"primary",onClick:()=>n("create",void 0,t.id)},{default:()=>[s("\u65B0\u589E")]})),C(["system:menu:delete"])&&o.push(a(x,{key:"delete",link:!0,type:"danger",onClick:()=>k(t.id)},{default:()=>[s("\u5220\u9664")]})),o.length===0?null:a(b,null,[o])}}],{wsCache:e}=L(),{t:E}=N(),y=Q(),i=u(!0),f=u([]),d=j({name:void 0,status:void 0}),h=u(),m=u(!1),R=u(!0),c=u([]),p=async()=>{i.value=!0;try{const t=await de(d);f.value=se(t)}finally{i.value=!1}},w=()=>{p()},v=u(),n=(t,o,B)=>{v.value.open(t,o,B)},k=async t=>{try{await y.delConfirm(),await ue(t),y.success(E("common.delSuccess")),await p()}catch{}},_=u({}),K=async(t,o)=>{_.value[t.id]=!0;try{t.status=o,await ie(t)}finally{_.value[t.id]=!1}};G(()=>{p()});const T={columns:S,wsCache:e,t:E,message:y,loading:i,list:f,queryParams:d,queryFormRef:h,isExpandAll:m,refreshTable:R,expandedRowKeys:c,getList:p,handleQuery:w,resetQuery:()=>{h.value.resetFields(),w()},formRef:v,openForm:n,toggleExpandAll:()=>{m.value?c.value=[]:c.value=f.value.map(t=>t.id),m.value=!m.value},refreshMenu:async()=>{try{await y.confirm("\u5373\u5C06\u66F4\u65B0\u7F13\u5B58\u5237\u65B0\u6D4F\u89C8\u5668\uFF01","\u5237\u65B0\u83DC\u5355\u7F13\u5B58"),e.delete(F.USER),e.delete(F.ROLE_ROUTERS),location.reload()}catch{}},handleDelete:k,menuStatusUpdating:_,handleStatusChanged:K,get DICT_TYPE(){return D},get getIntDictOptions(){return Y},MenuForm:me,get Icon(){return U},get ElButton(){return x}};return Object.defineProperty(T,"__isScriptSetup",{enumerable:!1,value:!0}),T}}),[["render",function(M,l,S,e,E,y){const i=re,f=Z,d=$,h=ee,m=ae,R=te,c=oe,p=le,w=ne,v=X("hasPermi");return g(),q(b,null,[a(i,{title:"\u529F\u80FD\u6743\u9650",url:"https://doc.iocoder.cn/resource-permission"}),a(i,{title:"\u83DC\u5355\u8DEF\u7531",url:"https://doc.iocoder.cn/vue3/route/"}),a(c,null,{default:r(()=>[a(R,{ref:"queryFormRef",inline:!0,model:e.queryParams,class:"-mb-15px","label-width":"68px"},{default:r(()=>[a(d,{label:"\u83DC\u5355\u540D\u79F0",prop:"name"},{default:r(()=>[a(f,{modelValue:e.queryParams.name,"onUpdate:modelValue":l[0]||(l[0]=n=>e.queryParams.name=n),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u83DC\u5355\u540D\u79F0",onKeyup:z(e.handleQuery,["enter"])},null,8,["modelValue"])]),_:1}),a(d,{label:"\u72B6\u6001",prop:"status"},{default:r(()=>[a(m,{modelValue:e.queryParams.status,"onUpdate:modelValue":l[1]||(l[1]=n=>e.queryParams.status=n),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u83DC\u5355\u72B6\u6001"},{default:r(()=>[(g(!0),q(b,null,J(e.getIntDictOptions(e.DICT_TYPE.COMMON_STATUS),n=>(g(),O(h,{key:n.value,label:n.label,value:n.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(d,null,{default:r(()=>[a(e.ElButton,{onClick:e.handleQuery},{default:r(()=>[a(e.Icon,{class:"mr-5px",icon:"ep:search"}),l[4]||(l[4]=s(" \u641C\u7D22 "))]),_:1}),a(e.ElButton,{onClick:e.resetQuery},{default:r(()=>[a(e.Icon,{class:"mr-5px",icon:"ep:refresh"}),l[5]||(l[5]=s(" \u91CD\u7F6E "))]),_:1}),W((g(),O(e.ElButton,{plain:"",type:"primary",onClick:l[2]||(l[2]=n=>e.openForm("create"))},{default:r(()=>[a(e.Icon,{class:"mr-5px",icon:"ep:plus"}),l[6]||(l[6]=s(" \u65B0\u589E "))]),_:1})),[[v,["system:menu:create"]]]),a(e.ElButton,{plain:"",type:"danger",onClick:e.toggleExpandAll},{default:r(()=>[a(e.Icon,{class:"mr-5px",icon:"ep:sort"}),l[7]||(l[7]=s(" \u5C55\u5F00/\u6298\u53E0 "))]),_:1}),a(e.ElButton,{plain:"",onClick:e.refreshMenu},{default:r(()=>[a(e.Icon,{class:"mr-5px",icon:"ep:refresh"}),l[8]||(l[8]=s(" \u5237\u65B0\u83DC\u5355\u7F13\u5B58 "))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(c,null,{default:r(()=>[a(w,null,{default:r(({width:n})=>[a(p,{"expanded-row-keys":e.expandedRowKeys,"onUpdate:expandedRowKeys":l[3]||(l[3]=k=>e.expandedRowKeys=k),columns:e.columns,data:e.list,"expand-column-key":e.columns[0].key,height:1e3,width:n,fixed:"","row-key":"id"},null,8,["expanded-row-keys","data","expand-column-key","width"])]),_:1})]),_:1}),a(e.MenuForm,{ref:"formRef",onSuccess:e.getList},null,512)],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/system/menu/index.vue"]]);export{pe as default};
