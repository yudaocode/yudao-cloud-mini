import{d as N,g as R,D as F,r as m,f as I,_ as E,o as C,q as V,w as s,k as t,m as p,I as D,t as w,an as L,L as M,ch as O,cC as S,l as T,O as U,N as P,R as j}from"./index-BaY5TDP-.js";import{_ as K}from"./Dialog-CZSXtzfQ.js";import{h as q,d as H}from"./tree-z7HkrWVC.js";import{g as z}from"./index-cImR9iDp.js";import{g as B,a as G}from"./index-CBoTGgba.js";const J=E(N({name:"SystemRoleAssignMenuForm",__name:"RoleAssignMenuForm",emits:["success"],setup(A,{expose:a,emit:y}){const{t:e}=R(),x=F(),h=m(!1),u=m(!1),d=I({id:void 0,name:"",code:"",menuIds:[]}),i=m(),v=m([]),c=m(!1),o=m(),f=m(!1),g=async l=>{h.value=!0,n(),v.value=q(await z()),d.id=l.id,d.name=l.name,d.code=l.code,u.value=!0;try{d.value.menuIds=await B(l.id),d.value.menuIds.forEach(r=>{o.value.setChecked(r,!0,!1)})}finally{u.value=!1}};a({open:g});const _=y,n=()=>{var l,r;f.value=!1,c.value=!1,d.value={id:void 0,name:"",code:"",menuIds:[]},(l=o.value)==null||l.setCheckedNodes([]),(r=i.value)==null||r.resetFields()},b={t:e,message:x,dialogVisible:h,formLoading:u,formData:d,formRef:i,menuOptions:v,menuExpand:c,treeRef:o,treeNodeAll:f,open:g,emit:_,submitForm:async()=>{if(i&&await i.value.validate()){u.value=!0;try{const l={roleId:d.id,menuIds:[...o.value.getCheckedKeys(!1),...o.value.getHalfCheckedKeys()]};await G(l),x.success(e("common.updateSuccess")),h.value=!1,_("success")}finally{u.value=!1}}},resetForm:n,handleCheckedTreeNodeAll:()=>{o.value.setCheckedNodes(f.value?v.value:[])},handleCheckedTreeExpand:()=>{var r;const l=(r=o.value)==null?void 0:r.store.nodesMap;for(let k in l)l[k].expanded!==c.value&&(l[k].expanded=c.value)},get defaultProps(){return H}};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}}),[["render",function(A,a,y,e,x,h){const u=L,d=M,i=O,v=S,c=T,o=U,f=P,g=K,_=j;return C(),V(g,{modelValue:e.dialogVisible,"onUpdate:modelValue":a[3]||(a[3]=n=>e.dialogVisible=n),title:"\u83DC\u5355\u6743\u9650"},{footer:s(()=>[t(f,{disabled:e.formLoading,type:"primary",onClick:e.submitForm},{default:s(()=>a[6]||(a[6]=[p("\u786E \u5B9A")])),_:1},8,["disabled"]),t(f,{onClick:a[2]||(a[2]=n=>e.dialogVisible=!1)},{default:s(()=>a[7]||(a[7]=[p("\u53D6 \u6D88")])),_:1})]),default:s(()=>[D((C(),V(o,{ref:"formRef",model:e.formData,"label-width":"80px"},{default:s(()=>[t(d,{label:"\u89D2\u8272\u540D\u79F0"},{default:s(()=>[t(u,null,{default:s(()=>[p(w(e.formData.name),1)]),_:1})]),_:1}),t(d,{label:"\u89D2\u8272\u6807\u8BC6"},{default:s(()=>[t(u,null,{default:s(()=>[p(w(e.formData.code),1)]),_:1})]),_:1}),t(d,{label:"\u83DC\u5355\u6743\u9650"},{default:s(()=>[t(c,{class:"w-full h-400px !overflow-y-scroll",shadow:"never"},{header:s(()=>[a[4]||(a[4]=p(" \u5168\u9009/\u5168\u4E0D\u9009: ")),t(i,{modelValue:e.treeNodeAll,"onUpdate:modelValue":a[0]||(a[0]=n=>e.treeNodeAll=n),"active-text":"\u662F","inactive-text":"\u5426","inline-prompt":"",onChange:e.handleCheckedTreeNodeAll},null,8,["modelValue"]),a[5]||(a[5]=p(" \u5168\u90E8\u5C55\u5F00/\u6298\u53E0: ")),t(i,{modelValue:e.menuExpand,"onUpdate:modelValue":a[1]||(a[1]=n=>e.menuExpand=n),"active-text":"\u5C55\u5F00","inactive-text":"\u6298\u53E0","inline-prompt":"",onChange:e.handleCheckedTreeExpand},null,8,["modelValue"])]),default:s(()=>[t(v,{ref:"treeRef",data:e.menuOptions,props:e.defaultProps,"empty-text":"\u52A0\u8F7D\u4E2D\uFF0C\u8BF7\u7A0D\u5019","node-key":"id","show-checkbox":""},null,8,["data","props"])]),_:1})]),_:1})]),_:1},8,["model"])),[[_,e.formLoading]])]),_:1},8,["modelValue"])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/system/role/RoleAssignMenuForm.vue"]]);export{J as default};
