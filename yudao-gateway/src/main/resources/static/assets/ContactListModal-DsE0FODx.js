import{d as R,D as F,r as i,f as V,u as S,G as k,_ as D,X as Q,o as P,q,w as r,k as t,m as p,Y as T,I as N,t as U,Z as z,L as O,z as j,N as A,O as E,P as M,y as Y,Q as G,R as B}from"./index-BaY5TDP-.js";import{_ as K}from"./Dialog-CZSXtzfQ.js";import{_ as X}from"./index-avjYFQiD.js";import{_ as Z}from"./DictTag-QtcI9ZjC.js";import{_ as H}from"./ContentWrap-DKQn7kZm.js";import{g as J}from"./index-DiJG1eDb.js";import W from"./ContactForm-DLuG_ZcF.js";import"./index-DrSdAlug.js";import"./color-BN7ZL7BD.js";import"./index-CuAlllbQ.js";import"./index-h6ObHKtQ.js";import"./index-Qzz5HSIB.js";import"./tree-z7HkrWVC.js";const $=D(R({name:"ContactListModal",__name:"ContactListModal",props:{customerId:{type:Number,required:!0}},emits:["success"],setup(x,{expose:a,emit:I}){const e=F(),g=x,y=i(!1),u=i(!0),d=i(0),m=i([]),o=i(),w=i(!1),n=V({pageNo:1,pageSize:10,name:void 0,customerId:g.customerId}),s=async()=>{y.value=!0,n.customerId=g.customerId,await c()};a({open:s});const c=async()=>{u.value=!0;try{const l=await J(n);m.value=l.list,d.value=l.total}finally{u.value=!1}},_=()=>{n.pageNo=1,c()},b=i(),v=I,f=i(),{push:C}=S(),h={message:e,props:g,dialogVisible:y,loading:u,total:d,list:m,queryFormRef:o,formLoading:w,queryParams:n,open:s,getList:c,handleQuery:_,resetQuery:()=>{o.value.resetFields(),_()},formRef:b,openForm:()=>{b.value.open("create")},emit:v,contactRef:f,submitForm:async()=>{const l=f.value.getSelectionRows().map(L=>L.id);if(l.length===0)return e.error("\u672A\u9009\u62E9\u8054\u7CFB\u4EBA");y.value=!1,v("success",l,f.value.getSelectionRows())},push:C,openDetail:l=>{C({name:"CrmContactDetail",params:{id:l}})},ContactForm:W,get DICT_TYPE(){return k}};return Object.defineProperty(h,"__isScriptSetup",{enumerable:!1,value:!0}),h}}),[["render",function(x,a,I,e,g,y){const u=z,d=O,m=j,o=A,w=E,n=H,s=M,c=Y,_=Z,b=G,v=X,f=K,C=Q("hasPermi"),h=B;return P(),q(f,{modelValue:e.dialogVisible,"onUpdate:modelValue":a[5]||(a[5]=l=>e.dialogVisible=l),title:"\u5173\u8054\u8054\u7CFB\u4EBA"},{footer:r(()=>[t(o,{disabled:e.formLoading,type:"primary",onClick:e.submitForm},{default:r(()=>a[9]||(a[9]=[p("\u786E \u5B9A")])),_:1},8,["disabled"]),t(o,{onClick:a[4]||(a[4]=l=>e.dialogVisible=!1)},{default:r(()=>a[10]||(a[10]=[p("\u53D6 \u6D88")])),_:1})]),default:r(()=>[t(n,null,{default:r(()=>[t(w,{ref:"queryFormRef",inline:!0,model:e.queryParams,class:"-mb-15px","label-width":"90px"},{default:r(()=>[t(d,{label:"\u8054\u7CFB\u4EBA\u540D\u79F0",prop:"name"},{default:r(()=>[t(u,{modelValue:e.queryParams.name,"onUpdate:modelValue":a[0]||(a[0]=l=>e.queryParams.name=l),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u8054\u7CFB\u4EBA\u540D\u79F0",onKeyup:T(e.handleQuery,["enter"])},null,8,["modelValue"])]),_:1}),t(d,null,{default:r(()=>[t(o,{onClick:e.handleQuery},{default:r(()=>[t(m,{class:"mr-5px",icon:"ep:search"}),a[6]||(a[6]=p(" \u641C\u7D22 "))]),_:1}),t(o,{onClick:e.resetQuery},{default:r(()=>[t(m,{class:"mr-5px",icon:"ep:refresh"}),a[7]||(a[7]=p(" \u91CD\u7F6E "))]),_:1}),N((P(),q(o,{type:"primary",onClick:a[1]||(a[1]=l=>e.openForm())},{default:r(()=>[t(m,{class:"mr-5px",icon:"ep:plus"}),a[8]||(a[8]=p(" \u65B0\u589E "))]),_:1})),[[C,["crm:business:create"]]])]),_:1})]),_:1},8,["model"])]),_:1}),t(n,{class:"mt-10px"},{default:r(()=>[N((P(),q(b,{ref:"contactRef",data:e.list,"show-overflow-tooltip":!0,stripe:!0},{default:r(()=>[t(s,{type:"selection",width:"55"}),t(s,{align:"center",fixed:"left",label:"\u59D3\u540D",prop:"name"},{default:r(l=>[t(c,{underline:!1,type:"primary",onClick:L=>e.openDetail(l.row.id)},{default:r(()=>[p(U(l.row.name),1)]),_:2},1032,["onClick"])]),_:1}),t(s,{align:"center",label:"\u624B\u673A\u53F7",prop:"mobile"}),t(s,{align:"center",label:"\u804C\u4F4D",prop:"post"}),t(s,{align:"center",label:"\u76F4\u5C5E\u4E0A\u7EA7",prop:"parentName"}),t(s,{align:"center",label:"\u662F\u5426\u5173\u952E\u51B3\u7B56\u4EBA","min-width":"100",prop:"master"},{default:r(l=>[t(_,{type:e.DICT_TYPE.INFRA_BOOLEAN_STRING,value:l.row.master},null,8,["type","value"])]),_:1})]),_:1},8,["data"])),[[h,e.loading]]),t(v,{limit:e.queryParams.pageSize,"onUpdate:limit":a[2]||(a[2]=l=>e.queryParams.pageSize=l),page:e.queryParams.pageNo,"onUpdate:page":a[3]||(a[3]=l=>e.queryParams.pageNo=l),total:e.total,onPagination:e.getList},null,8,["limit","page","total"])]),_:1}),t(e.ContactForm,{ref:"formRef",onSuccess:e.getList},null,512)]),_:1},8,["modelValue"])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/crm/contact/components/ContactListModal.vue"]]);export{$ as default};
