import{d as E,u as q,S as z,r as m,C as G,g as H,D as J,aw as P,ax as D,a as d,ay as K,az as g,_ as M,I as Q,q as O,w as s,R as W,o as T,k as o,m as j,ah as X,A as Y,B as Z,N as $,L as ee,O as ae}from"./index-BaY5TDP-.js";import{_ as re}from"./ContentWrap-DKQn7kZm.js";import{u as te}from"./tagsView-lnAkwTv2.js";import{g as ie,c as oe,u as se}from"./spu-BVX48OKx.js";import ce from"./InfoForm-E4Vph0sJ.js";import me from"./DescriptionForm-BK3oVXCu.js";import le from"./OtherForm-CISKi5Dk.js";import de from"./SkuForm-GA3y__Rf.js";import pe from"./DeliveryForm-DnA1SvF0.js";import"./tree-z7HkrWVC.js";import"./category-B7jjsMOS.js";import"./brand-CpGCeCT3.js";import"./formRules-CMjZInfO.js";import"./index-DqlyDc99.js";import"./el-image-Bg-CwbDE.js";import"./SkuList-LfTbtJ44.js";import"./ProductAttributes-ZrPf19nd.js";import"./property-Ddjv43NP.js";import"./ProductPropertyAddForm-B6g9kPn8.js";import"./Dialog-CZSXtzfQ.js";import"./index-oo0HyGJ_.js";import"./constants-CEEr2azc.js";const ne=M(E({name:"ProductSpuAdd",__name:"index",setup(A,{expose:r}){r();const{t:N}=H(),e=J(),{push:_,currentRoute:h}=q(),{params:c,name:y}=z(),{delView:p}=te(),l=m(!1),w=m("info"),n=m(!1),F=m(),i=m(),R=m(),U=m(),S=m(),b=m({name:"",categoryId:void 0,keyword:"",picUrl:"",sliderPicUrls:[],introduction:"",deliveryTypes:[],deliveryTemplateId:void 0,brandId:void 0,specType:!1,subCommissionType:!1,skus:[{price:0,marketPrice:0,costPrice:0,barCode:"",picUrl:"",stock:0,weight:0,volume:0,firstBrokeragePrice:0,secondBrokeragePrice:0}],description:"",sort:0,giveIntegral:0,virtualSalesCount:0}),I=async()=>{var f;y==="ProductSpuDetail"&&(n.value=!0);const u=c.id;if(u){l.value=!0;try{const v=await ie(u);(f=v.skus)==null||f.forEach(a=>{n.value?(a.price=P(a.price),a.marketPrice=P(a.marketPrice),a.costPrice=P(a.costPrice),a.firstBrokeragePrice=P(a.firstBrokeragePrice),a.secondBrokeragePrice=P(a.secondBrokeragePrice)):(a.price=D(a.price),a.marketPrice=D(a.marketPrice),a.costPrice=D(a.costPrice),a.firstBrokeragePrice=D(a.firstBrokeragePrice),a.secondBrokeragePrice=D(a.secondBrokeragePrice))}),b.value=v}finally{l.value=!1}}},C=()=>{p(d(h)),_({name:"ProductSpu"})};G(async()=>{await I()});const x={t:N,message:e,push:_,currentRoute:h,params:c,name:y,delView:p,formLoading:l,activeName:w,isDetail:n,infoRef:F,skuRef:i,deliveryRef:R,descriptionRef:U,otherRef:S,formData:b,getDetail:I,submitForm:async()=>{var u,f,v,a,V;l.value=!0;try{await((u=d(F))==null?void 0:u.validate()),await((f=d(i))==null?void 0:f.validate()),await((v=d(R))==null?void 0:v.validate()),await((a=d(U))==null?void 0:a.validate()),await((V=d(S))==null?void 0:V.validate());const k=K(d(b.value));k.skus.forEach(t=>{t.name=k.name,t.price=g(t.price),t.marketPrice=g(t.marketPrice),t.costPrice=g(t.costPrice),t.firstBrokeragePrice=g(t.firstBrokeragePrice),t.secondBrokeragePrice=g(t.secondBrokeragePrice)});const B=[];k.sliderPicUrls.forEach(t=>{typeof t=="object"?B.push(t.url):B.push(t)}),k.sliderPicUrls=B;const L=k;c.id?(await se(L),e.success(N("common.updateSuccess"))):(await oe(L),e.success(N("common.createSuccess"))),C()}finally{l.value=!1}},close:C,InfoForm:ce,DescriptionForm:me,OtherForm:le,SkuForm:de,DeliveryForm:pe};return Object.defineProperty(x,"__isScriptSetup",{enumerable:!1,value:!0}),x}}),[["render",function(A,r,N,e,_,h){const c=Y,y=Z,p=$,l=ee,w=ae,n=re,F=W;return Q((T(),O(n,null,{default:s(()=>[o(y,{modelValue:e.activeName,"onUpdate:modelValue":r[5]||(r[5]=i=>e.activeName=i)},{default:s(()=>[o(c,{label:"\u57FA\u7840\u8BBE\u7F6E",name:"info"},{default:s(()=>[o(e.InfoForm,{ref:"infoRef",activeName:e.activeName,"onUpdate:activeName":r[0]||(r[0]=i=>e.activeName=i),"is-detail":e.isDetail,propFormData:e.formData},null,8,["activeName","is-detail","propFormData"])]),_:1}),o(c,{label:"\u4EF7\u683C\u5E93\u5B58",name:"sku"},{default:s(()=>[o(e.SkuForm,{ref:"skuRef",activeName:e.activeName,"onUpdate:activeName":r[1]||(r[1]=i=>e.activeName=i),"is-detail":e.isDetail,propFormData:e.formData},null,8,["activeName","is-detail","propFormData"])]),_:1}),o(c,{label:"\u7269\u6D41\u8BBE\u7F6E",name:"delivery"},{default:s(()=>[o(e.DeliveryForm,{ref:"deliveryRef",activeName:e.activeName,"onUpdate:activeName":r[2]||(r[2]=i=>e.activeName=i),"is-detail":e.isDetail,propFormData:e.formData},null,8,["activeName","is-detail","propFormData"])]),_:1}),o(c,{label:"\u5546\u54C1\u8BE6\u60C5",name:"description"},{default:s(()=>[o(e.DescriptionForm,{ref:"descriptionRef",activeName:e.activeName,"onUpdate:activeName":r[3]||(r[3]=i=>e.activeName=i),"is-detail":e.isDetail,propFormData:e.formData},null,8,["activeName","is-detail","propFormData"])]),_:1}),o(c,{label:"\u5176\u5B83\u8BBE\u7F6E",name:"other"},{default:s(()=>[o(e.OtherForm,{ref:"otherRef",activeName:e.activeName,"onUpdate:activeName":r[4]||(r[4]=i=>e.activeName=i),"is-detail":e.isDetail,propFormData:e.formData},null,8,["activeName","is-detail","propFormData"])]),_:1})]),_:1},8,["modelValue"]),o(w,null,{default:s(()=>[o(l,{style:{float:"right"}},{default:s(()=>[e.isDetail?X("",!0):(T(),O(p,{key:0,loading:e.formLoading,type:"primary",onClick:e.submitForm},{default:s(()=>r[6]||(r[6]=[j(" \u4FDD\u5B58 ")])),_:1},8,["loading"])),o(p,{onClick:e.close},{default:s(()=>r[7]||(r[7]=[j("\u8FD4\u56DE")])),_:1})]),_:1})]),_:1})]),_:1})),[[F,e.formLoading]])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/mall/product/spu/form/index.vue"]]);export{ne as default};
