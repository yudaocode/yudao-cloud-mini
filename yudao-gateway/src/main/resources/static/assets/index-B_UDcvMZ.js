import{d as B,r as s,u as O,S as I,C as A,D,a as x,_ as M,c as N,I as k,q as T,w as e,k as i,F as E,v as S,R as U,o as y,m as g,ah as w,N as h,A as j,B as P}from"./index-BaY5TDP-.js";import{g as H,_ as V}from"./index-fxekK-Kb.js";import{u as q}from"./tagsView-lnAkwTv2.js";import{a as Q}from"./index-DiJG1eDb.js";import W from"./ContactDetailsHeader-D1c3tV6D.js";import G from"./ContactDetailsInfo-D-H2iJyZ.js";import J from"./BusinessList-Dr19N1lh.js";import K from"./PermissionList-CbQig5nT.js";import{B as L}from"./index-BlslFSYd.js";import X from"./ContactForm-DLuG_ZcF.js";import Y from"./TransferForm-nV8fyRSP.js";import Z from"./index-CI2uGAAL.js";import"./el-timeline-item-BFYwlQ-d.js";import"./formatTime-Dr6TiYYc.js";import"./ContentWrap-DKQn7kZm.js";import"./el-descriptions-item-CRF_CO88.js";import"./DictTag-QtcI9ZjC.js";import"./color-BN7ZL7BD.js";import"./index-avjYFQiD.js";import"./index-DrSdAlug.js";import"./index-6-r4wYJE.js";import"./BusinessForm-DKlvsT4o.js";import"./Dialog-CZSXtzfQ.js";import"./index-n6shePIl.js";import"./index-h6ObHKtQ.js";import"./index-CuAlllbQ.js";import"./BusinessProductForm-FoZjzksq.js";import"./index-D4G-Yxr7.js";import"./BusinessListModal-6XoY13Ne.js";import"./PermissionForm-jo-CjsNU.js";import"./index-Qzz5HSIB.js";import"./tree-z7HkrWVC.js";import"./index-C4zjco0X.js";import"./index-B97LdofC.js";import"./FollowUpRecordForm-C2CG18-w.js";import"./FollowUpRecordBusinessForm-B1oFy6Z2.js";import"./FollowUpRecordContactForm-BevYD0eZ.js";import"./ContactListModal-DsE0FODx.js";const $=M(B({name:"CrmContactDetail",__name:"index",setup(F,{expose:a}){a();const _=D(),t=s(0),l=s(!0),p=s({}),c=s(),r=async()=>{l.value=!0;try{p.value=await Q(t.value),await C(t.value)}finally{l.value=!1}},u=s(),d=s(),f=s([]),C=async o=>{if(!o)return;const v=await H({bizType:L.CRM_CONTACT,bizId:o});f.value=v.list},{delView:n}=q(),{currentRoute:m}=O(),b=()=>{n(x(m))},{params:z}=I();A(async()=>{if(!z.id)return _.warning("\u53C2\u6570\u9519\u8BEF\uFF0C\u8054\u7CFB\u4EBA\u4E0D\u80FD\u4E3A\u7A7A\uFF01"),void b();t.value=z.id,await r()});const R={message:_,contactId:t,loading:l,contact:p,permissionListRef:c,getContact:r,formRef:u,openForm:(o,v)=>{u.value.open(o,v)},transferFormRef:d,transfer:()=>{var o;(o=d.value)==null||o.open(p.value.id)},logList:f,getOperateLog:C,delView:n,currentRoute:m,close:b,params:z,ContactDetailsHeader:W,ContactDetailsInfo:G,BusinessList:J,PermissionList:K,get BizTypeEnum(){return L},ContactForm:X,CrmTransferForm:Y,FollowUpList:Z};return Object.defineProperty(R,"__isScriptSetup",{enumerable:!1,value:!0}),R}}),[["render",function(F,a,_,t,l,p){const c=h,r=j,u=V,d=P,f=S,C=U;return y(),N(E,null,[k((y(),T(t.ContactDetailsHeader,{contact:t.contact},{default:e(()=>{var n,m;return[(n=t.permissionListRef)!=null&&n.validateWrite?(y(),T(c,{key:0,onClick:a[0]||(a[0]=b=>t.openForm("update",t.contact.id))},{default:e(()=>a[1]||(a[1]=[g(" \u7F16\u8F91 ")])),_:1})):w("",!0),(m=t.permissionListRef)!=null&&m.validateOwnerUser?(y(),T(c,{key:1,type:"primary",onClick:t.transfer},{default:e(()=>a[2]||(a[2]=[g(" \u8F6C\u79FB ")])),_:1})):w("",!0)]}),_:1},8,["contact"])),[[C,t.loading]]),i(f,null,{default:e(()=>[i(d,null,{default:e(()=>[i(r,{label:"\u8DDF\u8FDB\u8BB0\u5F55"},{default:e(()=>[i(t.FollowUpList,{"biz-id":t.contactId,"biz-type":t.BizTypeEnum.CRM_CONTACT},null,8,["biz-id","biz-type"])]),_:1}),i(r,{label:"\u8BE6\u7EC6\u8D44\u6599"},{default:e(()=>[i(t.ContactDetailsInfo,{contact:t.contact},null,8,["contact"])]),_:1}),i(r,{label:"\u64CD\u4F5C\u65E5\u5FD7"},{default:e(()=>[i(u,{"log-list":t.logList},null,8,["log-list"])]),_:1}),i(r,{label:"\u56E2\u961F\u6210\u5458"},{default:e(()=>[i(t.PermissionList,{ref:"permissionListRef","biz-id":t.contact.id,"biz-type":t.BizTypeEnum.CRM_CONTACT,"show-action":!0,onQuitTeam:t.close},null,8,["biz-id","biz-type"])]),_:1}),i(r,{label:"\u5546\u673A",lazy:""},{default:e(()=>[i(t.BusinessList,{"biz-id":t.contact.id,"biz-type":t.BizTypeEnum.CRM_CONTACT,"contact-id":t.contact.id,"customer-id":t.contact.customerId},null,8,["biz-id","biz-type","contact-id","customer-id"])]),_:1})]),_:1})]),_:1}),i(t.ContactForm,{ref:"formRef",onSuccess:t.getContact},null,512),i(t.CrmTransferForm,{ref:"transferFormRef","biz-type":t.BizTypeEnum.CRM_CONTACT,onSuccess:t.close},null,8,["biz-type"])],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/crm/contact/detail/index.vue"]]);export{$ as default};
