import{d as L,D as Q,g as V,r as u,f as A,C as R,G as z,U as E,aA as $,_ as K,X as j,o as s,c as D,k as t,w as i,Y as G,F as Y,n as q,q as c,m,I as k,t as S,Z as J,L as H,J as W,K as X,z as Z,N as B,O as ee,P as te,an as ae,Q as re,R as le}from"./index-BaY5TDP-.js";import{_ as ie}from"./index-avjYFQiD.js";import{_ as oe}from"./DictTag-QtcI9ZjC.js";import{E as se}from"./el-image-Bg-CwbDE.js";import{_ as ne}from"./ContentWrap-DKQn7kZm.js";import{_ as me}from"./index-BAz6Gqim.js";import{d as pe,f as ue}from"./formatTime-Dr6TiYYc.js";import{a as ce,b as de,d as fe}from"./seckillActivity-Cs09fUfF.js";import{S as ye}from"./seckillConfig-CO_19uSx.js";import we from"./SeckillActivityForm-BWKMLDNx.js";import{f as ge}from"./formatter-DdccBgw4.js";import"./index-DrSdAlug.js";import"./color-BN7ZL7BD.js";import"./Dialog-CZSXtzfQ.js";import"./Form-CB5RGX1K.js";import"./el-virtual-list-Cbbiio1P.js";import"./el-tree-select-DphqCDCz.js";import"./el-time-select-DuQV2otj.js";import"./InputPassword-liMgUpCC.js";import"./tsxHelper-B5zJ1wt3.js";import"./SpuSelect-egfD7fzC.js";import"./index-DqlyDc99.js";import"./SkuList-LfTbtJ44.js";import"./tree-z7HkrWVC.js";import"./category-B7jjsMOS.js";import"./spu-BVX48OKx.js";import"./SpuAndSkuList-BPESFKMK.js";import"./formRules-CMjZInfO.js";import"./useCrudSchemas-BQxlWSsn.js";const _e=K(L({name:"SeckillActivity",__name:"index",setup(F,{expose:l}){l();const d=Q(),{t:e}=V(),v=u(!0),x=u(0),b=u([]),w=A({pageNo:1,pageSize:10,name:null,status:null}),f=u(),T=u(!1),p=async()=>{v.value=!0;try{const r=await ce(w);b.value=r.list,x.value=r.total}finally{v.value=!1}},y=()=>{w.pageNo=1,p()},n=u(),g=u([]);R(async()=>{await p(),g.value=await ye.getSimpleSeckillConfigList()});const _={message:d,t:e,loading:v,total:x,list:b,queryParams:w,queryFormRef:f,exportLoading:T,getList:p,handleQuery:y,resetQuery:()=>{f.value.resetFields(),y()},formRef:n,openForm:(r,o)=>{n.value.open(r,o)},handleClose:async r=>{try{await d.confirm("\u786E\u8BA4\u5173\u95ED\u8BE5\u79D2\u6740\u6D3B\u52A8\u5417\uFF1F"),await de(r),d.success("\u5173\u95ED\u6210\u529F"),await p()}catch{}},handleDelete:async r=>{try{await d.delConfirm(),await fe(r),d.success(e("common.delSuccess")),await p()}catch{}},configList:g,formatConfigNames:r=>{const o=g.value.find(h=>h.id===r);return o!=null?`${o.name}[${o.startTime} ~ ${o.endTime}]`:""},formatSeckillPrice:r=>{const o=Math.min(...r.map(h=>h.seckillPrice));return`\uFFE5${$(o)}`},get DICT_TYPE(){return z},get getIntDictOptions(){return E},get dateFormatter(){return pe},SeckillActivityForm:we,get formatDate(){return ue},get fenToYuanFormat(){return ge}};return Object.defineProperty(_,"__isScriptSetup",{enumerable:!1,value:!0}),_}}),[["render",function(F,l,d,e,v,x){const b=me,w=J,f=H,T=W,p=X,y=Z,n=B,g=ee,_=ne,r=te,o=ae,h=se,N=oe,M=re,U=ie,P=j("hasPermi"),O=le;return s(),D(Y,null,[t(b,{title:"\u3010\u8425\u9500\u3011\u79D2\u6740\u6D3B\u52A8",url:"https://doc.iocoder.cn/mall/promotion-seckill/"}),t(_,null,{default:i(()=>[t(g,{class:"-mb-15px",model:e.queryParams,ref:"queryFormRef",inline:!0,"label-width":"68px"},{default:i(()=>[t(f,{label:"\u6D3B\u52A8\u540D\u79F0",prop:"name"},{default:i(()=>[t(w,{modelValue:e.queryParams.name,"onUpdate:modelValue":l[0]||(l[0]=a=>e.queryParams.name=a),placeholder:"\u8BF7\u8F93\u5165\u6D3B\u52A8\u540D\u79F0",clearable:"",onKeyup:G(e.handleQuery,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),t(f,{label:"\u6D3B\u52A8\u72B6\u6001",prop:"status"},{default:i(()=>[t(p,{modelValue:e.queryParams.status,"onUpdate:modelValue":l[1]||(l[1]=a=>e.queryParams.status=a),placeholder:"\u8BF7\u9009\u62E9\u6D3B\u52A8\u72B6\u6001",clearable:"",class:"!w-240px"},{default:i(()=>[(s(!0),D(Y,null,q(e.getIntDictOptions(e.DICT_TYPE.COMMON_STATUS),a=>(s(),c(T,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(f,null,{default:i(()=>[t(n,{onClick:e.handleQuery},{default:i(()=>[t(y,{icon:"ep:search",class:"mr-5px"}),l[5]||(l[5]=m(" \u641C\u7D22"))]),_:1}),t(n,{onClick:e.resetQuery},{default:i(()=>[t(y,{icon:"ep:refresh",class:"mr-5px"}),l[6]||(l[6]=m(" \u91CD\u7F6E"))]),_:1}),k((s(),c(n,{type:"primary",plain:"",onClick:l[2]||(l[2]=a=>e.openForm("create"))},{default:i(()=>[t(y,{icon:"ep:plus",class:"mr-5px"}),l[7]||(l[7]=m(" \u65B0\u589E "))]),_:1})),[[P,["promotion:seckill-activity:create"]]])]),_:1})]),_:1},8,["model"])]),_:1}),t(_,null,{default:i(()=>[k((s(),c(M,{data:e.list,stripe:!0,"show-overflow-tooltip":!0},{default:i(()=>[t(r,{label:"\u6D3B\u52A8\u7F16\u53F7",prop:"id","min-width":"80"}),t(r,{label:"\u6D3B\u52A8\u540D\u79F0",prop:"name","min-width":"140"}),t(r,{label:"\u79D2\u6740\u65F6\u6BB5",prop:"configIds",width:"220px","show-overflow-tooltip":!1},{default:i(a=>[(s(!0),D(Y,null,q(a.row.configIds,(C,I)=>(s(),c(o,{key:I,class:"mr-5px"},{default:i(()=>[m(S(e.formatConfigNames(C)),1)]),_:2},1024))),128))]),_:1}),t(r,{label:"\u6D3B\u52A8\u65F6\u95F4","min-width":"210"},{default:i(a=>[m(S(e.formatDate(a.row.startTime,"YYYY-MM-DD"))+" ~ "+S(e.formatDate(a.row.endTime,"YYYY-MM-DD")),1)]),_:1}),t(r,{label:"\u5546\u54C1\u56FE\u7247",prop:"spuName","min-width":"80"},{default:i(a=>[t(h,{src:a.row.picUrl,class:"h-40px w-40px","preview-src-list":[a.row.picUrl],"preview-teleported":""},null,8,["src","preview-src-list"])]),_:1}),t(r,{label:"\u5546\u54C1\u6807\u9898",prop:"spuName","min-width":"300"}),t(r,{label:"\u539F\u4EF7",prop:"marketPrice","min-width":"100",formatter:e.fenToYuanFormat},null,8,["formatter"]),t(r,{label:"\u539F\u4EF7",prop:"marketPrice","min-width":"100"}),t(r,{label:"\u79D2\u6740\u4EF7",prop:"seckillPrice","min-width":"100"},{default:i(a=>[m(S(e.formatSeckillPrice(a.row.products)),1)]),_:1}),t(r,{label:"\u6D3B\u52A8\u72B6\u6001",align:"center",prop:"status","min-width":"100"},{default:i(a=>[t(N,{type:e.DICT_TYPE.COMMON_STATUS,value:a.row.status},null,8,["type","value"])]),_:1}),t(r,{label:"\u5E93\u5B58",align:"center",prop:"stock","min-width":"80"}),t(r,{label:"\u603B\u5E93\u5B58",align:"center",prop:"totalStock","min-width":"80"}),t(r,{label:"\u521B\u5EFA\u65F6\u95F4",align:"center",prop:"createTime",formatter:e.dateFormatter,width:"180px"},null,8,["formatter"]),t(r,{label:"\u64CD\u4F5C",align:"center",width:"150px",fixed:"right"},{default:i(a=>[k((s(),c(n,{link:"",type:"primary",onClick:C=>e.openForm("update",a.row.id)},{default:i(()=>l[8]||(l[8]=[m(" \u7F16\u8F91 ")])),_:2},1032,["onClick"])),[[P,["promotion:seckill-activity:update"]]]),a.row.status===0?k((s(),c(n,{key:0,link:"",type:"danger",onClick:C=>e.handleClose(a.row.id)},{default:i(()=>l[9]||(l[9]=[m(" \u5173\u95ED ")])),_:2},1032,["onClick"])),[[P,["promotion:seckill-activity:close"]]]):k((s(),c(n,{key:1,link:"",type:"danger",onClick:C=>e.handleDelete(a.row.id)},{default:i(()=>l[10]||(l[10]=[m(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[P,["promotion:seckill-activity:delete"]]])]),_:1})]),_:1},8,["data"])),[[O,e.loading]]),t(U,{total:e.total,page:e.queryParams.pageNo,"onUpdate:page":l[3]||(l[3]=a=>e.queryParams.pageNo=a),limit:e.queryParams.pageSize,"onUpdate:limit":l[4]||(l[4]=a=>e.queryParams.pageSize=a),onPagination:e.getList},null,8,["total","page","limit"])]),_:1}),t(e.SeckillActivityForm,{ref:"formRef",onSuccess:e.getList},null,512)],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/mall/promotion/seckill/activity/index.vue"]]);export{_e as default};
