import{er as b,d as P,r as v,f as F,C as O,G as h,aB as R,eu as x,_ as E,o as U,c as S,k as t,w as i,I as q,q as D,F as I,l as L,P as Y,Q as B,R as j}from"./index-BaY5TDP-.js";import{_ as A}from"./DictTag-QtcI9ZjC.js";import{E as M}from"./el-skeleton-item-BYAIkmCs.js";import{_ as W}from"./Echart-BQxFkezy.js";import{S as k}from"./customer-DKZgktXn.js";import"./color-BN7ZL7BD.js";import"./echarts-DpbyC_6K.js";const G=E(P({name:"CustomerFollowupType",__name:"CustomerFollowUpType",props:{queryParams:{type:null,required:!0}},setup(_,{expose:y}){const m=_,a=v(!1),c=v([]),l=F({title:{text:"\u5BA2\u6237\u8DDF\u8FDB\u65B9\u5F0F\u5206\u6790",left:"center"},legend:{orient:"vertical",left:"left"},tooltip:{trigger:"item",formatter:"{b} : {c}% "},toolbox:{feature:{saveAsImage:{show:!0,name:"\u5BA2\u6237\u8DDF\u8FDB\u65B9\u5F0F\u5206\u6790"}}},series:[{name:"\u8DDF\u8FDB\u65B9\u5F0F",type:"pie",radius:"50%",data:[],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]}),p=async()=>{const o=await k.getFollowUpSummaryByType(m.queryParams);l.series&&l.series[0]&&l.series[0].data&&(l.series[0].data=o.map(e=>({name:R(h.CRM_FOLLOW_UP_TYPE,e.followUpType),value:e.followUpRecordCount})));const f=(u="followUpRecordCount",(n=o)&&n.length?function(e,C){for(var d,g=-1,T=e.length;++g<T;){var w=C(e[g]);w!==void 0&&(d=d===void 0?w:d+w)}return d}(n,b(u)):0);var n,u;c.value=o.map(e=>({...e,portion:x(e.followUpRecordCount,f)}))},s=async()=>{a.value=!0;try{await p()}finally{a.value=!1}};y({loadData:s}),O(()=>{s()});const r={props:m,loading:a,list:c,echartsOption:l,fetchAndFill:p,loadData:s,get DICT_TYPE(){return h}};return Object.defineProperty(r,"__isScriptSetup",{enumerable:!1,value:!0}),r}}),[["render",function(_,y,m,a,c,l){const p=W,s=M,r=L,o=Y,f=A,n=B,u=j;return U(),S(I,null,[t(r,{shadow:"never"},{default:i(()=>[t(s,{loading:a.loading,animated:""},{default:i(()=>[t(p,{height:500,options:a.echartsOption},null,8,["options"])]),_:1},8,["loading"])]),_:1}),t(r,{shadow:"never",class:"mt-16px"},{default:i(()=>[q((U(),D(n,{data:a.list},{default:i(()=>[t(o,{label:"\u5E8F\u53F7",align:"center",type:"index",width:"80"}),t(o,{label:"\u8DDF\u8FDB\u65B9\u5F0F",align:"center",prop:"followUpType","min-width":"200"},{default:i(e=>[t(f,{type:a.DICT_TYPE.CRM_FOLLOW_UP_TYPE,value:e.row.followUpType},null,8,["type","value"])]),_:1}),t(o,{label:"\u4E2A\u6570",align:"center",prop:"followUpRecordCount","min-width":"200"}),t(o,{label:"\u5360\u6BD4(%)",align:"center",prop:"portion","min-width":"200"})]),_:1},8,["data"])),[[u,a.loading]])]),_:1})],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/crm/statistics/customer/components/CustomerFollowUpType.vue"]]);export{G as default};
