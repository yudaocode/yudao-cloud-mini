import{d as K,D as M,S as $,g as H,u as O,r as h,ba as j,C as X,aA as Z,aE as G,_ as J,X as W,o as u,c as L,k as a,w as t,Y as aa,m as p,I as b,q as f,F as U,n as ea,j as w,t as C,Z as ta,L as la,cg as na,M as sa,z as ra,N as ua,O as oa,A as ia,B as da,v as pa,E as ca,P as ma,aK as fa,ch as ya,an as ga,Q as _a,R as ha}from"./index-BaY5TDP-.js";import{_ as wa}from"./index-avjYFQiD.js";import{E as ba}from"./el-image-Bg-CwbDE.js";import{_ as Ca}from"./ContentWrap-DKQn7kZm.js";import{_ as va}from"./index-BAz6Gqim.js";import{d as ka}from"./formatTime-Dr6TiYYc.js";import{h as Pa,d as xa,t as Sa}from"./tree-z7HkrWVC.js";import{g as S}from"./constants-CEEr2azc.js";import{d as qa}from"./download-oWiM5xVU.js";import{d as Ea,a as Ta,e as Y,f as Va,h as Da}from"./spu-BVX48OKx.js";import{g as Ia}from"./category-B7jjsMOS.js";import"./index-DrSdAlug.js";const La={class:"flex"},Ua={class:"ml-4 overflow-hidden"},Ya=J(K({name:"ProductSpu",__name:"index",setup(N,{expose:s}){s();const y=M(),e=$(),{t:I}=H(),{push:q}=O(),k=h(!1),P=h(!1),o=h(0),E=h([]),T=h([{name:"\u51FA\u552E\u4E2D",type:0,count:0},{name:"\u4ED3\u5E93\u4E2D",type:1,count:0},{name:"\u5DF2\u552E\u7F44",type:2,count:0},{name:"\u8B66\u6212\u5E93\u5B58",type:3,count:0},{name:"\u56DE\u6536\u7AD9",type:4,count:0}]),c=h({pageNo:1,pageSize:10,tabType:0,name:"",categoryId:void 0,createTime:void 0}),i=h(),d=async()=>{k.value=!0;try{const n=await Ea(c.value);E.value=n.list,o.value=n.total}finally{k.value=!1}},g=async()=>{const n=await Ta();for(let r in n)T.value[Number(r)].count=n[r]},V=()=>{d()},x=h();j(()=>{d()}),X(async()=>{e.query.categoryId&&(c.value.categoryId=Number(e.query.categoryId)),await g(),await d();const n=await Ia({});x.value=Pa(n,"id","parentId")});const m={message:y,route:e,t:I,push:q,loading:k,exportLoading:P,total:o,list:E,tabsData:T,queryParams:c,queryFormRef:i,getList:d,handleTabClick:n=>{c.value.tabType=n.paneName,d()},getTabsCount:g,handleStatus02Change:async(n,r)=>{try{const D=r===S.RECYCLE.status?"\u52A0\u5165\u5230\u56DE\u6536\u7AD9":"\u6062\u590D\u5230\u4ED3\u5E93";await y.confirm(`\u786E\u8BA4\u8981"${n.name}"${D}\u5417\uFF1F`),await Y({id:n.id,status:r}),y.success(D+"\u6210\u529F"),await g(),await d()}catch{}},handleStatusChange:async n=>{try{const r=n.status?"\u4E0A\u67B6":"\u4E0B\u67B6";await y.confirm(`\u786E\u8BA4\u8981${r}"${n.name}"\u5417\uFF1F`),await Y({id:n.id,status:n.status}),y.success(r+"\u6210\u529F"),await g(),await d()}catch{n.status=n.status===S.DISABLE.status?S.ENABLE.status:S.DISABLE.status}},handleDelete:async n=>{try{await y.delConfirm(),await Va(n),y.success(I("common.delSuccess")),await g(),await d()}catch{}},imagePreview:n=>{G({urlList:[n]})},handleQuery:V,resetQuery:()=>{i.value.resetFields(),V()},openForm:n=>{q(typeof n!="number"?{name:"ProductSpuAdd"}:{name:"ProductSpuEdit",params:{id:n}})},openDetail:n=>{q({name:"ProductSpuDetail",params:{id:n}})},handleExport:async()=>{try{await y.exportConfirm(),P.value=!0;const n=await Da(c);qa.excel(n,"\u5546\u54C1\u5217\u8868.xls")}catch{}finally{P.value=!1}},categoryList:x,formatCategoryName:n=>Sa(x.value,n),get dateFormatter(){return ka},get defaultProps(){return xa},get ProductSpuStatusEnum(){return S},get fenToYuan(){return Z}};return Object.defineProperty(m,"__isScriptSetup",{enumerable:!1,value:!0}),m}}),[["render",function(N,s,y,e,I,q){const k=va,P=ta,o=la,E=na,T=sa,c=ra,i=ua,d=oa,g=Ca,V=ia,x=da,m=pa,n=ca,r=ma,D=ba,F=fa,A=ya,Q=ga,B=_a,R=wa,v=W("hasPermi"),z=ha;return u(),L(U,null,[a(k,{title:"\u3010\u5546\u54C1\u3011\u5546\u54C1 SPU \u4E0E SKU",url:"https://doc.iocoder.cn/mall/product-spu-sku/"}),a(g,null,{default:t(()=>[a(d,{ref:"queryFormRef",inline:!0,model:e.queryParams,class:"-mb-15px","label-width":"68px"},{default:t(()=>[a(o,{label:"\u5546\u54C1\u540D\u79F0",prop:"name"},{default:t(()=>[a(P,{modelValue:e.queryParams.name,"onUpdate:modelValue":s[0]||(s[0]=l=>e.queryParams.name=l),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u5546\u54C1\u540D\u79F0",onKeyup:aa(e.handleQuery,["enter"])},null,8,["modelValue"])]),_:1}),a(o,{label:"\u5546\u54C1\u5206\u7C7B",prop:"categoryId"},{default:t(()=>[a(E,{modelValue:e.queryParams.categoryId,"onUpdate:modelValue":s[1]||(s[1]=l=>e.queryParams.categoryId=l),options:e.categoryList,props:e.defaultProps,class:"w-1/1",clearable:"",filterable:"",placeholder:"\u8BF7\u9009\u62E9\u5546\u54C1\u5206\u7C7B"},null,8,["modelValue","options","props"])]),_:1}),a(o,{label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime"},{default:t(()=>[a(T,{modelValue:e.queryParams.createTime,"onUpdate:modelValue":s[2]||(s[2]=l=>e.queryParams.createTime=l),"default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],class:"!w-240px","end-placeholder":"\u7ED3\u675F\u65E5\u671F","start-placeholder":"\u5F00\u59CB\u65E5\u671F",type:"daterange","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue","default-time"])]),_:1}),a(o,null,{default:t(()=>[a(i,{onClick:e.handleQuery},{default:t(()=>[a(c,{class:"mr-5px",icon:"ep:search"}),s[7]||(s[7]=p(" \u641C\u7D22 "))]),_:1}),a(i,{onClick:e.resetQuery},{default:t(()=>[a(c,{class:"mr-5px",icon:"ep:refresh"}),s[8]||(s[8]=p(" \u91CD\u7F6E "))]),_:1}),b((u(),f(i,{plain:"",type:"primary",onClick:s[3]||(s[3]=l=>e.openForm(void 0))},{default:t(()=>[a(c,{class:"mr-5px",icon:"ep:plus"}),s[9]||(s[9]=p(" \u65B0\u589E "))]),_:1})),[[v,["product:spu:create"]]]),b((u(),f(i,{loading:e.exportLoading,plain:"",type:"success",onClick:e.handleExport},{default:t(()=>[a(c,{class:"mr-5px",icon:"ep:download"}),s[10]||(s[10]=p(" \u5BFC\u51FA "))]),_:1},8,["loading"])),[[v,["product:spu:export"]]])]),_:1})]),_:1},8,["model"])]),_:1}),a(g,null,{default:t(()=>[a(x,{modelValue:e.queryParams.tabType,"onUpdate:modelValue":s[4]||(s[4]=l=>e.queryParams.tabType=l),onTabClick:e.handleTabClick},{default:t(()=>[(u(!0),L(U,null,ea(e.tabsData,l=>(u(),f(V,{key:l.type,label:l.name+"("+l.count+")",name:l.type},null,8,["label","name"]))),128))]),_:1},8,["modelValue"]),b((u(),f(B,{data:e.list},{default:t(()=>[a(r,{type:"expand"},{default:t(({row:l})=>[a(d,{class:"spu-table-expand","label-position":"left"},{default:t(()=>[a(n,null,{default:t(()=>[a(m,{span:24},{default:t(()=>[a(n,null,{default:t(()=>[a(m,{span:8},{default:t(()=>[a(o,{label:"\u5546\u54C1\u5206\u7C7B:"},{default:t(()=>[w("span",null,C(e.formatCategoryName(l.categoryId)),1)]),_:2},1024)]),_:2},1024),a(m,{span:8},{default:t(()=>[a(o,{label:"\u5E02\u573A\u4EF7:"},{default:t(()=>[w("span",null,C(e.fenToYuan(l.marketPrice)),1)]),_:2},1024)]),_:2},1024),a(m,{span:8},{default:t(()=>[a(o,{label:"\u6210\u672C\u4EF7:"},{default:t(()=>[w("span",null,C(e.fenToYuan(l.costPrice)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),a(n,null,{default:t(()=>[a(m,{span:24},{default:t(()=>[a(n,null,{default:t(()=>[a(m,{span:8},{default:t(()=>[a(o,{label:"\u6D4F\u89C8\u91CF:"},{default:t(()=>[w("span",null,C(l.browseCount),1)]),_:2},1024)]),_:2},1024),a(m,{span:8},{default:t(()=>[a(o,{label:"\u865A\u62DF\u9500\u91CF:"},{default:t(()=>[w("span",null,C(l.virtualSalesCount),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1}),a(r,{label:"\u5546\u54C1\u7F16\u53F7","min-width":"140",prop:"id"}),a(r,{label:"\u5546\u54C1\u4FE1\u606F","min-width":"300"},{default:t(({row:l})=>[w("div",La,[a(D,{fit:"cover",src:l.picUrl,class:"flex-none w-50px h-50px",onClick:_=>e.imagePreview(l.picUrl)},null,8,["src","onClick"]),w("div",Ua,[a(F,{effect:"dark",content:l.name,placement:"top"},{default:t(()=>[w("div",null,C(l.name),1)]),_:2},1032,["content"])])])]),_:1}),a(r,{align:"center",label:"\u4EF7\u683C","min-width":"160",prop:"price"},{default:t(({row:l})=>[p(" \xA5 "+C(e.fenToYuan(l.price)),1)]),_:1}),a(r,{align:"center",label:"\u9500\u91CF","min-width":"90",prop:"salesCount"}),a(r,{align:"center",label:"\u5E93\u5B58","min-width":"90",prop:"stock"}),a(r,{align:"center",label:"\u6392\u5E8F","min-width":"70",prop:"sort"}),a(r,{align:"center",label:"\u9500\u552E\u72B6\u6001","min-width":"80"},{default:t(({row:l})=>[l.status>=0?(u(),f(A,{key:0,modelValue:l.status,"onUpdate:modelValue":_=>l.status=_,"active-value":1,"inactive-value":0,"active-text":"\u4E0A\u67B6","inactive-text":"\u4E0B\u67B6","inline-prompt":"",onChange:_=>e.handleStatusChange(l)},null,8,["modelValue","onUpdate:modelValue","onChange"])):(u(),f(Q,{key:1,type:"info"},{default:t(()=>s[11]||(s[11]=[p("\u56DE\u6536\u7AD9")])),_:1}))]),_:1}),a(r,{formatter:e.dateFormatter,align:"center",label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime",width:"180"},null,8,["formatter"]),a(r,{align:"center",fixed:"right",label:"\u64CD\u4F5C","min-width":"200"},{default:t(({row:l})=>[a(i,{link:"",type:"primary",onClick:_=>e.openDetail(l.id)},{default:t(()=>s[12]||(s[12]=[p(" \u8BE6\u60C5 ")])),_:2},1032,["onClick"]),b((u(),f(i,{link:"",type:"primary",onClick:_=>e.openForm(l.id)},{default:t(()=>s[13]||(s[13]=[p(" \u4FEE\u6539 ")])),_:2},1032,["onClick"])),[[v,["product:spu:update"]]]),e.queryParams.tabType===4?(u(),L(U,{key:0},[b((u(),f(i,{link:"",type:"danger",onClick:_=>e.handleDelete(l.id)},{default:t(()=>s[14]||(s[14]=[p(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[v,["product:spu:delete"]]]),b((u(),f(i,{link:"",type:"primary",onClick:_=>e.handleStatus02Change(l,e.ProductSpuStatusEnum.DISABLE.status)},{default:t(()=>s[15]||(s[15]=[p(" \u6062\u590D ")])),_:2},1032,["onClick"])),[[v,["product:spu:update"]]])],64)):b((u(),f(i,{key:1,link:"",type:"danger",onClick:_=>e.handleStatus02Change(l,e.ProductSpuStatusEnum.RECYCLE.status)},{default:t(()=>s[16]||(s[16]=[p(" \u56DE\u6536 ")])),_:2},1032,["onClick"])),[[v,["product:spu:update"]]])]),_:1})]),_:1},8,["data"])),[[z,e.loading]]),a(R,{limit:e.queryParams.pageSize,"onUpdate:limit":s[5]||(s[5]=l=>e.queryParams.pageSize=l),page:e.queryParams.pageNo,"onUpdate:page":s[6]||(s[6]=l=>e.queryParams.pageNo=l),total:e.total,onPagination:e.getList},null,8,["limit","page","total"])]),_:1})],64)}],["__scopeId","data-v-b78c7ed6"],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/mall/product/spu/index.vue"]]);export{Ya as default};
