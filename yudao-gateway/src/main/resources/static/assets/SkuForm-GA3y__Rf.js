import{d as h,p as F,r as c,f as C,au as R,a as w,D as A,d_ as V,_ as x,o as d,c as S,I as j,q as k,w as o,k as s,m as n,ah as g,F as P,ak as B,al as O,L as U,N,O as q,R as I}from"./index-BaY5TDP-.js";import{g as z}from"./index-DqlyDc99.js";import E from"./ProductAttributes-ZrPf19nd.js";import G from"./ProductPropertyAddForm-B6g9kPn8.js";import{r as T}from"./formRules-CMjZInfO.js";import H from"./SkuList-LfTbtJ44.js";import"./el-image-Bg-CwbDE.js";import"./property-Ddjv43NP.js";import"./Dialog-CZSXtzfQ.js";const J=x(h({name:"ProductSpuSkuForm",__name:"SkuForm",props:{propFormData:{type:Object,default:()=>{}},isDetail:F.bool.def(!1)},emits:["update:activeName"],setup(_,{expose:r,emit:p}){const e=A(),D=c(!1),y=_,l=c(),u=c(),t=c([]),f=c(),i=C({specType:!1,subCommissionType:!1,skus:[]}),b=C({specType:[T],subCommissionType:[T]});R(()=>y.propFormData,a=>{a&&(V(i,a),t.value=z(a))},{immediate:!0});const m=p,v=async()=>{if(u)try{f.value.validateSku(),await w(u).validate(),Object.assign(y.propFormData,i)}catch(a){throw e.error("\u3010\u5E93\u5B58\u4EF7\u683C\u3011\u4E0D\u5B8C\u5584\uFF0C\u8BF7\u586B\u5199\u76F8\u5173\u4FE1\u606F"),m("update:activeName","sku"),a}};r({validate:v});const L={ruleConfig:[{name:"stock",rule:a=>a>=0,message:"\u5546\u54C1\u5E93\u5B58\u5FC5\u987B\u5927\u4E8E\u7B49\u4E8E 1 \uFF01\uFF01\uFF01"},{name:"price",rule:a=>a>=.01,message:"\u5546\u54C1\u9500\u552E\u4EF7\u683C\u5FC5\u987B\u5927\u4E8E\u7B49\u4E8E 0.01 \u5143\uFF01\uFF01\uFF01"},{name:"marketPrice",rule:a=>a>=.01,message:"\u5546\u54C1\u5E02\u573A\u4EF7\u683C\u5FC5\u987B\u5927\u4E8E\u7B49\u4E8E 0.01 \u5143\uFF01\uFF01\uFF01"},{name:"costPrice",rule:a=>a>=.01,message:"\u5546\u54C1\u6210\u672C\u4EF7\u683C\u5FC5\u987B\u5927\u4E8E\u7B49\u4E8E 0.00 \u5143\uFF01\uFF01\uFF01"}],message:e,formLoading:D,props:y,attributesAddFormRef:l,formRef:u,propertyList:t,skuListRef:f,formData:i,rules:b,emit:m,validate:v,changeSubCommissionType:()=>{for(const a of i.skus)a.firstBrokeragePrice=0,a.secondBrokeragePrice=0},onChangeSpec:()=>{t.value=[],i.skus=[{price:0,marketPrice:0,costPrice:0,barCode:"",picUrl:"",stock:0,weight:0,volume:0,firstBrokeragePrice:0,secondBrokeragePrice:0}]},generateSkus:a=>{f.value.generateTableData(a)},get SkuList(){return H},ProductAttributes:E,ProductPropertyAddForm:G};return Object.defineProperty(L,"__isScriptSetup",{enumerable:!1,value:!0}),L}}),[["render",function(_,r,p,e,D,y){const l=B,u=O,t=U,f=N,i=q,b=I;return d(),S(P,null,[j((d(),k(i,{ref:"formRef",disabled:p.isDetail,model:e.formData,rules:e.rules,"label-width":"120px"},{default:o(()=>[s(t,{label:"\u5206\u9500\u7C7B\u578B",prop:"subCommissionType"},{default:o(()=>[s(u,{modelValue:e.formData.subCommissionType,"onUpdate:modelValue":r[0]||(r[0]=m=>e.formData.subCommissionType=m),class:"w-80",onChange:e.changeSubCommissionType},{default:o(()=>[s(l,{value:!1},{default:o(()=>r[2]||(r[2]=[n("\u9ED8\u8BA4\u8BBE\u7F6E")])),_:1}),s(l,{value:!0,class:"radio"},{default:o(()=>r[3]||(r[3]=[n("\u5355\u72EC\u8BBE\u7F6E")])),_:1})]),_:1},8,["modelValue"])]),_:1}),s(t,{label:"\u5546\u54C1\u89C4\u683C",prop:"specType"},{default:o(()=>[s(u,{modelValue:e.formData.specType,"onUpdate:modelValue":r[1]||(r[1]=m=>e.formData.specType=m),class:"w-80",onChange:e.onChangeSpec},{default:o(()=>[s(l,{value:!1,class:"radio"},{default:o(()=>r[4]||(r[4]=[n("\u5355\u89C4\u683C")])),_:1}),s(l,{value:!0},{default:o(()=>r[5]||(r[5]=[n("\u591A\u89C4\u683C")])),_:1})]),_:1},8,["modelValue"])]),_:1}),e.formData.specType?g("",!0):(d(),k(t,{key:0},{default:o(()=>[s(e.SkuList,{ref:"skuListRef","prop-form-data":e.formData,"property-list":e.propertyList,"rule-config":e.ruleConfig},null,8,["prop-form-data","property-list"])]),_:1})),e.formData.specType?(d(),k(t,{key:1,label:"\u5546\u54C1\u5C5E\u6027"},{default:o(()=>[s(f,{class:"mb-10px mr-15px",onClick:e.attributesAddFormRef.open},{default:o(()=>r[6]||(r[6]=[n("\u6DFB\u52A0\u5C5E\u6027")])),_:1},8,["onClick"]),s(e.ProductAttributes,{"is-detail":p.isDetail,"property-list":e.propertyList,onSuccess:e.generateSkus},null,8,["is-detail","property-list"])]),_:1})):g("",!0),e.formData.specType&&e.propertyList.length>0?(d(),S(P,{key:2},[p.isDetail?g("",!0):(d(),k(t,{key:0,label:"\u6279\u91CF\u8BBE\u7F6E"},{default:o(()=>[s(e.SkuList,{"is-batch":!0,"prop-form-data":e.formData,"property-list":e.propertyList},null,8,["prop-form-data","property-list"])]),_:1})),s(t,{label:"\u89C4\u683C\u5217\u8868"},{default:o(()=>[s(e.SkuList,{ref:"skuListRef","is-detail":p.isDetail,"prop-form-data":e.formData,"property-list":e.propertyList,"rule-config":e.ruleConfig},null,8,["is-detail","prop-form-data","property-list"])]),_:1})],64)):g("",!0)]),_:1},8,["disabled","model","rules"])),[[b,e.formLoading]]),s(e.ProductPropertyAddForm,{ref:"attributesAddFormRef",propertyList:e.propertyList},null,8,["propertyList"])],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/mall/product/spu/form/SkuForm.vue"]]);export{J as default};
