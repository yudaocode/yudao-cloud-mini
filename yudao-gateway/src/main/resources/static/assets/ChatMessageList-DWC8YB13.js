import{d as S,D as Y,g as F,r as p,f as Q,C as U,G as R,_ as z,X as O,o as m,c as I,k as e,w as r,Y as A,F as q,n as E,q as v,m as b,I as x,j,t as B,Z as G,L as H,J as K,K as J,M as X,z as Z,N as W,O as $,P as ee,Q as ae,R as te}from"./index-BaY5TDP-.js";import{_ as le}from"./index-avjYFQiD.js";import{_ as re}from"./DictTag-QtcI9ZjC.js";import{_ as se}from"./ContentWrap-DKQn7kZm.js";import{d as oe}from"./formatTime-Dr6TiYYc.js";import{C}from"./index-CuG4_yhq.js";import{g as ie}from"./index-CuAlllbQ.js";import"./index-DrSdAlug.js";import"./color-BN7ZL7BD.js";import"./fetch-D5K_4anA.js";const ne=z(S({__name:"ChatMessageList",setup(T,{expose:l}){l();const c=Y(),{t:a}=F(),f=p(!0),_=p([]),g=p(0),o=Q({pageNo:1,pageSize:10,conversationId:void 0,userId:void 0,content:void 0,createTime:[]}),y=p(),h=p([]),i=async()=>{f.value=!0;try{const d=await C.getChatMessagePage(o);_.value=d.list,g.value=d.total}finally{f.value=!1}},u=()=>{o.pageNo=1,i()};U(async()=>{i(),h.value=await ie()});const n={message:c,t:a,loading:f,list:_,total:g,queryParams:o,queryFormRef:y,userList:h,getList:i,handleQuery:u,resetQuery:()=>{y.value.resetFields(),u()},handleDelete:async d=>{try{await c.delConfirm(),await C.deleteChatMessageByAdmin(d),c.success(a("common.delSuccess")),await i()}catch{}},get dateFormatter(){return oe},get DICT_TYPE(){return R}};return Object.defineProperty(n,"__isScriptSetup",{enumerable:!1,value:!0}),n}}),[["render",function(T,l,c,a,f,_){const g=G,o=H,y=K,h=J,i=X,u=Z,n=W,d=$,P=se,s=ee,k=re,D=ae,L=le,N=O("hasPermi"),V=te;return m(),I(q,null,[e(P,null,{default:r(()=>[e(d,{class:"-mb-15px",model:a.queryParams,ref:"queryFormRef",inline:!0,"label-width":"68px"},{default:r(()=>[e(o,{label:"\u5BF9\u8BDD\u7F16\u53F7",prop:"conversationId"},{default:r(()=>[e(g,{modelValue:a.queryParams.conversationId,"onUpdate:modelValue":l[0]||(l[0]=t=>a.queryParams.conversationId=t),placeholder:"\u8BF7\u8F93\u5165\u5BF9\u8BDD\u7F16\u53F7",clearable:"",onKeyup:A(a.handleQuery,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),e(o,{label:"\u7528\u6237\u7F16\u53F7",prop:"userId"},{default:r(()=>[e(h,{modelValue:a.queryParams.userId,"onUpdate:modelValue":l[1]||(l[1]=t=>a.queryParams.userId=t),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u7F16\u53F7",class:"!w-240px"},{default:r(()=>[(m(!0),I(q,null,E(a.userList,t=>(m(),v(y,{key:t.id,label:t.nickname,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(o,{label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime"},{default:r(()=>[e(i,{modelValue:a.queryParams.createTime,"onUpdate:modelValue":l[2]||(l[2]=t=>a.queryParams.createTime=t),"value-format":"YYYY-MM-DD HH:mm:ss",type:"daterange","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F","default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],class:"!w-240px"},null,8,["modelValue","default-time"])]),_:1}),e(o,null,{default:r(()=>[e(n,{onClick:a.handleQuery},{default:r(()=>[e(u,{icon:"ep:search",class:"mr-5px"}),l[5]||(l[5]=b(" \u641C\u7D22"))]),_:1}),e(n,{onClick:a.resetQuery},{default:r(()=>[e(u,{icon:"ep:refresh",class:"mr-5px"}),l[6]||(l[6]=b(" \u91CD\u7F6E"))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(P,null,{default:r(()=>[x((m(),v(D,{data:a.list,stripe:!0,"show-overflow-tooltip":!0},{default:r(()=>[e(s,{label:"\u6D88\u606F\u7F16\u53F7",align:"center",prop:"id",width:"180",fixed:"left"}),e(s,{label:"\u5BF9\u8BDD\u7F16\u53F7",align:"center",prop:"conversationId",width:"180",fixed:"left"}),e(s,{label:"\u7528\u6237",align:"center",prop:"userId",width:"180"},{default:r(t=>{var w;return[j("span",null,B((w=a.userList.find(M=>M.id===t.row.userId))==null?void 0:w.nickname),1)]}),_:1}),e(s,{label:"\u89D2\u8272",align:"center",prop:"roleName",width:"180"}),e(s,{label:"\u6D88\u606F\u7C7B\u578B",align:"center",prop:"type",width:"100"}),e(s,{label:"\u6A21\u578B\u6807\u8BC6",align:"center",prop:"model",width:"180"}),e(s,{label:"\u6D88\u606F\u5185\u5BB9",align:"center",prop:"content",width:"300"}),e(s,{label:"\u521B\u5EFA\u65F6\u95F4",align:"center",prop:"createTime",formatter:a.dateFormatter,width:"180px"},null,8,["formatter"]),e(s,{label:"\u56DE\u590D\u6D88\u606F\u7F16\u53F7",align:"center",prop:"replyId",width:"180"}),e(s,{label:"\u643A\u5E26\u4E0A\u4E0B\u6587",align:"center",prop:"useContext",width:"100"},{default:r(t=>[e(k,{type:a.DICT_TYPE.INFRA_BOOLEAN_STRING,value:t.row.useContext},null,8,["type","value"])]),_:1}),e(s,{label:"\u64CD\u4F5C",align:"center",fixed:"right"},{default:r(t=>[x((m(),v(n,{link:"",type:"danger",onClick:w=>a.handleDelete(t.row.id)},{default:r(()=>l[7]||(l[7]=[b(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[N,["ai:chat-message:delete"]]])]),_:1})]),_:1},8,["data"])),[[V,a.loading]]),e(L,{total:a.total,page:a.queryParams.pageNo,"onUpdate:page":l[3]||(l[3]=t=>a.queryParams.pageNo=t),limit:a.queryParams.pageSize,"onUpdate:limit":l[4]||(l[4]=t=>a.queryParams.pageSize=t),onPagination:a.getList},null,8,["total","page","limit"])]),_:1})],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/ai/chat/manager/ChatMessageList.vue"]]);export{ne as default};
