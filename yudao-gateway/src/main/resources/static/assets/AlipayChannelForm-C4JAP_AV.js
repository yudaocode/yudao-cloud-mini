import{d as U,g as R,D as P,r as b,G as T,cP as A,_ as K,o as m,c as C,k as a,w as t,m as n,I as k,q as x,F as q,n as I,t as S,ah as V,Z as F,L as E,ak as O,al as z,z as N,N as B,bx as L,O as M,R as J}from"./index-BaY5TDP-.js";import{_ as Y}from"./Dialog-CZSXtzfQ.js";import{C as j}from"./constants-CEEr2azc.js";import{g as G,c as Z,u as $}from"./index-pf8i-b2A.js";const w=".crt",H={key:0},Q={key:1},W={key:2},X=K(U({name:"AlipayChannelForm",__name:"AlipayChannelForm",emits:["success"],setup(h,{expose:e,emit:D}){const{t:l}=R(),c=P(),v=b(!1),u=b(""),r=b(!1),p=b({appId:"",code:"",status:void 0,feeRate:void 0,remark:"",config:{appId:"",serverUrl:null,signType:"",mode:null,privateKey:"",alipayPublicKey:"",appCertContent:"",alipayPublicCertContent:"",rootCertContent:"",encryptType:"",encryptKey:""}}),s=b(),g=async(i,d)=>{v.value=!0,r.value=!0,y(i,d);try{const o=await G(i,d);o&&o.id&&(p.value=o,p.value.config=JSON.parse(o.config)),u.value=p.value.id?"\u7F16\u8F91\u652F\u4ED8\u6E20\u9053":"\u521B\u5EFA\u652F\u4ED8\u6E20\u9053"}finally{r.value=!1}};e({open:g});const f=D,y=(i,d)=>{var o;p.value={appId:i,code:d,status:j.ENABLE,remark:"",feeRate:null,config:{appId:"",serverUrl:null,signType:"RSA2",mode:null,privateKey:"",alipayPublicKey:"",appCertContent:"",alipayPublicCertContent:"",rootCertContent:"",encryptType:"",encryptKey:""}},(o=s.value)==null||o.resetFields()},_={t:l,message:c,dialogVisible:v,dialogTitle:u,formLoading:r,formData:p,formRules:{feeRate:[{required:!0,message:"\u8BF7\u8F93\u5165\u6E20\u9053\u8D39\u7387",trigger:"blur"}],status:[{required:!0,message:"\u6E20\u9053\u72B6\u6001\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],"config.appId":[{required:!0,message:"\u8BF7\u8F93\u5165\u5F00\u653E\u5E73\u53F0\u4E0A\u521B\u5EFA\u7684\u5E94\u7528\u7684 ID",trigger:"blur"}],"config.serverUrl":[{required:!0,message:"\u8BF7\u4F20\u5165\u7F51\u5173\u5730\u5740",trigger:"blur"}],"config.signType":[{required:!0,message:"\u8BF7\u4F20\u5165\u7B7E\u540D\u7B97\u6CD5\u7C7B\u578B",trigger:"blur"}],"config.mode":[{required:!0,message:"\u516C\u94A5\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],"config.privateKey":[{required:!0,message:"\u8BF7\u8F93\u5165\u5546\u6237\u79C1\u94A5",trigger:"blur"}],"config.alipayPublicKey":[{required:!0,message:"\u8BF7\u8F93\u5165\u652F\u4ED8\u5B9D\u516C\u94A5\u5B57\u7B26\u4E32",trigger:"blur"}],"config.appCertContent":[{required:!0,message:"\u8BF7\u4E0A\u4F20\u5546\u6237\u516C\u94A5\u5E94\u7528\u8BC1\u4E66",trigger:"blur"}],"config.alipayPublicCertContent":[{required:!0,message:"\u8BF7\u4E0A\u4F20\u652F\u4ED8\u5B9D\u516C\u94A5\u8BC1\u4E66",trigger:"blur"}],"config.rootCertContent":[{required:!0,message:"\u8BF7\u4E0A\u4F20\u6307\u5B9A\u6839\u8BC1\u4E66",trigger:"blur"}],"config.encryptKey":[{required:!0,message:"\u8BF7\u8F93\u5165\u63A5\u53E3\u5185\u5BB9\u52A0\u5BC6\u5BC6\u94A5",trigger:"blur"}]},fileAccept:w,formRef:s,open:g,emit:f,submitForm:async()=>{if(s&&await s.value.validate()){r.value=!0;try{const i={...p.value};i.config=JSON.stringify(p.value.config),i.id?(await $(i),c.success(l("common.updateSuccess"))):(await Z(i),c.success(l("common.createSuccess"))),v.value=!1,f("success")}finally{r.value=!1}}},resetForm:y,fileBeforeUpload:i=>{if("."+i.name.split(".")[1]!==w)return c.error(`\u8BF7\u4E0A\u4F20\u6307\u5B9A\u683C\u5F0F"${w}"\u6587\u4EF6`),!1;let d=i.size/1024/1024<2;return d||c.error("\u6587\u4EF6\u5927\u5C0F\u8D85\u8FC7 2MB"),d},appCertUpload:i=>{const d=new FileReader;d.onload=o=>{p.value.config.appCertContent=o.target.result},d.readAsText(i.file)},alipayPublicCertUpload:i=>{const d=new FileReader;d.onload=o=>{p.value.config.alipayPublicCertContent=o.target.result},d.readAsText(i.file)},rootCertUpload:i=>{const d=new FileReader;d.onload=o=>{p.value.config.rootCertContent=o.target.result},d.readAsText(i.file)},get DICT_TYPE(){return T},get getDictOptions(){return A}};return Object.defineProperty(_,"__isScriptSetup",{enumerable:!1,value:!0}),_}}),[["render",function(h,e,D,l,c,v){const u=F,r=E,p=O,s=z,g=N,f=B,y=L,_=M,i=Y,d=J;return m(),C("div",null,[a(i,{modelValue:l.dialogVisible,"onUpdate:modelValue":e[16]||(e[16]=o=>l.dialogVisible=o),title:l.dialogTitle,width:"830px",onClosed:h.close},{footer:t(()=>[a(f,{disabled:l.formLoading,type:"primary",onClick:l.submitForm},{default:t(()=>e[28]||(e[28]=[n("\u786E \u5B9A")])),_:1},8,["disabled"]),a(f,{onClick:e[15]||(e[15]=o=>l.dialogVisible=!1)},{default:t(()=>e[29]||(e[29]=[n("\u53D6 \u6D88")])),_:1})]),default:t(()=>[k((m(),x(_,{ref:"formRef",model:l.formData,rules:l.formRules,"label-width":"100px"},{default:t(()=>[a(r,{label:"\u6E20\u9053\u8D39\u7387","label-width":"180px",prop:"feeRate"},{default:t(()=>[a(u,{modelValue:l.formData.feeRate,"onUpdate:modelValue":e[0]||(e[0]=o=>l.formData.feeRate=o),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u6E20\u9053\u8D39\u7387"},{append:t(()=>e[17]||(e[17]=[n("%")])),_:1},8,["modelValue"])]),_:1}),a(r,{label:"\u5F00\u653E\u5E73\u53F0 APPID","label-width":"180px",prop:"config.appId"},{default:t(()=>[a(u,{modelValue:l.formData.config.appId,"onUpdate:modelValue":e[1]||(e[1]=o=>l.formData.config.appId=o),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u5F00\u653E\u5E73\u53F0 APPID"},null,8,["modelValue"])]),_:1}),a(r,{label:"\u6E20\u9053\u72B6\u6001","label-width":"180px",prop:"status"},{default:t(()=>[a(s,{modelValue:l.formData.status,"onUpdate:modelValue":e[2]||(e[2]=o=>l.formData.status=o)},{default:t(()=>[(m(!0),C(q,null,I(l.getDictOptions(l.DICT_TYPE.COMMON_STATUS),o=>(m(),x(p,{key:parseInt(o.value),value:parseInt(o.value)},{default:t(()=>[n(S(o.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(r,{label:"\u7F51\u5173\u5730\u5740","label-width":"180px",prop:"config.serverUrl"},{default:t(()=>[a(s,{modelValue:l.formData.config.serverUrl,"onUpdate:modelValue":e[3]||(e[3]=o=>l.formData.config.serverUrl=o)},{default:t(()=>[a(p,{value:"https://openapi.alipay.com/gateway.do"},{default:t(()=>e[18]||(e[18]=[n("\u7EBF\u4E0A\u73AF\u5883")])),_:1}),a(p,{value:"https://openapi-sandbox.dl.alipaydev.com/gateway.do"},{default:t(()=>e[19]||(e[19]=[n(" \u6C99\u7BB1\u73AF\u5883 ")])),_:1})]),_:1},8,["modelValue"])]),_:1}),a(r,{label:"\u7B97\u6CD5\u7C7B\u578B","label-width":"180px",prop:"config.signType"},{default:t(()=>[a(s,{modelValue:l.formData.config.signType,"onUpdate:modelValue":e[4]||(e[4]=o=>l.formData.config.signType=o)},{default:t(()=>[a(p,{key:"RSA2",value:"RSA2"},{default:t(()=>e[20]||(e[20]=[n("RSA2")])),_:1})]),_:1},8,["modelValue"])]),_:1}),a(r,{label:"\u516C\u94A5\u7C7B\u578B","label-width":"180px",prop:"config.mode"},{default:t(()=>[a(s,{modelValue:l.formData.config.mode,"onUpdate:modelValue":e[5]||(e[5]=o=>l.formData.config.mode=o)},{default:t(()=>[a(p,{key:"\u516C\u94A5\u6A21\u5F0F",value:1},{default:t(()=>e[21]||(e[21]=[n("\u516C\u94A5\u6A21\u5F0F")])),_:1}),a(p,{key:"\u8BC1\u4E66\u6A21\u5F0F",value:2},{default:t(()=>e[22]||(e[22]=[n("\u8BC1\u4E66\u6A21\u5F0F")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l.formData.config.mode===1?(m(),C("div",H,[a(r,{label:"\u5E94\u7528\u79C1\u94A5","label-width":"180px",prop:"config.privateKey"},{default:t(()=>[a(u,{modelValue:l.formData.config.privateKey,"onUpdate:modelValue":e[6]||(e[6]=o=>l.formData.config.privateKey=o),autosize:{minRows:8,maxRows:8},style:{width:"100%"},clearable:"",placeholder:"\u8BF7\u8F93\u5165\u5E94\u7528\u79C1\u94A5",type:"textarea"},null,8,["modelValue"])]),_:1}),a(r,{label:"\u652F\u4ED8\u5B9D\u516C\u94A5","label-width":"180px",prop:"config.alipayPublicKey"},{default:t(()=>[a(u,{modelValue:l.formData.config.alipayPublicKey,"onUpdate:modelValue":e[7]||(e[7]=o=>l.formData.config.alipayPublicKey=o),autosize:{minRows:8,maxRows:8},style:{width:"100%"},clearable:"",placeholder:"\u8BF7\u8F93\u5165\u652F\u4ED8\u5B9D\u516C\u94A5",type:"textarea"},null,8,["modelValue"])]),_:1})])):V("",!0),l.formData.config.mode===2?(m(),C("div",Q,[a(r,{label:"\u5E94\u7528\u79C1\u94A5","label-width":"180px",prop:"config.privateKey"},{default:t(()=>[a(u,{modelValue:l.formData.config.privateKey,"onUpdate:modelValue":e[8]||(e[8]=o=>l.formData.config.privateKey=o),autosize:{minRows:8,maxRows:8},style:{width:"100%"},clearable:"",placeholder:"\u8BF7\u8F93\u5165\u5E94\u7528\u79C1\u94A5",type:"textarea"},null,8,["modelValue"])]),_:1}),a(r,{label:"\u5546\u6237\u516C\u94A5\u5E94\u7528\u8BC1\u4E66","label-width":"180px",prop:"config.appCertContent"},{default:t(()=>[a(u,{modelValue:l.formData.config.appCertContent,"onUpdate:modelValue":e[9]||(e[9]=o=>l.formData.config.appCertContent=o),autosize:{minRows:8,maxRows:8},style:{width:"100%"},placeholder:"\u8BF7\u4E0A\u4F20\u5546\u6237\u516C\u94A5\u5E94\u7528\u8BC1\u4E66",readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1}),a(r,{label:"","label-width":"180px"},{default:t(()=>[a(y,{ref:"privateKeyContentFile",accept:l.fileAccept,"before-upload":l.fileBeforeUpload,"http-request":l.appCertUpload,limit:1,action:""},{default:t(()=>[a(f,{type:"primary"},{default:t(()=>[a(g,{class:"mr-5px",icon:"ep:upload"}),e[23]||(e[23]=n(" \u70B9\u51FB\u4E0A\u4F20 "))]),_:1})]),_:1},512)]),_:1}),a(r,{label:"\u652F\u4ED8\u5B9D\u516C\u94A5\u8BC1\u4E66","label-width":"180px",prop:"config.alipayPublicCertContent"},{default:t(()=>[a(u,{modelValue:l.formData.config.alipayPublicCertContent,"onUpdate:modelValue":e[10]||(e[10]=o=>l.formData.config.alipayPublicCertContent=o),autosize:{minRows:8,maxRows:8},style:{width:"100%"},placeholder:"\u8BF7\u4E0A\u4F20\u652F\u4ED8\u5B9D\u516C\u94A5\u8BC1\u4E66",readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1}),a(r,{label:"","label-width":"180px"},{default:t(()=>[a(y,{ref:"privateCertContentFile",accept:l.fileAccept,"before-upload":l.fileBeforeUpload,"http-request":l.alipayPublicCertUpload,limit:1,action:""},{default:t(()=>[a(f,{type:"primary"},{default:t(()=>[a(g,{class:"mr-5px",icon:"ep:upload"}),e[24]||(e[24]=n(" \u70B9\u51FB\u4E0A\u4F20 "))]),_:1})]),_:1},512)]),_:1}),a(r,{label:"\u6839\u8BC1\u4E66","label-width":"180px",prop:"config.rootCertContent"},{default:t(()=>[a(u,{modelValue:l.formData.config.rootCertContent,"onUpdate:modelValue":e[11]||(e[11]=o=>l.formData.config.rootCertContent=o),autosize:{minRows:8,maxRows:8},style:{width:"100%"},placeholder:"\u8BF7\u4E0A\u4F20\u6839\u8BC1\u4E66",readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1}),a(r,{label:"","label-width":"180px"},{default:t(()=>[a(y,{ref:"privateCertContentFile",accept:l.fileAccept,"before-upload":l.fileBeforeUpload,"http-request":l.rootCertUpload,limit:1,action:""},{default:t(()=>[a(f,{type:"primary"},{default:t(()=>[a(g,{class:"mr-5px",icon:"ep:upload"}),e[25]||(e[25]=n(" \u70B9\u51FB\u4E0A\u4F20 "))]),_:1})]),_:1},512)]),_:1})])):V("",!0),a(r,{label:"\u63A5\u53E3\u5185\u5BB9\u52A0\u5BC6\u65B9\u5F0F","label-width":"180px",prop:"config.encryptType"},{default:t(()=>[a(s,{modelValue:l.formData.config.encryptType,"onUpdate:modelValue":e[12]||(e[12]=o=>l.formData.config.encryptType=o)},{default:t(()=>[a(p,{key:"NONE",label:""},{default:t(()=>e[26]||(e[26]=[n("\u65E0\u52A0\u5BC6")])),_:1}),a(p,{key:"AES",label:"AES"},{default:t(()=>e[27]||(e[27]=[n("AES")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l.formData.config.encryptType==="AES"?(m(),C("div",W,[a(r,{label:"\u63A5\u53E3\u5185\u5BB9\u52A0\u5BC6\u5BC6\u94A5","label-width":"180px",prop:"config.encryptKey"},{default:t(()=>[a(u,{modelValue:l.formData.config.encryptKey,"onUpdate:modelValue":e[13]||(e[13]=o=>l.formData.config.encryptKey=o),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u63A5\u53E3\u5185\u5BB9\u52A0\u5BC6\u5BC6\u94A5"},null,8,["modelValue"])]),_:1})])):V("",!0),a(r,{label:"\u5907\u6CE8","label-width":"180px",prop:"remark"},{default:t(()=>[a(u,{modelValue:l.formData.remark,"onUpdate:modelValue":e[14]||(e[14]=o=>l.formData.remark=o),style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])),[[d,l.formLoading]])]),_:1},8,["modelValue","title","onClosed"])])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/pay/app/components/channel/AlipayChannelForm.vue"]]);export{X as default};
