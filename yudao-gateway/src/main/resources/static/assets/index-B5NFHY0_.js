import{d as L,D as Q,g as Y,r as c,f as z,u as A,C as B,G as K,e2 as M,_ as O,X as G,o as p,c as I,k as a,w as r,Y as q,F as R,n as J,q as u,m as s,I as b,t as F,Z as j,L as X,J as Z,K as $,z as W,N as H,O as ee,A as ae,B as te,y as le,P as re,Q as oe,R as ie}from"./index-BaY5TDP-.js";import{_ as ne}from"./index-avjYFQiD.js";import{_ as se}from"./DictTag-QtcI9ZjC.js";import{_ as pe}from"./ContentWrap-DKQn7kZm.js";import{_ as me}from"./index-BAz6Gqim.js";import{d as ce,b as ue}from"./formatTime-Dr6TiYYc.js";import{d as de}from"./download-oWiM5xVU.js";import{b as fe,d as ye,s as be,f as we}from"./index-DcQDDeHJ.js";import _e from"./ReceivableForm-C0pIMqYw.js";import{g as ge}from"./index-h6ObHKtQ.js";import"./index-DrSdAlug.js";import"./color-BN7ZL7BD.js";import"./Dialog-CZSXtzfQ.js";import"./index-ndAUlMgd.js";import"./index-CuAlllbQ.js";import"./index-B97LdofC.js";const he=O(L({name:"Receivable",__name:"index",setup(S,{expose:l}){l();const d=Q(),{t:e}=Y(),x=c(!0),T=c(0),h=c([]),f=z({pageNo:1,pageSize:10,sceneType:"1",no:void 0,customerId:void 0}),w=c(),C=c(!1),D=c("1"),y=c([]),n=async()=>{x.value=!0;try{const o=await fe(f);h.value=o.list,T.value=o.total}finally{x.value=!1}},v=()=>{f.pageNo=1,n()},k=c(),{push:m}=A();B(async()=>{await n(),y.value=await ge()});const P={message:d,t:e,loading:x,total:T,list:h,queryParams:f,queryFormRef:w,exportLoading:C,activeName:D,customerList:y,handleTabClick:o=>{f.sceneType=o.paneName,v()},getList:n,handleQuery:v,resetQuery:()=>{w.value.resetFields(),v()},formRef:k,openForm:(o,i)=>{k.value.open(o,i)},handleDelete:async o=>{try{await d.delConfirm(),await ye(o),d.success(e("common.delSuccess")),await n()}catch{}},handleSubmit:async o=>{await d.confirm(`\u60A8\u786E\u5B9A\u63D0\u4EA4\u7F16\u53F7\u4E3A\u3010${o.no}\u3011\u7684\u56DE\u6B3E\u5BA1\u6838\u5417\uFF1F`),await be(o.id),d.success("\u63D0\u4EA4\u5BA1\u6838\u6210\u529F\uFF01"),await n()},handleProcessDetail:o=>{m({name:"BpmProcessInstanceDetail",query:{id:o.processInstanceId}})},push:m,openDetail:o=>{m({name:"CrmReceivableDetail",params:{id:o}})},openCustomerDetail:o=>{m({name:"CrmCustomerDetail",params:{id:o}})},openContractDetail:o=>{m({name:"CrmContractDetail",params:{id:o}})},handleExport:async()=>{try{await d.exportConfirm(),C.value=!0;const o=await we(f);de.excel(o,"\u56DE\u6B3E.xls")}catch{}finally{C.value=!1}},get DICT_TYPE(){return K},get dateFormatter(){return ce},get dateFormatter2(){return ue},ReceivableForm:_e,get erpPriceTableColumnFormatter(){return M}};return Object.defineProperty(P,"__isScriptSetup",{enumerable:!1,value:!0}),P}}),[["render",function(S,l,d,e,x,T){const h=me,f=j,w=X,C=Z,D=$,y=W,n=H,v=ee,k=pe,m=ae,P=te,o=le,i=re,N=se,U=oe,E=ne,_=G("hasPermi"),V=ie;return p(),I(R,null,[a(h,{title:"\u3010\u56DE\u6B3E\u3011\u56DE\u6B3E\u7BA1\u7406\u3001\u56DE\u6B3E\u8BA1\u5212",url:"https://doc.iocoder.cn/crm/receivable/"}),a(h,{title:"\u3010\u901A\u7528\u3011\u6570\u636E\u6743\u9650",url:"https://doc.iocoder.cn/crm/permission/"}),a(k,null,{default:r(()=>[a(v,{ref:"queryFormRef",inline:!0,model:e.queryParams,class:"-mb-15px","label-width":"68px"},{default:r(()=>[a(w,{label:"\u56DE\u6B3E\u7F16\u53F7",prop:"no"},{default:r(()=>[a(f,{modelValue:e.queryParams.no,"onUpdate:modelValue":l[0]||(l[0]=t=>e.queryParams.no=t),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u56DE\u6B3E\u7F16\u53F7",onKeyup:q(e.handleQuery,["enter"])},null,8,["modelValue"])]),_:1}),a(w,{label:"\u5BA2\u6237\u540D\u79F0",prop:"customerId"},{default:r(()=>[a(D,{modelValue:e.queryParams.customerId,"onUpdate:modelValue":l[1]||(l[1]=t=>e.queryParams.customerId=t),class:"!w-240px",placeholder:"\u8BF7\u9009\u62E9\u5BA2\u6237",onKeyup:q(e.handleQuery,["enter"])},{default:r(()=>[(p(!0),I(R,null,J(e.customerList,t=>(p(),u(C,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(w,null,{default:r(()=>[a(n,{onClick:e.handleQuery},{default:r(()=>[a(y,{class:"mr-5px",icon:"ep:search"}),l[6]||(l[6]=s(" \u641C\u7D22 "))]),_:1}),a(n,{onClick:e.resetQuery},{default:r(()=>[a(y,{class:"mr-5px",icon:"ep:refresh"}),l[7]||(l[7]=s(" \u91CD\u7F6E "))]),_:1}),b((p(),u(n,{plain:"",type:"primary",onClick:l[2]||(l[2]=t=>e.openForm("create"))},{default:r(()=>[a(y,{class:"mr-5px",icon:"ep:plus"}),l[8]||(l[8]=s(" \u65B0\u589E "))]),_:1})),[[_,["crm:receivable:create"]]]),b((p(),u(n,{loading:e.exportLoading,plain:"",type:"success",onClick:e.handleExport},{default:r(()=>[a(y,{class:"mr-5px",icon:"ep:download"}),l[9]||(l[9]=s(" \u5BFC\u51FA "))]),_:1},8,["loading"])),[[_,["crm:receivable:export"]]])]),_:1})]),_:1},8,["model"])]),_:1}),a(k,null,{default:r(()=>[a(P,{modelValue:e.activeName,"onUpdate:modelValue":l[3]||(l[3]=t=>e.activeName=t),onTabClick:e.handleTabClick},{default:r(()=>[a(m,{label:"\u6211\u8D1F\u8D23\u7684",name:"1"}),a(m,{label:"\u6211\u53C2\u4E0E\u7684",name:"2"}),a(m,{label:"\u4E0B\u5C5E\u8D1F\u8D23\u7684",name:"3"})]),_:1},8,["modelValue"]),b((p(),u(U,{data:e.list,"show-overflow-tooltip":!0,stripe:!0},{default:r(()=>[a(i,{align:"center",fixed:"left",label:"\u56DE\u6B3E\u7F16\u53F7",prop:"no",width:"180"},{default:r(t=>[a(o,{underline:!1,type:"primary",onClick:g=>e.openDetail(t.row.id)},{default:r(()=>[s(F(t.row.no),1)]),_:2},1032,["onClick"])]),_:1}),a(i,{align:"center",label:"\u5BA2\u6237\u540D\u79F0",prop:"customerName",width:"120"},{default:r(t=>[a(o,{underline:!1,type:"primary",onClick:g=>e.openCustomerDetail(t.row.customerId)},{default:r(()=>[s(F(t.row.customerName),1)]),_:2},1032,["onClick"])]),_:1}),a(i,{align:"center",label:"\u5408\u540C\u7F16\u53F7",prop:"contractNo",width:"180"},{default:r(t=>[a(o,{underline:!1,type:"primary",onClick:g=>e.openContractDetail(t.row.contractId)},{default:r(()=>[s(F(t.row.contract.no),1)]),_:2},1032,["onClick"])]),_:1}),a(i,{formatter:e.dateFormatter2,align:"center",label:"\u56DE\u6B3E\u65E5\u671F",prop:"returnTime",width:"150px"},null,8,["formatter"]),a(i,{align:"center",label:"\u56DE\u6B3E\u91D1\u989D(\u5143)",prop:"price",width:"140",formatter:e.erpPriceTableColumnFormatter},null,8,["formatter"]),a(i,{align:"center",label:"\u56DE\u6B3E\u65B9\u5F0F",prop:"returnType",width:"130px"},{default:r(t=>[a(N,{type:e.DICT_TYPE.CRM_RECEIVABLE_RETURN_TYPE,value:t.row.returnType},null,8,["type","value"])]),_:1}),a(i,{align:"center",label:"\u5907\u6CE8",prop:"remark",width:"200"}),a(i,{align:"center",label:"\u5408\u540C\u91D1\u989D\uFF08\u5143\uFF09",prop:"contract.totalPrice",width:"140",formatter:e.erpPriceTableColumnFormatter},null,8,["formatter"]),a(i,{align:"center",label:"\u8D1F\u8D23\u4EBA",prop:"ownerUserName",width:"120"}),a(i,{align:"center",label:"\u6240\u5C5E\u90E8\u95E8",prop:"ownerUserDeptName",width:"100px"}),a(i,{formatter:e.dateFormatter,align:"center",label:"\u66F4\u65B0\u65F6\u95F4",prop:"updateTime",width:"180px"},null,8,["formatter"]),a(i,{formatter:e.dateFormatter,align:"center",label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime",width:"180px"},null,8,["formatter"]),a(i,{align:"center",label:"\u521B\u5EFA\u4EBA",prop:"creatorName",width:"120"}),a(i,{align:"center",fixed:"right",label:"\u56DE\u6B3E\u72B6\u6001",prop:"auditStatus",width:"120"},{default:r(t=>[a(N,{type:e.DICT_TYPE.CRM_AUDIT_STATUS,value:t.row.auditStatus},null,8,["type","value"])]),_:1}),a(i,{align:"center",fixed:"right",label:"\u64CD\u4F5C",width:"180px"},{default:r(t=>[b((p(),u(n,{link:"",type:"primary",onClick:g=>e.openForm("update",t.row.id)},{default:r(()=>l[10]||(l[10]=[s(" \u7F16\u8F91 ")])),_:2},1032,["onClick"])),[[_,["crm:receivable:update"]]]),t.row.auditStatus===0?b((p(),u(n,{key:0,link:"",type:"primary",onClick:g=>e.handleSubmit(t.row)},{default:r(()=>l[11]||(l[11]=[s(" \u63D0\u4EA4\u5BA1\u6838 ")])),_:2},1032,["onClick"])),[[_,["crm:receivable:update"]]]):b((p(),u(n,{key:1,link:"",type:"primary",onClick:g=>e.handleProcessDetail(t.row)},{default:r(()=>l[12]||(l[12]=[s(" \u67E5\u770B\u5BA1\u6279 ")])),_:2},1032,["onClick"])),[[_,["crm:receivable:update"]]]),b((p(),u(n,{link:"",type:"danger",onClick:g=>e.handleDelete(t.row.id)},{default:r(()=>l[13]||(l[13]=[s(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[_,["crm:receivable:delete"]]])]),_:1})]),_:1},8,["data"])),[[V,e.loading]]),a(E,{limit:e.queryParams.pageSize,"onUpdate:limit":l[4]||(l[4]=t=>e.queryParams.pageSize=t),page:e.queryParams.pageNo,"onUpdate:page":l[5]||(l[5]=t=>e.queryParams.pageNo=t),total:e.total,onPagination:e.getList},null,8,["limit","page","total"])]),_:1}),a(e.ReceivableForm,{ref:"formRef",onSuccess:e.getList},null,512)],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/crm/receivable/index.vue"]]);export{he as default};
