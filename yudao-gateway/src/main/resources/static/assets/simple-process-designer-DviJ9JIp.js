import{_ as ln}from"./Dialog-CZSXtzfQ.js";import{d as q,D as Me,r as A,b4 as j,dq as Y,_ as G,o as n,c,j as a,q as y,w as d,k as l,ah as E,z as B,dF as an,X as K,I as $,cb as X,m as O,t as I,F as R,n as x,b8 as qe,aK as dn,A as $e,ak as Ge,al as Fe,B as Xe,x as me,N as ae,G as Ke,a2 as ne,P as Qe,Q as We,E as De,cK as Je,Z as Te,L as fe,J as ge,K as ye,b as Z,ch as Ze,cQ as It,O as Ne,f as Re,ay as on,v as rn,cf as Pt,aJ as xt,l as At,au as Be,bQ as et,M as sn,dG as un,am as cn,at as pn,dv as mn,dw as vn,dx as fn,b5 as gn,aF as yn,aV as Nn}from"./index-BaY5TDP-.js";import{_ as tt}from"./DictTag-QtcI9ZjC.js";import{N as V,l as Oe,i as be,R as nt,d as lt,k as _n,o as ee,p as Ie,F as he,S as Tn,n as se,B as bn,q as Lt,C as Ee,P as hn,A as Pe,T as ie,r as Ht,D as En,O as Mt,e as kn,j as Sn,g as Cn,f as at,b as wn,M as qt,h as Gt,a as Un,c as Vn,s as Fn,t as Bt,u as ve,v as Dn,w as ke,x as Rn}from"./consts-vgsb8q48.js";import{a as Se,b as W,d as Ce,u as dt,e as we,f as ue,g as ot,h as jt,c as zt,i as On,j as Yt,k as In,l as Pn}from"./utils-DQEYWnsS.js";import{E as _e}from"./el-drawer-r3cMvY4i.js";import{d as it,a as rt}from"./formatTime-Dr6TiYYc.js";import{E as $t}from"./el-tree-select-DphqCDCz.js";import{d as Xt}from"./tree-z7HkrWVC.js";import{E as xn}from"./el-space-B4pGZPiv.js";import{B as An}from"./constants-CEEr2azc.js";import{d as Ln}from"./download-oWiM5xVU.js";const Hn={class:"node-handler-wrapper"},Mn={class:"node-handler"},qn={class:"handler-item-wrapper"},Gn={class:"add-icon"},ce=G(q({name:"NodeHandler",__name:"NodeHandler",props:{childNode:{type:Object,default:null},currentNode:{type:Object,required:!0}},emits:["update:childNode"],setup(F,{expose:t,emit:C}){t();const e=Me(),b=A(!1),N=F,s=C,r=j("readonly"),v={message:e,popoverShow:b,props:N,emits:s,readonly:r,addNode:p=>{var i;if(p===V.PARALLEL_BRANCH_NODE&&[V.CONDITION_BRANCH_NODE,V.INCLUSIVE_BRANCH_NODE].includes((i=N.currentNode)==null?void 0:i.type))e.error("\u6761\u4EF6\u5206\u652F\u3001\u5305\u5BB9\u5206\u652F\u540E\u9762\uFF0C\u4E0D\u5141\u8BB8\u76F4\u63A5\u6DFB\u52A0\u5E76\u884C\u5206\u652F");else{if(b.value=!1,p===V.USER_TASK_NODE){const o={id:"Activity_"+Y(),name:Oe.get(V.USER_TASK_NODE),showText:"",type:V.USER_TASK_NODE,approveMethod:be.SEQUENTIAL_APPROVE,rejectHandler:{type:nt.FINISH_PROCESS},timeoutHandler:{enable:!1},assignEmptyHandler:{type:lt.APPROVE},assignStartUserHandlerType:_n.START_USER_AUDIT,childNode:N.childNode,taskCreateListener:{enable:!1},taskAssignListener:{enable:!1},taskCompleteListener:{enable:!1}};s("update:childNode",o)}if(p===V.COPY_TASK_NODE){const o={id:"Activity_"+Y(),name:Oe.get(V.COPY_TASK_NODE),showText:"",type:V.COPY_TASK_NODE,childNode:N.childNode};s("update:childNode",o)}if(p===V.CONDITION_BRANCH_NODE){const o={name:"\u6761\u4EF6\u5206\u652F",type:V.CONDITION_BRANCH_NODE,id:"GateWay_"+Y(),childNode:N.childNode,conditionNodes:[{id:"Flow_"+Y(),name:"\u6761\u4EF61",showText:"",type:V.CONDITION_NODE,childNode:void 0,conditionSetting:{defaultFlow:!1,conditionType:ee.RULE,conditionGroups:Ie}},{id:"Flow_"+Y(),name:"\u5176\u5B83\u60C5\u51B5",showText:"\u672A\u6EE1\u8DB3\u5176\u5B83\u6761\u4EF6\u65F6\uFF0C\u5C06\u8FDB\u5165\u6B64\u5206\u652F",type:V.CONDITION_NODE,childNode:void 0,conditionSetting:{defaultFlow:!0}}]};s("update:childNode",o)}if(p===V.PARALLEL_BRANCH_NODE){const o={name:"\u5E76\u884C\u5206\u652F",type:V.PARALLEL_BRANCH_NODE,id:"GateWay_"+Y(),childNode:N.childNode,conditionNodes:[{id:"Flow_"+Y(),name:"\u5E76\u884C1",showText:"\u65E0\u9700\u914D\u7F6E\u6761\u4EF6\u540C\u65F6\u6267\u884C",type:V.CONDITION_NODE,childNode:void 0},{id:"Flow_"+Y(),name:"\u5E76\u884C2",showText:"\u65E0\u9700\u914D\u7F6E\u6761\u4EF6\u540C\u65F6\u6267\u884C",type:V.CONDITION_NODE,childNode:void 0}]};s("update:childNode",o)}if(p===V.INCLUSIVE_BRANCH_NODE){const o={name:"\u5305\u5BB9\u5206\u652F",type:V.INCLUSIVE_BRANCH_NODE,id:"GateWay_"+Y(),childNode:N.childNode,conditionNodes:[{id:"Flow_"+Y(),name:"\u5305\u5BB9\u6761\u4EF61",showText:"",type:V.CONDITION_NODE,childNode:void 0,conditionSetting:{defaultFlow:!1,conditionType:ee.RULE,conditionGroups:Ie}},{id:"Flow_"+Y(),name:"\u5176\u5B83\u60C5\u51B5",showText:"\u672A\u6EE1\u8DB3\u5176\u5B83\u6761\u4EF6\u65F6\uFF0C\u5C06\u8FDB\u5165\u6B64\u5206\u652F",type:V.CONDITION_NODE,childNode:void 0,conditionSetting:{defaultFlow:!0}}]};s("update:childNode",o)}if(p===V.DELAY_TIMER_NODE){const o={id:"Activity_"+Y(),name:Oe.get(V.DELAY_TIMER_NODE),showText:"",type:V.DELAY_TIMER_NODE,childNode:N.childNode};s("update:childNode",o)}if(p===V.ROUTER_BRANCH_NODE){const o={id:"GateWay_"+Y(),name:Oe.get(V.ROUTER_BRANCH_NODE),showText:"",type:V.ROUTER_BRANCH_NODE,childNode:N.childNode};s("update:childNode",o)}if(p===V.TRIGGER_NODE){const o={id:"Activity_"+Y(),name:Oe.get(V.TRIGGER_NODE),showText:"",type:V.TRIGGER_NODE,childNode:N.childNode};s("update:childNode",o)}}},get NodeType(){return V}};return Object.defineProperty(v,"__isScriptSetup",{enumerable:!1,value:!0}),v}}),[["render",function(F,t,C,e,b,N){const s=B,r=an;return n(),c("div",Hn,[a("div",Mn,[e.readonly?E("",!0):(n(),y(r,{key:0,trigger:"hover",visible:e.popoverShow,"onUpdate:visible":t[8]||(t[8]=v=>e.popoverShow=v),placement:"right-start",width:"auto"},{reference:d(()=>[a("div",Gn,[l(s,{icon:"ep:plus"})])]),default:d(()=>[a("div",qn,[a("div",{class:"handler-item",onClick:t[0]||(t[0]=v=>e.addNode(e.NodeType.USER_TASK_NODE))},t[9]||(t[9]=[a("div",{class:"approve handler-item-icon"},[a("span",{class:"iconfont icon-approve icon-size"})],-1),a("div",{class:"handler-item-text"},"\u5BA1\u6279\u4EBA",-1)])),a("div",{class:"handler-item",onClick:t[1]||(t[1]=v=>e.addNode(e.NodeType.COPY_TASK_NODE))},t[10]||(t[10]=[a("div",{class:"handler-item-icon copy"},[a("span",{class:"iconfont icon-size icon-copy"})],-1),a("div",{class:"handler-item-text"},"\u6284\u9001",-1)])),a("div",{class:"handler-item",onClick:t[2]||(t[2]=v=>e.addNode(e.NodeType.CONDITION_BRANCH_NODE))},t[11]||(t[11]=[a("div",{class:"handler-item-icon condition"},[a("span",{class:"iconfont icon-size icon-exclusive"})],-1),a("div",{class:"handler-item-text"},"\u6761\u4EF6\u5206\u652F",-1)])),a("div",{class:"handler-item",onClick:t[3]||(t[3]=v=>e.addNode(e.NodeType.PARALLEL_BRANCH_NODE))},t[12]||(t[12]=[a("div",{class:"handler-item-icon parallel"},[a("span",{class:"iconfont icon-size icon-parallel"})],-1),a("div",{class:"handler-item-text"},"\u5E76\u884C\u5206\u652F",-1)])),a("div",{class:"handler-item",onClick:t[4]||(t[4]=v=>e.addNode(e.NodeType.INCLUSIVE_BRANCH_NODE))},t[13]||(t[13]=[a("div",{class:"handler-item-icon inclusive"},[a("span",{class:"iconfont icon-size icon-inclusive"})],-1),a("div",{class:"handler-item-text"},"\u5305\u5BB9\u5206\u652F",-1)])),a("div",{class:"handler-item",onClick:t[5]||(t[5]=v=>e.addNode(e.NodeType.DELAY_TIMER_NODE))},t[14]||(t[14]=[a("div",{class:"handler-item-icon delay"},[a("span",{class:"iconfont icon-size icon-delay"})],-1),a("div",{class:"handler-item-text"},"\u5EF6\u8FDF\u5668",-1)])),a("div",{class:"handler-item",onClick:t[6]||(t[6]=v=>e.addNode(e.NodeType.ROUTER_BRANCH_NODE))},t[15]||(t[15]=[a("div",{class:"handler-item-icon router"},[a("span",{class:"iconfont icon-size icon-router"})],-1),a("div",{class:"handler-item-text"},"\u8DEF\u7531\u5206\u652F",-1)])),a("div",{class:"handler-item",onClick:t[7]||(t[7]=v=>e.addNode(e.NodeType.TRIGGER_NODE))},t[16]||(t[16]=[a("div",{class:"handler-item-icon trigger"},[a("span",{class:"iconfont icon-size icon-trigger"})],-1),a("div",{class:"handler-item-text"},"\u89E6\u53D1\u5668",-1)]))])]),_:1},8,["visible"]))])])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/components/SimpleProcessDesignerV2/src/NodeHandler.vue"]]),Bn={class:"config-header"},jn=["placeholder"],zn={key:1,class:"node-name"},Yn={class:"field-setting-pane"},$n={class:"field-setting-item-label"},Xn={class:"item-radio-wrap"},Kn={class:"item-radio-wrap"},Qn={class:"item-radio-wrap"},Wn=G(q({name:"StartUserNodeConfig",__name:"StartUserNodeConfig",props:{flowNode:{type:Object,required:!0}},setup(F,{expose:t}){const C=F,e=j("startUserIds"),b=j("userList"),{settingVisible:N,closeDrawer:s,openDrawer:r}=Se(),v=W(C),{nodeName:p,showInput:i,clickIcon:o,blurEvent:g}=Ce(V.COPY_TASK_NODE),u=A("user"),{formType:m,fieldsPermissionConfig:k,getNodeConfigFormFields:w}=dt(he.WRITE),_=P=>{p.value=P.name,w(P.fieldsPermission)};t({openDrawer:r,showStartUserNodeConfig:_});const S={props:C,startUserIds:e,userOptions:b,settingVisible:N,closeDrawer:s,openDrawer:r,currentNode:v,nodeName:p,showInput:i,clickIcon:o,blurEvent:g,activeTabName:u,formType:m,fieldsPermissionConfig:k,getNodeConfigFormFields:w,getUserNicknames:P=>{if(!P||P.length===0)return"";const h=[];return P.forEach(T=>{const L=b==null?void 0:b.value.find(J=>J.id===T);L&&L.nickname&&h.push(L.nickname)}),h.join(",")},saveConfig:async()=>(u.value="user",v.value.name=p.value,v.value.showText="\u5DF2\u8BBE\u7F6E",v.value.fieldsPermission=k.value,v.value.buttonsSetting=Tn,N.value=!1,!0),showStartUserNodeConfig:_,get FieldPermissionType(){return he}};return Object.defineProperty(S,"__isScriptSetup",{enumerable:!1,value:!0}),S}}),[["render",function(F,t,C,e,b,N){const s=B,r=qe,v=dn,p=$e,i=Ge,o=Fe,g=Xe,u=me,m=ae,k=_e,w=K("mountedFocus");return n(),y(k,{"append-to-body":!0,modelValue:e.settingVisible,"onUpdate:modelValue":t[4]||(t[4]=_=>e.settingVisible=_),"show-close":!1,size:550,"before-close":e.saveConfig},{header:d(()=>[a("div",Bn,[e.showInput?$((n(),c("input",{key:0,type:"text",class:"config-editable-input",onBlur:t[0]||(t[0]=_=>e.blurEvent()),"onUpdate:modelValue":t[1]||(t[1]=_=>e.nodeName=_),placeholder:e.nodeName},null,40,jn)),[[w],[X,e.nodeName]]):(n(),c("div",zn,[O(I(e.nodeName)+" ",1),l(s,{class:"ml-1",icon:"ep:edit-pen",size:16,onClick:t[2]||(t[2]=_=>e.clickIcon())})])),t[5]||(t[5]=a("div",{class:"divide-line"},null,-1))])]),footer:d(()=>[l(u),a("div",null,[l(m,{type:"primary",onClick:e.saveConfig},{default:d(()=>t[12]||(t[12]=[O("\u786E \u5B9A")])),_:1}),l(m,{onClick:e.closeDrawer},{default:d(()=>t[13]||(t[13]=[O("\u53D6 \u6D88")])),_:1},8,["onClick"])])]),default:d(()=>[l(g,{type:"border-card",modelValue:e.activeTabName,"onUpdate:modelValue":t[3]||(t[3]=_=>e.activeTabName=_)},{default:d(()=>[l(p,{label:"\u6743\u9650",name:"user"},{default:d(()=>[e.startUserIds&&e.startUserIds.length!==0?e.startUserIds.length==1?(n(),y(r,{key:1},{default:d(()=>[O(I(e.getUserNicknames(e.startUserIds))+" \u53EF\u53D1\u8D77\u6D41\u7A0B ",1)]),_:1})):(n(),y(r,{key:2},{default:d(()=>[l(v,{class:"box-item",effect:"dark",placement:"top",content:e.getUserNicknames(e.startUserIds)},{default:d(()=>[O(I(e.getUserNicknames(e.startUserIds.slice(0,2)))+" \u7B49 "+I(e.startUserIds.length)+" \u4EBA\u53EF\u53D1\u8D77\u6D41\u7A0B ",1)]),_:1},8,["content"])]),_:1})):(n(),y(r,{key:0},{default:d(()=>t[6]||(t[6]=[O(" \u5168\u90E8\u6210\u5458\u53EF\u4EE5\u53D1\u8D77\u6D41\u7A0B ")])),_:1}))]),_:1}),e.formType===10?(n(),y(p,{key:0,label:"\u8868\u5355\u5B57\u6BB5\u6743\u9650",name:"fields"},{default:d(()=>[a("div",Yn,[t[10]||(t[10]=a("div",{class:"field-setting-desc"},"\u5B57\u6BB5\u6743\u9650",-1)),t[11]||(t[11]=a("div",{class:"field-permit-title"},[a("div",{class:"setting-title-label first-title"}," \u5B57\u6BB5\u540D\u79F0 "),a("div",{class:"other-titles"},[a("span",{class:"setting-title-label"},"\u53EA\u8BFB"),a("span",{class:"setting-title-label"},"\u53EF\u7F16\u8F91"),a("span",{class:"setting-title-label"},"\u9690\u85CF")])],-1)),(n(!0),c(R,null,x(e.fieldsPermissionConfig,(_,S)=>(n(),c("div",{class:"field-setting-item",key:S},[a("div",$n,I(_.title),1),l(o,{class:"field-setting-item-group",modelValue:_.permission,"onUpdate:modelValue":P=>_.permission=P},{default:d(()=>[a("div",Xn,[l(i,{value:e.FieldPermissionType.READ,size:"large",label:e.FieldPermissionType.READ},{default:d(()=>[...t[7]||(t[7]=[a("span",null,null,-1)])]),_:1},8,["value","label"])]),a("div",Kn,[l(i,{value:e.FieldPermissionType.WRITE,size:"large",label:e.FieldPermissionType.WRITE},{default:d(()=>[...t[8]||(t[8]=[a("span",null,null,-1)])]),_:1},8,["value","label"])]),a("div",Qn,[l(i,{value:e.FieldPermissionType.NONE,size:"large",label:e.FieldPermissionType.NONE},{default:d(()=>[...t[9]||(t[9]=[a("span",null,null,-1)])]),_:1},8,["value","label"])])]),_:2},1032,["modelValue","onUpdate:modelValue"])]))),128))])]),_:1})):E("",!0)]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/components/SimpleProcessDesignerV2/src/nodes-config/StartUserNodeConfig.vue"]]),Jn={class:"node-wrapper"},Zn={class:"node-container"},el={class:"node-title-container"},tl=["placeholder"],nl=["title"],ll={key:1,class:"node-text"},al=G(q({name:"StartEventNode",__name:"StartUserNode",props:{flowNode:{type:Object,default:()=>null}},emits:["update:modelValue"],setup(F,{expose:t,emit:C}){t();const e=F,b=j("readonly"),N=j("tasks",A([])),s=C,r=W(e),{showInput:v,blurEvent:p,clickTitle:i}=we(r,V.START_USER_NODE),o=A(),g=A(!1),u=A(void 0),m=A([]),k={props:e,readonly:b,tasks:N,emits:s,currentNode:r,showInput:v,blurEvent:p,clickTitle:i,nodeSetting:o,nodeClick:()=>{b?N&&N.value&&(u.value=r.value.name,m.value=N.value.filter(w=>(w==null?void 0:w.taskDefinitionKey)===r.value.id),g.value=!0):(o.value.showStartUserNodeConfig(r.value),o.value.openDrawer())},dialogVisible:g,dialogTitle:u,selectTasks:m,NodeHandler:ce,get useTaskStatusClass(){return ue},get NODE_DEFAULT_TEXT(){return se},get NodeType(){return V},StartUserNodeConfig:Wn,get dateFormatter(){return it},get formatPast2(){return rt},get DICT_TYPE(){return Ke}};return Object.defineProperty(k,"__isScriptSetup",{enumerable:!1,value:!0}),k}}),[["render",function(F,t,C,e,b,N){var u;const s=B,r=Qe,v=tt,p=We,i=De,o=Je,g=K("mountedFocus");return n(),c(R,null,[a("div",Jn,[a("div",Zn,[a("div",{class:ne(["node-box",[{"node-config-error":!e.currentNode.showText},`${e.useTaskStatusClass((u=e.currentNode)==null?void 0:u.activityStatus)}`]])},[a("div",el,[t[5]||(t[5]=a("div",{class:"node-title-icon start-user"},[a("span",{class:"iconfont icon-start-user"})],-1)),!e.readonly&&e.showInput?$((n(),c("input",{key:0,type:"text",class:"editable-title-input",onBlur:t[0]||(t[0]=m=>e.blurEvent()),"onUpdate:modelValue":t[1]||(t[1]=m=>e.currentNode.name=m),placeholder:e.currentNode.name},null,40,tl)),[[g],[X,e.currentNode.name]]):(n(),c("div",{key:1,class:"node-title",onClick:t[2]||(t[2]=(...m)=>e.clickTitle&&e.clickTitle(...m))},I(e.currentNode.name),1))]),a("div",{class:"node-content",onClick:e.nodeClick},[e.currentNode.showText?(n(),c("div",{key:0,class:"node-text",title:e.currentNode.showText},I(e.currentNode.showText),9,nl)):(n(),c("div",ll,I(e.NODE_DEFAULT_TEXT.get(e.NodeType.START_USER_NODE)),1)),e.readonly?E("",!0):(n(),y(s,{key:2,icon:"ep:arrow-right-bold"}))])],2),e.currentNode?(n(),y(e.NodeHandler,{key:0,"child-node":e.currentNode.childNode,"onUpdate:childNode":t[3]||(t[3]=m=>e.currentNode.childNode=m),"current-node":e.currentNode},null,8,["child-node","current-node"])):E("",!0)])]),!e.readonly&&e.currentNode?(n(),y(e.StartUserNodeConfig,{key:0,ref:"nodeSetting","flow-node":e.currentNode},null,8,["flow-node"])):E("",!0),l(o,{title:e.dialogTitle||"\u5BA1\u6279\u8BB0\u5F55",modelValue:e.dialogVisible,"onUpdate:modelValue":t[4]||(t[4]=m=>e.dialogVisible=m),width:"1000px","append-to-body":""},{default:d(()=>[l(i,null,{default:d(()=>[l(p,{data:e.selectTasks,size:"small",border:"","header-cell-class-name":"table-header-gray"},{default:d(()=>[l(r,{label:"\u5E8F\u53F7","header-align":"center",align:"center",type:"index",width:"50"}),l(r,{label:"\u5BA1\u6279\u4EBA","min-width":"100",align:"center"},{default:d(m=>{var k,w;return[O(I(((k=m.row.assigneeUser)==null?void 0:k.nickname)||((w=m.row.ownerUser)==null?void 0:w.nickname)),1)]}),_:1}),l(r,{label:"\u90E8\u95E8","min-width":"100",align:"center"},{default:d(m=>{var k,w;return[O(I(((k=m.row.assigneeUser)==null?void 0:k.deptName)||((w=m.row.ownerUser)==null?void 0:w.deptName)),1)]}),_:1}),l(r,{formatter:e.dateFormatter,align:"center",label:"\u5F00\u59CB\u65F6\u95F4",prop:"createTime","min-width":"140"},null,8,["formatter"]),l(r,{formatter:e.dateFormatter,align:"center",label:"\u7ED3\u675F\u65F6\u95F4",prop:"endTime","min-width":"140"},null,8,["formatter"]),l(r,{align:"center",label:"\u5BA1\u6279\u72B6\u6001",prop:"status","min-width":"90"},{default:d(m=>[l(v,{type:e.DICT_TYPE.BPM_TASK_STATUS,value:m.row.status},null,8,["type","value"])]),_:1}),l(r,{align:"center",label:"\u5BA1\u6279\u5EFA\u8BAE",prop:"reason","min-width":"120"}),l(r,{align:"center",label:"\u8017\u65F6",prop:"durationInMillis",width:"100"},{default:d(m=>[O(I(e.formatPast2(m.row.durationInMillis)),1)]),_:1})]),_:1},8,["data"])]),_:1})]),_:1},8,["title","modelValue"])],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/components/SimpleProcessDesignerV2/src/nodes/StartUserNode.vue"]]),dl={class:"end-node-wrapper"},ol=G(q({name:"EndEventNode",__name:"EndEventNode",props:{flowNode:{type:Object,default:()=>null}},setup(F,{expose:t}){t();const C=F,e=W(C),b=j("readonly"),N=j("processInstance",A({})),s=A(!1),r=A([]),v={props:C,currentNode:e,readonly:b,processInstance:N,dialogVisible:s,processInstanceInfos:r,nodeClick:()=>{b&&N&&N.value&&(r.value=[{assigneeUser:N.value.startUser,createTime:N.value.startTime,endTime:N.value.endTime,status:N.value.status,durationInMillis:N.value.durationInMillis}],s.value=!0)},get useTaskStatusClass(){return ue},get dateFormatter(){return it},get formatPast2(){return rt},get DICT_TYPE(){return Ke}};return Object.defineProperty(v,"__isScriptSetup",{enumerable:!1,value:!0}),v}}),[["render",function(F,t,C,e,b,N){var o;const s=Qe,r=tt,v=We,p=De,i=Je;return n(),c(R,null,[a("div",dl,[a("div",{class:ne(["end-node-box cursor-pointer",`${e.useTaskStatusClass((o=e.currentNode)==null?void 0:o.activityStatus)}`]),onClick:e.nodeClick},t[1]||(t[1]=[a("span",{class:"node-fixed-name",title:"\u7ED3\u675F"},"\u7ED3\u675F",-1)]),2)]),l(i,{title:"\u5BA1\u6279\u4FE1\u606F",modelValue:e.dialogVisible,"onUpdate:modelValue":t[0]||(t[0]=g=>e.dialogVisible=g),width:"1000px","append-to-body":""},{default:d(()=>[l(p,null,{default:d(()=>[l(v,{data:e.processInstanceInfos,size:"small",border:"","header-cell-class-name":"table-header-gray"},{default:d(()=>[l(s,{label:"\u5E8F\u53F7","header-align":"center",align:"center",type:"index",width:"50"}),l(s,{label:"\u53D1\u8D77\u4EBA",prop:"assigneeUser.nickname","min-width":"100",align:"center"}),l(s,{label:"\u90E8\u95E8","min-width":"100",align:"center"},{default:d(g=>{var u,m;return[O(I(((u=g.row.assigneeUser)==null?void 0:u.deptName)||((m=g.row.ownerUser)==null?void 0:m.deptName)),1)]}),_:1}),l(s,{formatter:e.dateFormatter,align:"center",label:"\u5F00\u59CB\u65F6\u95F4",prop:"createTime","min-width":"140"},null,8,["formatter"]),l(s,{formatter:e.dateFormatter,align:"center",label:"\u7ED3\u675F\u65F6\u95F4",prop:"endTime","min-width":"140"},null,8,["formatter"]),l(s,{align:"center",label:"\u5BA1\u6279\u72B6\u6001",prop:"status","min-width":"90"},{default:d(g=>[l(r,{type:e.DICT_TYPE.BPM_PROCESS_INSTANCE_STATUS,value:g.row.status},null,8,["type","value"])]),_:1}),l(s,{align:"center",label:"\u8017\u65F6",prop:"durationInMillis",width:"100"},{default:d(g=>[O(I(e.formatPast2(g.row.durationInMillis)),1)]),_:1})]),_:1},8,["data"])]),_:1})]),_:1},8,["modelValue"])],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/components/SimpleProcessDesignerV2/src/nodes/EndEventNode.vue"]]),il={class:"mr-2"},rl={class:"mr-2"},sl={class:"mr-2"},ul={class:"mr-1 flex items-center"},cl={class:"mr-2"},pl={class:"mr-2"},ml={class:"mr-2"},vl={class:"mr-1 flex items-center"},Kt=G(q({name:"HttpRequestParamSetting",__name:"HttpRequestParamSetting",props:{header:{type:Array,required:!1,default:()=>[]},body:{type:Array,required:!1,default:()=>[]},bind:{type:String,required:!0}},setup(F,{expose:t}){t();const C={props:F,formFieldOptions:ot(),addHttpRequestParam:e=>{e.push({key:"",type:Lt.FIXED_VALUE,value:""})},deleteHttpRequestParam:(e,b)=>{e.splice(b,1)},get BPM_HTTP_REQUEST_PARAM_TYPES(){return bn},get BpmHttpRequestParamTypeEnum(){return Lt}};return Object.defineProperty(C,"__isScriptSetup",{enumerable:!1,value:!0}),C}}),[["render",function(F,t,C,e,b,N){const s=Te,r=fe,v=ge,p=ye,i=B,o=ae;return n(),c(R,null,[l(r,{label:"\u8BF7\u6C42\u5934"},{default:d(()=>[(n(!0),c(R,null,x(e.props.header,(g,u)=>(n(),c("div",{class:"flex pt-2",key:u},[a("div",il,[l(r,{prop:`${C.bind}.header.${u}.key`,rules:{required:!0,message:"\u53C2\u6570\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}},{default:d(()=>[l(s,{class:"w-160px",modelValue:g.key,"onUpdate:modelValue":m=>g.key=m},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"])]),a("div",rl,[l(p,{class:"w-100px!",modelValue:g.type,"onUpdate:modelValue":m=>g.type=m},{default:d(()=>[(n(!0),c(R,null,x(e.BPM_HTTP_REQUEST_PARAM_TYPES,m=>(n(),y(v,{key:m.value,label:m.label,value:m.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),a("div",sl,[l(r,{prop:`${C.bind}.header.${u}.value`,rules:{required:!0,message:"\u53C2\u6570\u503C\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}},{default:d(()=>[g.type===e.BpmHttpRequestParamTypeEnum.FIXED_VALUE?(n(),y(s,{key:0,class:"w-160px",modelValue:g.value,"onUpdate:modelValue":m=>g.value=m},null,8,["modelValue","onUpdate:modelValue"])):E("",!0)]),_:2},1032,["prop"]),l(r,{prop:`${C.bind}.header.${u}.value`,rules:{required:!0,message:"\u53C2\u6570\u503C\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}},{default:d(()=>[g.type===e.BpmHttpRequestParamTypeEnum.FROM_FORM?(n(),y(p,{key:0,class:"w-160px!",modelValue:g.value,"onUpdate:modelValue":m=>g.value=m},{default:d(()=>[(n(!0),c(R,null,x(e.formFieldOptions,(m,k)=>(n(),y(v,{key:k,label:m.title,value:m.field,disabled:!m.required},null,8,["label","value","disabled"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):E("",!0)]),_:2},1032,["prop"])]),a("div",ul,[l(i,{icon:"ep:delete",size:18,onClick:m=>e.deleteHttpRequestParam(e.props.header,u)},null,8,["onClick"])])]))),128)),l(o,{type:"primary",text:"",onClick:t[0]||(t[0]=g=>e.addHttpRequestParam(e.props.header))},{default:d(()=>[l(i,{icon:"ep:plus",class:"mr-5px"}),t[2]||(t[2]=O("\u6DFB\u52A0\u4E00\u884C "))]),_:1})]),_:1}),l(r,{label:"\u8BF7\u6C42\u4F53"},{default:d(()=>[(n(!0),c(R,null,x(e.props.body,(g,u)=>(n(),c("div",{class:"flex pt-2",key:u},[a("div",cl,[l(r,{prop:`${C.bind}.body.${u}.key`,rules:{required:!0,message:"\u53C2\u6570\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}},{default:d(()=>[l(s,{class:"w-160px",modelValue:g.key,"onUpdate:modelValue":m=>g.key=m},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"])]),a("div",pl,[l(p,{class:"w-100px!",modelValue:g.type,"onUpdate:modelValue":m=>g.type=m},{default:d(()=>[(n(!0),c(R,null,x(e.BPM_HTTP_REQUEST_PARAM_TYPES,m=>(n(),y(v,{key:m.value,label:m.label,value:m.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),a("div",ml,[l(r,{prop:`${C.bind}.body.${u}.value`,rules:{required:!0,message:"\u53C2\u6570\u503C\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}},{default:d(()=>[g.type===e.BpmHttpRequestParamTypeEnum.FIXED_VALUE?(n(),y(s,{key:0,class:"w-160px",modelValue:g.value,"onUpdate:modelValue":m=>g.value=m},null,8,["modelValue","onUpdate:modelValue"])):E("",!0)]),_:2},1032,["prop"]),l(r,{prop:`${C.bind}.body.${u}.value`,rules:{required:!0,message:"\u53C2\u6570\u503C\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}},{default:d(()=>[g.type===e.BpmHttpRequestParamTypeEnum.FROM_FORM?(n(),y(p,{key:0,class:"w-160px!",modelValue:g.value,"onUpdate:modelValue":m=>g.value=m},{default:d(()=>[(n(!0),c(R,null,x(e.formFieldOptions,(m,k)=>(n(),y(v,{key:k,label:m.title,value:m.field,disabled:!m.required},null,8,["label","value","disabled"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):E("",!0)]),_:2},1032,["prop"])]),a("div",vl,[l(i,{icon:"ep:delete",size:18,onClick:m=>e.deleteHttpRequestParam(e.props.body,u)},null,8,["onClick"])])]))),128)),l(o,{type:"primary",text:"",onClick:t[1]||(t[1]=g=>e.addHttpRequestParam(e.props.body))},{default:d(()=>[l(i,{icon:"ep:plus",class:"mr-5px"}),t[3]||(t[3]=O("\u6DFB\u52A0\u4E00\u884C "))]),_:1})]),_:1})],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/components/SimpleProcessDesignerV2/src/nodes-config/components/HttpRequestParamSetting.vue"]]),fl={key:0},gl=G(q({__name:"UserTaskListener",props:{modelValue:{type:Object,required:!0},formFieldOptions:{type:Object,required:!0}},emits:["update:modelValue"],setup(F,{expose:t,emit:C}){const e=F,b=C,N=A(),s=Z({get:()=>e.modelValue,set(i){b("update:modelValue",i)}}),r=A([{name:"\u521B\u5EFA\u4EFB\u52A1",type:"Create"},{name:"\u6307\u6D3E\u4EFB\u52A1\u6267\u884C\u4EBA\u5458",type:"Assign"},{name:"\u5B8C\u6210\u4EFB\u52A1",type:"Complete"}]),v=async()=>!!N&&await N.value.validate();t({validate:v});const p={props:e,emit:b,listenerFormRef:N,configForm:s,taskListener:r,validate:v,HttpRequestParamSetting:Kt};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}}),[["render",function(F,t,C,e,b,N){const s=qe,r=me,v=Ze,p=fe,i=It,o=Te,g=Ne;return n(),y(g,{ref:"listenerFormRef",model:e.configForm,"label-position":"top"},{default:d(()=>[(n(!0),c(R,null,x(e.taskListener,(u,m)=>(n(),c("div",{key:m},[l(r,{"content-position":"left"},{default:d(()=>[l(s,{tag:"b",size:"large"},{default:d(()=>[O(I(u.name),1)]),_:2},1024)]),_:2},1024),l(p,null,{default:d(()=>[l(v,{modelValue:e.configForm[`task${u.type}ListenerEnable`],"onUpdate:modelValue":k=>e.configForm[`task${u.type}ListenerEnable`]=k,"active-text":"\u5F00\u542F","inactive-text":"\u5173\u95ED"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e.configForm[`task${u.type}ListenerEnable`]?(n(),c("div",fl,[l(p,null,{default:d(()=>[l(i,{title:"\u4EC5\u652F\u6301 POST \u8BF7\u6C42\uFF0C\u4EE5\u8BF7\u6C42\u4F53\u65B9\u5F0F\u63A5\u6536\u53C2\u6570",type:"warning","show-icon":"",closable:!1})]),_:1}),l(p,{label:"\u8BF7\u6C42\u5730\u5740",prop:`task${u.type}ListenerPath`,rules:{required:!0,message:"\u8BF7\u6C42\u5730\u5740\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}},{default:d(()=>[l(o,{modelValue:e.configForm[`task${u.type}ListenerPath`],"onUpdate:modelValue":k=>e.configForm[`task${u.type}ListenerPath`]=k},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"]),l(e.HttpRequestParamSetting,{header:e.configForm[`task${u.type}Listener`].header,body:e.configForm[`task${u.type}Listener`].body,bind:`task${u.type}Listener`},null,8,["header","body","bind"])])):E("",!0)]))),128))]),_:1},8,["model"])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/components/SimpleProcessDesignerV2/src/nodes-config/components/UserTaskListener.vue"]]),yl={class:"config-header"},Nl=["placeholder"],_l={key:1,class:"node-name"},Tl={class:"flex flex-items-center mb-3"},bl={class:"flex-col"},hl={class:"flex-col"},El={class:"flex-col"},kl={class:"flex-col"},Sl={class:"button-setting-pane"},Cl={class:"button-setting-item-label"},wl={class:"button-setting-item-label"},Ul=["onBlur","onUpdate:modelValue","placeholder"],Vl={class:"button-setting-item-label"},Fl={class:"field-setting-pane"},Dl={class:"field-setting-item-label"},Rl={class:"item-radio-wrap"},Ol={class:"item-radio-wrap"},Il={class:"item-radio-wrap"},Pl=G(q({name:"UserTaskNodeConfig",__name:"UserTaskNodeConfig",props:{flowNode:{type:Object,required:!0}},emits:["find:returnTaskNodes"],setup(F,{expose:t,emit:C}){const e=F,b=C,N=Z(()=>{let D="\u90E8\u95E8\u8D1F\u8D23\u4EBA\u6765\u6E90";return U.value.candidateStrategy==Ee.MULTI_LEVEL_DEPT_LEADER?D+="(\u6307\u5B9A\u90E8\u95E8\u5411\u4E0A)":U.value.candidateStrategy==Ee.FORM_DEPT_LEADER?D+="(\u8868\u5355\u5185\u90E8\u95E8\u5411\u4E0A)":D+="(\u53D1\u8D77\u4EBA\u90E8\u95E8\u5411\u4E0A)",D}),s=W(e),{settingVisible:r,closeDrawer:v,openDrawer:p}=Se(),{nodeName:i,showInput:o,clickIcon:g,blurEvent:u}=Ce(V.USER_TASK_NODE),m=A("user"),{formType:k,fieldsPermissionConfig:w,formFieldOptions:_,getNodeConfigFormFields:S}=dt(he.READ),P=Z(()=>(_.unshift({field:hn.START_USER_ID,title:"\u53D1\u8D77\u4EBA",type:"UserSelect",required:!0}),_.filter(D=>D.type==="UserSelect"))),h=Z(()=>_.filter(D=>D.type==="DeptSelect")),{buttonsSetting:T,btnDisplayNameEdit:L,changeBtnDisplayName:J,btnDisplayNameBlurEvent:pe}=yt(),z=A(Pe.USER),f=A(),H=Re({candidateStrategy:[{required:!0,message:"\u5BA1\u6279\u4EBA\u8BBE\u7F6E\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],userIds:[{required:!0,message:"\u7528\u6237\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],roleIds:[{required:!0,message:"\u89D2\u8272\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],deptIds:[{required:!0,message:"\u90E8\u95E8\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],userGroups:[{required:!0,message:"\u7528\u6237\u7EC4\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],formUser:[{required:!0,message:"\u8868\u5355\u5185\u7528\u6237\u5B57\u6BB5\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],formDept:[{required:!0,message:"\u8868\u5355\u5185\u90E8\u95E8\u5B57\u6BB5\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],postIds:[{required:!0,message:"\u5C97\u4F4D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],expression:[{required:!0,message:"\u6D41\u7A0B\u8868\u8FBE\u5F0F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],approveMethod:[{required:!0,message:"\u591A\u4EBA\u5BA1\u6279\u65B9\u5F0F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],approveRatio:[{required:!0,message:"\u901A\u8FC7\u6BD4\u4F8B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],returnNodeId:[{required:!0,message:"\u9A73\u56DE\u8282\u70B9\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],timeoutHandlerEnable:[{required:!0}],timeoutHandlerType:[{required:!0}],timeDuration:[{required:!0,message:"\u8D85\u65F6\u65F6\u95F4\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],maxRemindCount:[{required:!0,message:"\u63D0\u9192\u6B21\u6570\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],assignEmptyHandlerType:[{required:!0}],assignEmptyHandlerUserIds:[{required:!0,message:"\u7528\u6237\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],assignStartUserHandlerType:[{required:!0}]}),{configForm:Q,roleOptions:xe,postOptions:te,userOptions:ze,userGroupOptions:Ae,deptTreeOptions:Le,handleCandidateParam:M,parseCandidateParam:st,getShowText:ut}=jt(V.USER_TASK_NODE),U=Q,ct=A([]),{timeoutHandlerChange:Jt,cTimeoutType:pt,timeoutHandlerTypeChanged:Zt,timeUnit:mt,timeUnitChange:en,isoTimeDuration:vt,cTimeoutMaxRemindCount:ft}=Nt(),Ye=A(),gt=D=>{var le,oe,re,Ue,Ve,Tt,bt,ht,Et,kt,St,Ct,wt,Ut,Vt,Ft,Dt,Rt,Ot;if(i.value=D.name,z.value=D.approveType?D.approveType:Pe.USER,z.value!==Pe.USER)return;U.value.candidateStrategy=D.candidateStrategy,st(D.candidateStrategy,D==null?void 0:D.candidateParam),U.value.approveMethod=D.approveMethod,D.approveMethod==be.APPROVE_BY_RATIO&&(U.value.approveRatio=D.approveRatio),U.value.rejectHandlerType=D.rejectHandler.type,U.value.returnNodeId=(le=D.rejectHandler)==null?void 0:le.returnNodeId;const de=[];if(b("find:returnTaskNodes",de),ct.value=de,U.value.timeoutHandlerEnable=D.timeoutHandler.enable,((oe=D.timeoutHandler)==null?void 0:oe.enable)&&((re=D.timeoutHandler)==null?void 0:re.timeDuration)){const He=D.timeoutHandler.timeDuration;let tn=He.slice(2,He.length-1),nn=He.slice(He.length-1);U.value.timeDuration=parseInt(tn),mt.value=zt(nn)}U.value.timeoutHandlerType=(Ue=D.timeoutHandler)==null?void 0:Ue.type,U.value.maxRemindCount=(Ve=D.timeoutHandler)==null?void 0:Ve.maxRemindCount,U.value.assignEmptyHandlerType=(Tt=D.assignEmptyHandler)==null?void 0:Tt.type,U.value.assignEmptyHandlerUserIds=(bt=D.assignEmptyHandler)==null?void 0:bt.userIds,U.value.assignStartUserHandlerType=D.assignStartUserHandlerType,T.value=on(D.buttonsSetting)||En,S(D.fieldsPermission),U.value.taskCreateListenerEnable=(ht=D.taskCreateListener)==null?void 0:ht.enable,U.value.taskCreateListenerPath=(Et=D.taskCreateListener)==null?void 0:Et.path,U.value.taskCreateListener={header:((kt=D.taskCreateListener)==null?void 0:kt.header)??[],body:((St=D.taskCreateListener)==null?void 0:St.body)??[]},U.value.taskAssignListenerEnable=(Ct=D.taskAssignListener)==null?void 0:Ct.enable,U.value.taskAssignListenerPath=(wt=D.taskAssignListener)==null?void 0:wt.path,U.value.taskAssignListener={header:((Ut=D.taskAssignListener)==null?void 0:Ut.header)??[],body:((Vt=D.taskAssignListener)==null?void 0:Vt.body)??[]},U.value.taskCompleteListenerEnable=(Ft=D.taskCompleteListener)==null?void 0:Ft.enable,U.value.taskCompleteListenerPath=(Dt=D.taskCompleteListener)==null?void 0:Dt.path,U.value.taskCompleteListener={header:((Rt=D.taskCompleteListener)==null?void 0:Rt.header)??[],body:((Ot=D.taskCompleteListener)==null?void 0:Ot.body)??[]},U.value.signEnable=(D==null?void 0:D.signEnable)??!1,U.value.reasonRequire=(D==null?void 0:D.reasonRequire)??!1};function yt(){const D=A(),de=A([]);return{buttonsSetting:D,btnDisplayNameEdit:de,changeBtnDisplayName:le=>{de.value[le]=!0},btnDisplayNameBlurEvent:le=>{de.value[le]=!1;const oe=D.value[le];oe.displayName=oe.displayName||Mt.get(oe.id)}}}function Nt(){const D=A(ie.HOUR),de=Z(()=>{if(U.value.timeoutHandlerEnable)return U.value.timeoutHandlerType}),le=Z(()=>{if(!U.value.timeoutHandlerEnable)return;let re="PT";return D.value===ie.MINUTE&&(re+=U.value.timeDuration+"M"),D.value===ie.HOUR&&(re+=U.value.timeDuration+"H"),D.value===ie.DAY&&(re+=U.value.timeDuration+"D"),re}),oe=Z(()=>{if(U.value.timeoutHandlerEnable&&U.value.timeoutHandlerType===Ht.REMINDER)return U.value.maxRemindCount});return{timeoutHandlerChange:()=>{U.value.timeoutHandlerEnable&&(D.value=2,U.value.timeDuration=6,U.value.timeoutHandlerType=1,U.value.maxRemindCount=1)},cTimeoutType:de,timeoutHandlerTypeChanged:()=>{U.value.timeoutHandlerType===Ht.REMINDER&&(U.value.maxRemindCount=1)},timeUnit:D,timeUnitChange:()=>{D.value===ie.MINUTE&&(U.value.timeDuration=60),D.value===ie.HOUR&&(U.value.timeDuration=6),D.value===ie.DAY&&(U.value.timeDuration=1)},isoTimeDuration:le,cTimeoutMaxRemindCount:oe}}t({openDrawer:p,showUserTaskNodeConfig:gt});const _t={props:e,emits:b,deptLevelLabel:N,currentNode:s,settingVisible:r,closeDrawer:v,openDrawer:p,nodeName:i,showInput:o,clickIcon:g,blurEvent:u,activeTabName:m,formType:k,fieldsPermissionConfig:w,formFieldOptions:_,getNodeConfigFormFields:S,userFieldOnFormOptions:P,deptFieldOnFormOptions:h,buttonsSetting:T,btnDisplayNameEdit:L,changeBtnDisplayName:J,btnDisplayNameBlurEvent:pe,approveType:z,formRef:f,formRules:H,tempConfigForm:Q,roleOptions:xe,postOptions:te,userOptions:ze,userGroupOptions:Ae,deptTreeOptions:Le,handleCandidateParam:M,parseCandidateParam:st,getShowText:ut,configForm:U,changeCandidateStrategy:()=>{U.value.userIds=[],U.value.deptIds=[],U.value.roleIds=[],U.value.postIds=[],U.value.userGroups=[],U.value.deptLevel=1,U.value.formUser="",U.value.formDept="",U.value.approveMethod=be.SEQUENTIAL_APPROVE},approveMethodChanged:()=>{U.value.rejectHandlerType=nt.FINISH_PROCESS,U.value.approveMethod===be.APPROVE_BY_RATIO&&(U.value.approveRatio=100),f.value.clearValidate("approveRatio")},returnTaskList:ct,timeoutHandlerChange:Jt,cTimeoutType:pt,timeoutHandlerTypeChanged:Zt,timeUnit:mt,timeUnitChange:en,isoTimeDuration:vt,cTimeoutMaxRemindCount:ft,userTaskListenerRef:Ye,saveConfig:async()=>{var de,le,oe,re,Ue,Ve;if(s.value.name=i.value,s.value.approveType=z.value,z.value!==Pe.USER)return s.value.showText=On(z.value),r.value=!1,!0;if(!f||!Ye||!(await f.value.validate()&&await Ye.value.validate()))return!1;const D=ut();return!!D&&(s.value.candidateStrategy=U.value.candidateStrategy,s.value.candidateParam=M(),s.value.approveMethod=U.value.approveMethod,U.value.approveMethod===be.APPROVE_BY_RATIO&&(s.value.approveRatio=U.value.approveRatio),s.value.rejectHandler={type:U.value.rejectHandlerType,returnNodeId:U.value.returnNodeId},s.value.timeoutHandler={enable:U.value.timeoutHandlerEnable,type:pt.value,timeDuration:vt.value,maxRemindCount:ft.value},s.value.assignEmptyHandler={type:U.value.assignEmptyHandlerType,userIds:U.value.assignEmptyHandlerType===lt.ASSIGN_USER?U.value.assignEmptyHandlerUserIds:void 0},s.value.assignStartUserHandlerType=U.value.assignStartUserHandlerType,s.value.fieldsPermission=w.value,s.value.buttonsSetting=T.value,s.value.taskCreateListener={enable:U.value.taskCreateListenerEnable??!1,path:U.value.taskCreateListenerPath,header:(de=U.value.taskCreateListener)==null?void 0:de.header,body:(le=U.value.taskCreateListener)==null?void 0:le.body},s.value.taskAssignListener={enable:U.value.taskAssignListenerEnable??!1,path:U.value.taskAssignListenerPath,header:(oe=U.value.taskAssignListener)==null?void 0:oe.header,body:(re=U.value.taskAssignListener)==null?void 0:re.body},s.value.taskCompleteListener={enable:U.value.taskCompleteListenerEnable??!1,path:U.value.taskCompleteListenerPath,header:(Ue=U.value.taskCompleteListener)==null?void 0:Ue.header,body:(Ve=U.value.taskCompleteListener)==null?void 0:Ve.body},s.value.signEnable=U.value.signEnable,s.value.reasonRequire=U.value.reasonRequire,s.value.showText=D,r.value=!1,!0)},showUserTaskNodeConfig:gt,useButtonsSetting:yt,useTimeoutHandler:Nt,get APPROVE_TYPE(){return kn},get ApproveType(){return Pe},get APPROVE_METHODS(){return Sn},get CandidateStrategy(){return Ee},get ApproveMethodType(){return be},get RejectHandlerType(){return nt},get TIMEOUT_HANDLER_TYPES(){return Cn},get TIME_UNIT_TYPES(){return at},get REJECT_HANDLER_TYPES(){return wn},get OPERATION_BUTTON_NAME(){return Mt},get MULTI_LEVEL_DEPT(){return qt},get CANDIDATE_STRATEGY(){return Gt},get ASSIGN_START_USER_HANDLER_TYPES(){return Un},get ASSIGN_EMPTY_HANDLER_TYPES(){return Vn},get AssignEmptyHandlerType(){return lt},get FieldPermissionType(){return he},get defaultProps(){return Xt},UserTaskListener:gl};return Object.defineProperty(_t,"__isScriptSetup",{enumerable:!1,value:!0}),_t}}),[["render",function(F,t,C,e,b,N){const s=B,r=Ge,v=Fe,p=rn,i=De,o=fe,g=ge,u=ye,m=$t,k=Te,w=Pt,_=me,S=Ze,P=xt,h=Ne,T=$e,L=ae,J=Xe,pe=_e,z=K("mountedFocus");return n(),y(pe,{"append-to-body":!0,modelValue:e.settingVisible,"onUpdate:modelValue":t[30]||(t[30]=f=>e.settingVisible=f),"show-close":!1,size:580,"before-close":e.saveConfig,class:"justify-start"},{header:d(()=>[a("div",yl,[e.showInput?$((n(),c("input",{key:0,type:"text",class:"config-editable-input",onBlur:t[0]||(t[0]=f=>e.blurEvent()),"onUpdate:modelValue":t[1]||(t[1]=f=>e.nodeName=f),placeholder:e.nodeName},null,40,Nl)),[[z],[X,e.nodeName]]):(n(),c("div",_l,[O(I(e.nodeName)+" ",1),l(s,{class:"ml-1",icon:"ep:edit-pen",size:16,onClick:t[2]||(t[2]=f=>e.clickIcon())})])),t[31]||(t[31]=a("div",{class:"divide-line"},null,-1))])]),footer:d(()=>[l(_),a("div",null,[l(L,{type:"primary",onClick:e.saveConfig},{default:d(()=>t[48]||(t[48]=[O("\u786E \u5B9A")])),_:1}),l(L,{onClick:e.closeDrawer},{default:d(()=>t[49]||(t[49]=[O("\u53D6 \u6D88")])),_:1},8,["onClick"])])]),default:d(()=>[a("div",Tl,[t[32]||(t[32]=a("span",{class:"font-size-16px mr-3"},"\u5BA1\u6279\u7C7B\u578B :",-1)),l(v,{modelValue:e.approveType,"onUpdate:modelValue":t[3]||(t[3]=f=>e.approveType=f)},{default:d(()=>[(n(!0),c(R,null,x(e.APPROVE_TYPE,(f,H)=>(n(),y(r,{key:H,value:f.value,label:f.value},{default:d(()=>[O(I(f.label),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])]),e.approveType===e.ApproveType.USER?(n(),y(J,{key:0,type:"border-card",modelValue:e.activeTabName,"onUpdate:modelValue":t[29]||(t[29]=f=>e.activeTabName=f)},{default:d(()=>[l(T,{label:"\u5BA1\u6279\u4EBA",name:"user"},{default:d(()=>[a("div",null,[l(h,{ref:"formRef",model:e.configForm,"label-position":"top",rules:e.formRules},{default:d(()=>[l(o,{label:"\u5BA1\u6279\u4EBA\u8BBE\u7F6E",prop:"candidateStrategy"},{default:d(()=>[l(v,{modelValue:e.configForm.candidateStrategy,"onUpdate:modelValue":t[4]||(t[4]=f=>e.configForm.candidateStrategy=f),onChange:e.changeCandidateStrategy},{default:d(()=>[l(i,null,{default:d(()=>[(n(!0),c(R,null,x(e.CANDIDATE_STRATEGY,(f,H)=>(n(),y(p,{key:H,span:8},{default:d(()=>[l(r,{value:f.value,label:f.value},{default:d(()=>[O(I(f.label),1)]),_:2},1032,["value","label"])]),_:2},1024))),128))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e.configForm.candidateStrategy==e.CandidateStrategy.ROLE?(n(),y(o,{key:0,label:"\u6307\u5B9A\u89D2\u8272",prop:"roleIds"},{default:d(()=>[l(u,{filterable:"",modelValue:e.configForm.roleIds,"onUpdate:modelValue":t[5]||(t[5]=f=>e.configForm.roleIds=f),clearable:"",multiple:"",style:{width:"100%"}},{default:d(()=>[(n(!0),c(R,null,x(e.roleOptions,f=>(n(),y(g,{key:f.id,label:f.name,value:f.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):E("",!0),e.configForm.candidateStrategy==e.CandidateStrategy.DEPT_MEMBER||e.configForm.candidateStrategy==e.CandidateStrategy.DEPT_LEADER||e.configForm.candidateStrategy==e.CandidateStrategy.MULTI_LEVEL_DEPT_LEADER?(n(),y(o,{key:1,label:"\u6307\u5B9A\u90E8\u95E8",prop:"deptIds",span:"24"},{default:d(()=>[l(m,{ref:"treeRef",modelValue:e.configForm.deptIds,"onUpdate:modelValue":t[6]||(t[6]=f=>e.configForm.deptIds=f),data:e.deptTreeOptions,props:e.defaultProps,"empty-text":"\u52A0\u8F7D\u4E2D\uFF0C\u8BF7\u7A0D\u540E",multiple:"","node-key":"id","check-strictly":!0,style:{width:"100%"},"show-checkbox":""},null,8,["modelValue","data","props"])]),_:1})):E("",!0),e.configForm.candidateStrategy==e.CandidateStrategy.POST?(n(),y(o,{key:2,label:"\u6307\u5B9A\u5C97\u4F4D",prop:"postIds",span:"24"},{default:d(()=>[l(u,{filterable:"",modelValue:e.configForm.postIds,"onUpdate:modelValue":t[7]||(t[7]=f=>e.configForm.postIds=f),clearable:"",multiple:"",style:{width:"100%"}},{default:d(()=>[(n(!0),c(R,null,x(e.postOptions,f=>(n(),y(g,{key:f.id,label:f.name,value:f.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):E("",!0),e.configForm.candidateStrategy==e.CandidateStrategy.USER?(n(),y(o,{key:3,label:"\u6307\u5B9A\u7528\u6237",prop:"userIds",span:"24"},{default:d(()=>[l(u,{filterable:"",modelValue:e.configForm.userIds,"onUpdate:modelValue":t[8]||(t[8]=f=>e.configForm.userIds=f),clearable:"",multiple:"",style:{width:"100%"}},{default:d(()=>[(n(!0),c(R,null,x(e.userOptions,f=>(n(),y(g,{key:f.id,label:f.nickname,value:f.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):E("",!0),e.configForm.candidateStrategy===e.CandidateStrategy.USER_GROUP?(n(),y(o,{key:4,label:"\u6307\u5B9A\u7528\u6237\u7EC4",prop:"userGroups"},{default:d(()=>[l(u,{filterable:"",modelValue:e.configForm.userGroups,"onUpdate:modelValue":t[9]||(t[9]=f=>e.configForm.userGroups=f),clearable:"",multiple:"",style:{width:"100%"}},{default:d(()=>[(n(!0),c(R,null,x(e.userGroupOptions,f=>(n(),y(g,{key:f.id,label:f.name,value:f.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):E("",!0),e.configForm.candidateStrategy===e.CandidateStrategy.FORM_USER?(n(),y(o,{key:5,label:"\u8868\u5355\u5185\u7528\u6237\u5B57\u6BB5",prop:"formUser"},{default:d(()=>[l(u,{filterable:"",modelValue:e.configForm.formUser,"onUpdate:modelValue":t[10]||(t[10]=f=>e.configForm.formUser=f),clearable:"",style:{width:"100%"}},{default:d(()=>[(n(!0),c(R,null,x(e.userFieldOnFormOptions,(f,H)=>(n(),y(g,{key:H,label:f.title,value:f.field,disabled:!f.required},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1})):E("",!0),e.configForm.candidateStrategy===e.CandidateStrategy.FORM_DEPT_LEADER?(n(),y(o,{key:6,label:"\u8868\u5355\u5185\u90E8\u95E8\u5B57\u6BB5",prop:"formDept"},{default:d(()=>[l(u,{filterable:"",modelValue:e.configForm.formDept,"onUpdate:modelValue":t[11]||(t[11]=f=>e.configForm.formDept=f),clearable:"",style:{width:"100%"}},{default:d(()=>[(n(!0),c(R,null,x(e.deptFieldOnFormOptions,(f,H)=>(n(),y(g,{key:H,label:f.title,value:f.field,disabled:!f.required},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1})):E("",!0),e.configForm.candidateStrategy==e.CandidateStrategy.MULTI_LEVEL_DEPT_LEADER||e.configForm.candidateStrategy==e.CandidateStrategy.START_USER_DEPT_LEADER||e.configForm.candidateStrategy==e.CandidateStrategy.START_USER_MULTI_LEVEL_DEPT_LEADER||e.configForm.candidateStrategy==e.CandidateStrategy.FORM_DEPT_LEADER?(n(),y(o,{key:7,label:e.deptLevelLabel,prop:"deptLevel",span:"24"},{default:d(()=>[l(u,{filterable:"",modelValue:e.configForm.deptLevel,"onUpdate:modelValue":t[12]||(t[12]=f=>e.configForm.deptLevel=f),clearable:""},{default:d(()=>[(n(!0),c(R,null,x(e.MULTI_LEVEL_DEPT,(f,H)=>(n(),y(g,{key:H,label:f.label,value:f.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])):E("",!0),e.configForm.candidateStrategy===e.CandidateStrategy.EXPRESSION?(n(),y(o,{key:8,label:"\u6D41\u7A0B\u8868\u8FBE\u5F0F",prop:"expression"},{default:d(()=>[l(k,{type:"textarea",modelValue:e.configForm.expression,"onUpdate:modelValue":t[13]||(t[13]=f=>e.configForm.expression=f),clearable:"",style:{width:"100%"}},null,8,["modelValue"])]),_:1})):E("",!0),l(o,{label:"\u591A\u4EBA\u5BA1\u6279\u65B9\u5F0F",prop:"approveMethod"},{default:d(()=>[l(v,{modelValue:e.configForm.approveMethod,"onUpdate:modelValue":t[15]||(t[15]=f=>e.configForm.approveMethod=f),onChange:e.approveMethodChanged},{default:d(()=>[a("div",bl,[(n(!0),c(R,null,x(e.APPROVE_METHODS,(f,H)=>(n(),c("div",{key:H,class:"flex items-center"},[l(r,{value:f.value,label:f.value},{default:d(()=>[O(I(f.label),1)]),_:2},1032,["value","label"]),l(o,{prop:"approveRatio"},{default:d(()=>[f.value===e.ApproveMethodType.APPROVE_BY_RATIO&&e.configForm.approveMethod===e.ApproveMethodType.APPROVE_BY_RATIO?(n(),y(w,{key:0,modelValue:e.configForm.approveRatio,"onUpdate:modelValue":t[14]||(t[14]=Q=>e.configForm.approveRatio=Q),min:10,max:100,step:10,size:"small"},null,8,["modelValue"])):E("",!0)]),_:2},1024)]))),128))])]),_:1},8,["modelValue"])]),_:1}),l(_,{"content-position":"left"},{default:d(()=>t[33]||(t[33]=[O("\u5BA1\u6279\u4EBA\u62D2\u7EDD\u65F6")])),_:1}),l(o,{prop:"rejectHandlerType"},{default:d(()=>[l(v,{modelValue:e.configForm.rejectHandlerType,"onUpdate:modelValue":t[16]||(t[16]=f=>e.configForm.rejectHandlerType=f)},{default:d(()=>[a("div",hl,[(n(!0),c(R,null,x(e.REJECT_HANDLER_TYPES,(f,H)=>(n(),c("div",{key:H},[(n(),y(r,{key:f.value,value:f.value,label:f.label},null,8,["value","label"]))]))),128))])]),_:1},8,["modelValue"])]),_:1}),e.configForm.rejectHandlerType==e.RejectHandlerType.RETURN_USER_TASK?(n(),y(o,{key:9,label:"\u9A73\u56DE\u8282\u70B9",prop:"returnNodeId"},{default:d(()=>[l(u,{filterable:"",modelValue:e.configForm.returnNodeId,"onUpdate:modelValue":t[17]||(t[17]=f=>e.configForm.returnNodeId=f),clearable:"",style:{width:"100%"}},{default:d(()=>[(n(!0),c(R,null,x(e.returnTaskList,f=>(n(),y(g,{key:f.id,label:f.name,value:f.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):E("",!0),l(_,{"content-position":"left"},{default:d(()=>t[34]||(t[34]=[O("\u5BA1\u6279\u4EBA\u8D85\u65F6\u672A\u5904\u7406\u65F6")])),_:1}),l(o,{label:"\u542F\u7528\u5F00\u5173",prop:"timeoutHandlerEnable"},{default:d(()=>[l(S,{modelValue:e.configForm.timeoutHandlerEnable,"onUpdate:modelValue":t[18]||(t[18]=f=>e.configForm.timeoutHandlerEnable=f),"active-text":"\u5F00\u542F","inactive-text":"\u5173\u95ED",onChange:e.timeoutHandlerChange},null,8,["modelValue","onChange"])]),_:1}),e.configForm.timeoutHandlerEnable?(n(),y(o,{key:10,label:"\u6267\u884C\u52A8\u4F5C",prop:"timeoutHandlerType"},{default:d(()=>[l(v,{modelValue:e.configForm.timeoutHandlerType,"onUpdate:modelValue":t[19]||(t[19]=f=>e.configForm.timeoutHandlerType=f),onChange:e.timeoutHandlerTypeChanged},{default:d(()=>[(n(!0),c(R,null,x(e.TIMEOUT_HANDLER_TYPES,f=>(n(),y(P,{key:f.value,value:f.value,label:f.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue","onChange"])]),_:1})):E("",!0),e.configForm.timeoutHandlerEnable?(n(),y(o,{key:11,label:"\u8D85\u65F6\u65F6\u95F4\u8BBE\u7F6E"},{default:d(()=>[t[35]||(t[35]=a("span",{class:"mr-2"},"\u5F53\u8D85\u8FC7",-1)),l(o,{prop:"timeDuration"},{default:d(()=>[l(w,{class:"mr-2",style:{width:"100px"},modelValue:e.configForm.timeDuration,"onUpdate:modelValue":t[20]||(t[20]=f=>e.configForm.timeDuration=f),min:1,"controls-position":"right"},null,8,["modelValue"])]),_:1}),l(u,{filterable:"",modelValue:e.timeUnit,"onUpdate:modelValue":t[21]||(t[21]=f=>e.timeUnit=f),class:"mr-2",style:{width:"100px"},onChange:e.timeUnitChange},{default:d(()=>[(n(!0),c(R,null,x(e.TIME_UNIT_TYPES,f=>(n(),y(g,{key:f.value,label:f.label,value:f.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"]),t[36]||(t[36]=O(" \u672A\u5904\u7406 "))]),_:1})):E("",!0),e.configForm.timeoutHandlerEnable&&e.configForm.timeoutHandlerType===1?(n(),y(o,{key:12,label:"\u6700\u5927\u63D0\u9192\u6B21\u6570",prop:"maxRemindCount"},{default:d(()=>[l(w,{modelValue:e.configForm.maxRemindCount,"onUpdate:modelValue":t[22]||(t[22]=f=>e.configForm.maxRemindCount=f),min:1,max:10},null,8,["modelValue"])]),_:1})):E("",!0),l(_,{"content-position":"left"},{default:d(()=>t[37]||(t[37]=[O("\u5BA1\u6279\u4EBA\u4E3A\u7A7A\u65F6")])),_:1}),l(o,{prop:"assignEmptyHandlerType"},{default:d(()=>[l(v,{modelValue:e.configForm.assignEmptyHandlerType,"onUpdate:modelValue":t[23]||(t[23]=f=>e.configForm.assignEmptyHandlerType=f)},{default:d(()=>[a("div",El,[(n(!0),c(R,null,x(e.ASSIGN_EMPTY_HANDLER_TYPES,(f,H)=>(n(),c("div",{key:H},[(n(),y(r,{key:f.value,value:f.value,label:f.label},null,8,["value","label"]))]))),128))])]),_:1},8,["modelValue"])]),_:1}),e.configForm.assignEmptyHandlerType==e.AssignEmptyHandlerType.ASSIGN_USER?(n(),y(o,{key:13,label:"\u6307\u5B9A\u7528\u6237",prop:"assignEmptyHandlerUserIds",span:"24"},{default:d(()=>[l(u,{filterable:"",modelValue:e.configForm.assignEmptyHandlerUserIds,"onUpdate:modelValue":t[24]||(t[24]=f=>e.configForm.assignEmptyHandlerUserIds=f),clearable:"",multiple:"",style:{width:"100%"}},{default:d(()=>[(n(!0),c(R,null,x(e.userOptions,f=>(n(),y(g,{key:f.id,label:f.nickname,value:f.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):E("",!0),l(_,{"content-position":"left"},{default:d(()=>t[38]||(t[38]=[O("\u5BA1\u6279\u4EBA\u4E0E\u63D0\u4EA4\u4EBA\u4E3A\u540C\u4E00\u4EBA\u65F6")])),_:1}),l(o,{prop:"assignStartUserHandlerType"},{default:d(()=>[l(v,{modelValue:e.configForm.assignStartUserHandlerType,"onUpdate:modelValue":t[25]||(t[25]=f=>e.configForm.assignStartUserHandlerType=f)},{default:d(()=>[a("div",kl,[(n(!0),c(R,null,x(e.ASSIGN_START_USER_HANDLER_TYPES,(f,H)=>(n(),c("div",{key:H},[(n(),y(r,{key:f.value,value:f.value,label:f.label},null,8,["value","label"]))]))),128))])]),_:1},8,["modelValue"])]),_:1}),l(_,{"content-position":"left"},{default:d(()=>t[39]||(t[39]=[O("\u662F\u5426\u9700\u8981\u7B7E\u540D")])),_:1}),l(o,{prop:"signEnable"},{default:d(()=>[l(S,{modelValue:e.configForm.signEnable,"onUpdate:modelValue":t[26]||(t[26]=f=>e.configForm.signEnable=f),"active-text":"\u662F","inactive-text":"\u5426"},null,8,["modelValue"])]),_:1}),l(_,{"content-position":"left"},{default:d(()=>t[40]||(t[40]=[O("\u5BA1\u6279\u610F\u89C1")])),_:1}),l(o,{prop:"reasonRequire"},{default:d(()=>[l(S,{modelValue:e.configForm.reasonRequire,"onUpdate:modelValue":t[27]||(t[27]=f=>e.configForm.reasonRequire=f),"active-text":"\u5FC5\u586B","inactive-text":"\u975E\u5FC5\u586B"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])]),_:1}),l(T,{label:"\u64CD\u4F5C\u6309\u94AE\u8BBE\u7F6E",name:"buttons"},{default:d(()=>[a("div",Sl,[t[41]||(t[41]=a("div",{class:"button-setting-desc"},"\u64CD\u4F5C\u6309\u94AE",-1)),t[42]||(t[42]=a("div",{class:"button-setting-title"},[a("div",{class:"button-title-label"},"\u64CD\u4F5C\u6309\u94AE"),a("div",{class:"pl-4 button-title-label"},"\u663E\u793A\u540D\u79F0"),a("div",{class:"button-title-label"},"\u542F\u7528")],-1)),(n(!0),c(R,null,x(e.buttonsSetting,(f,H)=>(n(),c("div",{class:"button-setting-item",key:H},[a("div",Cl,I(e.OPERATION_BUTTON_NAME.get(f.id)),1),a("div",wl,[e.btnDisplayNameEdit[H]?$((n(),c("input",{key:0,type:"text",class:"editable-title-input",onBlur:Q=>e.btnDisplayNameBlurEvent(H),"onUpdate:modelValue":Q=>f.displayName=Q,placeholder:f.displayName},null,40,Ul)),[[z],[X,f.displayName]]):(n(),y(L,{key:1,text:"",onClick:Q=>e.changeBtnDisplayName(H)},{default:d(()=>[O(I(f.displayName)+" \xA0",1),l(s,{icon:"ep:edit"})]),_:2},1032,["onClick"]))]),a("div",Vl,[l(S,{modelValue:f.enable,"onUpdate:modelValue":Q=>f.enable=Q},null,8,["modelValue","onUpdate:modelValue"])])]))),128))])]),_:1}),e.formType===10?(n(),y(T,{key:0,label:"\u8868\u5355\u5B57\u6BB5\u6743\u9650",name:"fields"},{default:d(()=>[a("div",Fl,[t[46]||(t[46]=a("div",{class:"field-setting-desc"},"\u5B57\u6BB5\u6743\u9650",-1)),t[47]||(t[47]=a("div",{class:"field-permit-title"},[a("div",{class:"setting-title-label first-title"}," \u5B57\u6BB5\u540D\u79F0 "),a("div",{class:"other-titles"},[a("span",{class:"setting-title-label"},"\u53EA\u8BFB"),a("span",{class:"setting-title-label"},"\u53EF\u7F16\u8F91"),a("span",{class:"setting-title-label"},"\u9690\u85CF")])],-1)),(n(!0),c(R,null,x(e.fieldsPermissionConfig,(f,H)=>(n(),c("div",{class:"field-setting-item",key:H},[a("div",Dl,I(f.title),1),l(v,{class:"field-setting-item-group",modelValue:f.permission,"onUpdate:modelValue":Q=>f.permission=Q},{default:d(()=>[a("div",Rl,[l(r,{value:e.FieldPermissionType.READ,size:"large",label:e.FieldPermissionType.READ},{default:d(()=>[...t[43]||(t[43]=[a("span",null,null,-1)])]),_:1},8,["value","label"])]),a("div",Ol,[l(r,{value:e.FieldPermissionType.WRITE,size:"large",label:e.FieldPermissionType.WRITE},{default:d(()=>[...t[44]||(t[44]=[a("span",null,null,-1)])]),_:1},8,["value","label"])]),a("div",Il,[l(r,{value:e.FieldPermissionType.NONE,size:"large",label:e.FieldPermissionType.NONE},{default:d(()=>[...t[45]||(t[45]=[a("span",null,null,-1)])]),_:1},8,["value","label"])])]),_:2},1032,["modelValue","onUpdate:modelValue"])]))),128))])]),_:1})):E("",!0),l(T,{label:"\u76D1\u542C\u5668",name:"listener"},{default:d(()=>[l(e.UserTaskListener,{ref:"userTaskListenerRef",modelValue:e.configForm,"onUpdate:modelValue":t[28]||(t[28]=f=>e.configForm=f),"form-field-options":e.formFieldOptions},null,8,["modelValue","form-field-options"])]),_:1})]),_:1},8,["modelValue"])):E("",!0)]),_:1},8,["modelValue"])}],["__scopeId","data-v-e926d8ec"],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/components/SimpleProcessDesignerV2/src/nodes-config/UserTaskNodeConfig.vue"]]),xl={class:"node-wrapper"},Al={class:"node-container"},Ll={class:"node-title-container"},Hl=["placeholder"],Ml=["title"],ql={key:1,class:"node-text"},Gl={key:0,class:"node-toolbar"},Bl={class:"toolbar-icon"},jl=G(q({name:"UserTaskNode",__name:"UserTaskNode",props:{flowNode:{type:Object,required:!0}},emits:["update:flowNode","find:parentNode"],setup(F,{expose:t,emit:C}){t();const e=F,b=C,N=j("readonly"),s=j("tasks",A([])),r=W(e),{showInput:v,blurEvent:p,clickTitle:i}=we(r,V.START_USER_NODE),o=A(),g=A(!1),u=A(void 0),m=A([]),k={props:e,emits:b,readonly:N,tasks:s,currentNode:r,showInput:v,blurEvent:p,clickTitle:i,nodeSetting:o,nodeClick:()=>{N?s&&s.value&&(u.value=r.value.name,m.value=s.value.filter(w=>(w==null?void 0:w.taskDefinitionKey)===r.value.id),g.value=!0):(o.value.showUserTaskNodeConfig(r.value),o.value.openDrawer())},deleteNode:()=>{b("update:flowNode",r.value.childNode)},findReturnTaskNodes:w=>{b("find:parentNode",w,V.USER_TASK_NODE)},dialogVisible:g,dialogTitle:u,selectTasks:m,get NodeType(){return V},get NODE_DEFAULT_TEXT(){return se},get useTaskStatusClass(){return ue},NodeHandler:ce,UserTaskNodeConfig:Pl,get dateFormatter(){return it},get formatPast2(){return rt},get DICT_TYPE(){return Ke}};return Object.defineProperty(k,"__isScriptSetup",{enumerable:!1,value:!0}),k}}),[["render",function(F,t,C,e,b,N){var u;const s=B,r=Qe,v=tt,p=We,i=De,o=Je,g=K("mountedFocus");return n(),c(R,null,[a("div",xl,[a("div",Al,[a("div",{class:ne(["node-box",[{"node-config-error":!e.currentNode.showText},`${e.useTaskStatusClass((u=e.currentNode)==null?void 0:u.activityStatus)}`]])},[a("div",Ll,[t[5]||(t[5]=a("div",{class:"node-title-icon user-task"},[a("span",{class:"iconfont icon-approve"})],-1)),!e.readonly&&e.showInput?$((n(),c("input",{key:0,type:"text",class:"editable-title-input",onBlur:t[0]||(t[0]=m=>e.blurEvent()),"onUpdate:modelValue":t[1]||(t[1]=m=>e.currentNode.name=m),placeholder:e.currentNode.name},null,40,Hl)),[[g],[X,e.currentNode.name]]):(n(),c("div",{key:1,class:"node-title",onClick:t[2]||(t[2]=(...m)=>e.clickTitle&&e.clickTitle(...m))},I(e.currentNode.name),1))]),a("div",{class:"node-content",onClick:e.nodeClick},[e.currentNode.showText?(n(),c("div",{key:0,class:"node-text",title:e.currentNode.showText},I(e.currentNode.showText),9,Ml)):(n(),c("div",ql,I(e.NODE_DEFAULT_TEXT.get(e.NodeType.USER_TASK_NODE)),1)),e.readonly?E("",!0):(n(),y(s,{key:2,icon:"ep:arrow-right-bold"}))]),e.readonly?E("",!0):(n(),c("div",Gl,[a("div",Bl,[l(s,{color:"#0089ff",icon:"ep:circle-close-filled",size:18,onClick:e.deleteNode})])]))],2),e.currentNode?(n(),y(e.NodeHandler,{key:0,"child-node":e.currentNode.childNode,"onUpdate:childNode":t[3]||(t[3]=m=>e.currentNode.childNode=m),"current-node":e.currentNode},null,8,["child-node","current-node"])):E("",!0)])]),e.currentNode?(n(),y(e.UserTaskNodeConfig,{key:0,ref:"nodeSetting","flow-node":e.currentNode,"onFind:returnTaskNodes":e.findReturnTaskNodes},null,8,["flow-node"])):E("",!0),l(o,{title:e.dialogTitle||"\u5BA1\u6279\u8BB0\u5F55",modelValue:e.dialogVisible,"onUpdate:modelValue":t[4]||(t[4]=m=>e.dialogVisible=m),width:"1000px","append-to-body":""},{default:d(()=>[l(i,null,{default:d(()=>[l(p,{data:e.selectTasks,size:"small",border:"","header-cell-class-name":"table-header-gray"},{default:d(()=>[l(r,{label:"\u5E8F\u53F7","header-align":"center",align:"center",type:"index",width:"50"}),l(r,{label:"\u5BA1\u6279\u4EBA","min-width":"100",align:"center"},{default:d(m=>{var k,w;return[O(I(((k=m.row.assigneeUser)==null?void 0:k.nickname)||((w=m.row.ownerUser)==null?void 0:w.nickname)),1)]}),_:1}),l(r,{label:"\u90E8\u95E8","min-width":"100",align:"center"},{default:d(m=>{var k,w;return[O(I(((k=m.row.assigneeUser)==null?void 0:k.deptName)||((w=m.row.ownerUser)==null?void 0:w.deptName)),1)]}),_:1}),l(r,{formatter:e.dateFormatter,align:"center",label:"\u5F00\u59CB\u65F6\u95F4",prop:"createTime","min-width":"140"},null,8,["formatter"]),l(r,{formatter:e.dateFormatter,align:"center",label:"\u7ED3\u675F\u65F6\u95F4",prop:"endTime","min-width":"140"},null,8,["formatter"]),l(r,{align:"center",label:"\u5BA1\u6279\u72B6\u6001",prop:"status","min-width":"90"},{default:d(m=>[l(v,{type:e.DICT_TYPE.BPM_TASK_STATUS,value:m.row.status},null,8,["type","value"])]),_:1}),l(r,{align:"center",label:"\u5BA1\u6279\u5EFA\u8BAE",prop:"reason","min-width":"120"}),l(r,{align:"center",label:"\u8017\u65F6",prop:"durationInMillis",width:"100"},{default:d(m=>[O(I(e.formatPast2(m.row.durationInMillis)),1)]),_:1})]),_:1},8,["data"])]),_:1})]),_:1},8,["title","modelValue"])],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/components/SimpleProcessDesignerV2/src/nodes/UserTaskNode.vue"]]),zl={class:"config-header"},Yl=["placeholder"],$l={key:1,class:"node-name"},Xl={class:"field-setting-pane"},Kl={class:"field-setting-item-label"},Ql={class:"item-radio-wrap"},Wl={class:"item-radio-wrap"},Jl={class:"item-radio-wrap"},Zl=G(q({name:"CopyTaskNodeConfig",__name:"CopyTaskNodeConfig",props:{flowNode:{type:Object,required:!0}},setup(F,{expose:t}){const C=F,e=Z(()=>{let M="\u90E8\u95E8\u8D1F\u8D23\u4EBA\u6765\u6E90";return te.value.candidateStrategy==Ee.MULTI_LEVEL_DEPT_LEADER?M+="(\u6307\u5B9A\u90E8\u95E8\u5411\u4E0A)":M+="(\u53D1\u8D77\u4EBA\u90E8\u95E8\u5411\u4E0A)",M}),{settingVisible:b,closeDrawer:N,openDrawer:s}=Se(),r=W(C),{nodeName:v,showInput:p,clickIcon:i,blurEvent:o}=Ce(V.COPY_TASK_NODE),g=A("user"),{formType:u,fieldsPermissionConfig:m,formFieldOptions:k,getNodeConfigFormFields:w}=dt(he.READ),_=Z(()=>k.filter(M=>M.type==="UserSelect")),S=Z(()=>k.filter(M=>M.type==="DeptSelect")),P=A(),h=Re({candidateStrategy:[{required:!0,message:"\u6284\u9001\u4EBA\u8BBE\u7F6E\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],userIds:[{required:!0,message:"\u7528\u6237\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],roleIds:[{required:!0,message:"\u89D2\u8272\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],deptIds:[{required:!0,message:"\u90E8\u95E8\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],userGroups:[{required:!0,message:"\u7528\u6237\u7EC4\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],postIds:[{required:!0,message:"\u5C97\u4F4D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],formUser:[{required:!0,message:"\u8868\u5355\u5185\u7528\u6237\u5B57\u6BB5\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],formDept:[{required:!0,message:"\u8868\u5355\u5185\u90E8\u95E8\u5B57\u6BB5\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],expression:[{required:!0,message:"\u6D41\u7A0B\u8868\u8FBE\u5F0F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),{configForm:T,roleOptions:L,postOptions:J,userOptions:pe,userGroupOptions:z,deptTreeOptions:f,getShowText:H,handleCandidateParam:Q,parseCandidateParam:xe}=jt(V.COPY_TASK_NODE),te=T,ze=Z(()=>Gt.filter(M=>M.value!==Ee.START_USER)),Ae=M=>{v.value=M.name,te.value.candidateStrategy=M.candidateStrategy,xe(M.candidateStrategy,M==null?void 0:M.candidateParam),w(M.fieldsPermission)};t({openDrawer:s,showCopyTaskNodeConfig:Ae});const Le={props:C,deptLevelLabel:e,settingVisible:b,closeDrawer:N,openDrawer:s,currentNode:r,nodeName:v,showInput:p,clickIcon:i,blurEvent:o,activeTabName:g,formType:u,fieldsPermissionConfig:m,formFieldOptions:k,getNodeConfigFormFields:w,userFieldOnFormOptions:_,deptFieldOnFormOptions:S,formRef:P,formRules:h,tempConfigForm:T,roleOptions:L,postOptions:J,userOptions:pe,userGroupOptions:z,deptTreeOptions:f,getShowText:H,handleCandidateParam:Q,parseCandidateParam:xe,configForm:te,copyUserStrategies:ze,changeCandidateStrategy:()=>{te.value.userIds=[],te.value.deptIds=[],te.value.roleIds=[],te.value.postIds=[],te.value.userGroups=[],te.value.deptLevel=1,te.value.formUser=""},saveConfig:async()=>{if(g.value="user",!P||!await P.value.validate())return!1;const M=H();return!!M&&(r.value.name=v.value,r.value.candidateParam=Q(),r.value.candidateStrategy=te.value.candidateStrategy,r.value.showText=M,r.value.fieldsPermission=m.value,b.value=!1,!0)},showCopyTaskNodeConfig:Ae,get CandidateStrategy(){return Ee},get FieldPermissionType(){return he},get MULTI_LEVEL_DEPT(){return qt},get defaultProps(){return Xt}};return Object.defineProperty(Le,"__isScriptSetup",{enumerable:!1,value:!0}),Le}}),[["render",function(F,t,C,e,b,N){const s=B,r=Ge,v=Fe,p=fe,i=ge,o=ye,g=$t,u=Te,m=Ne,k=$e,w=Xe,_=me,S=ae,P=_e,h=K("mountedFocus");return n(),y(P,{"append-to-body":!0,modelValue:e.settingVisible,"onUpdate:modelValue":t[14]||(t[14]=T=>e.settingVisible=T),"show-close":!1,size:550,"before-close":e.saveConfig},{header:d(()=>[a("div",zl,[e.showInput?$((n(),c("input",{key:0,type:"text",class:"config-editable-input",onBlur:t[0]||(t[0]=T=>e.blurEvent()),"onUpdate:modelValue":t[1]||(t[1]=T=>e.nodeName=T),placeholder:e.nodeName},null,40,Yl)),[[h],[X,e.nodeName]]):(n(),c("div",$l,[O(I(e.nodeName)+" ",1),l(s,{class:"ml-1",icon:"ep:edit-pen",size:16,onClick:t[2]||(t[2]=T=>e.clickIcon())})])),t[15]||(t[15]=a("div",{class:"divide-line"},null,-1))])]),footer:d(()=>[l(_),a("div",null,[l(S,{type:"primary",onClick:e.saveConfig},{default:d(()=>t[21]||(t[21]=[O("\u786E \u5B9A")])),_:1}),l(S,{onClick:e.closeDrawer},{default:d(()=>t[22]||(t[22]=[O("\u53D6 \u6D88")])),_:1},8,["onClick"])])]),default:d(()=>[l(w,{type:"border-card",modelValue:e.activeTabName,"onUpdate:modelValue":t[13]||(t[13]=T=>e.activeTabName=T)},{default:d(()=>[l(k,{label:"\u6284\u9001\u4EBA",name:"user"},{default:d(()=>[a("div",null,[l(m,{ref:"formRef",model:e.configForm,"label-position":"top",rules:e.formRules},{default:d(()=>[l(p,{label:"\u6284\u9001\u4EBA\u8BBE\u7F6E",prop:"candidateStrategy"},{default:d(()=>[l(v,{modelValue:e.configForm.candidateStrategy,"onUpdate:modelValue":t[3]||(t[3]=T=>e.configForm.candidateStrategy=T),onChange:e.changeCandidateStrategy},{default:d(()=>[(n(!0),c(R,null,x(e.copyUserStrategies,(T,L)=>(n(),y(r,{key:L,value:T.value,label:T.value},{default:d(()=>[O(I(T.label),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),e.configForm.candidateStrategy==e.CandidateStrategy.ROLE?(n(),y(p,{key:0,label:"\u6307\u5B9A\u89D2\u8272",prop:"roleIds"},{default:d(()=>[l(o,{modelValue:e.configForm.roleIds,"onUpdate:modelValue":t[4]||(t[4]=T=>e.configForm.roleIds=T),clearable:"",multiple:"",style:{width:"100%"}},{default:d(()=>[(n(!0),c(R,null,x(e.roleOptions,T=>(n(),y(i,{key:T.id,label:T.name,value:T.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):E("",!0),e.configForm.candidateStrategy==e.CandidateStrategy.DEPT_MEMBER||e.configForm.candidateStrategy==e.CandidateStrategy.DEPT_LEADER||e.configForm.candidateStrategy==e.CandidateStrategy.MULTI_LEVEL_DEPT_LEADER?(n(),y(p,{key:1,label:"\u6307\u5B9A\u90E8\u95E8",prop:"deptIds",span:"24"},{default:d(()=>[l(g,{ref:"treeRef",modelValue:e.configForm.deptIds,"onUpdate:modelValue":t[5]||(t[5]=T=>e.configForm.deptIds=T),data:e.deptTreeOptions,props:e.defaultProps,"empty-text":"\u52A0\u8F7D\u4E2D\uFF0C\u8BF7\u7A0D\u540E",multiple:"","node-key":"id",style:{width:"100%"},"show-checkbox":""},null,8,["modelValue","data","props"])]),_:1})):E("",!0),e.configForm.candidateStrategy==e.CandidateStrategy.POST?(n(),y(p,{key:2,label:"\u6307\u5B9A\u5C97\u4F4D",prop:"postIds",span:"24"},{default:d(()=>[l(o,{modelValue:e.configForm.postIds,"onUpdate:modelValue":t[6]||(t[6]=T=>e.configForm.postIds=T),clearable:"",multiple:"",style:{width:"100%"}},{default:d(()=>[(n(!0),c(R,null,x(e.postOptions,T=>(n(),y(i,{key:T.id,label:T.name,value:T.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):E("",!0),e.configForm.candidateStrategy==e.CandidateStrategy.USER?(n(),y(p,{key:3,label:"\u6307\u5B9A\u7528\u6237",prop:"userIds",span:"24"},{default:d(()=>[l(o,{modelValue:e.configForm.userIds,"onUpdate:modelValue":t[7]||(t[7]=T=>e.configForm.userIds=T),clearable:"",multiple:"",style:{width:"100%"}},{default:d(()=>[(n(!0),c(R,null,x(e.userOptions,T=>(n(),y(i,{key:T.id,label:T.nickname,value:T.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):E("",!0),e.configForm.candidateStrategy===e.CandidateStrategy.USER_GROUP?(n(),y(p,{key:4,label:"\u6307\u5B9A\u7528\u6237\u7EC4",prop:"userGroups"},{default:d(()=>[l(o,{modelValue:e.configForm.userGroups,"onUpdate:modelValue":t[8]||(t[8]=T=>e.configForm.userGroups=T),clearable:"",multiple:"",style:{width:"100%"}},{default:d(()=>[(n(!0),c(R,null,x(e.userGroupOptions,T=>(n(),y(i,{key:T.id,label:T.name,value:T.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):E("",!0),e.configForm.candidateStrategy===e.CandidateStrategy.FORM_USER?(n(),y(p,{key:5,label:"\u8868\u5355\u5185\u7528\u6237\u5B57\u6BB5",prop:"formUser"},{default:d(()=>[l(o,{modelValue:e.configForm.formUser,"onUpdate:modelValue":t[9]||(t[9]=T=>e.configForm.formUser=T),clearable:"",style:{width:"100%"}},{default:d(()=>[(n(!0),c(R,null,x(e.userFieldOnFormOptions,(T,L)=>(n(),y(i,{key:L,label:T.title,value:T.field,disabled:!T.required},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1})):E("",!0),e.configForm.candidateStrategy===e.CandidateStrategy.FORM_DEPT_LEADER?(n(),y(p,{key:6,label:"\u8868\u5355\u5185\u90E8\u95E8\u5B57\u6BB5",prop:"formDept"},{default:d(()=>[l(o,{modelValue:e.configForm.formDept,"onUpdate:modelValue":t[10]||(t[10]=T=>e.configForm.formDept=T),clearable:"",style:{width:"100%"}},{default:d(()=>[(n(!0),c(R,null,x(e.deptFieldOnFormOptions,(T,L)=>(n(),y(i,{key:L,label:T.title,value:T.field,disabled:!T.required},null,8,["label","value","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1})):E("",!0),e.configForm.candidateStrategy==e.CandidateStrategy.MULTI_LEVEL_DEPT_LEADER||e.configForm.candidateStrategy==e.CandidateStrategy.START_USER_DEPT_LEADER||e.configForm.candidateStrategy==e.CandidateStrategy.START_USER_MULTI_LEVEL_DEPT_LEADER||e.configForm.candidateStrategy==e.CandidateStrategy.FORM_DEPT_LEADER?(n(),y(p,{key:7,label:e.deptLevelLabel,prop:"deptLevel",span:"24"},{default:d(()=>[l(o,{modelValue:e.configForm.deptLevel,"onUpdate:modelValue":t[11]||(t[11]=T=>e.configForm.deptLevel=T),clearable:""},{default:d(()=>[(n(!0),c(R,null,x(e.MULTI_LEVEL_DEPT,(T,L)=>(n(),y(i,{key:L,label:T.label,value:T.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])):E("",!0),e.configForm.candidateStrategy===e.CandidateStrategy.EXPRESSION?(n(),y(p,{key:8,label:"\u6D41\u7A0B\u8868\u8FBE\u5F0F",prop:"expression"},{default:d(()=>[l(u,{type:"textarea",modelValue:e.configForm.expression,"onUpdate:modelValue":t[12]||(t[12]=T=>e.configForm.expression=T),clearable:"",style:{width:"100%"}},null,8,["modelValue"])]),_:1})):E("",!0)]),_:1},8,["model","rules"])])]),_:1}),e.formType===10?(n(),y(k,{key:0,label:"\u8868\u5355\u5B57\u6BB5\u6743\u9650",name:"fields"},{default:d(()=>[a("div",Xl,[t[19]||(t[19]=a("div",{class:"field-setting-desc"},"\u5B57\u6BB5\u6743\u9650",-1)),t[20]||(t[20]=a("div",{class:"field-permit-title"},[a("div",{class:"setting-title-label first-title"}," \u5B57\u6BB5\u540D\u79F0 "),a("div",{class:"other-titles"},[a("span",{class:"setting-title-label"},"\u53EA\u8BFB"),a("span",{class:"setting-title-label"},"\u53EF\u7F16\u8F91"),a("span",{class:"setting-title-label"},"\u9690\u85CF")])],-1)),(n(!0),c(R,null,x(e.fieldsPermissionConfig,(T,L)=>(n(),c("div",{class:"field-setting-item",key:L},[a("div",Kl,I(T.title),1),l(v,{class:"field-setting-item-group",modelValue:T.permission,"onUpdate:modelValue":J=>T.permission=J},{default:d(()=>[a("div",Ql,[l(r,{value:e.FieldPermissionType.READ,size:"large",label:e.FieldPermissionType.WRITE},{default:d(()=>[...t[16]||(t[16]=[a("span",null,null,-1)])]),_:1},8,["value","label"])]),a("div",Wl,[l(r,{value:e.FieldPermissionType.WRITE,size:"large",label:e.FieldPermissionType.WRITE,disabled:""},{default:d(()=>[...t[17]||(t[17]=[a("span",null,null,-1)])]),_:1},8,["value","label"])]),a("div",Jl,[l(r,{value:e.FieldPermissionType.NONE,size:"large",label:e.FieldPermissionType.NONE},{default:d(()=>[...t[18]||(t[18]=[a("span",null,null,-1)])]),_:1},8,["value","label"])])]),_:2},1032,["modelValue","onUpdate:modelValue"])]))),128))])]),_:1})):E("",!0)]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/components/SimpleProcessDesignerV2/src/nodes-config/CopyTaskNodeConfig.vue"]]),ea={class:"node-wrapper"},ta={class:"node-container"},na={class:"node-title-container"},la=["placeholder"],aa=["title"],da={key:1,class:"node-text"},oa={key:0,class:"node-toolbar"},ia={class:"toolbar-icon"},ra=G(q({name:"CopyTaskNode",__name:"CopyTaskNode",props:{flowNode:{type:Object,required:!0}},emits:["update:flowNode"],setup(F,{expose:t,emit:C}){t();const e=F,b=C,N=j("readonly"),s=W(e),{showInput:r,blurEvent:v,clickTitle:p}=we(s,V.COPY_TASK_NODE),i=A(),o={props:e,emits:b,readonly:N,currentNode:s,showInput:r,blurEvent:v,clickTitle:p,nodeSetting:i,openNodeConfig:()=>{N||(i.value.showCopyTaskNodeConfig(s.value),i.value.openDrawer())},deleteNode:()=>{b("update:flowNode",s.value.childNode)},get NodeType(){return V},get NODE_DEFAULT_TEXT(){return se},NodeHandler:ce,get useTaskStatusClass(){return ue},CopyTaskNodeConfig:Zl};return Object.defineProperty(o,"__isScriptSetup",{enumerable:!1,value:!0}),o}}),[["render",function(F,t,C,e,b,N){var v;const s=B,r=K("mountedFocus");return n(),c("div",ea,[a("div",ta,[a("div",{class:ne(["node-box",[{"node-config-error":!e.currentNode.showText},`${e.useTaskStatusClass((v=e.currentNode)==null?void 0:v.activityStatus)}`]])},[a("div",na,[t[4]||(t[4]=a("div",{class:"node-title-icon copy-task"},[a("span",{class:"iconfont icon-copy"})],-1)),!e.readonly&&e.showInput?$((n(),c("input",{key:0,type:"text",class:"editable-title-input",onBlur:t[0]||(t[0]=p=>e.blurEvent()),"onUpdate:modelValue":t[1]||(t[1]=p=>e.currentNode.name=p),placeholder:e.currentNode.name},null,40,la)),[[r],[X,e.currentNode.name]]):(n(),c("div",{key:1,class:"node-title",onClick:t[2]||(t[2]=(...p)=>e.clickTitle&&e.clickTitle(...p))},I(e.currentNode.name),1))]),a("div",{class:"node-content",onClick:e.openNodeConfig},[e.currentNode.showText?(n(),c("div",{key:0,class:"node-text",title:e.currentNode.showText},I(e.currentNode.showText),9,aa)):(n(),c("div",da,I(e.NODE_DEFAULT_TEXT.get(e.NodeType.COPY_TASK_NODE)),1)),e.readonly?E("",!0):(n(),y(s,{key:2,icon:"ep:arrow-right-bold"}))]),e.readonly?E("",!0):(n(),c("div",oa,[a("div",ia,[l(s,{color:"#0089ff",icon:"ep:circle-close-filled",size:18,onClick:e.deleteNode})])]))],2),e.currentNode?(n(),y(e.NodeHandler,{key:0,"child-node":e.currentNode.childNode,"onUpdate:childNode":t[3]||(t[3]=p=>e.currentNode.childNode=p),"current-node":e.currentNode},null,8,["child-node","current-node"])):E("",!0)]),!e.readonly&&e.currentNode?(n(),y(e.CopyTaskNodeConfig,{key:0,ref:"nodeSetting","flow-node":e.currentNode},null,8,["flow-node"])):E("",!0)])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/components/SimpleProcessDesignerV2/src/nodes/CopyTaskNode.vue"]]),sa={class:"condition-group-tool"},ua={class:"flex items-center"},ca={key:0,class:"condition-group-delete"},pa={class:"flex items-center justify-between"},ma={class:"flex"},va={class:"mr-2"},fa={class:"mr-2"},ga={class:"mr-2"},ya={key:0,class:"mr-1 flex items-center"},Na={class:"flex items-center"},_a={title:"\u6DFB\u52A0\u6761\u4EF6\u7EC4",class:"mt-4 cursor-pointer"},Qt=G(q({__name:"Condition",props:{modelValue:{type:Object,required:!0}},emits:["update:modelValue"],setup(F,{expose:t,emit:C}){const e=F,b=C,N=Z({get:()=>e.modelValue,set(u){b("update:modelValue",u)}}),s=j("formType"),r=Z(()=>Fn.filter(u=>(s==null?void 0:s.value)!==An.CUSTOM||u.value!==ee.RULE)),v=ot(),p=Re({conditionType:[{required:!0,message:"\u914D\u7F6E\u65B9\u5F0F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],conditionExpression:[{required:!0,message:"\u6761\u4EF6\u8868\u8FBE\u5F0F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),i=A(),o=async()=>!!i&&await i.value.validate();t({validate:o});const g={props:e,emit:b,condition:N,formType:s,conditionConfigTypes:r,fieldOptions:v,formRules:p,formRef:i,changeConditionType:()=>{N.value.conditionType===ee.RULE&&(N.value.conditionGroups||(N.value.conditionGroups=Ie))},deleteConditionGroup:(u,m)=>{u.splice(m,1)},deleteConditionRule:(u,m)=>{u.rules.splice(m,1)},addConditionRule:(u,m)=>{u.rules.splice(m+1,0,{opCode:"==",leftSide:"",rightSide:""})},addConditionGroup:u=>{u.push({and:!0,rules:[{opCode:"==",leftSide:"",rightSide:""}]})},validate:o,get COMPARISON_OPERATORS(){return Bt},get ConditionType(){return ee}};return Object.defineProperty(g,"__isScriptSetup",{enumerable:!1,value:!0}),g}}),[["render",function(F,t,C,e,b,N){const s=Ge,r=Fe,v=fe,p=Ze,i=B,o=ge,g=ye,u=Te,m=At,k=xn,w=Ne;return n(),y(w,{ref:"formRef",model:e.condition,rules:e.formRules,"label-position":"top"},{default:d(()=>[l(v,{label:"\u914D\u7F6E\u65B9\u5F0F",prop:"conditionType"},{default:d(()=>[l(r,{modelValue:e.condition.conditionType,"onUpdate:modelValue":t[0]||(t[0]=_=>e.condition.conditionType=_),onChange:e.changeConditionType},{default:d(()=>[(n(!0),c(R,null,x(e.conditionConfigTypes,(_,S)=>(n(),y(s,{key:S,value:_.value,label:_.value},{default:d(()=>[O(I(_.label),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),e.condition.conditionType===e.ConditionType.RULE&&e.condition.conditionGroups?(n(),y(v,{key:0,label:"\u6761\u4EF6\u89C4\u5219"},{default:d(()=>[a("div",sa,[a("div",ua,[t[4]||(t[4]=a("div",{class:"mr-4"},"\u6761\u4EF6\u7EC4\u5173\u7CFB",-1)),l(p,{modelValue:e.condition.conditionGroups.and,"onUpdate:modelValue":t[1]||(t[1]=_=>e.condition.conditionGroups.and=_),"inline-prompt":"","active-text":"\u4E14","inactive-text":"\u6216"},null,8,["modelValue"])])]),l(k,{direction:"vertical",spacer:e.condition.conditionGroups.and?"\u4E14":"\u6216"},{default:d(()=>[(n(!0),c(R,null,x(e.condition.conditionGroups.conditions,(_,S)=>(n(),y(m,{class:"condition-group",style:{width:"530px"},key:S},{header:d(()=>[a("div",pa,[t[6]||(t[6]=a("div",null,"\u6761\u4EF6\u7EC4",-1)),a("div",ma,[t[5]||(t[5]=a("div",{class:"mr-4"},"\u89C4\u5219\u5173\u7CFB",-1)),l(p,{modelValue:_.and,"onUpdate:modelValue":P=>_.and=P,"inline-prompt":"","active-text":"\u4E14","inactive-text":"\u6216"},null,8,["modelValue","onUpdate:modelValue"])])])]),default:d(()=>[e.condition.conditionGroups.conditions.length>1?(n(),c("div",ca,[l(i,{color:"#0089ff",icon:"ep:circle-close-filled",size:18,onClick:P=>e.deleteConditionGroup(e.condition.conditionGroups.conditions,S)},null,8,["onClick"])])):E("",!0),(n(!0),c(R,null,x(_.rules,(P,h)=>(n(),c("div",{class:"flex pt-2",key:h},[a("div",va,[l(v,{prop:`conditionGroups.conditions.${S}.rules.${h}.leftSide`,rules:{required:!0,message:"\u5DE6\u503C\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}},{default:d(()=>[l(g,{style:{width:"160px"},modelValue:P.leftSide,"onUpdate:modelValue":T=>P.leftSide=T},{default:d(()=>[(n(!0),c(R,null,x(e.fieldOptions,(T,L)=>(n(),y(o,{key:L,label:T.title,value:T.field,disabled:!T.required},null,8,["label","value","disabled"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"])]),a("div",fa,[l(g,{modelValue:P.opCode,"onUpdate:modelValue":T=>P.opCode=T,style:{width:"100px"}},{default:d(()=>[(n(!0),c(R,null,x(e.COMPARISON_OPERATORS,T=>(n(),y(o,{key:T.value,label:T.label,value:T.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),a("div",ga,[l(v,{prop:`conditionGroups.conditions.${S}.rules.${h}.rightSide`,rules:{required:!0,message:"\u53F3\u503C\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}},{default:d(()=>[l(u,{modelValue:P.rightSide,"onUpdate:modelValue":T=>P.rightSide=T,style:{width:"160px"}},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"])]),_.rules.length>1?(n(),c("div",ya,[l(i,{icon:"ep:delete",size:18,onClick:T=>e.deleteConditionRule(_,h)},null,8,["onClick"])])):E("",!0),a("div",Na,[l(i,{icon:"ep:plus",size:18,onClick:T=>e.addConditionRule(_,h)},null,8,["onClick"])])]))),128))]),_:2},1024))),128))]),_:1},8,["spacer"]),a("div",_a,[l(i,{color:"#0089ff",icon:"ep:plus",size:24,onClick:t[2]||(t[2]=_=>{var S;return e.addConditionGroup((S=e.condition.conditionGroups)==null?void 0:S.conditions)})})])]),_:1})):E("",!0),e.condition.conditionType===e.ConditionType.EXPRESSION?(n(),y(v,{key:1,label:"\u6761\u4EF6\u8868\u8FBE\u5F0F",prop:"conditionExpression"},{default:d(()=>[l(u,{type:"textarea",modelValue:e.condition.conditionExpression,"onUpdate:modelValue":t[3]||(t[3]=_=>e.condition.conditionExpression=_),clearable:"",style:{width:"100%"}},null,8,["modelValue"])]),_:1})):E("",!0)]),_:1},8,["model","rules"])}],["__scopeId","data-v-4b00e6ad"],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/components/SimpleProcessDesignerV2/src/nodes-config/components/Condition.vue"]]),Ta={class:"config-header"},ba=["placeholder"],ha={key:1,class:"node-name"},Ea={key:0,class:"mb-3 font-size-16px"},ka={key:1},Wt=G(q({name:"ConditionNodeConfig",__name:"ConditionNodeConfig",props:{conditionNode:{type:Object,required:!0},nodeIndex:{type:Number,required:!0}},setup(F,{expose:t}){const C=Me(),e=F,b=A(!1),N=A(e.conditionNode),s=A(),r=()=>{s.value=N.value.conditionSetting,b.value=!0};Be(()=>e.conditionNode,w=>{N.value=w});const v=A(!1);t({open:r});const p=A(),i=async()=>{var w,_,S,P,h;if(!((w=N.value.conditionSetting)!=null&&w.defaultFlow)){if(!await p.value.validate())return!1;const T=o();if(!T)return!1;N.value.showText=T,N.value.conditionSetting.conditionType=(_=s.value)==null?void 0:_.conditionType,((S=N.value.conditionSetting)==null?void 0:S.conditionType)===ee.EXPRESSION&&(N.value.conditionSetting.conditionGroups=void 0,N.value.conditionSetting.conditionExpression=(P=s.value)==null?void 0:P.conditionExpression),N.value.conditionSetting.conditionType===ee.RULE&&(N.value.conditionSetting.conditionExpression=void 0,N.value.conditionSetting.conditionGroups=(h=s.value)==null?void 0:h.conditionGroups)}return b.value=!1,!0},o=()=>{var _,S,P,h;let w="";if(((_=s.value)==null?void 0:_.conditionType)===ee.EXPRESSION&&s.value.conditionExpression&&(w=`\u8868\u8FBE\u5F0F\uFF1A${s.value.conditionExpression}`),((S=s.value)==null?void 0:S.conditionType)===ee.RULE){const T=(P=s.value.conditionGroups)==null?void 0:P.and;let L;const J=(h=s.value.conditionGroups)==null?void 0:h.conditions.map(pe=>"("+pe.rules.map(z=>z.leftSide&&z.rightSide?u(z.leftSide)+" "+m(z.opCode)+" "+z.rightSide:(L="\u8BF7\u5B8C\u5584\u6761\u4EF6\u89C4\u5219","")).join(pe.and?" \u4E14 ":" \u6216 ")+" ) ");L?(C.warning(L),w=""):w=J.join(T?" \u4E14 ":" \u6216 ")}return w},g=ot(),u=w=>{const _=g.find(S=>S.field===w);return _==null?void 0:_.title},m=w=>{const _=Bt.find(S=>S.value===w);return _==null?void 0:_.label},k={message:C,props:e,settingVisible:b,currentNode:N,condition:s,open:r,showInput:v,clickIcon:()=>{v.value=!0},blurEvent:()=>{var w,_;v.value=!1,N.value.name=N.value.name||Yt(e.nodeIndex,(_=(w=N.value)==null?void 0:w.conditionSetting)==null?void 0:_.defaultFlow)},closeDrawer:()=>{b.value=!1},handleClose:async w=>{await i()?w():w(!0)},conditionRef:p,saveConfig:i,getShowText:o,fieldOptions:g,getFieldTitle:u,getOpName:m,Condition:Qt};return Object.defineProperty(k,"__isScriptSetup",{enumerable:!1,value:!0}),k}}),[["render",function(F,t,C,e,b,N){const s=B,r=me,v=ae,p=_e,i=K("mountedFocus");return n(),y(p,{"append-to-body":!0,modelValue:e.settingVisible,"onUpdate:modelValue":t[4]||(t[4]=o=>e.settingVisible=o),"show-close":!1,size:588,"before-close":e.handleClose},{header:d(()=>[a("div",Ta,[e.showInput?$((n(),c("input",{key:0,type:"text",class:"config-editable-input",onBlur:t[0]||(t[0]=o=>e.blurEvent()),"onUpdate:modelValue":t[1]||(t[1]=o=>e.currentNode.name=o),placeholder:e.currentNode.name},null,40,ba)),[[i],[X,e.currentNode.name]]):(n(),c("div",ha,[O(I(e.currentNode.name)+" ",1),l(s,{class:"ml-1",icon:"ep:edit-pen",size:16,onClick:t[2]||(t[2]=o=>e.clickIcon())})])),t[5]||(t[5]=a("div",{class:"divide-line"},null,-1))])]),footer:d(()=>[l(r),a("div",null,[l(v,{type:"primary",onClick:e.saveConfig},{default:d(()=>t[6]||(t[6]=[O("\u786E \u5B9A")])),_:1}),l(v,{onClick:e.closeDrawer},{default:d(()=>t[7]||(t[7]=[O("\u53D6 \u6D88")])),_:1})])]),default:d(()=>{var o;return[a("div",null,[(o=e.currentNode.conditionSetting)!=null&&o.defaultFlow?(n(),c("div",Ea,"\u672A\u6EE1\u8DB3\u5176\u5B83\u6761\u4EF6\u65F6\uFF0C\u5C06\u8FDB\u5165\u6B64\u5206\u652F\uFF08\u8BE5\u5206\u652F\u4E0D\u53EF\u7F16\u8F91\u548C\u5220\u9664\uFF09")):(n(),c("div",ka,[l(e.Condition,{ref:"conditionRef",modelValue:e.condition,"onUpdate:modelValue":t[3]||(t[3]=g=>e.condition=g)},null,8,["modelValue"])]))])]}),_:1},8,["modelValue"])}],["__scopeId","data-v-855d8c6d"],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/components/SimpleProcessDesignerV2/src/nodes-config/ConditionNodeConfig.vue"]]),Sa={class:"branch-node-wrapper"},Ca={class:"branch-node-container"},wa={class:"node-wrapper"},Ua={class:"node-container"},Va={class:"branch-node-title-container"},Fa={key:0},Da=["onBlur","onUpdate:modelValue"],Ra=["onClick"],Oa={class:"branch-priority"},Ia=["onClick"],Pa=["title"],xa={key:1,class:"branch-node-text"},Aa={key:0,class:"node-toolbar"},La={class:"toolbar-icon"},Ha=["onClick"],Ma=["onClick"],qa=G(q({name:"ExclusiveNode",__name:"ExclusiveNode",props:{flowNode:{type:Object,required:!0}},emits:["update:modelValue","find:parentNode","find:recursiveFindParentNode"],setup(F,{expose:t,emit:C}){t();const{proxy:e}=et(),b=F,N=C,s=j("readonly"),r=A(b.flowNode);Be(()=>b.flowNode,i=>{r.value=i});const v=A([]),p={proxy:e,props:b,emits:N,readonly:s,currentNode:r,showInputs:v,blurEvent:i=>{var g,u;v.value[i]=!1;const o=(g=r.value.conditionNodes)==null?void 0:g.at(i);o.name=o.name||Yt(i,(u=o.conditionSetting)==null?void 0:u.defaultFlow)},clickEvent:i=>{v.value[i]=!0},conditionNodeConfig:i=>{s||e.$refs[i][0].open()},addCondition:()=>{const i=r.value.conditionNodes;if(i){const o=i.length;let g=o-1;const u={id:"Flow_"+Y(),name:"\u6761\u4EF6"+o,showText:"",type:V.CONDITION_NODE,childNode:void 0,conditionNodes:[],conditionSetting:{defaultFlow:!1,conditionType:ee.RULE,conditionGroups:Ie}};i.splice(g,0,u)}},deleteCondition:i=>{const o=r.value.conditionNodes;if(o&&(o.splice(i,1),o.length==1)){const g=r.value.childNode;N("update:modelValue",g)}},moveNode:(i,o)=>{r.value.conditionNodes&&(r.value.conditionNodes[i]=r.value.conditionNodes.splice(i+o,1,r.value.conditionNodes[i])[0])},recursiveFindParentNode:(i,o,g)=>{o&&o.type!==V.START_USER_NODE&&(o.type===g&&i.push(o),N("find:parentNode",i,g))},NodeHandler:ce,ProcessNodeTree:je,get NodeType(){return V},get NODE_DEFAULT_TEXT(){return se},get useTaskStatusClass(){return ue},ConditionNodeConfig:Wt};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}}),[["render",function(F,t,C,e,b,N){var p;const s=ae,r=B,v=K("mountedFocus");return n(),c("div",Sa,[a("div",Ca,[e.readonly?(n(),c("div",{key:0,class:ne(["branch-node-readonly",`${e.useTaskStatusClass((p=e.currentNode)==null?void 0:p.activityStatus)}`])},t[1]||(t[1]=[a("span",{class:"iconfont icon-exclusive icon-size condition"},null,-1)]),2)):(n(),y(s,{key:1,class:"branch-node-add",color:"#67c23a",onClick:e.addCondition,plain:""},{default:d(()=>t[2]||(t[2]=[O("\u6DFB\u52A0\u6761\u4EF6")])),_:1})),(n(!0),c(R,null,x(e.currentNode.conditionNodes,(i,o)=>{var g,u,m;return n(),c("div",{class:"branch-node-item",key:o},[o==0?(n(),c(R,{key:0},[t[3]||(t[3]=a("div",{class:"branch-line-first-top"},null,-1)),t[4]||(t[4]=a("div",{class:"branch-line-first-bottom"},null,-1))],64)):E("",!0),o+1==((g=e.currentNode.conditionNodes)==null?void 0:g.length)?(n(),c(R,{key:1},[t[5]||(t[5]=a("div",{class:"branch-line-last-top"},null,-1)),t[6]||(t[6]=a("div",{class:"branch-line-last-bottom"},null,-1))],64)):E("",!0),a("div",wa,[a("div",Ua,[a("div",{class:ne(["node-box",[{"node-config-error":!i.showText},`${e.useTaskStatusClass(i.activityStatus)}`]])},[a("div",Va,[!e.readonly&&e.showInputs[o]?(n(),c("div",Fa,[$(a("input",{type:"text",class:"input-max-width editable-title-input",onBlur:k=>e.blurEvent(o),"onUpdate:modelValue":k=>i.name=k},null,40,Da),[[v],[X,i.name]])])):(n(),c("div",{key:1,class:"branch-title",onClick:k=>e.clickEvent(o)},I(i.name),9,Ra)),a("div",Oa," \u4F18\u5148\u7EA7"+I(o+1),1)]),a("div",{class:"branch-node-content",onClick:k=>e.conditionNodeConfig(i.id)},[i.showText?(n(),c("div",{key:0,class:"branch-node-text",title:i.showText},I(i.showText),9,Pa)):(n(),c("div",xa,I(e.NODE_DEFAULT_TEXT.get(e.NodeType.CONDITION_NODE)),1))],8,Ia),e.readonly||o+1===((u=e.currentNode.conditionNodes)==null?void 0:u.length)?E("",!0):(n(),c("div",Aa,[a("div",La,[l(r,{color:"#0089ff",icon:"ep:circle-close-filled",size:18,onClick:k=>e.deleteCondition(o)},null,8,["onClick"])])])),o!=0&&o+1!==((m=e.currentNode.conditionNodes)==null?void 0:m.length)?(n(),c("div",{key:1,class:"branch-node-move move-node-left",onClick:k=>e.moveNode(o,-1)},[l(r,{icon:"ep:arrow-left"})],8,Ha)):E("",!0),e.currentNode.conditionNodes&&o<e.currentNode.conditionNodes.length-2?(n(),c("div",{key:2,class:"branch-node-move move-node-right",onClick:k=>e.moveNode(o,1)},[l(r,{icon:"ep:arrow-right"})],8,Ma)):E("",!0)],2),l(e.NodeHandler,{"child-node":i.childNode,"onUpdate:childNode":k=>i.childNode=k,"current-node":i},null,8,["child-node","onUpdate:childNode","current-node"])])]),l(e.ConditionNodeConfig,{"node-index":o,"condition-node":i,ref_for:!0,ref:i.id},null,8,["node-index","condition-node"]),i&&i.childNode?(n(),y(e.ProcessNodeTree,{key:2,"parent-node":i,"flow-node":i.childNode,"onUpdate:flowNode":k=>i.childNode=k,"onFind:recursiveFindParentNode":e.recursiveFindParentNode},null,8,["parent-node","flow-node","onUpdate:flowNode"])):E("",!0)])}),128))]),e.currentNode?(n(),y(e.NodeHandler,{key:0,"child-node":e.currentNode.childNode,"onUpdate:childNode":t[0]||(t[0]=i=>e.currentNode.childNode=i),"current-node":e.currentNode},null,8,["child-node","current-node"])):E("",!0)])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/components/SimpleProcessDesignerV2/src/nodes/ExclusiveNode.vue"]]),Ga={class:"branch-node-wrapper"},Ba={class:"branch-node-container"},ja={class:"node-wrapper"},za={class:"node-container"},Ya={class:"branch-node-title-container"},$a={key:0},Xa=["onBlur","onUpdate:modelValue"],Ka=["onClick"],Qa=["onClick"],Wa=["title"],Ja={key:1,class:"branch-node-text"},Za={key:0,class:"node-toolbar"},ed={class:"toolbar-icon"},td=G(q({name:"ParallelNode",__name:"ParallelNode",props:{flowNode:{type:Object,required:!0}},emits:["update:modelValue","find:parentNode","find:recursiveFindParentNode"],setup(F,{expose:t,emit:C}){t();const{proxy:e}=et(),b=F,N=C,s=A(b.flowNode),r=j("readonly");Be(()=>b.flowNode,i=>{s.value=i});const v=A([]),p={proxy:e,props:b,emits:N,currentNode:s,readonly:r,showInputs:v,blurEvent:i=>{var g;v.value[i]=!1;const o=(g=s.value.conditionNodes)==null?void 0:g.at(i);o.name=o.name||`\u5E76\u884C${i+1}`},clickEvent:i=>{v.value[i]=!0},conditionNodeConfig:i=>{e.$refs[i][0].open()},addCondition:()=>{const i=s.value.conditionNodes;if(i){const o=i.length;let g=o-1;const u={id:"Flow_"+Y(),name:"\u5E76\u884C"+o,showText:"\u65E0\u9700\u914D\u7F6E\u6761\u4EF6\u540C\u65F6\u6267\u884C",type:V.CONDITION_NODE,childNode:void 0,conditionNodes:[]};i.splice(g,0,u)}},deleteCondition:i=>{const o=s.value.conditionNodes;if(o&&(o.splice(i,1),o.length==1)){const g=s.value.childNode;N("update:modelValue",g)}},recursiveFindParentNode:(i,o,g)=>{o&&o.type!==V.START_USER_NODE&&(o.type===g&&i.push(o),N("find:parentNode",i,g))},NodeHandler:ce,ProcessNodeTree:je,get NodeType(){return V},get NODE_DEFAULT_TEXT(){return se},get useTaskStatusClass(){return ue}};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}}),[["render",function(F,t,C,e,b,N){var p;const s=ae,r=B,v=K("mountedFocus");return n(),c("div",Ga,[a("div",Ba,[e.readonly?(n(),c("div",{key:0,class:ne(["branch-node-readonly",`${e.useTaskStatusClass((p=e.currentNode)==null?void 0:p.activityStatus)}`])},t[1]||(t[1]=[a("span",{class:"iconfont icon-parallel icon-size parallel"},null,-1)]),2)):(n(),y(s,{key:1,class:"branch-node-add",color:"#626aef",onClick:e.addCondition,plain:""},{default:d(()=>t[2]||(t[2]=[O("\u6DFB\u52A0\u5206\u652F")])),_:1})),(n(!0),c(R,null,x(e.currentNode.conditionNodes,(i,o)=>{var g;return n(),c("div",{class:"branch-node-item",key:o},[o==0?(n(),c(R,{key:0},[t[3]||(t[3]=a("div",{class:"branch-line-first-top"},null,-1)),t[4]||(t[4]=a("div",{class:"branch-line-first-bottom"},null,-1))],64)):E("",!0),o+1==((g=e.currentNode.conditionNodes)==null?void 0:g.length)?(n(),c(R,{key:1},[t[5]||(t[5]=a("div",{class:"branch-line-last-top"},null,-1)),t[6]||(t[6]=a("div",{class:"branch-line-last-bottom"},null,-1))],64)):E("",!0),a("div",ja,[a("div",za,[a("div",{class:ne(["node-box",`${e.useTaskStatusClass(i.activityStatus)}`])},[a("div",Ya,[e.showInputs[o]?(n(),c("div",$a,[$(a("input",{type:"text",class:"input-max-width editable-title-input",onBlur:u=>e.blurEvent(o),"onUpdate:modelValue":u=>i.name=u},null,40,Xa),[[v],[X,i.name]])])):(n(),c("div",{key:1,class:"branch-title",onClick:u=>e.clickEvent(o)},I(i.name),9,Ka)),t[7]||(t[7]=a("div",{class:"branch-priority"},"\u65E0\u4F18\u5148\u7EA7",-1))]),a("div",{class:"branch-node-content",onClick:u=>e.conditionNodeConfig(i.id)},[i.showText?(n(),c("div",{key:0,class:"branch-node-text",title:i.showText},I(i.showText),9,Wa)):(n(),c("div",Ja,I(e.NODE_DEFAULT_TEXT.get(e.NodeType.CONDITION_NODE)),1))],8,Qa),e.readonly?E("",!0):(n(),c("div",Za,[a("div",ed,[l(r,{color:"#0089ff",icon:"ep:circle-close-filled",size:18,onClick:u=>e.deleteCondition(o)},null,8,["onClick"])])]))],2),l(e.NodeHandler,{"child-node":i.childNode,"onUpdate:childNode":u=>i.childNode=u,"current-node":i},null,8,["child-node","onUpdate:childNode","current-node"])])]),i&&i.childNode?(n(),y(e.ProcessNodeTree,{key:2,"parent-node":i,"flow-node":i.childNode,"onUpdate:flowNode":u=>i.childNode=u,"onFind:recursiveFindParentNode":e.recursiveFindParentNode},null,8,["parent-node","flow-node","onUpdate:flowNode"])):E("",!0)])}),128))]),e.currentNode?(n(),y(e.NodeHandler,{key:0,"child-node":e.currentNode.childNode,"onUpdate:childNode":t[0]||(t[0]=i=>e.currentNode.childNode=i),"current-node":e.currentNode},null,8,["child-node","current-node"])):E("",!0)])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/components/SimpleProcessDesignerV2/src/nodes/ParallelNode.vue"]]),nd={class:"branch-node-wrapper"},ld={class:"branch-node-container"},ad={class:"node-wrapper"},dd={class:"node-container"},od={class:"branch-node-title-container"},id={key:0},rd=["onBlur","onUpdate:modelValue"],sd=["onClick"],ud=["onClick"],cd=["title"],pd={key:1,class:"branch-node-text"},md={key:0,class:"node-toolbar"},vd={class:"toolbar-icon"},fd=["onClick"],gd=["onClick"],yd=G(q({name:"InclusiveNode",__name:"InclusiveNode",props:{flowNode:{type:Object,required:!0}},emits:["update:modelValue","find:parentNode","find:recursiveFindParentNode"],setup(F,{expose:t,emit:C}){t();const{proxy:e}=et(),b=F,N=C,s=j("readonly"),r=A(b.flowNode);Be(()=>b.flowNode,i=>{r.value=i});const v=A([]),p={proxy:e,props:b,emits:N,readonly:s,currentNode:r,showInputs:v,blurEvent:i=>{var g,u;v.value[i]=!1;const o=(g=r.value.conditionNodes)==null?void 0:g.at(i);o.name=o.name||In(i,(u=o.conditionSetting)==null?void 0:u.defaultFlow)},clickEvent:i=>{v.value[i]=!0},conditionNodeConfig:i=>{s||e.$refs[i][0].open()},addCondition:()=>{const i=r.value.conditionNodes;if(i){const o=i.length;let g=o-1;const u={id:"Flow_"+Y(),name:"\u5305\u5BB9\u6761\u4EF6"+o,showText:"",type:V.CONDITION_NODE,childNode:void 0,conditionNodes:[],conditionSetting:{defaultFlow:!1,conditionType:ee.RULE,conditionGroups:Ie}};i.splice(g,0,u)}},deleteCondition:i=>{const o=r.value.conditionNodes;if(o&&(o.splice(i,1),o.length==1)){const g=r.value.childNode;N("update:modelValue",g)}},moveNode:(i,o)=>{r.value.conditionNodes&&(r.value.conditionNodes[i]=r.value.conditionNodes.splice(i+o,1,r.value.conditionNodes[i])[0])},recursiveFindParentNode:(i,o,g)=>{o&&o.type!==V.START_USER_NODE&&(o.type===g&&i.push(o),N("find:parentNode",i,g))},NodeHandler:ce,ProcessNodeTree:je,get NodeType(){return V},get NODE_DEFAULT_TEXT(){return se},get useTaskStatusClass(){return ue},ConditionNodeConfig:Wt};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}}),[["render",function(F,t,C,e,b,N){var p;const s=ae,r=B,v=K("mountedFocus");return n(),c("div",nd,[a("div",ld,[e.readonly?(n(),c("div",{key:0,class:ne(["branch-node-readonly",`${e.useTaskStatusClass((p=e.currentNode)==null?void 0:p.activityStatus)}`])},t[1]||(t[1]=[a("span",{class:"iconfont icon-inclusive icon-size inclusive"},null,-1)]),2)):(n(),y(s,{key:1,class:"branch-node-add",color:"#345da2",onClick:e.addCondition,plain:""},{default:d(()=>t[2]||(t[2]=[O("\u6DFB\u52A0\u6761\u4EF6")])),_:1})),(n(!0),c(R,null,x(e.currentNode.conditionNodes,(i,o)=>{var g,u,m;return n(),c("div",{class:"branch-node-item",key:o},[o==0?(n(),c(R,{key:0},[t[3]||(t[3]=a("div",{class:"branch-line-first-top"},null,-1)),t[4]||(t[4]=a("div",{class:"branch-line-first-bottom"},null,-1))],64)):E("",!0),o+1==((g=e.currentNode.conditionNodes)==null?void 0:g.length)?(n(),c(R,{key:1},[t[5]||(t[5]=a("div",{class:"branch-line-last-top"},null,-1)),t[6]||(t[6]=a("div",{class:"branch-line-last-bottom"},null,-1))],64)):E("",!0),a("div",ad,[a("div",dd,[a("div",{class:ne(["node-box",[{"node-config-error":!i.showText},`${e.useTaskStatusClass(i.activityStatus)}`]])},[a("div",od,[!e.readonly&&e.showInputs[o]?(n(),c("div",id,[$(a("input",{type:"text",class:"editable-title-input",onBlur:k=>e.blurEvent(o),"onUpdate:modelValue":k=>i.name=k},null,40,rd),[[v],[X,i.name]])])):(n(),c("div",{key:1,class:"branch-title",onClick:k=>e.clickEvent(o)},I(i.name),9,sd))]),a("div",{class:"branch-node-content",onClick:k=>e.conditionNodeConfig(i.id)},[i.showText?(n(),c("div",{key:0,class:"branch-node-text",title:i.showText},I(i.showText),9,cd)):(n(),c("div",pd,I(e.NODE_DEFAULT_TEXT.get(e.NodeType.CONDITION_NODE)),1))],8,ud),e.readonly||o+1===((u=e.currentNode.conditionNodes)==null?void 0:u.length)?E("",!0):(n(),c("div",md,[a("div",vd,[l(r,{color:"#0089ff",icon:"ep:circle-close-filled",size:18,onClick:k=>e.deleteCondition(o)},null,8,["onClick"])])])),e.readonly||o==0||o+1===((m=e.currentNode.conditionNodes)==null?void 0:m.length)?E("",!0):(n(),c("div",{key:1,class:"branch-node-move move-node-left",onClick:k=>e.moveNode(o,-1)},[l(r,{icon:"ep:arrow-left"})],8,fd)),!e.readonly&&e.currentNode.conditionNodes&&o<e.currentNode.conditionNodes.length-2?(n(),c("div",{key:2,class:"branch-node-move move-node-right",onClick:k=>e.moveNode(o,1)},[l(r,{icon:"ep:arrow-right"})],8,gd)):E("",!0)],2),l(e.NodeHandler,{"child-node":i.childNode,"onUpdate:childNode":k=>i.childNode=k,"current-node":i},null,8,["child-node","onUpdate:childNode","current-node"])])]),l(e.ConditionNodeConfig,{"node-index":o,"condition-node":i,ref_for:!0,ref:i.id},null,8,["node-index","condition-node"]),i&&i.childNode?(n(),y(e.ProcessNodeTree,{key:2,"parent-node":i,"flow-node":i.childNode,"onUpdate:flowNode":k=>i.childNode=k,"onFind:recursiveFindParentNode":e.recursiveFindParentNode},null,8,["parent-node","flow-node","onUpdate:flowNode"])):E("",!0)])}),128))]),e.currentNode?(n(),y(e.NodeHandler,{key:0,"child-node":e.currentNode.childNode,"onUpdate:childNode":t[0]||(t[0]=i=>e.currentNode.childNode=i),"current-node":e.currentNode},null,8,["child-node","current-node"])):E("",!0)])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/components/SimpleProcessDesignerV2/src/nodes/InclusiveNode.vue"]]),Nd={class:"config-header"},_d=["placeholder"],Td={key:1,class:"node-name"},bd=G(q({name:"DelayTimerNodeConfig",__name:"DelayTimerNodeConfig",props:{flowNode:{type:Object,required:!0}},setup(F,{expose:t}){const C=F,{settingVisible:e,closeDrawer:b,openDrawer:N}=Se(),s=W(C),{nodeName:r,showInput:v,clickIcon:p,blurEvent:i}=Ce(V.DELAY_TIMER_NODE),o=A(),g=Re({delayType:[{required:!0,message:"\u5EF6\u8FDF\u65F6\u95F4\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],timeDuration:[{required:!0,message:"\u5EF6\u8FDF\u65F6\u95F4\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],dateTime:[{required:!0,message:"\u5EF6\u8FDF\u65F6\u95F4\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}]}),u=A({delayType:ve.FIXED_TIME_DURATION,timeDuration:1,timeUnit:ie.HOUR,dateTime:""}),m=()=>{let S="";return u.value.delayType===ve.FIXED_TIME_DURATION&&(S=`\u5EF6\u8FDF${u.value.timeDuration}${at.find(P=>P.value===u.value.timeUnit).label}`),u.value.delayType===ve.FIXED_DATE_TIME&&(S=`\u5EF6\u8FDF\u81F3${u.value.dateTime.replace("T"," ")}`),S},k=()=>{let S="PT";return u.value.timeUnit===ie.MINUTE&&(S+=u.value.timeDuration+"M"),u.value.timeUnit===ie.HOUR&&(S+=u.value.timeDuration+"H"),u.value.timeUnit===ie.DAY&&(S+=u.value.timeDuration+"D"),S},w=S=>{if(r.value=S.name,S.delaySetting){if(u.value.delayType=S.delaySetting.delayType,u.value.delayType===ve.FIXED_TIME_DURATION){const P=S.delaySetting.delayTime;let h=P.slice(2,P.length-1),T=P.slice(P.length-1);u.value.timeDuration=parseInt(h),u.value.timeUnit=zt(T)}u.value.delayType===ve.FIXED_DATE_TIME&&(u.value.dateTime=S.delaySetting.delayTime)}};t({openDrawer:N,showDelayTimerNodeConfig:w});const _={props:C,settingVisible:e,closeDrawer:b,openDrawer:N,currentNode:s,nodeName:r,showInput:v,clickIcon:p,blurEvent:i,formRef:o,formRules:g,configForm:u,saveConfig:async()=>{if(!o||!await o.value.validate())return!1;const S=m();return!!S&&(s.value.name=r.value,s.value.showText=S,u.value.delayType===ve.FIXED_TIME_DURATION&&(s.value.delaySetting={delayType:u.value.delayType,delayTime:k()}),u.value.delayType===ve.FIXED_DATE_TIME&&(s.value.delaySetting={delayType:u.value.delayType,delayTime:u.value.dateTime}),e.value=!1,!0)},getShowText:m,getIsoTimeDuration:k,showDelayTimerNodeConfig:w,get TIME_UNIT_TYPES(){return at},get DelayTypeEnum(){return ve},get DELAY_TYPE(){return Dn}};return Object.defineProperty(_,"__isScriptSetup",{enumerable:!1,value:!0}),_}}),[["render",function(F,t,C,e,b,N){const s=B,r=xt,v=Fe,p=fe,i=Pt,o=ge,g=ye,u=qe,m=sn,k=Ne,w=me,_=ae,S=_e,P=K("mountedFocus");return n(),y(S,{"append-to-body":!0,modelValue:e.settingVisible,"onUpdate:modelValue":t[7]||(t[7]=h=>e.settingVisible=h),"show-close":!1,size:550,"before-close":e.saveConfig},{header:d(()=>[a("div",Nd,[e.showInput?$((n(),c("input",{key:0,type:"text",class:"config-editable-input",onBlur:t[0]||(t[0]=h=>e.blurEvent()),"onUpdate:modelValue":t[1]||(t[1]=h=>e.nodeName=h),placeholder:e.nodeName},null,40,_d)),[[P],[X,e.nodeName]]):(n(),c("div",Td,[O(I(e.nodeName)+" ",1),l(s,{class:"ml-1",icon:"ep:edit-pen",size:16,onClick:t[2]||(t[2]=h=>e.clickIcon())})])),t[8]||(t[8]=a("div",{class:"divide-line"},null,-1))])]),footer:d(()=>[l(w),a("div",null,[l(_,{type:"primary",onClick:e.saveConfig},{default:d(()=>t[11]||(t[11]=[O("\u786E \u5B9A")])),_:1}),l(_,{onClick:e.closeDrawer},{default:d(()=>t[12]||(t[12]=[O("\u53D6 \u6D88")])),_:1},8,["onClick"])])]),default:d(()=>[a("div",null,[l(k,{ref:"formRef",model:e.configForm,"label-position":"top",rules:e.formRules},{default:d(()=>[l(p,{label:"\u5EF6\u8FDF\u65F6\u95F4",prop:"delayType"},{default:d(()=>[l(v,{modelValue:e.configForm.delayType,"onUpdate:modelValue":t[3]||(t[3]=h=>e.configForm.delayType=h)},{default:d(()=>[(n(!0),c(R,null,x(e.DELAY_TYPE,h=>(n(),y(r,{key:h.value,label:h.label,value:h.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e.configForm.delayType===e.DelayTypeEnum.FIXED_TIME_DURATION?(n(),y(p,{key:0},{default:d(()=>[l(p,{prop:"timeDuration"},{default:d(()=>[l(i,{class:"mr-2",style:{width:"100px"},modelValue:e.configForm.timeDuration,"onUpdate:modelValue":t[4]||(t[4]=h=>e.configForm.timeDuration=h),min:1,"controls-position":"right"},null,8,["modelValue"])]),_:1}),l(g,{modelValue:e.configForm.timeUnit,"onUpdate:modelValue":t[5]||(t[5]=h=>e.configForm.timeUnit=h),class:"mr-2",style:{width:"100px"}},{default:d(()=>[(n(!0),c(R,null,x(e.TIME_UNIT_TYPES,h=>(n(),y(o,{key:h.value,label:h.label,value:h.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),l(u,null,{default:d(()=>t[9]||(t[9]=[O("\u540E\u8FDB\u5165\u4E0B\u4E00\u8282\u70B9")])),_:1})]),_:1})):E("",!0),e.configForm.delayType===e.DelayTypeEnum.FIXED_DATE_TIME?(n(),y(p,{key:1,prop:"dateTime"},{default:d(()=>[l(m,{class:"mr-2",modelValue:e.configForm.dateTime,"onUpdate:modelValue":t[6]||(t[6]=h=>e.configForm.dateTime=h),type:"datetime",placeholder:"\u8BF7\u9009\u62E9\u65E5\u671F\u548C\u65F6\u95F4","value-format":"YYYY-MM-DDTHH:mm:ss"},null,8,["modelValue"]),l(u,null,{default:d(()=>t[10]||(t[10]=[O("\u540E\u8FDB\u5165\u4E0B\u4E00\u8282\u70B9")])),_:1})]),_:1})):E("",!0)]),_:1},8,["model","rules"])])]),_:1},8,["modelValue"])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/components/SimpleProcessDesignerV2/src/nodes-config/DelayTimerNodeConfig.vue"]]),hd={class:"node-wrapper"},Ed={class:"node-container"},kd={class:"node-title-container"},Sd=["placeholder"],Cd=["title"],wd={key:1,class:"node-text"},Ud={key:0,class:"node-toolbar"},Vd={class:"toolbar-icon"},Fd=G(q({name:"DelayTimerNode",__name:"DelayTimerNode",props:{flowNode:{type:Object,required:!0}},emits:["update:flowNode"],setup(F,{expose:t,emit:C}){t();const e=F,b=C,N=j("readonly"),s=W(e),{showInput:r,blurEvent:v,clickTitle:p}=we(s,V.DELAY_TIMER_NODE),i=A(),o={props:e,emits:b,readonly:N,currentNode:s,showInput:r,blurEvent:v,clickTitle:p,nodeSetting:i,openNodeConfig:()=>{N||(i.value.showDelayTimerNodeConfig(s.value),i.value.openDrawer())},deleteNode:()=>{b("update:flowNode",s.value.childNode)},get NodeType(){return V},get NODE_DEFAULT_TEXT(){return se},NodeHandler:ce,get useTaskStatusClass(){return ue},DelayTimerNodeConfig:bd};return Object.defineProperty(o,"__isScriptSetup",{enumerable:!1,value:!0}),o}}),[["render",function(F,t,C,e,b,N){var v;const s=B,r=K("mountedFocus");return n(),c("div",hd,[a("div",Ed,[a("div",{class:ne(["node-box",[{"node-config-error":!e.currentNode.showText},`${e.useTaskStatusClass((v=e.currentNode)==null?void 0:v.activityStatus)}`]])},[a("div",kd,[t[4]||(t[4]=a("div",{class:"node-title-icon delay-node"},[a("span",{class:"iconfont icon-delay"})],-1)),!e.readonly&&e.showInput?$((n(),c("input",{key:0,type:"text",class:"editable-title-input",onBlur:t[0]||(t[0]=p=>e.blurEvent()),"onUpdate:modelValue":t[1]||(t[1]=p=>e.currentNode.name=p),placeholder:e.currentNode.name},null,40,Sd)),[[r],[X,e.currentNode.name]]):(n(),c("div",{key:1,class:"node-title",onClick:t[2]||(t[2]=(...p)=>e.clickTitle&&e.clickTitle(...p))},I(e.currentNode.name),1))]),a("div",{class:"node-content",onClick:e.openNodeConfig},[e.currentNode.showText?(n(),c("div",{key:0,class:"node-text",title:e.currentNode.showText},I(e.currentNode.showText),9,Cd)):(n(),c("div",wd,I(e.NODE_DEFAULT_TEXT.get(e.NodeType.DELAY_TIMER_NODE)),1)),e.readonly?E("",!0):(n(),y(s,{key:2,icon:"ep:arrow-right-bold"}))]),e.readonly?E("",!0):(n(),c("div",Ud,[a("div",Vd,[l(s,{color:"#0089ff",icon:"ep:circle-close-filled",size:18,onClick:e.deleteNode})])]))],2),e.currentNode?(n(),y(e.NodeHandler,{key:0,"child-node":e.currentNode.childNode,"onUpdate:childNode":t[3]||(t[3]=p=>e.currentNode.childNode=p),"current-node":e.currentNode},null,8,["child-node","current-node"])):E("",!0)]),!e.readonly&&e.currentNode?(n(),y(e.DelayTimerNodeConfig,{key:0,ref:"nodeSetting","flow-node":e.currentNode},null,8,["flow-node"])):E("",!0)])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/components/SimpleProcessDesignerV2/src/nodes/DelayTimerNode.vue"]]),Dd={class:"config-header"},Rd=["placeholder"],Od={key:1,class:"node-name"},Id={class:"flex flex-items-center"},Pd=G(q({name:"RouterNodeConfig",__name:"RouterNodeConfig",props:{flowNode:{type:Object,required:!0}},setup(F,{expose:t}){const C=Me(),e=F,b=j("processNodeTree"),{settingVisible:N,closeDrawer:s,openDrawer:r}=Se(),v=W(e),{nodeName:p,showInput:i,clickIcon:o,blurEvent:g}=Ce(V.ROUTER_BRANCH_NODE),u=A([]),m=A([]),k=A([]),w=h=>{S(b==null?void 0:b.value),u.value=[],p.value=h.name,h.routerGroups&&(u.value=h.routerGroups)},_=()=>{if(!u.value||!Array.isArray(u.value)||u.value.length<=0)return C.warning("\u8BF7\u914D\u7F6E\u8DEF\u7531\uFF01"),"";for(const h of u.value){if(!h.nodeId||!h.conditionType||h.conditionType===ee.EXPRESSION&&!h.conditionExpression)return C.warning("\u8BF7\u5B8C\u5584\u8DEF\u7531\u914D\u7F6E\u9879\uFF01"),"";if(h.conditionType===ee.RULE){for(const T of h.conditionGroups.conditions)for(const L of T.rules)if(!L.leftSide||!L.rightSide)return C.warning("\u8BF7\u5B8C\u5584\u8DEF\u7531\u914D\u7F6E\u9879\uFF01"),""}}return`${u.value.length}\u6761\u8DEF\u7531\u5206\u652F`},S=h=>{for(;h&&(h.type!==V.ROUTER_BRANCH_NODE&&h.type!==V.CONDITION_NODE&&m.value.push({label:h.name,value:h.id}),h.childNode&&h.type!==V.END_EVENT_NODE);)h.conditionNodes&&h.conditionNodes.length&&h.conditionNodes.forEach(T=>{S(T)}),h=h.childNode};t({openDrawer:r,showRouteNodeConfig:w});const P={message:C,props:e,processNodeTree:b,settingVisible:N,closeDrawer:s,openDrawer:r,currentNode:v,nodeName:p,showInput:i,clickIcon:o,blurEvent:g,routerGroups:u,nodeOptions:m,conditionRef:k,saveConfig:async()=>{let h=!0;for(const L of k.value)L&&!await L.validate()&&(h=!1);if(!h)return!1;const T=_();return!!T&&(v.value.name=p.value,v.value.showText=T,v.value.routerGroups=u.value,N.value=!1,!0)},showRouteNodeConfig:w,getShowText:_,addRouterGroup:()=>{u.value.push({nodeId:"",conditionType:ee.RULE,conditionExpression:"",conditionGroups:{and:!0,conditions:[{and:!0,rules:[{opCode:"==",leftSide:"",rightSide:""}]}]}})},deleteRouterGroup:h=>{u.value.splice(h,1)},getRouterNode:S,get Plus(){return un},Condition:Qt};return Object.defineProperty(P,"__isScriptSetup",{enumerable:!1,value:!0}),P}}),[["render",function(F,t,C,e,b,N){const s=B,r=qe,v=ge,p=ye,i=ae,o=At,g=Ne,u=me,m=_e,k=K("mountedFocus");return n(),y(m,{"append-to-body":!0,modelValue:e.settingVisible,"onUpdate:modelValue":t[3]||(t[3]=w=>e.settingVisible=w),"show-close":!1,size:630,"before-close":e.saveConfig},{header:d(()=>[a("div",Dd,[e.showInput?$((n(),c("input",{key:0,type:"text",class:"config-editable-input",onBlur:t[0]||(t[0]=w=>e.blurEvent()),"onUpdate:modelValue":t[1]||(t[1]=w=>e.nodeName=w),placeholder:e.nodeName},null,40,Rd)),[[k],[X,e.nodeName]]):(n(),c("div",Od,[O(I(e.nodeName)+" ",1),l(s,{class:"ml-1",icon:"ep:edit-pen",size:16,onClick:t[2]||(t[2]=w=>e.clickIcon())})])),t[4]||(t[4]=a("div",{class:"divide-line"},null,-1))])]),footer:d(()=>[l(u),a("div",null,[l(i,{type:"primary",onClick:e.saveConfig},{default:d(()=>t[7]||(t[7]=[O("\u786E \u5B9A")])),_:1}),l(i,{onClick:e.closeDrawer},{default:d(()=>t[8]||(t[8]=[O("\u53D6 \u6D88")])),_:1},8,["onClick"])])]),default:d(()=>[a("div",null,[l(g,{"label-position":"top"},{default:d(()=>[(n(!0),c(R,null,x(e.routerGroups,(w,_)=>(n(),y(o,{class:"mb-15px",key:_},{header:d(()=>[a("div",Id,[l(r,{size:"large"},{default:d(()=>[O("\u8DEF\u7531"+I(_+1),1)]),_:2},1024),l(p,{class:"ml-15px",modelValue:w.nodeId,"onUpdate:modelValue":S=>w.nodeId=S,style:{width:"180px"}},{default:d(()=>[(n(!0),c(R,null,x(e.nodeOptions,S=>(n(),y(v,{key:S.value,label:S.label,value:S.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"]),l(i,{class:"mla",type:"danger",link:"",onClick:S=>e.deleteRouterGroup(_)},{default:d(()=>[...t[5]||(t[5]=[O(" \u5220\u9664 ")])]),_:2},1032,["onClick"])])]),default:d(()=>[l(e.Condition,{ref_for:!0,ref:S=>e.conditionRef[_]=S,modelValue:e.routerGroups[_],"onUpdate:modelValue":S=>e.routerGroups[_]=S},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024))),128))]),_:1}),l(i,{class:"w-1/1",type:"primary",icon:e.Plus,onClick:e.addRouterGroup},{default:d(()=>t[6]||(t[6]=[O(" \u65B0\u589E\u8DEF\u7531\u5206\u652F ")])),_:1},8,["icon"])])]),_:1},8,["modelValue"])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/components/SimpleProcessDesignerV2/src/nodes-config/RouterNodeConfig.vue"]]),xd={class:"node-wrapper"},Ad={class:"node-container"},Ld={class:"node-title-container"},Hd=["placeholder"],Md=["title"],qd={key:1,class:"node-text"},Gd={key:0,class:"node-toolbar"},Bd={class:"toolbar-icon"},jd=G(q({name:"RouterNode",__name:"RouterNode",props:{flowNode:{type:Object,required:!0}},emits:["update:flowNode"],setup(F,{expose:t,emit:C}){t();const e=F,b=C,N=j("readonly"),s=W(e),{showInput:r,blurEvent:v,clickTitle:p}=we(s,V.ROUTER_BRANCH_NODE),i=A(),o={props:e,emits:b,readonly:N,currentNode:s,showInput:r,blurEvent:v,clickTitle:p,nodeSetting:i,openNodeConfig:()=>{N||(i.value.showRouteNodeConfig(s.value),i.value.openDrawer())},deleteNode:()=>{b("update:flowNode",s.value.childNode)},get NodeType(){return V},get NODE_DEFAULT_TEXT(){return se},NodeHandler:ce,get useTaskStatusClass(){return ue},RouterNodeConfig:Pd};return Object.defineProperty(o,"__isScriptSetup",{enumerable:!1,value:!0}),o}}),[["render",function(F,t,C,e,b,N){var v;const s=B,r=K("mountedFocus");return n(),c("div",xd,[a("div",Ad,[a("div",{class:ne(["node-box",[{"node-config-error":!e.currentNode.showText},`${e.useTaskStatusClass((v=e.currentNode)==null?void 0:v.activityStatus)}`]])},[a("div",Ld,[t[4]||(t[4]=a("div",{class:"node-title-icon router-node"},[a("span",{class:"iconfont icon-router"})],-1)),!e.readonly&&e.showInput?$((n(),c("input",{key:0,type:"text",class:"editable-title-input",onBlur:t[0]||(t[0]=p=>e.blurEvent()),"onUpdate:modelValue":t[1]||(t[1]=p=>e.currentNode.name=p),placeholder:e.currentNode.name},null,40,Hd)),[[r],[X,e.currentNode.name]]):(n(),c("div",{key:1,class:"node-title",onClick:t[2]||(t[2]=(...p)=>e.clickTitle&&e.clickTitle(...p))},I(e.currentNode.name),1))]),a("div",{class:"node-content",onClick:e.openNodeConfig},[e.currentNode.showText?(n(),c("div",{key:0,class:"node-text",title:e.currentNode.showText},I(e.currentNode.showText),9,Md)):(n(),c("div",qd,I(e.NODE_DEFAULT_TEXT.get(e.NodeType.ROUTER_BRANCH_NODE)),1)),e.readonly?E("",!0):(n(),y(s,{key:2,icon:"ep:arrow-right-bold"}))]),e.readonly?E("",!0):(n(),c("div",Gd,[a("div",Bd,[l(s,{color:"#0089ff",icon:"ep:circle-close-filled",size:18,onClick:e.deleteNode})])]))],2),e.currentNode?(n(),y(e.NodeHandler,{key:0,"child-node":e.currentNode.childNode,"onUpdate:childNode":t[3]||(t[3]=p=>e.currentNode.childNode=p),"current-node":e.currentNode},null,8,["child-node","current-node"])):E("",!0)]),!e.readonly&&e.currentNode?(n(),y(e.RouterNodeConfig,{key:0,ref:"nodeSetting","flow-node":e.currentNode},null,8,["flow-node"])):E("",!0)])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/components/SimpleProcessDesignerV2/src/nodes/RouterNode.vue"]]),zd={class:"config-header"},Yd=["placeholder"],$d={key:1,class:"node-name"},Xd={key:0},Kd={class:"mr-2"},Qd={class:"mr-2"},Wd={class:"mr-1 pt-1 cursor-pointer"},Jd={key:1},Zd={class:"mr-2 flex items-center"},eo={class:"mx-2"},to={class:"mr-2"},no={class:"mr-1 pt-1 cursor-pointer"},lo=G(q({name:"TriggerNodeConfig",__name:"TriggerNodeConfig",props:{flowNode:{type:Object,required:!0}},setup(F,{expose:t}){const C=F,e=Me(),{settingVisible:b,closeDrawer:N,openDrawer:s}=Se(),r=W(C),{nodeName:v,showInput:p,clickIcon:i,blurEvent:o}=Ce(V.TRIGGER_NODE),g=A(),u=Re({type:[{required:!0,message:"\u89E6\u53D1\u5668\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],"httpRequestSetting.url":[{required:!0,message:"\u8BF7\u6C42\u5730\u5740\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),m=A({type:ke.HTTP_REQUEST,httpRequestSetting:{url:"",header:[],body:[],response:[]},normalFormSetting:{updateFormFields:{}}}),k=Pn(),w=Z(()=>{var T;const h=Object.keys(((T=m.value.normalFormSetting)==null?void 0:T.updateFormFields)||{});return k.map(L=>({title:L.title,field:L.field,disabled:h.includes(L.field)}))}),_=()=>{var T,L;let h="";return m.value.type===ke.HTTP_REQUEST?h=`${(T=m.value.httpRequestSetting)==null?void 0:T.url}`:m.value.type===ke.UPDATE_NORMAL_FORM&&(Object.keys(((L=m.value.normalFormSetting)==null?void 0:L.updateFormFields)||{}).length===0?e.warning("\u8BF7\u8BBE\u7F6E\u4FEE\u6539\u8868\u5355\u5B57\u6BB5"):h="\u4FEE\u6539\u8868\u5355\u6570\u636E"),h},S=h=>{v.value=h.name,h.triggerSetting&&(m.value={type:h.triggerSetting.type,httpRequestSetting:h.triggerSetting.httpRequestSetting||{url:"",header:[],body:[],response:[]},normalFormSetting:h.triggerSetting.normalFormSetting||{updateFormFields:{}}})};t({openDrawer:s,showTriggerNodeConfig:S});const P={props:C,message:e,settingVisible:b,closeDrawer:N,openDrawer:s,currentNode:r,nodeName:v,showInput:p,clickIcon:i,blurEvent:o,formRef:g,formRules:u,configForm:m,formFields:k,optionalUpdateFormFields:w,updateFormFieldKey:(h,T)=>{var J;if(!((J=m.value.normalFormSetting)!=null&&J.updateFormFields))return;const L=m.value.normalFormSetting.updateFormFields[h];delete m.value.normalFormSetting.updateFormFields[h],m.value.normalFormSetting.updateFormFields[T]=L},addHttpResponseSetting:h=>{h.push({key:"",value:""})},deleteHttpResponseSetting:(h,T)=>{h.splice(T,1)},addFormFieldSetting:()=>{m.value.normalFormSetting.updateFormFields===void 0&&(m.value.normalFormSetting.updateFormFields={}),m.value.normalFormSetting.updateFormFields[""]=void 0},deleteFormFieldSetting:h=>{var T;(T=m.value.normalFormSetting)!=null&&T.updateFormFields&&delete m.value.normalFormSetting.updateFormFields[h]},saveConfig:async()=>{if(!g||!await g.value.validate())return!1;const h=_();return!!h&&(r.value.name=v.value,r.value.showText=h,m.value.type===ke.HTTP_REQUEST&&(m.value.normalFormSetting=void 0),m.value.type===ke.UPDATE_NORMAL_FORM&&(m.value.httpRequestSetting=void 0),r.value.triggerSetting=m.value,b.value=!1,!0)},getShowText:_,showTriggerNodeConfig:S,get TRIGGER_TYPES(){return Rn},get TriggerTypeEnum(){return ke},HttpRequestParamSetting:Kt};return Object.defineProperty(P,"__isScriptSetup",{enumerable:!1,value:!0}),P}}),[["render",function(F,t,C,e,b,N){const s=B,r=ge,v=ye,p=fe,i=It,o=Te,g=ae,u=me,m=Ne,k=_e,w=K("mountedFocus");return n(),y(k,{"append-to-body":!0,modelValue:e.settingVisible,"onUpdate:modelValue":t[7]||(t[7]=_=>e.settingVisible=_),"show-close":!1,size:550,"before-close":e.saveConfig},{header:d(()=>[a("div",zd,[e.showInput?$((n(),c("input",{key:0,type:"text",class:"config-editable-input",onBlur:t[0]||(t[0]=_=>e.blurEvent()),"onUpdate:modelValue":t[1]||(t[1]=_=>e.nodeName=_),placeholder:e.nodeName},null,40,Yd)),[[w],[X,e.nodeName]]):(n(),c("div",$d,[O(I(e.nodeName)+" ",1),l(s,{class:"ml-1",icon:"ep:edit-pen",size:16,onClick:t[2]||(t[2]=_=>e.clickIcon())})])),t[8]||(t[8]=a("div",{class:"divide-line"},null,-1))])]),footer:d(()=>[l(u),a("div",null,[l(g,{type:"primary",onClick:e.saveConfig},{default:d(()=>t[13]||(t[13]=[O("\u786E \u5B9A")])),_:1}),l(g,{onClick:e.closeDrawer},{default:d(()=>t[14]||(t[14]=[O("\u53D6 \u6D88")])),_:1},8,["onClick"])])]),default:d(()=>[a("div",null,[l(m,{ref:"formRef",model:e.configForm,"label-position":"top",rules:e.formRules},{default:d(()=>[l(p,{label:"\u89E6\u53D1\u5668\u7C7B\u578B",prop:"type"},{default:d(()=>[l(v,{modelValue:e.configForm.type,"onUpdate:modelValue":t[3]||(t[3]=_=>e.configForm.type=_)},{default:d(()=>[(n(!0),c(R,null,x(e.TRIGGER_TYPES,(_,S)=>(n(),y(r,{key:S,value:_.value,label:_.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),e.configForm.type===e.TriggerTypeEnum.HTTP_REQUEST&&e.configForm.httpRequestSetting?(n(),c("div",Xd,[l(p,null,{default:d(()=>[l(i,{title:"\u4EC5\u652F\u6301 POST \u8BF7\u6C42\uFF0C\u4EE5\u8BF7\u6C42\u4F53\u65B9\u5F0F\u63A5\u6536\u53C2\u6570",type:"warning","show-icon":"",closable:!1})]),_:1}),l(p,{label:"\u8BF7\u6C42\u5730\u5740",prop:"httpRequestSetting.url"},{default:d(()=>[l(o,{modelValue:e.configForm.httpRequestSetting.url,"onUpdate:modelValue":t[4]||(t[4]=_=>e.configForm.httpRequestSetting.url=_)},null,8,["modelValue"])]),_:1}),l(e.HttpRequestParamSetting,{header:e.configForm.httpRequestSetting.header,body:e.configForm.httpRequestSetting.body,bind:"httpRequestSetting"},null,8,["header","body"]),l(p,{label:"\u8FD4\u56DE\u503C"},{default:d(()=>[l(i,{title:"\u901A\u8FC7\u8BF7\u6C42\u8FD4\u56DE\u503C, \u53EF\u4EE5\u4FEE\u6539\u6D41\u7A0B\u8868\u5355\u7684\u503C",type:"warning","show-icon":"",closable:!1})]),_:1}),l(p,null,{default:d(()=>[(n(!0),c(R,null,x(e.configForm.httpRequestSetting.response,(_,S)=>(n(),c("div",{class:"flex pt-2",key:S},[a("div",Kd,[l(p,{prop:`httpRequestSetting.response.${S}.key`,rules:{required:!0,message:"\u8868\u5355\u5B57\u6BB5\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}},{default:d(()=>[l(v,{class:"w-160px!",modelValue:_.key,"onUpdate:modelValue":P=>_.key=P,placeholder:"\u8BF7\u9009\u62E9\u8868\u5355\u5B57\u6BB5"},{default:d(()=>[(n(!0),c(R,null,x(e.formFields,(P,h)=>(n(),y(r,{key:h,label:P.title,value:P.field,disabled:!P.required},null,8,["label","value","disabled"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"])]),a("div",Qd,[l(p,{prop:`httpRequestSetting.response.${S}.value`,rules:{required:!0,message:"\u8BF7\u6C42\u8FD4\u56DE\u5B57\u6BB5\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}},{default:d(()=>[l(o,{class:"w-160px",modelValue:_.value,"onUpdate:modelValue":P=>_.value=P,placeholder:"\u8BF7\u6C42\u8FD4\u56DE\u5B57\u6BB5"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"])]),a("div",Wd,[l(s,{icon:"ep:delete",size:18,onClick:P=>e.deleteHttpResponseSetting(e.configForm.httpRequestSetting.response,S)},null,8,["onClick"])])]))),128)),l(g,{type:"primary",text:"",onClick:t[5]||(t[5]=_=>e.addHttpResponseSetting(e.configForm.httpRequestSetting.response))},{default:d(()=>[l(s,{icon:"ep:plus",class:"mr-5px"}),t[9]||(t[9]=O("\u6DFB\u52A0\u4E00\u884C "))]),_:1})]),_:1})])):E("",!0),e.configForm.type===e.TriggerTypeEnum.UPDATE_NORMAL_FORM&&e.configForm.normalFormSetting?(n(),c("div",Jd,[l(u,{"content-position":"left"},{default:d(()=>t[10]||(t[10]=[O("\u4FEE\u6539\u8868\u5355\u8BBE\u7F6E")])),_:1}),(n(!0),c(R,null,x(Object.keys(e.configForm.normalFormSetting.updateFormFields),_=>(n(),c("div",{class:"flex items-center",key:_},[a("div",Zd,[l(p,null,{default:d(()=>[l(v,{class:"w-160px!","model-value":_,"onUpdate:modelValue":S=>e.updateFormFieldKey(_,S),placeholder:"\u8BF7\u9009\u62E9\u8868\u5355\u5B57\u6BB5",disabled:_!==""},{default:d(()=>[(n(!0),c(R,null,x(e.optionalUpdateFormFields,(S,P)=>(n(),y(r,{key:P,label:S.title,value:S.field,disabled:S.disabled},null,8,["label","value","disabled"]))),128))]),_:2},1032,["model-value","onUpdate:modelValue","disabled"])]),_:2},1024)]),a("div",eo,[l(p,null,{default:d(()=>[...t[11]||(t[11]=[O("\u7684\u503C\u8BBE\u7F6E\u4E3A")])]),_:1})]),a("div",to,[l(p,{prop:`normalFormSetting.updateFormFields.${_}`,rules:{required:!0,message:"\u503C\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}},{default:d(()=>[l(o,{class:"w-160px",modelValue:e.configForm.normalFormSetting.updateFormFields[_],"onUpdate:modelValue":S=>e.configForm.normalFormSetting.updateFormFields[_]=S,placeholder:"\u8BF7\u8F93\u5165",disabled:!_},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["prop"])]),a("div",no,[l(p,null,{default:d(()=>[l(s,{icon:"ep:delete",size:18,onClick:S=>e.deleteFormFieldSetting(_)},null,8,["onClick"])]),_:2},1024)])]))),128)),l(g,{type:"primary",text:"",onClick:t[6]||(t[6]=_=>e.addFormFieldSetting())},{default:d(()=>[l(s,{icon:"ep:plus",class:"mr-5px"}),t[12]||(t[12]=O("\u6DFB\u52A0\u4FEE\u6539\u5B57\u6BB5 "))]),_:1})])):E("",!0)]),_:1},8,["model","rules"])])]),_:1},8,["modelValue"])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/components/SimpleProcessDesignerV2/src/nodes-config/TriggerNodeConfig.vue"]]),ao={class:"node-wrapper"},oo={class:"node-container"},io={class:"node-title-container"},ro=["placeholder"],so=["title"],uo={key:1,class:"node-text"},co={key:0,class:"node-toolbar"},po={class:"toolbar-icon"},mo=G(q({name:"TriggerNode",__name:"TriggerNode",props:{flowNode:{type:Object,required:!0}},emits:["update:flowNode"],setup(F,{expose:t,emit:C}){t();const e=F,b=C,N=j("readonly"),s=W(e),{showInput:r,blurEvent:v,clickTitle:p}=we(s,V.TRIGGER_NODE),i=A(),o={props:e,emits:b,readonly:N,currentNode:s,showInput:r,blurEvent:v,clickTitle:p,nodeSetting:i,openNodeConfig:()=>{N||(i.value.showTriggerNodeConfig(s.value),i.value.openDrawer())},deleteNode:()=>{b("update:flowNode",s.value.childNode)},get NodeType(){return V},get NODE_DEFAULT_TEXT(){return se},NodeHandler:ce,get useTaskStatusClass(){return ue},TriggerNodeConfig:lo};return Object.defineProperty(o,"__isScriptSetup",{enumerable:!1,value:!0}),o}}),[["render",function(F,t,C,e,b,N){var v;const s=B,r=K("mountedFocus");return n(),c("div",ao,[a("div",oo,[a("div",{class:ne(["node-box",[{"node-config-error":!e.currentNode.showText},`${e.useTaskStatusClass((v=e.currentNode)==null?void 0:v.activityStatus)}`]])},[a("div",io,[t[4]||(t[4]=a("div",{class:"node-title-icon trigger-node"},[a("span",{class:"iconfont icon-trigger"})],-1)),!e.readonly&&e.showInput?$((n(),c("input",{key:0,type:"text",class:"editable-title-input",onBlur:t[0]||(t[0]=p=>e.blurEvent()),"onUpdate:modelValue":t[1]||(t[1]=p=>e.currentNode.name=p),placeholder:e.currentNode.name},null,40,ro)),[[r],[X,e.currentNode.name]]):(n(),c("div",{key:1,class:"node-title",onClick:t[2]||(t[2]=(...p)=>e.clickTitle&&e.clickTitle(...p))},I(e.currentNode.name),1))]),a("div",{class:"node-content",onClick:e.openNodeConfig},[e.currentNode.showText?(n(),c("div",{key:0,class:"node-text",title:e.currentNode.showText},I(e.currentNode.showText),9,so)):(n(),c("div",uo,I(e.NODE_DEFAULT_TEXT.get(e.NodeType.TRIGGER_NODE)),1)),e.readonly?E("",!0):(n(),y(s,{key:2,icon:"ep:arrow-right-bold"}))]),e.readonly?E("",!0):(n(),c("div",co,[a("div",po,[l(s,{color:"#0089ff",icon:"ep:circle-close-filled",size:18,onClick:e.deleteNode})])]))],2),e.currentNode?(n(),y(e.NodeHandler,{key:0,"child-node":e.currentNode.childNode,"onUpdate:childNode":t[3]||(t[3]=p=>e.currentNode.childNode=p),"current-node":e.currentNode},null,8,["child-node","current-node"])):E("",!0)]),!e.readonly&&e.currentNode?(n(),y(e.TriggerNodeConfig,{key:0,ref:"nodeSetting","flow-node":e.currentNode},null,8,["flow-node"])):E("",!0)])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/components/SimpleProcessDesignerV2/src/nodes/TriggerNode.vue"]]),je=G(q({name:"ProcessNodeTree",__name:"ProcessNodeTree",props:{parentNode:{type:Object,default:()=>null},flowNode:{type:Object,default:()=>null}},emits:["update:flowNode","find:recursiveFindParentNode"],setup(F,{expose:t,emit:C}){t();const e=F,b=C,N=W(e),s={props:e,emits:b,currentNode:N,handleModelValueUpdate:r=>{b("update:flowNode",r)},findFromParentNode:(r,v)=>{b("find:recursiveFindParentNode",r,e.parentNode,v)},recursiveFindParentNode:(r,v,p)=>{v&&(v.type!==V.START_USER_NODE?(v.type===p&&r.push(v),b("find:recursiveFindParentNode",r,e.parentNode,p)):r.push(v))},StartUserNode:al,EndEventNode:ol,UserTaskNode:jl,CopyTaskNode:ra,ExclusiveNode:qa,ParallelNode:td,InclusiveNode:yd,DelayTimerNode:Fd,RouterNode:jd,TriggerNode:mo,get NodeType(){return V}};return Object.defineProperty(s,"__isScriptSetup",{enumerable:!1,value:!0}),s}}),[["render",function(F,t,C,e,b,N){const s=cn("ProcessNodeTree",!0);return n(),c(R,null,[e.currentNode&&e.currentNode.type===e.NodeType.START_USER_NODE?(n(),y(e.StartUserNode,{key:0,"flow-node":e.currentNode},null,8,["flow-node"])):E("",!0),e.currentNode&&e.currentNode.type===e.NodeType.USER_TASK_NODE?(n(),y(e.UserTaskNode,{key:1,"flow-node":e.currentNode,"onUpdate:flowNode":e.handleModelValueUpdate,"onFind:parentNode":e.findFromParentNode},null,8,["flow-node"])):E("",!0),e.currentNode&&e.currentNode.type===e.NodeType.COPY_TASK_NODE?(n(),y(e.CopyTaskNode,{key:2,"flow-node":e.currentNode,"onUpdate:flowNode":e.handleModelValueUpdate},null,8,["flow-node"])):E("",!0),e.currentNode&&e.currentNode.type===e.NodeType.CONDITION_BRANCH_NODE?(n(),y(e.ExclusiveNode,{key:3,"flow-node":e.currentNode,"onUpdate:modelValue":e.handleModelValueUpdate,"onFind:parentNode":e.findFromParentNode},null,8,["flow-node"])):E("",!0),e.currentNode&&e.currentNode.type===e.NodeType.PARALLEL_BRANCH_NODE?(n(),y(e.ParallelNode,{key:4,"flow-node":e.currentNode,"onUpdate:modelValue":e.handleModelValueUpdate,"onFind:parentNode":e.findFromParentNode},null,8,["flow-node"])):E("",!0),e.currentNode&&e.currentNode.type===e.NodeType.INCLUSIVE_BRANCH_NODE?(n(),y(e.InclusiveNode,{key:5,"flow-node":e.currentNode,"onUpdate:modelValue":e.handleModelValueUpdate,"onFind:parentNode":e.findFromParentNode},null,8,["flow-node"])):E("",!0),e.currentNode&&e.currentNode.type===e.NodeType.DELAY_TIMER_NODE?(n(),y(e.DelayTimerNode,{key:6,"flow-node":e.currentNode,"onUpdate:flowNode":e.handleModelValueUpdate},null,8,["flow-node"])):E("",!0),e.currentNode&&e.currentNode.type===e.NodeType.ROUTER_BRANCH_NODE?(n(),y(e.RouterNode,{key:7,"flow-node":e.currentNode,"onUpdate:flowNode":e.handleModelValueUpdate},null,8,["flow-node"])):E("",!0),e.currentNode&&e.currentNode.type===e.NodeType.TRIGGER_NODE?(n(),y(e.TriggerNode,{key:8,"flow-node":e.currentNode,"onUpdate:flowNode":e.handleModelValueUpdate},null,8,["flow-node"])):E("",!0),e.currentNode&&e.currentNode.childNode?(n(),y(s,{key:9,"flow-node":e.currentNode.childNode,"onUpdate:flowNode":t[0]||(t[0]=r=>e.currentNode.childNode=r),"parent-node":e.currentNode,"onFind:recursiveFindParentNode":e.recursiveFindParentNode},null,8,["flow-node","parent-node"])):E("",!0),e.currentNode&&e.currentNode.type===e.NodeType.END_EVENT_NODE?(n(),y(e.EndEventNode,{key:10,"flow-node":e.currentNode},null,8,["flow-node"])):E("",!0)],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/components/SimpleProcessDesignerV2/src/ProcessNodeTree.vue"]]),vo=q({name:"SimpleProcessModel",__name:"SimpleProcessModel",props:{flowNode:{type:Object,required:!0},readonly:{type:Boolean,required:!1,default:!0}},emits:["save"],setup(F,{expose:t,emit:C}){const e=F,b=C,N=W(e);pn("readonly",e.readonly);let s=A(100);const r=A(!1);let v=[];const p=(u,m)=>{if(u){const{type:k,showText:w,conditionNodes:_}=u;if(k==V.END_EVENT_NODE)return;k==V.START_USER_NODE&&p(u.childNode,m),k!==V.USER_TASK_NODE&&k!==V.COPY_TASK_NODE&&k!==V.CONDITION_NODE||(w||m.push(u),p(u.childNode,m)),k!=V.CONDITION_BRANCH_NODE&&k!=V.PARALLEL_BRANCH_NODE&&k!=V.INCLUSIVE_BRANCH_NODE||(_==null||_.forEach(S=>{p(S,m)}),p(u.childNode,m))}},i=async()=>{try{return v=[],p(N.value,v),v.length>0?void(r.value=!0):N.value}catch(u){return void console.error("\u83B7\u53D6\u6D41\u7A0B\u6570\u636E\u5931\u8D25:",u)}};t({getCurrentFlowData:i});const o=A(),g={props:e,emits:b,processNodeTree:N,get scaleValue(){return s},set scaleValue(u){s=u},MAX_SCALE_VALUE:200,MIN_SCALE_VALUE:50,zoomIn:()=>{s.value!=200&&(s.value+=10)},zoomOut:()=>{s.value!=50&&(s.value-=10)},processReZoom:()=>{s.value=100},errorDialogVisible:r,get errorNodes(){return v},set errorNodes(u){v=u},saveSimpleFlowModel:async()=>{v=[],p(N.value,v),v.length>0?r.value=!0:b("save",N.value)},validateNode:p,getCurrentFlowData:i,exportJson:()=>{Ln.json(new Blob([JSON.stringify(N.value)]),"model.json")},refFile:o,importJson:()=>{o.value.click()},importLocalFile:()=>{const u=o.value.files[0],m=new FileReader;m.readAsText(u),m.onload=function(){gn(this.result)&&(N.value=JSON.parse(this.result),b("save",N.value))}},ProcessNodeTree:je,get NODE_DEFAULT_TEXT(){return se},get ZoomOut(){return mn},get ZoomIn(){return vn},get ScaleToOriginal(){return fn}};return Object.defineProperty(g,"__isScriptSetup",{enumerable:!1,value:!0}),g}}),fo={class:"simple-process-model-container position-relative"},go={class:"position-absolute top-0px right-0px bg-#fff"},yo=G(vo,[["render",function(F,t,C,e,b,N){const s=B,r=ae,v=Nn,p=De,i=ln;return n(),c(R,null,[a("div",fo,[a("div",go,[l(p,{type:"flex",justify:"end"},{default:d(()=>[l(v,{key:"scale-control",size:"default"},{default:d(()=>[C.readonly?E("",!0):(n(),y(r,{key:0,size:"default",onClick:e.exportJson},{default:d(()=>[l(s,{icon:"ep:download"}),t[6]||(t[6]=O(" \u5BFC\u51FA "))]),_:1})),C.readonly?E("",!0):(n(),y(r,{key:1,size:"default",onClick:e.importJson},{default:d(()=>[l(s,{icon:"ep:upload"}),t[7]||(t[7]=O("\u5BFC\u5165 "))]),_:1})),C.readonly?E("",!0):(n(),c("input",{key:2,type:"file",id:"files",ref:"refFile",style:{display:"none"},accept:".json",onChange:e.importLocalFile},null,544)),l(r,{size:"default",icon:e.ScaleToOriginal,onClick:t[0]||(t[0]=o=>e.processReZoom())},null,8,["icon"]),l(r,{size:"default",plain:!0,icon:e.ZoomOut,onClick:t[1]||(t[1]=o=>e.zoomOut())},null,8,["icon"]),l(r,{size:"default",class:"w-80px"},{default:d(()=>[O(I(e.scaleValue)+"% ",1)]),_:1}),l(r,{size:"default",plain:!0,icon:e.ZoomIn,onClick:t[2]||(t[2]=o=>e.zoomIn())},null,8,["icon"])]),_:1})]),_:1})]),a("div",{class:"simple-process-model",style:yn(`transform: scale(${e.scaleValue/100});`)},[e.processNodeTree?(n(),y(e.ProcessNodeTree,{key:0,"flow-node":e.processNodeTree,"onUpdate:flowNode":t[3]||(t[3]=o=>e.processNodeTree=o)},null,8,["flow-node"])):E("",!0)],4)]),l(i,{modelValue:e.errorDialogVisible,"onUpdate:modelValue":t[5]||(t[5]=o=>e.errorDialogVisible=o),title:"\u4FDD\u5B58\u5931\u8D25",width:"400",fullscreen:!1},{footer:d(()=>[l(r,{type:"primary",onClick:t[4]||(t[4]=o=>e.errorDialogVisible=!1)},{default:d(()=>t[8]||(t[8]=[O("\u77E5\u9053\u4E86")])),_:1})]),default:d(()=>[t[9]||(t[9]=a("div",{class:"mb-2"},"\u4EE5\u4E0B\u8282\u70B9\u5185\u5BB9\u4E0D\u5B8C\u5584\uFF0C\u8BF7\u4FEE\u6539\u540E\u4FDD\u5B58",-1)),(n(!0),c(R,null,x(e.errorNodes,(o,g)=>(n(),c("div",{class:"mb-3 b-rounded-1 bg-gray-100 p-2 line-height-normal",key:g},I(o.name)+" : "+I(e.NODE_DEFAULT_TEXT.get(o.type)),1))),128))]),_:1},8,["modelValue"])],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/components/SimpleProcessDesignerV2/src/SimpleProcessModel.vue"]]);export{yo as _};
