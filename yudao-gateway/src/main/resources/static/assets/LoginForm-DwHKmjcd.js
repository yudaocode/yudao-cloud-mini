import{d as H,g as Q,D as W,r as y,u as $,a5 as K,b as Y,a as Z,f as J,au as X,C as ee,a6 as ae,de as te,ab as E,aa as U,ac as oe,ad as le,ae as ne,af as ie,a8 as se,df as re,dg as de,_ as pe,I as ce,ag as ge,o as x,q as C,w as t,k as a,ah as z,Y as ue,m as u,t as D,j as A,c as me,F as fe,n as he,L as we,v as ye,Z as _e,ai as be,y as xe,E as Le,x as ve,z as Fe,O as Se}from"./index-BaY5TDP-.js";import{_ as ke}from"./Verify-fCGrs-Uj.js";import{_ as Ee}from"./XButton-BcV39lfk.js";import{u as Ce,L as q,a as De,b as Ve}from"./LoginFormTitle-Rxr-yfvU.js";import{u as V}from"./useIcon-BOHZRfMR.js";import{r as R}from"./formRules-CMjZInfO.js";const Re={class:"w-[100%] flex justify-between"},Ne={class:"w-[100%] flex justify-between"},Te=pe(H({name:"LoginForm",__name:"LoginForm",setup(B,{expose:o}){o();const{t:L}=Q(),e=W(),N=V({icon:"ep:house"}),T=V({icon:"ep:avatar"}),d=V({icon:"ep:lock"}),i=y(),{validForm:h}=Ve(i),{setLoginState:v,getLoginState:g}=Ce(),{currentRoute:w,push:m}=$(),_=K(),p=y(""),f=y(!1),b=y(),n=y("blockPuzzle"),F=Y(()=>Z(g)===q.LOGIN),I={tenantName:[R],username:[R],password:[R]},r=J({isShowPassword:!1,captchaEnable:"false",tenantEnable:"true",loginForm:{tenantName:"\u828B\u9053\u6E90\u7801",username:"admin",password:"admin123",captchaVerification:"",rememberMe:!0}}),S=async()=>{if(r.tenantEnable==="true"){const l=await U(r.loginForm.tenantName);E(l)}},M=()=>{const l=ae();l&&(r.loginForm={...r.loginForm,username:l.username?l.username:r.loginForm.username,password:l.password?l.password:r.loginForm.password,rememberMe:l.rememberMe,tenantName:l.tenantName?l.tenantName:r.loginForm.tenantName})},P=async()=>{const l=location.host,s=await te(l);s&&(r.loginForm.tenantName=s.name,E(s.id))},k=y(),j=async l=>{f.value=!0;try{if(await S(),!await h())return;const s={...r.loginForm};s.captchaVerification=l.captchaVerification;const c=await oe(s);if(!c)return;k.value=le.service({lock:!0,text:"\u6B63\u5728\u52A0\u8F7D\u7CFB\u7EDF\u4E2D...",background:"rgba(0, 0, 0, 0.7)"}),s.rememberMe?ne(s):ie(),se(c),p.value||(p.value="/"),p.value.indexOf("sso")!==-1?window.location.href=window.location.href.replace("/login?redirect=",""):await m({path:p.value||_.addRouters[0].path})}finally{f.value=!1,k.value.close()}};X(()=>w.value,l=>{var s;p.value=(s=l==null?void 0:l.query)==null?void 0:s.redirect},{immediate:!0}),ee(()=>{M(),P()});const O={t:L,message:e,iconHouse:N,iconAvatar:T,iconLock:d,formLogin:i,validForm:h,setLoginState:v,getLoginState:g,currentRoute:w,push:m,permissionStore:_,redirect:p,loginLoading:f,verify:b,captchaType:n,getShow:F,LoginRules:I,loginData:r,socialList:[{icon:"ant-design:wechat-filled",type:30},{icon:"ant-design:dingtalk-circle-filled",type:20},{icon:"ant-design:github-filled",type:0},{icon:"ant-design:alipay-circle-filled",type:0}],getCode:async()=>{r.captchaEnable==="false"?await j({}):b.value.show()},getTenantId:S,getLoginFormCache:M,getTenantByWebsite:P,loading:k,handleLogin:j,doSocialLogin:async l=>{if(l===0)e.error("\u6B64\u65B9\u5F0F\u672A\u914D\u7F6E");else{if(f.value=!0,r.tenantEnable==="true"&&(await S(),!re()))try{const c=await e.prompt("\u8BF7\u8F93\u5165\u79DF\u6237\u540D\u79F0",L("common.reminder"));if((c==null?void 0:c.action)!=="confirm")throw"cancel";const G=await U(c.value);E(G)}catch(c){if(c==="cancel")return}finally{f.value=!1}const s=location.origin+"/social-login?"+encodeURIComponent(`type=${l}&redirect=${p.value||"/"}`);window.location.href=await de(l,encodeURIComponent(s))}},LoginFormTitle:De,get LoginStateEnum(){return q}};return Object.defineProperty(O,"__isScriptSetup",{enumerable:!1,value:!0}),O}}),[["render",function(B,o,L,e,N,T){const d=we,i=ye,h=_e,v=be,g=xe,w=Le,m=Ee,_=ke,p=ve,f=Fe,b=Se;return ce((x(),C(b,{ref:"formLogin",model:e.loginData.loginForm,rules:e.LoginRules,class:"login-form","label-position":"top","label-width":"120px",size:"large"},{default:t(()=>[a(w,{style:{"margin-right":"-10px","margin-left":"-10px"}},{default:t(()=>[a(i,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:t(()=>[a(d,null,{default:t(()=>[a(e.LoginFormTitle,{style:{width:"100%"}})]),_:1})]),_:1}),a(i,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:t(()=>[e.loginData.tenantEnable==="true"?(x(),C(d,{key:0,prop:"tenantName"},{default:t(()=>[a(h,{modelValue:e.loginData.loginForm.tenantName,"onUpdate:modelValue":o[0]||(o[0]=n=>e.loginData.loginForm.tenantName=n),placeholder:e.t("login.tenantNamePlaceholder"),"prefix-icon":e.iconHouse,link:"",type:"primary"},null,8,["modelValue","placeholder","prefix-icon"])]),_:1})):z("",!0)]),_:1}),a(i,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:t(()=>[a(d,{prop:"username"},{default:t(()=>[a(h,{modelValue:e.loginData.loginForm.username,"onUpdate:modelValue":o[1]||(o[1]=n=>e.loginData.loginForm.username=n),placeholder:e.t("login.usernamePlaceholder"),"prefix-icon":e.iconAvatar},null,8,["modelValue","placeholder","prefix-icon"])]),_:1})]),_:1}),a(i,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:t(()=>[a(d,{prop:"password"},{default:t(()=>[a(h,{modelValue:e.loginData.loginForm.password,"onUpdate:modelValue":o[2]||(o[2]=n=>e.loginData.loginForm.password=n),placeholder:e.t("login.passwordPlaceholder"),"prefix-icon":e.iconLock,"show-password":"",type:"password",onKeyup:o[3]||(o[3]=ue(n=>e.getCode(),["enter"]))},null,8,["modelValue","placeholder","prefix-icon"])]),_:1})]),_:1}),a(i,{span:24,style:{"padding-right":"10px","padding-left":"10px","margin-top":"-20px","margin-bottom":"-20px"}},{default:t(()=>[a(d,null,{default:t(()=>[a(w,{justify:"space-between",style:{width:"100%"}},{default:t(()=>[a(i,{span:6},{default:t(()=>[a(v,{modelValue:e.loginData.loginForm.rememberMe,"onUpdate:modelValue":o[4]||(o[4]=n=>e.loginData.loginForm.rememberMe=n)},{default:t(()=>[u(D(e.t("login.remember")),1)]),_:1},8,["modelValue"])]),_:1}),a(i,{offset:6,span:12},{default:t(()=>[a(g,{style:{float:"right"},type:"primary",onClick:o[5]||(o[5]=n=>e.setLoginState(e.LoginStateEnum.RESET_PASSWORD))},{default:t(()=>[u(D(e.t("login.forgetPassword")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(i,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:t(()=>[a(d,null,{default:t(()=>[a(m,{loading:e.loginLoading,title:e.t("login.login"),class:"w-[100%]",type:"primary",onClick:o[6]||(o[6]=n=>e.getCode())},null,8,["loading","title"])]),_:1})]),_:1}),e.loginData.captchaEnable==="true"?(x(),C(_,{key:0,ref:"verify",captchaType:e.captchaType,imgSize:{width:"400px",height:"200px"},mode:"pop",onSuccess:e.handleLogin},null,8,["captchaType"])):z("",!0),a(i,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:t(()=>[a(d,null,{default:t(()=>[a(w,{gutter:5,justify:"space-between",style:{width:"100%"}},{default:t(()=>[a(i,{span:8},{default:t(()=>[a(m,{title:e.t("login.btnMobile"),class:"w-[100%]",onClick:o[7]||(o[7]=n=>e.setLoginState(e.LoginStateEnum.MOBILE))},null,8,["title"])]),_:1}),a(i,{span:8},{default:t(()=>[a(m,{title:e.t("login.btnQRCode"),class:"w-[100%]",onClick:o[8]||(o[8]=n=>e.setLoginState(e.LoginStateEnum.QR_CODE))},null,8,["title"])]),_:1}),a(i,{span:8},{default:t(()=>[a(m,{title:e.t("login.btnRegister"),class:"w-[100%]",onClick:o[9]||(o[9]=n=>e.setLoginState(e.LoginStateEnum.REGISTER))},null,8,["title"])]),_:1})]),_:1})]),_:1})]),_:1}),a(p,{"content-position":"center"},{default:t(()=>[u(D(e.t("login.otherLogin")),1)]),_:1}),a(i,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:t(()=>[a(d,null,{default:t(()=>[A("div",Re,[(x(),me(fe,null,he(e.socialList,(n,F)=>a(f,{key:F,icon:n.icon,size:30,class:"anticon cursor-pointer",color:"#999",onClick:I=>e.doSocialLogin(n.type)},null,8,["icon","onClick"])),64))])]),_:1})]),_:1}),a(p,{"content-position":"center"},{default:t(()=>o[10]||(o[10]=[u("\u840C\u65B0\u5FC5\u8BFB")])),_:1}),a(i,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:t(()=>[a(d,null,{default:t(()=>[A("div",Ne,[a(g,{href:"https://doc.iocoder.cn/",target:"_blank"},{default:t(()=>o[11]||(o[11]=[u("\u{1F4DA}\u5F00\u53D1\u6307\u5357")])),_:1}),a(g,{href:"https://doc.iocoder.cn/video/",target:"_blank"},{default:t(()=>o[12]||(o[12]=[u("\u{1F525}\u89C6\u9891\u6559\u7A0B")])),_:1}),a(g,{href:"https://www.iocoder.cn/Interview/good-collection/",target:"_blank"},{default:t(()=>o[13]||(o[13]=[u(" \u26A1\u9762\u8BD5\u624B\u518C ")])),_:1}),a(g,{href:"http://static.yudao.iocoder.cn/mp/Aix9975.jpeg",target:"_blank"},{default:t(()=>o[14]||(o[14]=[u(" \u{1F91D}\u5916\u5305\u54A8\u8BE2 ")])),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])),[[ge,e.getShow]])}],["__scopeId","data-v-1de2631f"],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/Login/components/LoginForm.vue"]]);export{Te as default};
