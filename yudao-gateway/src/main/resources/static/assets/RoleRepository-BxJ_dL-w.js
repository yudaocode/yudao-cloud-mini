import{d as k,u as T,r,f as P,C as A,e5 as N,_ as U,o as S,q as x,w as p,k as o,j as V,m as D,ah as E,Z as M,z as j,N as z,A as I,B as q,e8 as F,b7 as H}from"./index-BaY5TDP-.js";import B from"./RoleHeader-DMeV7Zuv.js";import Z from"./RoleList-CDc3DjHg.js";import{C as R,a as G}from"./ChatRoleForm-CkDSrpdx.js";import J from"./RoleCategoryList-C66gfOgI.js";import{C as K}from"./index-C2SngFyG.js";import"./Dialog-CZSXtzfQ.js";import"./constants-CEEr2azc.js";import"./index-Cz_ljQ_t.js";const Q={class:"search-container"},W=U(k({__name:"RoleRepository",setup(O,{expose:l}){l();const f=T(),e=r(!1),h=r("my-role"),v=r(""),i=P({pageNo:1,pageSize:50}),n=r([]),c=P({pageNo:1,pageSize:50}),t=r([]),d=r("\u5168\u90E8"),C=r([]),y=async a=>{const m={...i,name:v.value,publicStatus:!1},{list:g}=await R.getMyPage(m);a?n.value.push.apply(n.value,g):n.value=g},s=async a=>{const m={...c,category:d.value==="\u5168\u90E8"?"":d.value,name:v.value,publicStatus:!0},{total:g,list:L}=await R.getMyPage(m);a?t.value.push.apply(t.value,L):t.value=L},u=async()=>{h.value==="my-role"?(i.pageNo=1,await y()):(c.pageNo=1,await s())},w=async()=>{C.value=["\u5168\u90E8",...await R.getCategoryList()]},b=r();A(async()=>{await w(),await u()});const _={router:f,loading:e,activeTab:h,search:v,myRoleParams:i,myRoleList:n,publicRoleParams:c,publicRoleList:t,activeCategory:d,categoryList:C,handleTabsClick:async a=>{h.value=a.paneName+"",await u()},getMyRole:y,getPublicRole:s,getActiveTabsRole:u,getRoleCategoryList:w,handlerCategoryClick:async a=>{d.value=a,await u()},formRef:b,handlerAddRole:async()=>{b.value.open("my-create",null,"\u6DFB\u52A0\u89D2\u8272")},handlerCardEdit:async a=>{b.value.open("my-update",a.id,"\u7F16\u8F91\u89D2\u8272")},handlerAddRoleSuccess:async a=>{await u()},handlerCardDelete:async a=>{await R.deleteMy(a.id),await u()},handlerCardPage:async a=>{try{e.value=!0,a==="public"?(c.pageNo++,await s(!0)):(i.pageNo++,await y(!0))}finally{e.value=!1}},handlerCardUse:async a=>{const m={roleId:a.id},g=await K.createChatConversationMy(m);await f.push({name:"AiChat",query:{conversationId:g}})},RoleHeader:B,RoleList:Z,ChatRoleForm:G,RoleCategoryList:J,get Search(){return N}};return Object.defineProperty(_,"__isScriptSetup",{enumerable:!1,value:!0}),_}}),[["render",function(O,l,f,e,h,v){const i=M,n=j,c=z,t=I,d=q,C=F,y=H;return S(),x(y,{class:"role-container"},{default:p(()=>[o(e.ChatRoleForm,{ref:"formRef",onSuccess:e.handlerAddRoleSuccess},null,512),o(e.RoleHeader,{title:"\u89D2\u8272\u4ED3\u5E93",class:"relative"}),o(C,{class:"role-main"},{default:p(()=>[V("div",Q,[o(i,{loading:e.loading,modelValue:e.search,"onUpdate:modelValue":l[0]||(l[0]=s=>e.search=s),class:"search-input",size:"default",placeholder:"\u8BF7\u8F93\u5165\u641C\u7D22\u7684\u5185\u5BB9","suffix-icon":e.Search,onChange:e.getActiveTabsRole},null,8,["loading","modelValue","suffix-icon"]),e.activeTab=="my-role"?(S(),x(c,{key:0,type:"primary",onClick:e.handlerAddRole,class:"ml-20px"},{default:p(()=>[o(n,{icon:"ep:user",style:{"margin-right":"5px"}}),l[4]||(l[4]=D(" \u6DFB\u52A0\u89D2\u8272 "))]),_:1})):E("",!0)]),o(d,{modelValue:e.activeTab,"onUpdate:modelValue":l[3]||(l[3]=s=>e.activeTab=s),class:"tabs",onTabClick:e.handleTabsClick},{default:p(()=>[o(t,{class:"role-pane",label:"\u6211\u7684\u89D2\u8272",name:"my-role"},{default:p(()=>[o(e.RoleList,{loading:e.loading,"role-list":e.myRoleList,"show-more":!0,onOnDelete:e.handlerCardDelete,onOnEdit:e.handlerCardEdit,onOnUse:e.handlerCardUse,onOnPage:l[1]||(l[1]=s=>e.handlerCardPage("my")),class:"mt-20px"},null,8,["loading","role-list"])]),_:1}),o(t,{label:"\u516C\u5171\u89D2\u8272",name:"public-role"},{default:p(()=>[o(e.RoleCategoryList,{class:"role-category-list","category-list":e.categoryList,active:e.activeCategory,onOnCategoryClick:e.handlerCategoryClick},null,8,["category-list","active"]),o(e.RoleList,{"role-list":e.publicRoleList,onOnDelete:e.handlerCardDelete,onOnEdit:e.handlerCardEdit,onOnUse:e.handlerCardUse,onOnPage:l[2]||(l[2]=s=>e.handlerCardPage("public")),class:"mt-20px",loading:""},null,8,["role-list"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})}],["__scopeId","data-v-d6a1ade8"],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/ai/chat/index/components/role/RoleRepository.vue"]]);export{W as default};
