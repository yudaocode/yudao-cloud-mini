import{d as k,r as n,f as q,G as F,U as I,_ as N,o as P,q as O,w as o,k as a,m as _,c as U,F as V,n as E,I as D,t as L,Z as R,L as Y,J as x,K as M,z as Q,N as z,O as j,P as A,Q as K,R as G}from"./index-BaY5TDP-.js";import{_ as J}from"./Dialog-CZSXtzfQ.js";import{_ as Z}from"./index-avjYFQiD.js";import{_ as B}from"./DictTag-QtcI9ZjC.js";import{_ as H}from"./ContentWrap-DKQn7kZm.js";import{d as W,r as X,t as $,v as ee}from"./formatter-DYGBdQzW.js";import{g as ae}from"./couponTemplate-C5oFUT2R.js";import{h as te}from"./constants-CEEr2azc.js";import"./index-DrSdAlug.js";import"./color-BN7ZL7BD.js";import"./formatTime-Dr6TiYYc.js";const le=N(k({name:"CouponSelect",__name:"CouponSelect",props:{multipleSelection:{type:Array,required:!1},takeType:{type:Number,required:!0}},emits:["update:multipleSelection","change"],setup(S,{expose:l,emit:w}){const e=S,f=w,g=n(!1),h=n("\u9009\u62E9\u4F18\u60E0\u52B5"),d=n(!1),c=n(!0),T=n(0),y=n([]),u=q({pageNo:1,pageSize:10,name:null,discountType:null,canTakeTypes:[te.USER.type]}),s=n(),m=n([]),r=async()=>{c.value=!0;try{u.canTakeTypes=[e.takeType];const i=await ae(u);y.value=i.list,T.value=i.total}finally{c.value=!1}},p=()=>{u.pageNo=1,r()},b=()=>{var i;(i=s==null?void 0:s.value)==null||i.resetFields(),p()},v=async()=>{g.value=!0,b()};l({open:v});const C={props:e,emit:f,dialogVisible:g,dialogTitle:h,formLoading:d,loading:c,total:T,list:y,queryParams:u,queryFormRef:s,selectedCouponList:m,getList:r,handleQuery:p,resetQuery:b,open:v,handleSelectionChange:i=>{e.multipleSelection?f("update:multipleSelection",i):m.value=i},submitForm:()=>{g.value=!1,f("change",m.value)},get DICT_TYPE(){return F},get getIntDictOptions(){return I},get discountFormat(){return W},get remainedCountFormat(){return X},get takeLimitCountFormat(){return $},get validityTypeFormat(){return ee}};return Object.defineProperty(C,"__isScriptSetup",{enumerable:!1,value:!0}),C}}),[["render",function(S,l,w,e,f,g){const h=R,d=Y,c=x,T=M,y=Q,u=z,s=j,m=H,r=A,p=B,b=K,v=Z,C=J,i=G;return P(),O(C,{modelValue:e.dialogVisible,"onUpdate:modelValue":l[5]||(l[5]=t=>e.dialogVisible=t),title:e.dialogTitle,width:"65%"},{footer:o(()=>[a(u,{disabled:e.formLoading,type:"primary",onClick:e.submitForm},{default:o(()=>l[8]||(l[8]=[_("\u786E \u5B9A")])),_:1},8,["disabled"]),a(u,{onClick:l[4]||(l[4]=t=>e.dialogVisible=!1)},{default:o(()=>l[9]||(l[9]=[_("\u53D6 \u6D88")])),_:1})]),default:o(()=>[a(m,null,{default:o(()=>[a(s,{ref:"queryFormRef",inline:!0,model:e.queryParams,class:"-mb-15px","label-width":"82px"},{default:o(()=>[a(d,{label:"\u4F18\u60E0\u5238\u540D\u79F0",prop:"name"},{default:o(()=>[a(h,{modelValue:e.queryParams.name,"onUpdate:modelValue":l[0]||(l[0]=t=>e.queryParams.name=t),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u4F18\u60E0\u52B5\u540D",onKeyup:e.handleQuery},null,8,["modelValue"])]),_:1}),a(d,{label:"\u4F18\u60E0\u7C7B\u578B",prop:"discountType"},{default:o(()=>[a(T,{modelValue:e.queryParams.discountType,"onUpdate:modelValue":l[1]||(l[1]=t=>e.queryParams.discountType=t),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u4F18\u60E0\u5238\u7C7B\u578B"},{default:o(()=>[(P(!0),U(V,null,E(e.getIntDictOptions(e.DICT_TYPE.PROMOTION_DISCOUNT_TYPE),t=>(P(),O(c,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(d,null,{default:o(()=>[a(u,{onClick:e.handleQuery},{default:o(()=>[a(y,{class:"mr-5px",icon:"ep:search"}),l[6]||(l[6]=_(" \u641C\u7D22 "))]),_:1}),a(u,{onClick:e.resetQuery},{default:o(()=>[a(y,{class:"mr-5px",icon:"ep:refresh"}),l[7]||(l[7]=_(" \u91CD\u7F6E "))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(m,null,{default:o(()=>[D((P(),O(b,{data:e.list,onSelectionChange:e.handleSelectionChange},{default:o(()=>[a(r,{type:"selection",width:"55"}),a(r,{label:"\u4F18\u60E0\u5238\u540D\u79F0","min-width":"140",prop:"name"}),a(r,{label:"\u7C7B\u578B","min-width":"80",prop:"productScope"},{default:o(t=>[a(p,{type:e.DICT_TYPE.PROMOTION_PRODUCT_SCOPE,value:t.row.productScope},null,8,["type","value"])]),_:1}),a(r,{label:"\u4F18\u60E0","min-width":"100",prop:"discount"},{default:o(t=>[a(p,{type:e.DICT_TYPE.PROMOTION_DISCOUNT_TYPE,value:t.row.discountType},null,8,["type","value"]),_(" "+L(e.discountFormat(t.row)),1)]),_:1}),a(r,{label:"\u9886\u53D6\u65B9\u5F0F","min-width":"100",prop:"takeType"},{default:o(t=>[a(p,{type:e.DICT_TYPE.PROMOTION_COUPON_TAKE_TYPE,value:t.row.takeType},null,8,["type","value"])]),_:1}),a(r,{formatter:e.validityTypeFormat,align:"center",label:"\u4F7F\u7528\u65F6\u95F4",prop:"validityType",width:"185"},null,8,["formatter"]),a(r,{align:"center",label:"\u53D1\u653E\u6570\u91CF",prop:"totalCount"}),a(r,{formatter:e.remainedCountFormat,align:"center",label:"\u5269\u4F59\u6570\u91CF",prop:"totalCount"},null,8,["formatter"]),a(r,{formatter:e.takeLimitCountFormat,align:"center",label:"\u9886\u53D6\u4E0A\u9650",prop:"takeLimitCount"},null,8,["formatter"]),a(r,{align:"center",label:"\u72B6\u6001",prop:"status"},{default:o(t=>[a(p,{type:e.DICT_TYPE.COMMON_STATUS,value:t.row.status},null,8,["type","value"])]),_:1})]),_:1},8,["data"])),[[i,e.loading]]),a(v,{limit:e.queryParams.pageSize,"onUpdate:limit":l[2]||(l[2]=t=>e.queryParams.pageSize=t),page:e.queryParams.pageNo,"onUpdate:page":l[3]||(l[3]=t=>e.queryParams.pageNo=t),total:e.total,onPagination:e.getList},null,8,["limit","page","total"])]),_:1})]),_:1},8,["modelValue","title"])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/mall/promotion/coupon/components/CouponSelect.vue"]]);export{le as default};
