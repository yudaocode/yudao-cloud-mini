import{_ as I}from"./Dialog-CZSXtzfQ.js";import{d as O,S as C,u as R,r as u,f as T,C as U,g as q,D as E,G as B,U as j,aj as L,a as M,_ as P,c as F,k as s,w as r,F as k,o as y,j as A,m as v,n as N,q as z,t as Y,z as G,N as W,Z,L as H,ak as J,al as K,O as Q}from"./index-BaY5TDP-.js";import{_ as X}from"./ContentWrap-DKQn7kZm.js";import{C as $}from"./constants-CEEr2azc.js";import{g as ee,c as ae,u as te}from"./index-BeYJ8u62.js";import{s as se,e as re,a as le}from"./formCreate-Dy2BGZHq.js";import{u as oe}from"./tagsView-lnAkwTv2.js";import{u as ie}from"./useFormCreateDesigner-CiVbdKGs.js";import"./index-BCN8BzfC.js";import"./dict.type-DgSgotXb.js";const ne={class:"h-[calc(100vh-var(--top-tool-height)-var(--tags-view-height)-var(--app-content-padding)-var(--app-content-padding)-2px)]"},ue=P(O({name:"BpmFormEditor",__name:"index",setup(x,{expose:a}){a();const{t:f}=q(),e=E(),_=C(),{push:b,currentRoute:p}=R(),{query:n}=C(),{delView:c}=oe(),g=u({switchType:[],autoActive:!0,useTemplate:!1,formOptions:{form:{labelWidth:"100px"}},fieldReadonly:!1,hiddenDragMenu:!1,hiddenDragBtn:!1,hiddenMenu:[],hiddenItem:[],hiddenItemConfig:{},disabledItemConfig:{},showSaveBtn:!1,showConfig:!0,showBaseForm:!0,showControl:!0,showPropsForm:!0,showEventForm:!0,showValidateForm:!0,showFormConfig:!0,showInputData:!0,showDevice:!0,appendConfigData:[]}),l=u();ie(l);const d=u(!1),m=u(!1),i=u({name:"",status:$.ENABLE,remark:""}),w=T({name:[{required:!0,message:"\u8868\u5355\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],status:[{required:!0,message:"\u5F00\u542F\u72B6\u6001\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),t=u(),D=()=>{c(M(p)),b("/bpm/manager/form")};U(async()=>{const o=n.id;if(!o)return;const h=await ee(o);if(i.value=h,se(l,h.conf,h.fields),_.query.type!=="copy")return;const{id:de,...S}=h;i.value=S,i.value.name+="_copy"});const V={t:f,message:e,route:_,push:b,currentRoute:p,query:n,delView:c,designerConfig:g,designer:l,dialogVisible:d,formLoading:m,formData:i,formRules:w,formRef:t,handleSave:()=>{d.value=!0},submitForm:async()=>{if(t&&await t.value.validate()){m.value=!0;try{const o=i.value;o.conf=re(l),o.fields=le(l),o.id?(await te(o),e.success(f("common.updateSuccess"))):(await ae(o),e.success(f("common.createSuccess"))),d.value=!1,D()}finally{m.value=!1}}},close:D,get DICT_TYPE(){return B},get getIntDictOptions(){return j},get FcDesigner(){return L}};return Object.defineProperty(V,"__isScriptSetup",{enumerable:!1,value:!0}),V}}),[["render",function(x,a,f,e,_,b){const p=G,n=W,c=X,g=Z,l=H,d=J,m=K,i=Q,w=I;return y(),F(k,null,[s(c,{"body-style":{padding:"0px"},class:"!mb-0"},{default:r(()=>[A("div",ne,[s(e.FcDesigner,{class:"my-designer",ref:"designer",config:e.designerConfig},{handle:r(()=>[s(n,{size:"small",type:"success",plain:"",onClick:e.handleSave},{default:r(()=>[s(p,{class:"mr-5px",icon:"ep:plus"}),a[5]||(a[5]=v(" \u4FDD\u5B58 "))]),_:1})]),_:1},8,["config"])])]),_:1}),s(w,{modelValue:e.dialogVisible,"onUpdate:modelValue":a[4]||(a[4]=t=>e.dialogVisible=t),title:"\u4FDD\u5B58\u8868\u5355",width:"600"},{footer:r(()=>[s(n,{disabled:e.formLoading,type:"primary",onClick:e.submitForm},{default:r(()=>a[6]||(a[6]=[v("\u786E \u5B9A")])),_:1},8,["disabled"]),s(n,{onClick:a[3]||(a[3]=t=>e.dialogVisible=!1)},{default:r(()=>a[7]||(a[7]=[v("\u53D6 \u6D88")])),_:1})]),default:r(()=>[s(i,{ref:"formRef",model:e.formData,rules:e.formRules,"label-width":"80px"},{default:r(()=>[s(l,{label:"\u8868\u5355\u540D",prop:"name"},{default:r(()=>[s(g,{modelValue:e.formData.name,"onUpdate:modelValue":a[0]||(a[0]=t=>e.formData.name=t),placeholder:"\u8BF7\u8F93\u5165\u8868\u5355\u540D"},null,8,["modelValue"])]),_:1}),s(l,{label:"\u72B6\u6001",prop:"status"},{default:r(()=>[s(m,{modelValue:e.formData.status,"onUpdate:modelValue":a[1]||(a[1]=t=>e.formData.status=t)},{default:r(()=>[(y(!0),F(k,null,N(e.getIntDictOptions(e.DICT_TYPE.COMMON_STATUS),t=>(y(),z(d,{key:t.value,value:t.value},{default:r(()=>[v(Y(t.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(l,{label:"\u5907\u6CE8",prop:"remark"},{default:r(()=>[s(g,{modelValue:e.formData.remark,"onUpdate:modelValue":a[2]||(a[2]=t=>e.formData.remark=t),placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/bpm/form/editor/index.vue"]]);export{ue as default};
