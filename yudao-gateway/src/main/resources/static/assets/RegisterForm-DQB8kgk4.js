import{d as U,g as I,r as u,u as C,a5 as B,b as A,a as O,f as j,au as H,C as G,de as W,ab as S,df as Z,dj as $,ad as J,af as K,a8 as M,aa as Q,_ as X,I as Y,ag as ee,o as w,q as x,w as t,k as a,ah as P,L as ae,v as re,Z as te,E as ie,O as se}from"./index-BaY5TDP-.js";import{_ as oe}from"./Verify-fCGrs-Uj.js";import{_ as ne}from"./XButton-BcV39lfk.js";import{u as le,L as de,a as ge}from"./LoginFormTitle-Rxr-yfvU.js";import{u as y}from"./useIcon-BOHZRfMR.js";const pe=X(U({name:"RegisterForm",__name:"RegisterForm",setup(T,{expose:r}){r();const{t:b}=I(),e=y({icon:"ep:house"}),_=y({icon:"ep:avatar"}),v=y({icon:"ep:lock"}),l=u(),{handleBackLogin:d,getLoginState:g}=le(),{currentRoute:c,push:m}=C(),f=B(),p=u(""),i=u(!1),F=u(),q=u("blockPuzzle"),z=A(()=>O(g)===de.REGISTER),k=(n,o,R)=>{s.registerForm.password!==o?R(new Error("\u4E24\u6B21\u8F93\u5165\u7684\u5BC6\u7801\u4E0D\u4E00\u81F4")):R()},N={tenantName:[{required:!0,trigger:"blur",message:"\u8BF7\u8F93\u5165\u60A8\u6240\u5C5E\u7684\u79DF\u6237"},{min:2,max:20,message:"\u79DF\u6237\u8D26\u53F7\u957F\u5EA6\u5FC5\u987B\u4ECB\u4E8E 2 \u548C 20 \u4E4B\u95F4",trigger:"blur"}],username:[{required:!0,trigger:"blur",message:"\u8BF7\u8F93\u5165\u60A8\u7684\u8D26\u53F7"},{min:4,max:30,message:"\u7528\u6237\u8D26\u53F7\u957F\u5EA6\u5FC5\u987B\u4ECB\u4E8E 4 \u548C 30 \u4E4B\u95F4",trigger:"blur"}],nickname:[{required:!0,trigger:"blur",message:"\u8BF7\u8F93\u5165\u60A8\u7684\u6635\u79F0"},{min:0,max:30,message:"\u6635\u79F0\u957F\u5EA6\u5FC5\u987B\u4ECB\u4E8E 0 \u548C 30 \u4E4B\u95F4",trigger:"blur"}],password:[{required:!0,trigger:"blur",message:"\u8BF7\u8F93\u5165\u60A8\u7684\u5BC6\u7801"},{min:5,max:20,message:"\u7528\u6237\u5BC6\u7801\u957F\u5EA6\u5FC5\u987B\u4ECB\u4E8E 5 \u548C 20 \u4E4B\u95F4",trigger:"blur"},{pattern:/^[^<>"'|\\]+$/,message:`\u4E0D\u80FD\u5305\u542B\u975E\u6CD5\u5B57\u7B26\uFF1A< > " ' \\ |`,trigger:"blur"}],confirmPassword:[{required:!0,trigger:"blur",message:"\u8BF7\u518D\u6B21\u8F93\u5165\u60A8\u7684\u5BC6\u7801"},{required:!0,validator:k,trigger:"blur"}]},s=j({isShowPassword:!1,captchaEnable:"false",tenantEnable:"true",registerForm:{tenantName:"\u828B\u9053\u6E90\u7801",nickname:"",tenantId:0,username:"",password:"",confirmPassword:"",captchaVerification:""}}),V=async n=>{h.value=!0;try{s.tenantEnable&&(await L(),s.registerForm.tenantId=Z()),s.captchaEnable&&(s.registerForm.captchaVerification=n.captchaVerification);const o=await $(s.registerForm);if(!o)return;h.value=J.service({lock:!0,text:"\u6B63\u5728\u52A0\u8F7D\u7CFB\u7EDF\u4E2D...",background:"rgba(0, 0, 0, 0.7)"}),K(),M(o),p.value||(p.value="/"),p.value.indexOf("sso")!==-1?window.location.href=window.location.href.replace("/login?redirect=",""):m({path:p.value||f.addRouters[0].path})}finally{i.value=!1,h.value.close()}},L=async()=>{if(s.tenantEnable==="true"){const n=await Q(s.registerForm.tenantName);S(n)}},D=async()=>{const n=location.host,o=await W(n);o&&(s.registerForm.tenantName=o.name,S(o.id))},h=u();H(()=>c.value,n=>{var o;p.value=(o=n==null?void 0:n.query)==null?void 0:o.redirect},{immediate:!0}),G(()=>{D()});const E={t:b,iconHouse:e,iconAvatar:_,iconLock:v,formLogin:l,handleBackLogin:d,getLoginState:g,currentRoute:c,push:m,permissionStore:f,redirect:p,loginLoading:i,verify:F,captchaType:q,getShow:z,equalToPassword:k,registerRules:N,registerData:s,handleRegister:V,getCode:async()=>{s.captchaEnable==="false"?await V({}):F.value.show()},getTenantId:L,getTenantByWebsite:D,loading:h,LoginFormTitle:ge};return Object.defineProperty(E,"__isScriptSetup",{enumerable:!1,value:!0}),E}}),[["render",function(T,r,b,e,_,v){const l=ae,d=re,g=te,c=ne,m=oe,f=ie,p=se;return Y((w(),x(p,{ref:"formLogin",model:e.registerData.registerForm,rules:e.registerRules,class:"login-form","label-position":"top","label-width":"120px",size:"large"},{default:t(()=>[a(f,{style:{"margin-right":"-10px","margin-left":"-10px"}},{default:t(()=>[a(d,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:t(()=>[a(l,null,{default:t(()=>[a(e.LoginFormTitle,{style:{width:"100%"}})]),_:1})]),_:1}),a(d,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:t(()=>[e.registerData.tenantEnable==="true"?(w(),x(l,{key:0,prop:"tenantName"},{default:t(()=>[a(g,{modelValue:e.registerData.registerForm.tenantName,"onUpdate:modelValue":r[0]||(r[0]=i=>e.registerData.registerForm.tenantName=i),placeholder:e.t("login.tenantname"),"prefix-icon":e.iconHouse,link:"",type:"primary",size:"large"},null,8,["modelValue","placeholder","prefix-icon"])]),_:1})):P("",!0)]),_:1}),a(d,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:t(()=>[a(l,{prop:"username"},{default:t(()=>[a(g,{modelValue:e.registerData.registerForm.username,"onUpdate:modelValue":r[1]||(r[1]=i=>e.registerData.registerForm.username=i),placeholder:e.t("login.username"),size:"large","prefix-icon":e.iconAvatar},null,8,["modelValue","placeholder","prefix-icon"])]),_:1})]),_:1}),a(d,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:t(()=>[a(l,{prop:"username"},{default:t(()=>[a(g,{modelValue:e.registerData.registerForm.nickname,"onUpdate:modelValue":r[2]||(r[2]=i=>e.registerData.registerForm.nickname=i),placeholder:"\u6635\u79F0",size:"large","prefix-icon":e.iconAvatar},null,8,["modelValue","prefix-icon"])]),_:1})]),_:1}),a(d,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:t(()=>[a(l,{prop:"password"},{default:t(()=>[a(g,{modelValue:e.registerData.registerForm.password,"onUpdate:modelValue":r[3]||(r[3]=i=>e.registerData.registerForm.password=i),type:"password","auto-complete":"off",placeholder:e.t("login.password"),size:"large","prefix-icon":e.iconLock,"show-password":""},null,8,["modelValue","placeholder","prefix-icon"])]),_:1})]),_:1}),a(d,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:t(()=>[a(l,{prop:"confirmPassword"},{default:t(()=>[a(g,{modelValue:e.registerData.registerForm.confirmPassword,"onUpdate:modelValue":r[4]||(r[4]=i=>e.registerData.registerForm.confirmPassword=i),type:"password",size:"large","auto-complete":"off",placeholder:e.t("login.checkPassword"),"prefix-icon":e.iconLock,"show-password":""},null,8,["modelValue","placeholder","prefix-icon"])]),_:1})]),_:1}),a(d,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:t(()=>[a(l,null,{default:t(()=>[a(c,{loading:e.loginLoading,title:e.t("login.register"),class:"w-[100%]",type:"primary",onClick:r[5]||(r[5]=i=>e.getCode())},null,8,["loading","title"])]),_:1})]),_:1}),e.registerData.captchaEnable==="true"?(w(),x(m,{key:0,ref:"verify",captchaType:e.captchaType,imgSize:{width:"400px",height:"200px"},mode:"pop",onSuccess:e.handleRegister},null,8,["captchaType"])):P("",!0)]),_:1}),a(c,{title:e.t("login.hasUser"),class:"w-[100%]",onClick:r[6]||(r[6]=i=>e.handleBackLogin())},null,8,["title"])]),_:1},8,["model"])),[[ee,e.getShow]])}],["__scopeId","data-v-21629274"],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/Login/components/RegisterForm.vue"]]);export{pe as default};
