import{d as T,r as s,u as U,S as k,C as E,D as B,a as D,_ as I,X as h,c as x,k as i,w as r,F as S,v as M,o as y,I as O,q as C,m as b,ah as z,N as P,A as j,B as H}from"./index-BaY5TDP-.js";import{g as V,_ as $}from"./index-fxekK-Kb.js";import{u as q}from"./tagsView-lnAkwTv2.js";import{g as A,t as N}from"./index-C4zjco0X.js";import Q from"./ClueForm-D-Y0X_TT.js";import W from"./ClueDetailsHeader-C19jVZIk.js";import X from"./ClueDetailsInfo-RryOhIe7.js";import G from"./PermissionList-CbQig5nT.js";import J from"./TransferForm-nV8fyRSP.js";import K from"./index-CI2uGAAL.js";import{B as R}from"./index-BlslFSYd.js";import"./el-timeline-item-BFYwlQ-d.js";import"./formatTime-Dr6TiYYc.js";import"./Dialog-CZSXtzfQ.js";import"./index-Qzz5HSIB.js";import"./tree-z7HkrWVC.js";import"./index-CuAlllbQ.js";import"./ContentWrap-DKQn7kZm.js";import"./el-descriptions-item-CRF_CO88.js";import"./DictTag-QtcI9ZjC.js";import"./color-BN7ZL7BD.js";import"./PermissionForm-jo-CjsNU.js";import"./index-6-r4wYJE.js";import"./index-DiJG1eDb.js";import"./index-h6ObHKtQ.js";import"./index-B97LdofC.js";import"./index-avjYFQiD.js";import"./index-DrSdAlug.js";import"./FollowUpRecordForm-C2CG18-w.js";import"./FollowUpRecordBusinessForm-B1oFy6Z2.js";import"./FollowUpRecordContactForm-BevYD0eZ.js";import"./BusinessListModal-6XoY13Ne.js";import"./BusinessForm-DKlvsT4o.js";import"./index-n6shePIl.js";import"./BusinessProductForm-FoZjzksq.js";import"./index-D4G-Yxr7.js";import"./ContactListModal-DsE0FODx.js";import"./ContactForm-DLuG_ZcF.js";const Y=I(T({name:"CrmClueDetail",__name:"index",setup(F,{expose:t}){t();const o=s(0),e=s(!0),n=B(),{delView:g}=q(),{currentRoute:l}=U(),m=s(),u=s({}),p=async()=>{e.value=!0;try{u.value=await A(o.value),await c()}finally{e.value=!1}},_=s(),v=s(),f=s([]),c=async()=>{const a=await V({bizType:R.CRM_CLUE,bizId:o.value});f.value=a.list},d=()=>{g(D(l))},{params:w}=k();E(()=>{if(!w.id)return n.warning("\u53C2\u6570\u9519\u8BEF\uFF0C\u7EBF\u7D22\u4E0D\u80FD\u4E3A\u7A7A\uFF01"),void d();o.value=w.id,p()});const L={clueId:o,loading:e,message:n,delView:g,currentRoute:l,permissionListRef:m,clue:u,getClue:p,formRef:_,openForm:()=>{var a;(a=_.value)==null||a.open("update",o.value)},transferFormRef:v,transfer:()=>{var a;(a=v.value)==null||a.open(o.value)},handleTransform:async()=>{await n.confirm(`\u786E\u5B9A\u5C06\u3010${u.value.name}\u3011\u8F6C\u5316\u4E3A\u5BA2\u6237\u5417\uFF1F`),await N(o.value),n.success(`\u8F6C\u5316\u5BA2\u6237\u3010${u.value.name}\u3011\u6210\u529F`),await p()},logList:f,getOperateLog:c,close:d,params:w,ClueForm:Q,ClueDetailsHeader:W,ClueDetailsInfo:X,PermissionList:G,CrmTransferForm:J,FollowUpList:K,get BizTypeEnum(){return R}};return Object.defineProperty(L,"__isScriptSetup",{enumerable:!1,value:!0}),L}}),[["render",function(F,t,o,e,n,g){const l=P,m=j,u=$,p=H,_=M,v=h("hasPermi");return y(),x(S,null,[i(e.ClueDetailsHeader,{clue:e.clue,loading:e.loading},{default:r(()=>{var f,c,d;return[(f=e.permissionListRef)!=null&&f.validateWrite?O((y(),C(l,{key:0,type:"primary",onClick:e.openForm},{default:r(()=>t[0]||(t[0]=[b(" \u7F16\u8F91 ")])),_:1})),[[v,["crm:clue:update"]]]):z("",!0),(c=e.permissionListRef)!=null&&c.validateOwnerUser?(y(),C(l,{key:1,type:"primary",onClick:e.transfer},{default:r(()=>t[1]||(t[1]=[b(" \u8F6C\u79FB ")])),_:1})):z("",!0),(d=e.permissionListRef)!=null&&d.validateOwnerUser&&!e.clue.transformStatus?(y(),C(l,{key:2,type:"success",onClick:e.handleTransform},{default:r(()=>t[2]||(t[2]=[b(" \u8F6C\u5316\u4E3A\u5BA2\u6237 ")])),_:1})):(y(),C(l,{key:3,disabled:"",type:"success"},{default:r(()=>t[3]||(t[3]=[b("\u5DF2\u8F6C\u5316\u5BA2\u6237")])),_:1}))]}),_:1},8,["clue","loading"]),i(_,null,{default:r(()=>[i(p,null,{default:r(()=>[i(m,{label:"\u8DDF\u8FDB\u8BB0\u5F55"},{default:r(()=>[i(e.FollowUpList,{"biz-id":e.clueId,"biz-type":e.BizTypeEnum.CRM_CLUE},null,8,["biz-id","biz-type"])]),_:1}),i(m,{label:"\u57FA\u672C\u4FE1\u606F"},{default:r(()=>[i(e.ClueDetailsInfo,{clue:e.clue},null,8,["clue"])]),_:1}),i(m,{label:"\u56E2\u961F\u6210\u5458"},{default:r(()=>[i(e.PermissionList,{ref:"permissionListRef","biz-id":e.clue.id,"biz-type":e.BizTypeEnum.CRM_CLUE,"show-action":!0,onQuitTeam:e.close},null,8,["biz-id","biz-type"])]),_:1}),i(m,{label:"\u64CD\u4F5C\u65E5\u5FD7"},{default:r(()=>[i(u,{"log-list":e.logList},null,8,["log-list"])]),_:1})]),_:1})]),_:1}),i(e.ClueForm,{ref:"formRef",onSuccess:e.getClue},null,512),i(e.CrmTransferForm,{ref:"transferFormRef","biz-type":e.BizTypeEnum.CRM_CLUE,onSuccess:e.close},null,8,["biz-type"])],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/crm/clue/detail/index.vue"]]);export{Y as default};
