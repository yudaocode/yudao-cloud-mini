import{d as O,g as P,D as x,r as n,f as S,ay as j,e as Y,G as M,U as N,_ as A,o as i,q as b,w as t,k as l,m as F,I as B,c as w,F as T,n as U,Z as G,L as J,v as K,J as Z,K as z,E as H,cf as Q,M as W,O as X,N as $,R as ee}from"./index-BaY5TDP-.js";import{_ as ae}from"./Dialog-CZSXtzfQ.js";import{b as le,c as te,u as oe}from"./index-ndAUlMgd.js";import{g as ue}from"./index-CuAlllbQ.js";import{g as re}from"./index-h6ObHKtQ.js";import{d as se}from"./index-B97LdofC.js";const de=A(O({__name:"ReceivablePlanForm",emits:["success"],setup(q,{expose:o,emit:C}){const{t:e}=P(),V=x(),h=n([]),p=n(!1),s=n(""),u=n(!1),m=n(""),r=n({}),f=S({price:[{required:!0,message:"\u8BA1\u5212\u56DE\u6B3E\u91D1\u989D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],returnTime:[{required:!0,message:"\u8BA1\u5212\u56DE\u6B3E\u65E5\u671F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],customerId:[{required:!0,message:"\u5BA2\u6237\u7F16\u53F7\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],contractId:[{required:!0,message:"\u5408\u540C\u7F16\u53F7\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],ownerUserId:[{required:!0,message:"\u8D1F\u8D23\u4EBA\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),c=n(),D=n([]),v=n([]),_=async(d,L,k,E)=>{if(p.value=!0,s.value=e("action."+d),m.value=d,I(),L){u.value=!0;try{const g=await le(L);r.value=j(g),await a(g.customerId),r.value.contractId=g==null?void 0:g.contractId}finally{u.value=!1}}h.value=await ue(),D.value=await re(),m.value==="create"&&(r.value.ownerUserId=Y().getUser.id),k&&(r.value.customerId=k,await a(k)),E&&(r.value.contractId=E)};o({open:_});const y=C,I=()=>{var d;r.value={},(d=c.value)==null||d.resetFields()},a=async d=>{r.value.contractId=void 0,d&&(v.value=[],v.value=await se(d))},R={t:e,message:V,userOptions:h,dialogVisible:p,dialogTitle:s,formLoading:u,formType:m,formData:r,formRules:f,formRef:c,customerList:D,contractList:v,open:_,emit:y,submitForm:async()=>{if(c&&await c.value.validate()){u.value=!0;try{const d=r.value;m.value==="create"?(await te(d),V.success(e("common.createSuccess"))):(await oe(d),V.success(e("common.updateSuccess"))),p.value=!1,y("success")}finally{u.value=!1}}},resetForm:I,handleCustomerChange:a,get DICT_TYPE(){return M},get getIntDictOptions(){return N}};return Object.defineProperty(R,"__isScriptSetup",{enumerable:!1,value:!0}),R}}),[["render",function(q,o,C,e,V,h){const p=G,s=J,u=K,m=Z,r=z,f=H,c=Q,D=W,v=X,_=$,y=ae,I=ee;return i(),b(y,{modelValue:e.dialogVisible,"onUpdate:modelValue":o[10]||(o[10]=a=>e.dialogVisible=a),title:e.dialogTitle},{footer:t(()=>[l(_,{disabled:e.formLoading,type:"primary",onClick:e.submitForm},{default:t(()=>o[11]||(o[11]=[F("\u786E \u5B9A")])),_:1},8,["disabled"]),l(_,{onClick:o[9]||(o[9]=a=>e.dialogVisible=!1)},{default:t(()=>o[12]||(o[12]=[F("\u53D6 \u6D88")])),_:1})]),default:t(()=>[B((i(),b(v,{ref:"formRef",model:e.formData,rules:e.formRules,"label-width":"110px"},{default:t(()=>[l(f,null,{default:t(()=>[l(u,{span:12},{default:t(()=>[l(s,{label:"\u8FD8\u6B3E\u671F\u6570",prop:"period"},{default:t(()=>[l(p,{modelValue:e.formData.period,"onUpdate:modelValue":o[0]||(o[0]=a=>e.formData.period=a),disabled:"",placeholder:"\u4FDD\u5B58\u65F6\u81EA\u52A8\u751F\u6210"},null,8,["modelValue"])]),_:1})]),_:1}),l(u,{span:12},{default:t(()=>[l(s,{label:"\u8D1F\u8D23\u4EBA",prop:"ownerUserId"},{default:t(()=>[l(r,{modelValue:e.formData.ownerUserId,"onUpdate:modelValue":o[1]||(o[1]=a=>e.formData.ownerUserId=a),disabled:e.formType!=="create",class:"w-1/1"},{default:t(()=>[(i(!0),w(T,null,U(e.userOptions,a=>(i(),b(m,{key:a.id,label:a.nickname,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1})]),_:1}),l(f,null,{default:t(()=>[l(u,{span:12},{default:t(()=>[l(s,{label:"\u5BA2\u6237\u540D\u79F0",prop:"customerId"},{default:t(()=>[l(r,{modelValue:e.formData.customerId,"onUpdate:modelValue":o[2]||(o[2]=a=>e.formData.customerId=a),disabled:e.formType!=="create",class:"w-1/1",filterable:"",placeholder:"\u8BF7\u9009\u62E9\u5BA2\u6237",onChange:e.handleCustomerChange},{default:t(()=>[(i(!0),w(T,null,U(e.customerList,a=>(i(),b(m,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1}),l(u,{span:12},{default:t(()=>[l(s,{label:"\u5408\u540C\u540D\u79F0",prop:"contractId"},{default:t(()=>[l(r,{modelValue:e.formData.contractId,"onUpdate:modelValue":o[3]||(o[3]=a=>e.formData.contractId=a),disabled:e.formType!=="create"||!e.formData.customerId,class:"w-1/1",filterable:"",placeholder:"\u8BF7\u9009\u62E9\u5408\u540C"},{default:t(()=>[(i(!0),w(T,null,U(e.contractList,a=>(i(),b(m,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1})]),_:1}),l(f,null,{default:t(()=>[l(u,{span:12},{default:t(()=>[l(s,{label:"\u8BA1\u5212\u56DE\u6B3E\u91D1\u989D",prop:"price"},{default:t(()=>[l(c,{modelValue:e.formData.price,"onUpdate:modelValue":o[4]||(o[4]=a=>e.formData.price=a),min:.01,precision:2,class:"!w-100%","controls-position":"right",placeholder:"\u8BF7\u8F93\u5165\u8BA1\u5212\u56DE\u6B3E\u91D1\u989D"},null,8,["modelValue"])]),_:1})]),_:1}),l(u,{span:12},{default:t(()=>[l(s,{label:"\u8BA1\u5212\u56DE\u6B3E\u65E5\u671F",prop:"returnTime"},{default:t(()=>[l(D,{modelValue:e.formData.returnTime,"onUpdate:modelValue":o[5]||(o[5]=a=>e.formData.returnTime=a),placeholder:"\u9009\u62E9\u8BA1\u5212\u56DE\u6B3E\u65E5\u671F",type:"date","value-format":"x",class:"!w-100%"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(f,null,{default:t(()=>[l(u,{span:12},{default:t(()=>[l(s,{label:"\u63D0\u524D\u51E0\u5929\u63D0\u9192",prop:"remindDays"},{default:t(()=>[l(c,{modelValue:e.formData.remindDays,"onUpdate:modelValue":o[6]||(o[6]=a=>e.formData.remindDays=a),class:"!w-100%","controls-position":"right",placeholder:"\u8BF7\u8F93\u5165\u63D0\u524D\u51E0\u5929\u63D0\u9192"},null,8,["modelValue"])]),_:1})]),_:1}),l(u,{span:12},{default:t(()=>[l(s,{label:"\u56DE\u6B3E\u65B9\u5F0F",prop:"returnType"},{default:t(()=>[l(r,{modelValue:e.formData.returnType,"onUpdate:modelValue":o[7]||(o[7]=a=>e.formData.returnType=a),class:"w-1/1",placeholder:"\u8BF7\u9009\u62E9\u56DE\u6B3E\u65B9\u5F0F"},{default:t(()=>[(i(!0),w(T,null,U(e.getIntDictOptions(e.DICT_TYPE.CRM_RECEIVABLE_RETURN_TYPE),a=>(i(),b(m,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(u,{span:24},{default:t(()=>[l(s,{label:"\u5907\u6CE8",prop:"remark"},{default:t(()=>[l(p,{modelValue:e.formData.remark,"onUpdate:modelValue":o[8]||(o[8]=a=>e.formData.remark=a),placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])),[[I,e.formLoading]])]),_:1},8,["modelValue","title"])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/crm/receivable/plan/ReceivablePlanForm.vue"]]);export{de as default};
