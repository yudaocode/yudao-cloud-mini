import{d as U,D as A,g as D,r as f,f as R,b as I,C as L,G as Y,U as z,_ as E,X as M,o as s,c as F,k as t,w as l,F as S,n as V,q as u,m as p,I as y,t as j,J,K as G,L as K,z as X,N as B,O as H,P as W,Q as Z,R as $}from"./index-BaY5TDP-.js";import{_ as ee}from"./index-avjYFQiD.js";import{_ as te}from"./DictTag-QtcI9ZjC.js";import{E as ae}from"./el-image-Bg-CwbDE.js";import{_ as re}from"./ContentWrap-DKQn7kZm.js";import{_ as oe}from"./index-BAz6Gqim.js";import{d as le}from"./formatTime-Dr6TiYYc.js";import ie from"./PointActivityForm-D3ai5Lqz.js";import{f as ne}from"./formatter-DdccBgw4.js";import{P as C}from"./index-PmeLzyKc.js";import"./index-DrSdAlug.js";import"./color-BN7ZL7BD.js";import"./Dialog-CZSXtzfQ.js";import"./Form-CB5RGX1K.js";import"./el-virtual-list-Cbbiio1P.js";import"./el-tree-select-DphqCDCz.js";import"./el-time-select-DuQV2otj.js";import"./InputPassword-liMgUpCC.js";import"./tsxHelper-B5zJ1wt3.js";import"./SpuSelect-egfD7fzC.js";import"./index-DqlyDc99.js";import"./SkuList-LfTbtJ44.js";import"./tree-z7HkrWVC.js";import"./category-B7jjsMOS.js";import"./spu-BVX48OKx.js";import"./SpuAndSkuList-BPESFKMK.js";import"./formRules-CMjZInfO.js";import"./useCrudSchemas-BQxlWSsn.js";const se=E(U({name:"PointActivity",__name:"index",setup(T,{expose:r}){r();const m=A(),{t:e}=D(),g=f(!0),b=f(0),w=f([]),c=R({pageNo:1,pageSize:10,name:null,status:null}),_=f(),v=I(()=>a=>(a.totalStock||0)-(a.stock||0)),i=async()=>{g.value=!0;try{const a=await C.getPointActivityPage(c);w.value=a.list,b.value=a.total}finally{g.value=!1}},n=()=>{c.pageNo=1,i()},h=f();L(async()=>{await i()});const d={message:m,t:e,loading:g,total:b,list:w,queryParams:c,queryFormRef:_,getRedeemedQuantity:v,getList:i,handleQuery:n,resetQuery:()=>{_.value.resetFields(),n()},formRef:h,openForm:(a,k)=>{h.value.open(a,k)},handleClose:async a=>{try{await m.confirm("\u786E\u8BA4\u5173\u95ED\u8BE5\u79EF\u5206\u5546\u57CE\u6D3B\u52A8\u5417\uFF1F"),await C.closePointActivity(a),m.success("\u5173\u95ED\u6210\u529F"),await i()}catch{}},handleDelete:async a=>{try{await m.delConfirm(),await C.deletePointActivity(a),m.success(e("common.delSuccess")),await i()}catch{}},get DICT_TYPE(){return Y},get getIntDictOptions(){return z},get dateFormatter(){return le},PointActivityForm:ie,get fenToYuanFormat(){return ne}};return Object.defineProperty(d,"__isScriptSetup",{enumerable:!1,value:!0}),d}}),[["render",function(T,r,m,e,g,b){const w=oe,c=J,_=G,v=K,i=X,n=B,h=H,d=re,a=W,k=ae,q=te,N=Z,O=ee,P=M("hasPermi"),Q=$;return s(),F(S,null,[t(w,{title:"\u3010\u8425\u9500\u3011\u79EF\u5206\u5546\u57CE\u6D3B\u52A8",url:"https://doc.iocoder.cn/mall/promotion-point/"}),t(d,null,{default:l(()=>[t(h,{ref:"queryFormRef",inline:!0,model:e.queryParams,class:"-mb-15px","label-width":"68px"},{default:l(()=>[t(v,{label:"\u6D3B\u52A8\u72B6\u6001",prop:"status"},{default:l(()=>[t(_,{modelValue:e.queryParams.status,"onUpdate:modelValue":r[0]||(r[0]=o=>e.queryParams.status=o),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u6D3B\u52A8\u72B6\u6001"},{default:l(()=>[(s(!0),F(S,null,V(e.getIntDictOptions(e.DICT_TYPE.COMMON_STATUS),o=>(s(),u(c,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(v,null,{default:l(()=>[t(n,{onClick:e.handleQuery},{default:l(()=>[t(i,{class:"mr-5px",icon:"ep:search"}),r[4]||(r[4]=p(" \u641C\u7D22 "))]),_:1}),t(n,{onClick:e.resetQuery},{default:l(()=>[t(i,{class:"mr-5px",icon:"ep:refresh"}),r[5]||(r[5]=p(" \u91CD\u7F6E "))]),_:1}),y((s(),u(n,{plain:"",type:"primary",onClick:r[1]||(r[1]=o=>e.openForm("create"))},{default:l(()=>[t(i,{class:"mr-5px",icon:"ep:plus"}),r[6]||(r[6]=p(" \u65B0\u589E "))]),_:1})),[[P,["promotion:point-activity:create"]]])]),_:1})]),_:1},8,["model"])]),_:1}),t(d,null,{default:l(()=>[y((s(),u(N,{data:e.list,"show-overflow-tooltip":!0,stripe:!0},{default:l(()=>[t(a,{label:"\u6D3B\u52A8\u7F16\u53F7","min-width":"80",prop:"id"}),t(a,{label:"\u5546\u54C1\u56FE\u7247","min-width":"80",prop:"spuName"},{default:l(o=>[t(k,{"preview-src-list":[o.row.picUrl],src:o.row.picUrl,class:"h-40px w-40px","preview-teleported":""},null,8,["preview-src-list","src"])]),_:1}),t(a,{label:"\u5546\u54C1\u6807\u9898","min-width":"300",prop:"spuName"}),t(a,{formatter:e.fenToYuanFormat,label:"\u539F\u4EF7","min-width":"100",prop:"marketPrice"},null,8,["formatter"]),t(a,{label:"\u539F\u4EF7","min-width":"100",prop:"marketPrice"}),t(a,{align:"center",label:"\u6D3B\u52A8\u72B6\u6001","min-width":"100",prop:"status"},{default:l(o=>[t(q,{type:e.DICT_TYPE.COMMON_STATUS,value:o.row.status},null,8,["type","value"])]),_:1}),t(a,{align:"center",label:"\u5E93\u5B58","min-width":"80",prop:"stock"}),t(a,{align:"center",label:"\u603B\u5E93\u5B58","min-width":"80",prop:"totalStock"}),t(a,{align:"center",label:"\u5DF2\u5151\u6362\u6570\u91CF","min-width":"100",prop:"redeemedQuantity"},{default:l(({row:o})=>[p(j(e.getRedeemedQuantity(o)),1)]),_:1}),t(a,{formatter:e.dateFormatter,align:"center",label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime",width:"180px"},null,8,["formatter"]),t(a,{align:"center",fixed:"right",label:"\u64CD\u4F5C",width:"150px"},{default:l(o=>[y((s(),u(n,{link:"",type:"primary",onClick:x=>e.openForm("update",o.row.id)},{default:l(()=>r[7]||(r[7]=[p(" \u7F16\u8F91 ")])),_:2},1032,["onClick"])),[[P,["promotion:point-activity:update"]]]),o.row.status===0?y((s(),u(n,{key:0,link:"",type:"danger",onClick:x=>e.handleClose(o.row.id)},{default:l(()=>r[8]||(r[8]=[p(" \u5173\u95ED ")])),_:2},1032,["onClick"])),[[P,["promotion:point-activity:close"]]]):y((s(),u(n,{key:1,link:"",type:"danger",onClick:x=>e.handleDelete(o.row.id)},{default:l(()=>r[9]||(r[9]=[p(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[P,["promotion:point-activity:delete"]]])]),_:1})]),_:1},8,["data"])),[[Q,e.loading]]),t(O,{limit:e.queryParams.pageSize,"onUpdate:limit":r[2]||(r[2]=o=>e.queryParams.pageSize=o),page:e.queryParams.pageNo,"onUpdate:page":r[3]||(r[3]=o=>e.queryParams.pageNo=o),total:e.total,onPagination:e.getList},null,8,["limit","page","total"])]),_:1}),t(e.PointActivityForm,{ref:"formRef",onSuccess:e.getList},null,512)],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/mall/promotion/point/activity/index.vue"]]);export{se as default};
