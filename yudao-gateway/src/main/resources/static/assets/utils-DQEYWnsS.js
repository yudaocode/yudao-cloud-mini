import{T as L}from"./index-ZFL2ufyC.js";import{P as G,N as w,C as a,i as V,R as $,k as H,l as C,T as m,e as x}from"./consts-vgsb8q48.js";import{p as B}from"./index-BCN8BzfC.js";import{r as o,au as X,b4 as v,a as T,bU as J}from"./index-BaY5TDP-.js";function q(t){const r=o(t.flowNode);return X(()=>t.flowNode,n=>{r.value=n}),r}const _=t=>{const r=[];return t&&t.forEach(n=>{B(JSON.parse(n),r)}),r};function K(t){const r=o([]),n=v("formType",o()),p=v("formFields",o([])),f=(c,e)=>{let s=[];return e&&(s=_(e).map(i=>{const l=c.find(S=>S.field==i.field);return{field:i.field,title:i.title,permission:l?l.permission:t}})),s},R=c=>{let e=[];return c&&(e=_(c).map(s=>({field:s.field,title:s.title,permission:t}))),e},D=_(T(p));return{formType:n,fieldsPermissionConfig:r,formFieldOptions:D,getNodeConfigFormFields:c=>{(c=J(c))&&c.length!==0?r.value=f(c,T(p)):r.value=R(T(p))}}}function Q(){const t=v("formFields",o([]));return _(T(t))}function Y(){const t=v("formFields",o([])),r=_(T(t));return r.unshift({field:G.START_USER_ID,title:"\u53D1\u8D77\u4EBA",required:!0}),r}function z(t){const r=v("roleList",o([])),n=v("postList",o([])),p=v("userList",o([])),f=v("deptList",o([])),R=v("userGroupList",o([])),D=v("deptTree",o()),c=v("formFields",o([])),e=o();return t===w.USER_TASK_NODE?e.value={candidateStrategy:a.USER,approveMethod:V.SEQUENTIAL_APPROVE,approveRatio:100,rejectHandlerType:$.FINISH_PROCESS,assignStartUserHandlerType:H.START_USER_AUDIT,returnNodeId:"",timeoutHandlerEnable:!1,timeoutHandlerType:1,timeDuration:6,maxRemindCount:1,buttonsSetting:[]}:e.value={candidateStrategy:a.USER},{configForm:e,roleOptions:r,postOptions:n,userOptions:p,userGroupOptions:R,deptTreeOptions:D,handleCandidateParam:()=>{let s;if(!e.value)return s;switch(e.value.candidateStrategy){case a.USER:s=e.value.userIds.join(",");break;case a.ROLE:s=e.value.roleIds.join(",");break;case a.POST:s=e.value.postIds.join(",");break;case a.USER_GROUP:s=e.value.userGroups.join(",");break;case a.FORM_USER:s=e.value.formUser;break;case a.EXPRESSION:s=e.value.expression;break;case a.DEPT_MEMBER:case a.DEPT_LEADER:s=e.value.deptIds.join(",");break;case a.START_USER_DEPT_LEADER:case a.START_USER_MULTI_LEVEL_DEPT_LEADER:s=e.value.deptLevel+"";break;case a.MULTI_LEVEL_DEPT_LEADER:s=e.value.deptIds.join(",").concat("|"+e.value.deptLevel);break;case a.FORM_DEPT_LEADER:s=e.value.formDept.concat("|"+e.value.deptLevel);break}return s},parseCandidateParam:(s,i)=>{if(e.value&&i)switch(s){case a.USER:e.value.userIds=i.split(",").map(l=>+l);break;case a.ROLE:e.value.roleIds=i.split(",").map(l=>+l);break;case a.POST:e.value.postIds=i.split(",").map(l=>+l);break;case a.USER_GROUP:e.value.userGroups=i.split(",").map(l=>+l);break;case a.FORM_USER:e.value.formUser=i;break;case a.EXPRESSION:e.value.expression=i;break;case a.DEPT_MEMBER:case a.DEPT_LEADER:e.value.deptIds=i.split(",").map(l=>+l);break;case a.START_USER_DEPT_LEADER:case a.START_USER_MULTI_LEVEL_DEPT_LEADER:e.value.deptLevel=+i;break;case a.MULTI_LEVEL_DEPT_LEADER:{const l=i.split("|");e.value.deptIds=l[0].split(",").map(S=>+S),e.value.deptLevel=+l[1];break}case a.FORM_DEPT_LEADER:{const l=i.split("|");e.value.formDept=l[0],e.value.deptLevel=+l[1];break}}},getShowText:()=>{var i,l,S,U,I,P,g,A,O,b,h,k,y,M,N,j,F;let s="";if(((i=e.value)==null?void 0:i.candidateStrategy)===a.USER&&((l=e.value)==null?void 0:l.userIds.length)>0){const u=[];p==null||p.value.forEach(d=>{var E;(E=e.value)!=null&&E.userIds.includes(d.id)&&u.push(d.nickname)}),s=`\u6307\u5B9A\u6210\u5458\uFF1A${u.join(",")}`}if(((S=e.value)==null?void 0:S.candidateStrategy)===a.ROLE&&e.value.roleIds.length>0){const u=[];r==null||r.value.forEach(d=>{var E;(E=e.value)!=null&&E.roleIds.includes(d.id)&&u.push(d.name)}),s=`\u6307\u5B9A\u89D2\u8272\uFF1A${u.join(",")}`}if((((U=e.value)==null?void 0:U.candidateStrategy)===a.DEPT_MEMBER||((I=e.value)==null?void 0:I.candidateStrategy)===a.DEPT_LEADER||((P=e.value)==null?void 0:P.candidateStrategy)===a.MULTI_LEVEL_DEPT_LEADER)&&((g=e.value)==null?void 0:g.deptIds.length)>0){const u=[];f==null||f.value.forEach(d=>{var E;(E=e.value)!=null&&E.deptIds.includes(d.id)&&u.push(d.name)}),s=e.value.candidateStrategy===a.DEPT_MEMBER?`\u90E8\u95E8\u6210\u5458\uFF1A${u.join(",")}`:e.value.candidateStrategy===a.DEPT_LEADER?`\u90E8\u95E8\u7684\u8D1F\u8D23\u4EBA\uFF1A${u.join(",")}`:`\u591A\u7EA7\u90E8\u95E8\u7684\u8D1F\u8D23\u4EBA\uFF1A${u.join(",")}`}if(((A=e.value)==null?void 0:A.candidateStrategy)===a.POST&&e.value.postIds.length>0){const u=[];n==null||n.value.forEach(d=>{var E;(E=e.value)!=null&&E.postIds.includes(d.id)&&u.push(d.name)}),s=`\u6307\u5B9A\u5C97\u4F4D: ${u.join(",")}`}if(((O=e.value)==null?void 0:O.candidateStrategy)===a.USER_GROUP&&((b=e.value)==null?void 0:b.userGroups.length)>0){const u=[];R==null||R.value.forEach(d=>{var E;(E=e.value)!=null&&E.userGroups.includes(d.id)&&u.push(d.name)}),s=`\u6307\u5B9A\u7528\u6237\u7EC4: ${u.join(",")}`}if(((h=e.value)==null?void 0:h.candidateStrategy)===a.FORM_USER){const u=_(T(c)).find(d=>{var E;return d.field===((E=e.value)==null?void 0:E.formUser)});s=`\u8868\u5355\u7528\u6237\uFF1A${u==null?void 0:u.title}`}return((k=e.value)==null?void 0:k.candidateStrategy)===a.FORM_DEPT_LEADER&&(s="\u8868\u5355\u5185\u90E8\u95E8\u8D1F\u8D23\u4EBA"),((y=e.value)==null?void 0:y.candidateStrategy)===a.START_USER_SELECT&&(s="\u53D1\u8D77\u4EBA\u81EA\u9009"),((M=e.value)==null?void 0:M.candidateStrategy)===a.START_USER&&(s="\u53D1\u8D77\u4EBA\u81EA\u5DF1"),((N=e.value)==null?void 0:N.candidateStrategy)===a.START_USER_DEPT_LEADER&&(s="\u53D1\u8D77\u4EBA\u7684\u90E8\u95E8\u8D1F\u8D23\u4EBA"),((j=e.value)==null?void 0:j.candidateStrategy)===a.START_USER_MULTI_LEVEL_DEPT_LEADER&&(s="\u53D1\u8D77\u4EBA\u8FDE\u7EED\u90E8\u95E8\u8D1F\u8D23\u4EBA"),((F=e.value)==null?void 0:F.candidateStrategy)===a.EXPRESSION&&(s=`\u6D41\u7A0B\u8868\u8FBE\u5F0F\uFF1A${e.value.expression}`),s}}}function W(){const t=o(!1);return{settingVisible:t,closeDrawer:()=>{t.value=!1},openDrawer:()=>{t.value=!0}}}function Z(t){const r=o(),n=o(!1);return{nodeName:r,showInput:n,clickIcon:()=>{n.value=!0},blurEvent:()=>{n.value=!1,r.value=r.value||C.get(t)}}}function ee(t,r){const n=o(!1);return{showInput:n,clickTitle:()=>{n.value=!0},blurEvent:()=>{n.value=!1,t.value.name=t.value.name||C.get(r)}}}function ae(t){return t?t===L.APPROVE?"status-pass":t===L.RUNNING?"status-running":t===L.REJECT?"status-reject":t===L.CANCEL?"status-cancel":"":""}const te=(t,r)=>r?"\u5176\u5B83\u60C5\u51B5":"\u6761\u4EF6"+(t+1),se=(t,r)=>r?"\u5176\u5B83\u60C5\u51B5":"\u5305\u5BB9\u6761\u4EF6"+(t+1),re=t=>t==="M"?m.MINUTE:t==="H"?m.HOUR:t==="D"?m.DAY:m.HOUR,ne=t=>{let r="";return x.forEach(n=>{n.value!==t||(r=n.label)}),r};export{W as a,q as b,re as c,Z as d,ee as e,ae as f,Y as g,z as h,ne as i,te as j,se as k,Q as l,K as u};
