import{d as w,r as g,f as b,C as x,e2 as _,G as v,_ as P,o as y,c as T,k as e,w as i,I as S,q as D,F,l as I,P as A,Q as E,R}from"./index-BaY5TDP-.js";import{_ as U}from"./DictTag-QtcI9ZjC.js";import{E as O}from"./el-skeleton-item-BYAIkmCs.js";import{_ as q}from"./Echart-BQxFkezy.js";import{S as C}from"./customer-DKZgktXn.js";import{d as N}from"./formatTime-Dr6TiYYc.js";import"./color-BN7ZL7BD.js";import"./echarts-DpbyC_6K.js";const M=P(w({name:"CustomerConversionStat",__name:"CustomerConversionStat",props:{queryParams:{type:null,required:!0}},setup(c,{expose:f}){const s=c,t=g(!1),d=g([]),r=b({grid:{left:20,right:40,bottom:20,containLabel:!0},legend:{},series:[{name:"\u5BA2\u6237\u8F6C\u5316\u7387",type:"line",data:[]}],toolbox:{feature:{dataZoom:{xAxisIndex:!1},brush:{type:["lineX","clear"]},saveAsImage:{show:!0,name:"\u5BA2\u6237\u8F6C\u5316\u7387\u5206\u6790"}}},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},yAxis:{type:"value",name:"\u8F6C\u5316\u7387(%)"},xAxis:{type:"category",name:"\u65E5\u671F",data:[]}}),m=async()=>{const a=await C.getCustomerSummaryByDate(s.queryParams),u=await C.getContractSummary(s.queryParams);r.xAxis&&r.xAxis.data&&(r.xAxis.data=a.map(o=>o.time)),r.series&&r.series[0]&&r.series[0].data&&(r.series[0].data=a.map(o=>({name:o.time,value:o.customerCreateCount?(o.customerDealCount/o.customerCreateCount*100).toFixed(2):0}))),d.value=u},n=async()=>{t.value=!0;try{await m()}finally{t.value=!1}};f({loadData:n}),x(()=>{n()});const l={props:s,loading:t,list:d,echartsOption:r,fetchAndFill:m,loadData:n,get dateFormatter(){return N},get erpPriceTableColumnFormatter(){return _},get DICT_TYPE(){return v}};return Object.defineProperty(l,"__isScriptSetup",{enumerable:!1,value:!0}),l}}),[["render",function(c,f,s,t,d,r){const m=q,n=O,l=I,a=A,u=U,o=E,h=R;return y(),T(F,null,[e(l,{shadow:"never"},{default:i(()=>[e(n,{loading:t.loading,animated:""},{default:i(()=>[e(m,{height:500,options:t.echartsOption},null,8,["options"])]),_:1},8,["loading"])]),_:1}),e(l,{shadow:"never",class:"mt-16px"},{default:i(()=>[S((y(),D(o,{data:t.list},{default:i(()=>[e(a,{label:"\u5E8F\u53F7",align:"center",type:"index",width:"80",fixed:"left"}),e(a,{label:"\u5BA2\u6237\u540D\u79F0",align:"center",prop:"customerName","min-width":"200",fixed:"left"}),e(a,{label:"\u5408\u540C\u540D\u79F0",align:"center",prop:"contractName","min-width":"200"}),e(a,{label:"\u5408\u540C\u603B\u91D1\u989D",align:"center",prop:"totalPrice","min-width":"200",formatter:t.erpPriceTableColumnFormatter},null,8,["formatter"]),e(a,{label:"\u56DE\u6B3E\u91D1\u989D",align:"center",prop:"receivablePrice","min-width":"200",formatter:t.erpPriceTableColumnFormatter},null,8,["formatter"]),e(a,{align:"center",label:"\u5BA2\u6237\u6765\u6E90",prop:"source",width:"100"},{default:i(p=>[e(u,{type:t.DICT_TYPE.CRM_CUSTOMER_SOURCE,value:p.row.source},null,8,["type","value"])]),_:1}),e(a,{align:"center",label:"\u5BA2\u6237\u884C\u4E1A",prop:"industryId",width:"100"},{default:i(p=>[e(u,{type:t.DICT_TYPE.CRM_CUSTOMER_INDUSTRY,value:p.row.industryId},null,8,["type","value"])]),_:1}),e(a,{label:"\u8D1F\u8D23\u4EBA",align:"center",prop:"ownerUserName","min-width":"200"}),e(a,{label:"\u521B\u5EFA\u4EBA",align:"center",prop:"creatorUserName","min-width":"200"}),e(a,{label:"\u521B\u5EFA\u65F6\u95F4",align:"center",prop:"createTime",formatter:t.dateFormatter,"min-width":"200"},null,8,["formatter"]),e(a,{label:"\u4E0B\u5355\u65E5\u671F",align:"center",prop:"orderDate",formatter:t.dateFormatter,"min-width":"200",fixed:"right"},null,8,["formatter"])]),_:1},8,["data"])),[[h,t.loading]])]),_:1})],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/crm/statistics/customer/components/CustomerConversionStat.vue"]]);export{M as default};
