import{d as M,r as A,f as D,C as Y,cv as o,aA as g,_ as j,o as v,q as R,w as h,j as k,k as T,c as V,F as H,n as I,m as K,t as L,aJ as N,al as S,l as U}from"./index-BaY5TDP-.js";import{_ as W}from"./Echart-BQxFkezy.js";import{a as q}from"./trade-BIMVgidL.js";import{f as y}from"./formatTime-Dr6TiYYc.js";import{C as F}from"./CardTitle-Z2xLAPly.js";import"./echarts-DpbyC_6K.js";var E=(s=>(s[s.DAY30=1]="DAY30",s[s.WEEK=7]="WEEK",s[s.MONTH=30]="MONTH",s[s.YEAR=365]="YEAR",s))(E||{});const G={class:"flex flex-row items-center justify-between"},J={class:"flex flex-row items-center gap-2"},X=j(M({name:"TradeTrendCard",__name:"TradeTrendCard",setup(s,{expose:m}){m();const d=A(1),r=A(!0),c=new Map().set(1,{name:"30\u5929",series:[{name:"\u8BA2\u5355\u91D1\u989D",type:"bar",smooth:!0,data:[]},{name:"\u8BA2\u5355\u6570\u91CF",type:"line",smooth:!0,data:[]}]}).set(7,{name:"\u5468",series:[{name:"\u4E0A\u5468\u91D1\u989D",type:"bar",smooth:!0,data:[]},{name:"\u672C\u5468\u91D1\u989D",type:"bar",smooth:!0,data:[]},{name:"\u4E0A\u5468\u6570\u91CF",type:"line",smooth:!0,data:[]},{name:"\u672C\u5468\u6570\u91CF",type:"line",smooth:!0,data:[]}]}).set(30,{name:"\u6708",series:[{name:"\u4E0A\u6708\u91D1\u989D",type:"bar",smooth:!0,data:[]},{name:"\u672C\u6708\u91D1\u989D",type:"bar",smooth:!0,data:[]},{name:"\u4E0A\u6708\u6570\u91CF",type:"line",smooth:!0,data:[]},{name:"\u672C\u6708\u6570\u91CF",type:"line",smooth:!0,data:[]}]}).set(365,{name:"\u5E74",series:[{name:"\u53BB\u5E74\u91D1\u989D",type:"bar",smooth:!0,data:[]},{name:"\u4ECA\u5E74\u91D1\u989D",type:"bar",smooth:!0,data:[]},{name:"\u53BB\u5E74\u6570\u91CF",type:"line",smooth:!0,data:[]},{name:"\u4ECA\u5E74\u6570\u91CF",type:"line",smooth:!0,data:[]}]}),i=D({grid:{left:20,right:20,bottom:20,top:80,containLabel:!0},legend:{top:50,data:[]},series:[],toolbox:{feature:{dataZoom:{yAxisIndex:!1},brush:{type:["lineX","clear"]},saveAsImage:{show:!0,name:"\u8BA2\u5355\u91CF\u8D8B\u52BF"}}},tooltip:{trigger:"axis",axisPointer:{type:"cross"},padding:[5,10]},xAxis:{type:"category",inverse:!0,boundaryGap:!1,axisTick:{show:!1},data:[],axisLabel:{formatter:t=>{switch(d.value){case 1:return y(t,"MM-DD");case 7:let a=y(t,"ddd");return a=="0"&&(a="\u65E5"),"\u5468"+a;case 30:return y(t,"D");case 365:return y(t,"M")+"\u6708";default:return t}}}},yAxis:{axisTick:{show:!1}}}),l=async()=>{let t,a;switch(d.value){case 7:t=o().startOf("week"),a=o().endOf("week");break;case 30:t=o().startOf("month"),a=o().endOf("month");break;case 365:t=o().startOf("year"),a=o().endOf("year");break;default:t=o().subtract(30,"day").startOf("d"),a=o().endOf("d")}await u(t,a)},u=async(t,a)=>{var x,C,w,O,_,P;r.value=!0;const f=await q(d.value,t,a),b=[],n=[...c.get(d.value).series];for(let e of f)b.push(e.value.date),n.length===2?(n[0].data.push(g(((x=e==null?void 0:e.value)==null?void 0:x.orderPayPrice)||0)),n[1].data.push(((C=e==null?void 0:e.value)==null?void 0:C.orderPayCount)||0)):(n[0].data.push(g(((w=e==null?void 0:e.reference)==null?void 0:w.orderPayPrice)||0)),n[1].data.push(g(((O=e==null?void 0:e.value)==null?void 0:O.orderPayPrice)||0)),n[2].data.push(((_=e==null?void 0:e.reference)==null?void 0:_.orderPayCount)||0),n[3].data.push(((P=e==null?void 0:e.value)==null?void 0:P.orderPayCount)||0));i.xAxis.data=b,i.series=n,i.legend.data=n.map(e=>e.name),r.value=!1};Y(()=>{l()});const p={TimeRangeTypeEnum:E,timeRangeType:d,loading:r,timeRange:c,eChartOptions:i,handleTimeRangeTypeChange:l,getOrderCountTrendComparison:u,get CardTitle(){return F}};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}}),[["render",function(s,m,d,r,c,i){const l=N,u=S,p=W,t=U;return v(),R(t,{shadow:"never"},{header:h(()=>[k("div",G,[T(r.CardTitle,{title:"\u4EA4\u6613\u91CF\u8D8B\u52BF"}),k("div",J,[T(u,{modelValue:r.timeRangeType,"onUpdate:modelValue":m[0]||(m[0]=a=>r.timeRangeType=a),onChange:r.handleTimeRangeTypeChange},{default:h(()=>[(v(!0),V(H,null,I(r.timeRange.entries(),([a,f])=>(v(),R(l,{key:a,value:a},{default:h(()=>[K(L(f.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])])])]),default:h(()=>[T(p,{height:300,options:r.eChartOptions},null,8,["options"])]),_:1})}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/mall/home/components/TradeTrendCard.vue"]]);export{X as default};
