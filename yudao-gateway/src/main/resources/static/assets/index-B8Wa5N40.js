import{d as O,S as P,r as n,u as k,C as B,D as x,a as A,_ as N,c as M,I as S,q as y,w as o,k as e,F as U,v as E,R as h,o as b,m as F,ah as D,N as j,A as q,B as H}from"./index-BaY5TDP-.js";import{g as V,_ as Q}from"./index-fxekK-Kb.js";import{u as W}from"./tagsView-lnAkwTv2.js";import{b as G}from"./index-B97LdofC.js";import J from"./ContractDetailsInfo-CrwlF0ar.js";import K from"./ContractDetailsHeader-CmajXoj5.js";import X from"./ContractProductList-CGCV9MU4.js";import{B as I}from"./index-BlslFSYd.js";import Y from"./ContractForm-DyS_nB0a.js";import Z from"./TransferForm-nV8fyRSP.js";import $ from"./PermissionList-CbQig5nT.js";import tt from"./index-CI2uGAAL.js";import et from"./ReceivableList-u7g8SwvX.js";import rt from"./ReceivablePlanList-gsz63rbx.js";import"./el-timeline-item-BFYwlQ-d.js";import"./formatTime-Dr6TiYYc.js";import"./ContentWrap-DKQn7kZm.js";import"./el-descriptions-item-CRF_CO88.js";import"./DictTag-QtcI9ZjC.js";import"./color-BN7ZL7BD.js";import"./Dialog-CZSXtzfQ.js";import"./index-h6ObHKtQ.js";import"./index-CuAlllbQ.js";import"./index-DiJG1eDb.js";import"./index-6-r4wYJE.js";import"./ContractProductForm--_dghpLm.js";import"./index-D4G-Yxr7.js";import"./index-C4zjco0X.js";import"./PermissionForm-jo-CjsNU.js";import"./index-avjYFQiD.js";import"./index-DrSdAlug.js";import"./FollowUpRecordForm-C2CG18-w.js";import"./FollowUpRecordBusinessForm-B1oFy6Z2.js";import"./FollowUpRecordContactForm-BevYD0eZ.js";import"./BusinessListModal-6XoY13Ne.js";import"./BusinessForm-DKlvsT4o.js";import"./index-n6shePIl.js";import"./BusinessProductForm-FoZjzksq.js";import"./ContactListModal-DsE0FODx.js";import"./ContactForm-DLuG_ZcF.js";import"./index-Qzz5HSIB.js";import"./tree-z7HkrWVC.js";import"./index-DcQDDeHJ.js";import"./ReceivableForm-C0pIMqYw.js";import"./index-ndAUlMgd.js";import"./ReceivablePlanForm-CXCxBqXI.js";const ot=N(O({name:"CrmContractDetail",__name:"index",props:{id:{type:Number,required:!1}},setup(L,{expose:i}){i();const C=L,t=P(),v=x(),l=n(0),c=n(!0),a=n({}),R=n(),u=n(),d=async()=>{c.value=!0;try{a.value=await G(l.value),await m(l.value)}finally{c.value=!1}},f=n([]),m=async r=>{if(!r)return;const s=await V({bizType:I.CRM_CONTRACT,bizId:r});f.value=s.list},p=n(),_=n(),{delView:T}=W(),{currentRoute:g}=k(),z=()=>{T(A(g))};B(async()=>{const r=C.id||t.params.id;if(!r)return v.warning("\u53C2\u6570\u9519\u8BEF\uFF0C\u5408\u540C\u4E0D\u80FD\u4E3A\u7A7A\uFF01"),void z();l.value=r,await d()});const w={props:C,route:t,message:v,contractId:l,loading:c,contract:a,permissionListRef:R,formRef:u,openForm:(r,s)=>{u.value.open(r,s)},getContractData:d,logList:f,getOperateLog:m,receivableListRef:p,createReceivable:r=>{var s;(s=p.value)==null||s.createReceivable(r)},transferFormRef:_,transferContract:()=>{var r;(r=_.value)==null||r.open(a.value.id)},delView:T,currentRoute:g,close:z,ContractDetailsInfo:J,ContractDetailsHeader:K,ContractProductList:X,get BizTypeEnum(){return I},ContractForm:Y,CrmTransferForm:Z,PermissionList:$,FollowUpList:tt,ReceivableList:et,ReceivablePlanList:rt};return Object.defineProperty(w,"__isScriptSetup",{enumerable:!1,value:!0}),w}}),[["render",function(L,i,C,t,v,l){const c=j,a=q,R=Q,u=H,d=E,f=h;return b(),M(U,null,[S((b(),y(t.ContractDetailsHeader,{contract:t.contract},{default:o(()=>{var m,p;return[(m=t.permissionListRef)!=null&&m.validateWrite?(b(),y(c,{key:0,onClick:i[0]||(i[0]=_=>t.openForm("update",t.contract.id))},{default:o(()=>i[1]||(i[1]=[F(" \u7F16\u8F91 ")])),_:1})):D("",!0),(p=t.permissionListRef)!=null&&p.validateOwnerUser?(b(),y(c,{key:1,type:"primary",onClick:t.transferContract},{default:o(()=>i[2]||(i[2]=[F(" \u8F6C\u79FB ")])),_:1})):D("",!0)]}),_:1},8,["contract"])),[[f,t.loading]]),e(d,null,{default:o(()=>[e(u,null,{default:o(()=>[e(a,{label:"\u8DDF\u8FDB\u8BB0\u5F55"},{default:o(()=>[e(t.FollowUpList,{"biz-id":t.contract.id,"biz-type":t.BizTypeEnum.CRM_CONTRACT},null,8,["biz-id","biz-type"])]),_:1}),e(a,{label:"\u57FA\u672C\u4FE1\u606F"},{default:o(()=>[e(t.ContractDetailsInfo,{contract:t.contract},null,8,["contract"])]),_:1}),e(a,{label:"\u4EA7\u54C1"},{default:o(()=>[e(t.ContractProductList,{contract:t.contract},null,8,["contract"])]),_:1}),e(a,{label:"\u56DE\u6B3E"},{default:o(()=>[e(t.ReceivablePlanList,{"contract-id":t.contract.id,"customer-id":t.contract.customerId,onCreateReceivable:t.createReceivable},null,8,["contract-id","customer-id"]),e(t.ReceivableList,{ref:"receivableListRef","contract-id":t.contract.id,"customer-id":t.contract.customerId},null,8,["contract-id","customer-id"])]),_:1}),e(a,{label:"\u56E2\u961F\u6210\u5458"},{default:o(()=>[e(t.PermissionList,{ref:"permissionListRef","biz-id":t.contract.id,"biz-type":t.BizTypeEnum.CRM_CONTRACT,"show-action":!0,onQuitTeam:t.close},null,8,["biz-id","biz-type"])]),_:1}),e(a,{label:"\u64CD\u4F5C\u65E5\u5FD7"},{default:o(()=>[e(R,{"log-list":t.logList},null,8,["log-list"])]),_:1})]),_:1})]),_:1}),e(t.ContractForm,{ref:"formRef",onSuccess:t.getContractData},null,512),e(t.CrmTransferForm,{ref:"transferFormRef","biz-type":t.BizTypeEnum.CRM_CONTRACT,onSuccess:t.close},null,8,["biz-type"])],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/crm/contract/detail/index.vue"]]);export{ot as default};
