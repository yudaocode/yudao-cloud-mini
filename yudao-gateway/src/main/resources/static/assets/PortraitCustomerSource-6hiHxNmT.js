import{d as O,r as _,f as b,C as R,aB as v,G as h,aI as E,ew as w,eu as S,_ as x,o as P,c as T,k as t,w as s,I as U,q as I,F as M,v as q,E as D,l as L,P as W,Q as j,R as z}from"./index-BaY5TDP-.js";import{_ as A}from"./DictTag-QtcI9ZjC.js";import{E as Y}from"./el-skeleton-item-BYAIkmCs.js";import{_ as k}from"./Echart-BQxFkezy.js";import{S as B}from"./portrait-CXf55QaH.js";import"./color-BN7ZL7BD.js";import"./echarts-DpbyC_6K.js";const F=x(O({name:"PortraitCustomerSource",__name:"PortraitCustomerSource",props:{queryParams:{type:null,required:!0}},setup(g,{expose:C}){const p=g,o=_(!1),m=_([]),l=b({title:{text:"\u5168\u90E8\u5BA2\u6237",left:"center"},tooltip:{trigger:"item"},legend:{orient:"vertical",left:"left"},toolbox:{feature:{saveAsImage:{show:!0,name:"\u5168\u90E8\u5BA2\u6237"}}},series:[{name:"\u5168\u90E8\u5BA2\u6237",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:40,fontWeight:"bold"}},labelLine:{show:!1},data:[]}]}),i=b({title:{text:"\u6210\u4EA4\u5BA2\u6237",left:"center"},tooltip:{trigger:"item"},legend:{orient:"vertical",left:"left"},toolbox:{feature:{saveAsImage:{show:!0,name:"\u6210\u4EA4\u5BA2\u6237"}}},series:[{name:"\u6210\u4EA4\u5BA2\u6237",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:40,fontWeight:"bold"}},labelLine:{show:!1},data:[]}]}),n=async()=>{o.value=!0;const r=await B.getCustomerSource(p.queryParams);l.series&&l.series[0]&&l.series[0].data&&(l.series[0].data=r.map(e=>({name:v(h.CRM_CUSTOMER_SOURCE,e.source),value:e.customerCount}))),i.series&&i.series[0]&&i.series[0].data&&(i.series[0].data=r.map(e=>({name:v(h.CRM_CUSTOMER_SOURCE,e.source),value:e.dealCount}))),u(r),m.value=r,o.value=!1};C({loadData:n});const u=r=>{if(E(r))return;const e=r,c=w(e.map(a=>a.customerCount)),f=w(e.map(a=>a.dealCount));e.forEach(a=>{a.sourcePortion=a.customerCount===0?0:S(a.customerCount,c),a.dealPortion=a.dealCount===0?0:S(a.dealCount,f)})};R(()=>{n()});const d={props:p,loading:o,list:m,echartsOption:l,echartsOption2:i,loadData:n,calculateProportion:u,get DICT_TYPE(){return h}};return Object.defineProperty(d,"__isScriptSetup",{enumerable:!1,value:!0}),d}}),[["render",function(g,C,p,o,m,l){const i=k,n=Y,u=q,d=D,r=L,e=W,c=A,f=j,a=z;return P(),T(M,null,[t(r,{shadow:"never"},{default:s(()=>[t(d,{gutter:20},{default:s(()=>[t(u,{span:12},{default:s(()=>[t(n,{loading:o.loading,animated:""},{default:s(()=>[t(i,{height:500,options:o.echartsOption},null,8,["options"])]),_:1},8,["loading"])]),_:1}),t(u,{span:12},{default:s(()=>[t(n,{loading:o.loading,animated:""},{default:s(()=>[t(i,{height:500,options:o.echartsOption2},null,8,["options"])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1}),t(r,{class:"mt-16px",shadow:"never"},{default:s(()=>[U((P(),I(f,{data:o.list},{default:s(()=>[t(e,{align:"center",label:"\u5E8F\u53F7",type:"index",width:"80"}),t(e,{align:"center",label:"\u5BA2\u6237\u6765\u6E90",prop:"source",width:"100"},{default:s(y=>[t(c,{type:o.DICT_TYPE.CRM_CUSTOMER_SOURCE,value:y.row.source},null,8,["type","value"])]),_:1}),t(e,{align:"center",label:"\u5BA2\u6237\u4E2A\u6570","min-width":"200",prop:"customerCount"}),t(e,{align:"center",label:"\u6210\u4EA4\u4E2A\u6570","min-width":"200",prop:"dealCount"}),t(e,{align:"center",label:"\u6765\u6E90\u5360\u6BD4(%)","min-width":"200",prop:"sourcePortion"}),t(e,{align:"center",label:"\u6210\u4EA4\u5360\u6BD4(%)","min-width":"200",prop:"dealPortion"})]),_:1},8,["data"])),[[a,o.loading]])]),_:1})],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/crm/statistics/portrait/components/PortraitCustomerSource.vue"]]);export{F as default};
