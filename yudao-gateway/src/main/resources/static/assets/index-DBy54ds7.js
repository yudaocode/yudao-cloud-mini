import{d as q,D as x,g as F,r as h,f as I,_ as N,X as T,o as m,c as z,k as t,w as l,I as u,q as d,m as w,F as A,L as D,z as L,N as R,O as U,P as j,Q as O,R as W}from"./index-BaY5TDP-.js";import{_ as M}from"./index-avjYFQiD.js";import{_ as Q}from"./ContentWrap-DKQn7kZm.js";import{_ as X}from"./index-BAz6Gqim.js";import{d as B}from"./formatTime-Dr6TiYYc.js";import{a as E,d as G,s as H}from"./index-CFEI7Byd.js";import J from"./TagForm-Df2NpjSo.js";import K from"./main-DuOfDTOL.js";import"./index-DrSdAlug.js";import"./Dialog-CZSXtzfQ.js";import"./index-C1v7IUC9.js";import"./tagsView-lnAkwTv2.js";const V=N(q({name:"MpTag",__name:"index",setup(S,{expose:e}){e();const n=x(),{t:a}=F(),g=h(!0),P=h(0),f=h([]),o=I({pageNo:1,pageSize:10,accountId:-1}),p=h(null),s=async()=>{try{g.value=!0;const r=await E(o);f.value=r.list,P.value=r.total}finally{g.value=!1}},y={message:n,t:a,loading:g,total:P,list:f,queryParams:o,formRef:p,onAccountChanged:r=>{o.accountId=r,o.pageNo=1,s()},getList:s,openForm:(r,i)=>{var _;(_=p.value)==null||_.open(r,o.accountId,i)},handleDelete:async r=>{try{await n.delConfirm(),await G(r),n.success(a("common.delSuccess")),await s()}catch{}},handleSync:async()=>{try{await n.confirm("\u662F\u5426\u786E\u8BA4\u540C\u6B65\u6807\u7B7E\uFF1F"),await H(o.accountId),n.success("\u540C\u6B65\u6807\u7B7E\u6210\u529F"),await s()}catch{}},get dateFormatter(){return B},TagForm:J,get WxAccountSelect(){return K}};return Object.defineProperty(y,"__isScriptSetup",{enumerable:!1,value:!0}),y}}),[["render",function(S,e,n,a,g,P){const f=X,o=D,p=L,s=R,y=U,r=Q,i=j,_=O,v=M,b=T("hasPermi"),C=W;return m(),z(A,null,[t(f,{title:"\u516C\u4F17\u53F7\u6807\u7B7E",url:"https://doc.iocoder.cn/mp/tag/"}),t(r,null,{default:l(()=>[t(y,{class:"-mb-15px",model:a.queryParams,ref:"queryFormRef",inline:!0,"label-width":"68px"},{default:l(()=>[t(o,{label:"\u516C\u4F17\u53F7",prop:"accountId"},{default:l(()=>[t(a.WxAccountSelect,{onChange:a.onAccountChanged})]),_:1}),t(o,null,{default:l(()=>[u((m(),d(s,{type:"primary",plain:"",onClick:e[0]||(e[0]=c=>a.openForm("create")),disabled:a.queryParams.accountId===0},{default:l(()=>[t(p,{icon:"ep:plus",class:"mr-5px"}),e[3]||(e[3]=w(" \u65B0\u589E "))]),_:1},8,["disabled"])),[[b,["mp:tag:create"]]]),u((m(),d(s,{type:"success",plain:"",onClick:a.handleSync,disabled:a.queryParams.accountId===0},{default:l(()=>[t(p,{icon:"ep:refresh",class:"mr-5px"}),e[4]||(e[4]=w(" \u540C\u6B65 "))]),_:1},8,["disabled"])),[[b,["mp:tag:sync"]]])]),_:1})]),_:1},8,["model"])]),_:1}),t(r,null,{default:l(()=>[u((m(),d(_,{data:a.list},{default:l(()=>[t(i,{label:"\u7F16\u53F7",align:"center",prop:"id"}),t(i,{label:"\u6807\u7B7E\u540D\u79F0",align:"center",prop:"name"}),t(i,{label:"\u7C89\u4E1D\u6570",align:"center",prop:"count"}),t(i,{label:"\u521B\u5EFA\u65F6\u95F4",align:"center",prop:"createTime",width:"180",formatter:a.dateFormatter},null,8,["formatter"]),t(i,{label:"\u64CD\u4F5C",align:"center"},{default:l(c=>[u((m(),d(s,{link:"",type:"primary",onClick:k=>a.openForm("update",c.row.id)},{default:l(()=>e[5]||(e[5]=[w(" \u4FEE\u6539 ")])),_:2},1032,["onClick"])),[[b,["mp:tag:update"]]]),u((m(),d(s,{link:"",type:"danger",onClick:k=>a.handleDelete(c.row.id)},{default:l(()=>e[6]||(e[6]=[w(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[b,["mp:tag:delete"]]])]),_:1})]),_:1},8,["data"])),[[C,a.loading]]),t(v,{total:a.total,page:a.queryParams.pageNo,"onUpdate:page":e[1]||(e[1]=c=>a.queryParams.pageNo=c),limit:a.queryParams.pageSize,"onUpdate:limit":e[2]||(e[2]=c=>a.queryParams.pageSize=c),onPagination:a.getList},null,8,["total","page","limit"])]),_:1}),t(a.TagForm,{ref:"formRef",onSuccess:a.getList},null,512)],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/mp/tag/index.vue"]]);export{V as default};
