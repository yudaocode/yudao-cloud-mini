import{d as w,u as L,r as i,f as O,C as F,D as q,G as x,U as C,a as E,_ as I,I as P,q as g,w as t,O as j,R as B,o as d,k as r,c as h,n as D,F as S,m as A,ah as Y,J as K,K as M,L as G,M as J,Z as N,l as Z,v as $,N as z}from"./index-BaY5TDP-.js";import{c as H}from"./index-BQPLBeL2.js";import{u as Q}from"./tagsView-lnAkwTv2.js";import{a as W}from"./index-5lnhJJF7.js";import{g as X}from"./index-CuAlllbQ.js";const R="oa_leave",ee=I(w({name:"BpmOALeaveCreate",__name:"create",setup(k,{expose:l}){l();const v=q(),{delView:e}=Q(),{push:T,currentRoute:V}=L(),m=i(!1),p=i({type:void 0,reason:void 0,startTime:void 0,endTime:void 0}),o=O({type:[{required:!0,message:"\u8BF7\u5047\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],reason:[{required:!0,message:"\u8BF7\u5047\u539F\u56E0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],startTime:[{required:!0,message:"\u8BF7\u5047\u5F00\u59CB\u65F6\u95F4\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],endTime:[{required:!0,message:"\u8BF7\u5047\u7ED3\u675F\u65F6\u95F4\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}]}),n=i(),u=i([]),f=i({}),_=i(),b=i({}),y=i([]);F(async()=>{var s;const a=await W(void 0,R);if(a){if(u.value=a.startUserSelectTasks,((s=u.value)==null?void 0:s.length)>0){for(const c of u.value)f.value[c.id]=[],b.value[c.id]=[{required:!0,message:"\u8BF7\u9009\u62E9\u5BA1\u6279\u4EBA",trigger:"blur"}];y.value=await X()}}else v.error("OA \u8BF7\u5047\u7684\u6D41\u7A0B\u6A21\u578B\u672A\u914D\u7F6E\uFF0C\u8BF7\u68C0\u67E5\uFF01")});const U={message:v,delView:e,push:T,currentRoute:V,formLoading:m,formData:p,formRules:o,formRef:n,processDefineKey:R,startUserSelectTasks:u,startUserSelectAssignees:f,startUserSelectAssigneesFormRef:_,startUserSelectAssigneesFormRules:b,userList:y,submitForm:async()=>{var a,s;if(n&&await n.value.validate()){((a=u.value)==null?void 0:a.length)>0&&await _.value.validate(),m.value=!0;try{const c={...p.value};((s=u.value)==null?void 0:s.length)>0&&(c.startUserSelectAssignees=f.value),await H(c),v.success("\u53D1\u8D77\u6210\u529F"),e(E(V)),await T({name:"BpmOALeave"})}finally{m.value=!1}}},get DICT_TYPE(){return x},get getIntDictOptions(){return C}};return Object.defineProperty(U,"__isScriptSetup",{enumerable:!1,value:!0}),U}}),[["render",function(k,l,v,e,T,V){const m=K,p=M,o=G,n=J,u=N,f=j,_=Z,b=$,y=z,U=B;return P((d(),g(f,{ref:"formRef",model:e.formData,rules:e.formRules,"label-width":"80px"},{default:t(()=>[r(o,{label:"\u8BF7\u5047\u7C7B\u578B",prop:"type"},{default:t(()=>[r(p,{modelValue:e.formData.type,"onUpdate:modelValue":l[0]||(l[0]=a=>e.formData.type=a),clearable:"",placeholder:"\u8BF7\u9009\u62E9\u8BF7\u5047\u7C7B\u578B"},{default:t(()=>[(d(!0),h(S,null,D(e.getIntDictOptions(e.DICT_TYPE.BPM_OA_LEAVE_TYPE),a=>(d(),g(m,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),r(o,{label:"\u5F00\u59CB\u65F6\u95F4",prop:"startTime"},{default:t(()=>[r(n,{modelValue:e.formData.startTime,"onUpdate:modelValue":l[1]||(l[1]=a=>e.formData.startTime=a),clearable:"",placeholder:"\u8BF7\u9009\u62E9\u5F00\u59CB\u65F6\u95F4",type:"datetime","value-format":"x"},null,8,["modelValue"])]),_:1}),r(o,{label:"\u7ED3\u675F\u65F6\u95F4",prop:"endTime"},{default:t(()=>[r(n,{modelValue:e.formData.endTime,"onUpdate:modelValue":l[2]||(l[2]=a=>e.formData.endTime=a),clearable:"",placeholder:"\u8BF7\u9009\u62E9\u7ED3\u675F\u65F6\u95F4",type:"datetime","value-format":"x"},null,8,["modelValue"])]),_:1}),r(o,{label:"\u539F\u56E0",prop:"reason"},{default:t(()=>[r(u,{modelValue:e.formData.reason,"onUpdate:modelValue":l[3]||(l[3]=a=>e.formData.reason=a),placeholder:"\u8BF7\u8F93\u8BF7\u5047\u539F\u56E0",type:"textarea"},null,8,["modelValue"])]),_:1}),e.startUserSelectTasks.length>0?(d(),g(b,{key:0},{default:t(()=>[r(_,{class:"mb-10px"},{header:t(()=>l[4]||(l[4]=[A("\u6307\u5B9A\u5BA1\u6279\u4EBA")])),default:t(()=>[r(f,{model:e.startUserSelectAssignees,rules:e.startUserSelectAssigneesFormRules,ref:"startUserSelectAssigneesFormRef"},{default:t(()=>[(d(!0),h(S,null,D(e.startUserSelectTasks,a=>(d(),g(o,{key:a.id,label:`\u4EFB\u52A1\u3010${a.name}\u3011`,prop:a.id},{default:t(()=>[r(p,{modelValue:e.startUserSelectAssignees[a.id],"onUpdate:modelValue":s=>e.startUserSelectAssignees[a.id]=s,multiple:"",placeholder:"\u8BF7\u9009\u62E9\u5BA1\u6279\u4EBA"},{default:t(()=>[(d(!0),h(S,null,D(e.userList,s=>(d(),g(m,{key:s.id,label:s.nickname,value:s.id},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label","prop"]))),128))]),_:1},8,["model","rules"])]),_:1})]),_:1})):Y("",!0),r(o,null,{default:t(()=>[r(y,{disabled:e.formLoading,type:"primary",onClick:e.submitForm},{default:t(()=>l[5]||(l[5]=[A("\u786E \u5B9A")])),_:1},8,["disabled"])]),_:1})]),_:1},8,["model","rules"])),[[U,e.formLoading]])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/bpm/oa/leave/create.vue"]]);export{ee as default};
