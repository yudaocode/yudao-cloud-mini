import{d as N,D as R,r as n,f as k,u as S,e2 as B,_ as I,X as Q,o as q,q as x,w as l,k as s,m as p,Y as U,I as C,t as z,Z as D,L as j,z as M,N as T,O,P as K,y as X,Q as Y,R as Z}from"./index-BaY5TDP-.js";import{_ as A}from"./Dialog-CZSXtzfQ.js";import{_ as E}from"./index-avjYFQiD.js";import{_ as G}from"./ContentWrap-DKQn7kZm.js";import{g as H}from"./index-6-r4wYJE.js";import J from"./BusinessForm-DKlvsT4o.js";import"./index-DrSdAlug.js";import"./index-n6shePIl.js";import"./index-h6ObHKtQ.js";import"./index-CuAlllbQ.js";import"./BusinessProductForm-FoZjzksq.js";import"./DictTag-QtcI9ZjC.js";import"./color-BN7ZL7BD.js";import"./index-D4G-Yxr7.js";const W=I(N({name:"BusinessListModal",__name:"BusinessListModal",props:{customerId:{type:Number,required:!0}},emits:["success"],setup(F,{expose:a,emit:V}){const e=R(),y=F,b=n(!1),d=n(!0),c=n(0),u=n([]),i=n(),w=n(!1),m=k({pageNo:1,pageSize:10,name:void 0,customerId:y.customerId}),o=async()=>{b.value=!0,m.customerId=y.customerId,await f()};a({open:o});const f=async()=>{d.value=!0;try{const r=await H(m);u.value=r.list,c.value=r.total}finally{d.value=!1}},_=()=>{m.pageNo=1,f()},v=n(),P=V,g=n(),{push:h}=S(),t={message:e,props:y,dialogVisible:b,loading:d,total:c,list:u,queryFormRef:i,formLoading:w,queryParams:m,open:o,getList:f,handleQuery:_,resetQuery:()=>{i.value.resetFields(),_()},formRef:v,openForm:()=>{v.value.open("create")},emit:P,businessRef:g,submitForm:async()=>{const r=g.value.getSelectionRows().map(L=>L.id);if(r.length===0)return e.error("\u672A\u9009\u62E9\u5546\u673A");b.value=!1,P("success",r,g.value.getSelectionRows())},push:h,openDetail:r=>{h({name:"CrmBusinessDetail",params:{id:r}})},BusinessForm:J,get erpPriceTableColumnFormatter(){return B}};return Object.defineProperty(t,"__isScriptSetup",{enumerable:!1,value:!0}),t}}),[["render",function(F,a,V,e,y,b){const d=D,c=j,u=M,i=T,w=O,m=G,o=K,f=X,_=Y,v=E,P=A,g=Q("hasPermi"),h=Z;return q(),x(P,{title:"\u5173\u8054\u5546\u673A",modelValue:e.dialogVisible,"onUpdate:modelValue":a[5]||(a[5]=t=>e.dialogVisible=t)},{footer:l(()=>[s(i,{onClick:e.submitForm,type:"primary",disabled:e.formLoading},{default:l(()=>a[9]||(a[9]=[p("\u786E \u5B9A")])),_:1},8,["disabled"]),s(i,{onClick:a[4]||(a[4]=t=>e.dialogVisible=!1)},{default:l(()=>a[10]||(a[10]=[p("\u53D6 \u6D88")])),_:1})]),default:l(()=>[s(m,null,{default:l(()=>[s(w,{class:"-mb-15px",model:e.queryParams,ref:"queryFormRef",inline:!0,"label-width":"68px"},{default:l(()=>[s(c,{label:"\u5546\u673A\u540D\u79F0",prop:"name"},{default:l(()=>[s(d,{modelValue:e.queryParams.name,"onUpdate:modelValue":a[0]||(a[0]=t=>e.queryParams.name=t),placeholder:"\u8BF7\u8F93\u5165\u5546\u673A\u540D\u79F0",clearable:"",onKeyup:U(e.handleQuery,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),s(c,null,{default:l(()=>[s(i,{onClick:e.handleQuery},{default:l(()=>[s(u,{icon:"ep:search",class:"mr-5px"}),a[6]||(a[6]=p(" \u641C\u7D22"))]),_:1}),s(i,{onClick:e.resetQuery},{default:l(()=>[s(u,{icon:"ep:refresh",class:"mr-5px"}),a[7]||(a[7]=p(" \u91CD\u7F6E"))]),_:1}),C((q(),x(i,{type:"primary",onClick:a[1]||(a[1]=t=>e.openForm())},{default:l(()=>[s(u,{icon:"ep:plus",class:"mr-5px"}),a[8]||(a[8]=p(" \u65B0\u589E "))]),_:1})),[[g,["crm:business:create"]]])]),_:1})]),_:1},8,["model"])]),_:1}),s(m,{class:"mt-10px"},{default:l(()=>[C((q(),x(_,{ref:"businessRef",data:e.list,stripe:!0,"show-overflow-tooltip":!0},{default:l(()=>[s(o,{type:"selection",width:"55"}),s(o,{label:"\u5546\u673A\u540D\u79F0",fixed:"left",align:"center",prop:"name"},{default:l(t=>[s(f,{type:"primary",underline:!1,onClick:r=>e.openDetail(t.row.id)},{default:l(()=>[p(z(t.row.name),1)]),_:2},1032,["onClick"])]),_:1}),s(o,{label:"\u5546\u673A\u91D1\u989D",align:"center",prop:"totalPrice",formatter:e.erpPriceTableColumnFormatter},null,8,["formatter"]),s(o,{label:"\u5BA2\u6237\u540D\u79F0",align:"center",prop:"customerName"}),s(o,{label:"\u5546\u673A\u7EC4",align:"center",prop:"statusTypeName"}),s(o,{label:"\u5546\u673A\u9636\u6BB5",align:"center",prop:"statusName"})]),_:1},8,["data"])),[[h,e.loading]]),s(v,{total:e.total,page:e.queryParams.pageNo,"onUpdate:page":a[2]||(a[2]=t=>e.queryParams.pageNo=t),limit:e.queryParams.pageSize,"onUpdate:limit":a[3]||(a[3]=t=>e.queryParams.pageSize=t),onPagination:e.getList},null,8,["total","page","limit"])]),_:1}),s(e.BusinessForm,{ref:"formRef",onSuccess:e.getList},null,512)]),_:1},8,["modelValue"])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/crm/business/components/BusinessListModal.vue"]]);export{W as default};
