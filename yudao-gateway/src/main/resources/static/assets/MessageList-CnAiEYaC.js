import{d as H,D as T,ea as V,r as k,b as _,C as z,_ as S,o as u,c as g,e as O,ca as q,ao as U,eb as I,ec as N,ed as $,j as a,F as E,n as W,k as c,w as d,m as R,t as x,q as Y,ah as y,b8 as F,N as J,bs as K}from"./index-BaY5TDP-.js";import{E as Q}from"./el-avatar-DZsRbb7z.js";import{f as X}from"./formatTime-Dr6TiYYc.js";import{M as Z}from"./index-BiCwg61_.js";import{H as B}from"./index-BuMQ6E3q.js";import{C as e2}from"./index-CuG4_yhq.js";import{a as s2}from"./avatar-BG6NdH5s.js";import{r as t2}from"./gpt-WhTktY3S.js";import"./fetch-D5K_4anA.js";const a2=["innerHTML"],c2=S(H({__name:"index",props:{content:{type:String,required:!0}},setup(w,{expose:o}){o();const f=w,e=T(),{copy:v}=V(),h=k(),n=new Z({highlight:function(l,s){if(s&&B.getLanguage(s))try{return`<pre style="position: relative;">${`<div id="copy" data-copy='${l}' style="position: absolute; right: 10px; top: 5px; color: #fff;cursor: pointer;">\u590D\u5236</div>`}<code class="hljs">${B.highlight(s,l,!0).value}</code></pre>`}catch{}return""}}),p=_(()=>n.render(f.content));z(async()=>{h.value.addEventListener("click",l=>{var s,m;l.target.id==="copy"&&(v((m=(s=l.target)==null?void 0:s.dataset)==null?void 0:m.copy),e.success("\u590D\u5236\u6210\u529F!"))})});const i={props:f,message:e,copy:v,contentRef:h,md:n,renderedMarkdown:p};return Object.defineProperty(i,"__isScriptSetup",{enumerable:!1,value:!0}),i}}),[["render",function(w,o,f,e,v,h){return u(),g("div",{ref:"contentRef",class:"markdown-view",innerHTML:e.renderedMarkdown},null,8,a2)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/components/MarkdownView/index.vue"]]),G="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1715352878351'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='1499'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='200'%20height='200'%3e%3cpath%20d='M624.5%20786.3c92.9%200%20168.2-75.3%20168.2-168.2V309c0-92.4-75.3-168.2-168.2-168.2H303.6c-92.4%200-168.2%2075.3-168.2%20168.2v309.1c0%2092.4%2075.3%20168.2%20168.2%20168.2h320.9zM178.2%20618.1V309c0-69.4%2056.1-125.5%20125.5-125.5h320.9c69.4%200%20125.5%2056.1%20125.5%20125.5v309.1c0%2069.4-56.1%20125.5-125.5%20125.5h-321c-69.4%200-125.4-56.1-125.4-125.5z'%20p-id='1500'%20fill='%238a8a8a'%3e%3c/path%3e%3cpath%20d='M849.8%20295.1v361.5c0%20102.7-83.6%20186.3-186.3%20186.3H279.1v42.7h384.4c126.3%200%20229.1-102.8%20229.1-229.1V295.1h-42.8zM307.9%20361.8h312.3c11.8%200%2021.4-9.6%2021.4-21.4%200-11.8-9.6-21.4-21.4-21.4H307.9c-11.8%200-21.4%209.6-21.4%2021.4%200%2011.9%209.6%2021.4%2021.4%2021.4zM307.9%20484.6h312.3c11.8%200%2021.4-9.6%2021.4-21.4%200-11.8-9.6-21.4-21.4-21.4H307.9c-11.8%200-21.4%209.6-21.4%2021.4%200%2011.9%209.6%2021.4%2021.4%2021.4z'%20p-id='1501'%20fill='%238a8a8a'%3e%3c/path%3e%3cpath%20d='M620.2%20607.4c11.8%200%2021.4-9.6%2021.4-21.4%200-11.8-9.6-21.4-21.4-21.4H307.9c-11.8%200-21.4%209.6-21.4%2021.4%200%2011.8%209.6%2021.4%2021.4%2021.4h312.3z'%20p-id='1502'%20fill='%238a8a8a'%3e%3c/path%3e%3c/svg%3e",L="data:image/svg+xml,%3c?xml%20version='1.0'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20t='1715354120346'%20class='icon'%20viewBox='0%200%201024%201024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20p-id='3256'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='200'%20height='200'%3e%3cpath%20d='M907.1%20263.7H118.9c-9.1%200-16.4-7.3-16.4-16.4s7.3-16.4%2016.4-16.4H907c9.1%200%2016.4%207.3%2016.4%2016.4s-7.3%2016.4-16.3%2016.4z'%20fill='%238a8a8a'%20p-id='3257'%3e%3c/path%3e%3cpath%20d='M772.5%20928.3H257.4c-27.7%200-50.2-22.5-50.2-50.2V247.2c0-9.1%207.3-16.4%2016.4-16.4H801c12.1%200%2021.9%209.8%2021.9%2021.9v625.2c0%2027.8-22.6%2050.4-50.4%2050.4zM240%20263.7v614.4c0%209.6%207.8%2017.4%2017.4%2017.4h515.2c9.7%200%2017.5-7.9%2017.5-17.5V263.7H240zM657.4%20131.1H368.6c-9.1%200-16.4-7.3-16.4-16.4s7.3-16.4%2016.4-16.4h288.7c9.1%200%2016.4%207.3%2016.4%2016.4s-7.3%2016.4-16.3%2016.4z'%20fill='%238a8a8a'%20p-id='3258'%3e%3c/path%3e%3cpath%20d='M416%20754.5c-9.1%200-16.4-7.3-16.4-16.4V517.8c0-9.1%207.3-16.4%2016.4-16.4s16.4%207.3%2016.4%2016.4V738c0.1%209.1-7.3%2016.5-16.4%2016.5z'%20fill='%238a8a8a'%20p-id='3259'%3e%3c/path%3e%3cpath%20d='M416%20465.2c-9.1%200-16.4-7.3-16.4-16.4v-59.4c0-9.1%207.3-16.4%2016.4-16.4s16.4%207.3%2016.4%2016.4v59.4c0.1%209.1-7.3%2016.4-16.4%2016.4zM604.9%20754.5c-9.1%200-16.4-7.3-16.4-16.4v-67.2c0-9.1%207.3-16.4%2016.4-16.4s16.4%207.3%2016.4%2016.4V738c0%209.1-7.3%2016.5-16.4%2016.5z'%20fill='%238a8a8a'%20opacity='.4'%20p-id='3260'%3e%3c/path%3e%3cpath%20d='M604.9%20619.1c-9.1%200-16.4-7.3-16.4-16.4V389.4c0-9.1%207.3-16.4%2016.4-16.4s16.4%207.3%2016.4%2016.4v213.3c0%209.1-7.3%2016.4-16.4%2016.4z'%20fill='%238a8a8a'%20p-id='3261'%3e%3c/path%3e%3c/svg%3e",n2={ref:"messageContainer",class:"h-100% overflow-y-auto relative"},o2={key:0,class:"left-message message-item"},i2={class:"avatar"},l2={class:"message"},r2={class:"left-btns"},d2={key:1,class:"right-message message-item"},p2={class:"avatar"},u2={class:"message"},v2={class:"right-text-container"},h2={class:"right-text"},m2={class:"right-btns"},g2=S(H({__name:"MessageList",props:{conversation:{type:Object,required:!0},list:{type:Array,required:!0}},emits:["onDeleteSuccess","onRefresh","onEdit"],setup(w,{expose:o,emit:f}){const e=T(),{copy:v}=V(),h=O(),n=k(null),p=k(!1),i=_(()=>h.user.avatar||s2),l=_(()=>s.conversation.roleAvatar??t2),s=w,{list:m}=q(s),r=f,C=async t=>{await U(),!t&&p.value||(n.value.scrollTop=n.value.scrollHeight-n.value.offsetHeight)};function b(){const t=n.value,A=t.scrollTop,P=t.scrollHeight,j=t.offsetHeight;p.value=A+j<P-100}const M=async()=>{n.value.scrollTop=0};o({scrollToBottom:C,handlerGoTop:M}),z(async()=>{n.value.addEventListener("scroll",b)});const D={message:e,copy:v,userStore:h,messageContainer:n,isScrolling:p,userAvatar:i,roleAvatar:l,props:s,list:m,emits:r,scrollToBottom:C,handleScroll:b,handleGoBottom:async()=>{const t=n.value;t.scrollTop=t.scrollHeight},handlerGoTop:M,copyContent:async t=>{await v(t),e.success("\u590D\u5236\u6210\u529F\uFF01")},onDelete:async t=>{await e2.deleteChatMessage(t),e.success("\u5220\u9664\u6210\u529F\uFF01"),r("onDeleteSuccess")},onRefresh:async t=>{r("onRefresh",t)},onEdit:async t=>{r("onEdit",t)},get formatDate(){return X},MarkdownView:c2,get ArrowDownBold(){return I},get Edit(){return N},get RefreshRight(){return $}};return Object.defineProperty(D,"__isScriptSetup",{enumerable:!1,value:!0}),D}}),[["render",function(w,o,f,e,v,h){const n=Q,p=F,i=J,l=K;return u(),g(E,null,[a("div",n2,[(u(!0),g(E,null,W(e.list,(s,m)=>(u(),g("div",{class:"chat-list",key:m},[s.type!=="user"?(u(),g("div",o2,[a("div",i2,[c(n,{src:e.roleAvatar},null,8,["src"])]),a("div",l2,[a("div",null,[c(p,{class:"time"},{default:d(()=>[R(x(e.formatDate(s.createTime)),1)]),_:2},1024)]),a("div",{class:"left-text-container",ref_for:!0,ref:"markdownViewRef"},[c(e.MarkdownView,{class:"left-text",content:s.content},null,8,["content"])],512),a("div",r2,[c(i,{class:"btn-cus",link:"",onClick:r=>e.copyContent(s.content)},{default:d(()=>[...o[0]||(o[0]=[a("img",{class:"btn-image",src:G},null,-1)])]),_:2},1032,["onClick"]),s.id>0?(u(),Y(i,{key:0,class:"btn-cus",link:"",onClick:r=>e.onDelete(s.id)},{default:d(()=>[...o[1]||(o[1]=[a("img",{class:"btn-image h-17px",src:L},null,-1)])]),_:2},1032,["onClick"])):y("",!0)])])])):y("",!0),s.type==="user"?(u(),g("div",d2,[a("div",p2,[c(n,{src:e.userAvatar},null,8,["src"])]),a("div",u2,[a("div",null,[c(p,{class:"time"},{default:d(()=>[R(x(e.formatDate(s.createTime)),1)]),_:2},1024)]),a("div",v2,[a("div",h2,x(s.content),1)]),a("div",m2,[c(i,{class:"btn-cus",link:"",onClick:r=>e.copyContent(s.content)},{default:d(()=>[...o[2]||(o[2]=[a("img",{class:"btn-image",src:G},null,-1)])]),_:2},1032,["onClick"]),c(i,{class:"btn-cus",link:"",onClick:r=>e.onDelete(s.id)},{default:d(()=>[...o[3]||(o[3]=[a("img",{class:"btn-image h-17px mr-12px",src:L},null,-1)])]),_:2},1032,["onClick"]),c(i,{class:"btn-cus",link:"",onClick:r=>e.onRefresh(s)},{default:d(()=>[c(l,{size:"17"},{default:d(()=>[c(e.RefreshRight)]),_:1})]),_:2},1032,["onClick"]),c(i,{class:"btn-cus",link:"",onClick:r=>e.onEdit(s)},{default:d(()=>[c(l,{size:"17"},{default:d(()=>[c(e.Edit)]),_:1})]),_:2},1032,["onClick"])])])])):y("",!0)]))),128))],512),e.isScrolling?(u(),g("div",{key:0,class:"to-bottom",onClick:e.handleGoBottom},[c(i,{icon:e.ArrowDownBold,circle:""},null,8,["icon"])])):y("",!0)],64)}],["__scopeId","data-v-2f07428b"],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/ai/chat/index/components/message/MessageList.vue"]]);export{g2 as default};
