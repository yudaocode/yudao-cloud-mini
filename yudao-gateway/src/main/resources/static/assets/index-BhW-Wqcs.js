import{d as w,r as x,au as k,aA as T,_ as S,o,c as p,F as P,n as C,aF as a,k as h,ah as n,j as f,a2 as m,t as i,q as I}from"./index-BaY5TDP-.js";import{E as R}from"./el-image-Bg-CwbDE.js";import{b as B}from"./spu-BVX48OKx.js";import{P as _}from"./index-PmeLzyKc.js";const L=w({name:"PromotionPoint",__name:"index",props:{property:{type:Object,required:!0}},setup(v,{expose:b}){b();const t=v,l=x([]),y=x([]),u=x([]);k(()=>t.property.activityIds,async()=>{try{const r=t.property.activityIds;Array.isArray(r)&&r.length>0&&(u.value=await _.getPointActivityListByIds(r),l.value=[],y.value=u.value.map(s=>s.spuId),y.value.length>0&&(l.value=await B(y.value)),u.value.forEach(s=>{const d=l.value.find(g=>g.id===s.spuId);d&&(d.pointStock=s.stock,d.pointTotalStock=s.totalStock,d.point=s.point,d.pointPrice=s.price)}))}catch(r){console.error("\u83B7\u53D6\u79EF\u5206\u5546\u57CE\u6D3B\u52A8\u7EC6\u8282\u6216 SPU \u7EC6\u8282\u65F6\u51FA\u9519:",r)}},{immediate:!0,deep:!0});const c=x(),e={props:t,spuList:l,spuIdList:y,pointActivityList:u,calculateSpace:r=>{const s=t.property.layoutType==="twoCol"?2:1;return{marginLeft:r%s==0?"0":t.property.space+"px",marginTop:r<s?"0":t.property.space+"px"}},containerRef:c,calculateWidth:()=>{let r="100%";return t.property.layoutType==="twoCol"&&(r=(c.value.offsetWidth-t.property.space)/2+"px"),{width:r}},get fenToYuan(){return T}};return Object.defineProperty(e,"__isScriptSetup",{enumerable:!1,value:!0}),e}}),$={ref:"containerRef",class:m("box-content min-h-30px w-full flex flex-row flex-wrap")},A={key:0,class:"absolute left-0 top-0 z-1 items-center justify-center"},U={class:"text-12px"},j={class:"absolute bottom-8px right-8px"},E=S(L,[["render",function(v,b,t,l,y,u){const c=R;return o(),p("div",$,[(o(!0),p(P,null,C(l.spuList,(e,r)=>(o(),p("div",{key:r,style:a({...l.calculateSpace(r),...l.calculateWidth(),borderTopLeftRadius:`${t.property.borderRadiusTop}px`,borderTopRightRadius:`${t.property.borderRadiusTop}px`,borderBottomLeftRadius:`${t.property.borderRadiusBottom}px`,borderBottomRightRadius:`${t.property.borderRadiusBottom}px`}),class:"relative box-content flex flex-row flex-wrap overflow-hidden bg-white"},[t.property.badge.show?(o(),p("div",A,[h(c,{src:t.property.badge.imgUrl,class:"h-26px w-38px",fit:"cover"},null,8,["src"])])):n("",!0),f("div",{class:m(["h-140px",{"w-full":t.property.layoutType!=="oneColSmallImg","w-140px":t.property.layoutType==="oneColSmallImg"}])},[h(c,{src:e.picUrl,class:"h-full w-full",fit:"cover"},null,8,["src"])],2),f("div",{class:m([" flex flex-col gap-8px p-8px box-border",{"w-full":t.property.layoutType!=="oneColSmallImg","w-[calc(100%-140px-16px)]":t.property.layoutType==="oneColSmallImg"}])},[t.property.fields.name.show?(o(),p("div",{key:0,class:m(["text-14px ",{truncate:t.property.layoutType!=="oneColSmallImg","overflow-ellipsis line-clamp-2":t.property.layoutType==="oneColSmallImg"}]),style:a({color:t.property.fields.name.color})},i(e.name),7)):n("",!0),t.property.fields.introduction.show?(o(),p("div",{key:1,style:a({color:t.property.fields.introduction.color}),class:"truncate text-12px"},i(e.introduction),5)):n("",!0),f("div",null,[t.property.fields.price.show?(o(),p("span",{key:0,style:a({color:t.property.fields.price.color}),class:"text-16px"},i(e.point)+"\u79EF\u5206 "+i(e.pointPrice&&e.pointPrice!==0?`+${l.fenToYuan(e.pointPrice)}\u5143`:""),5)):n("",!0),t.property.fields.marketPrice.show&&e.marketPrice?(o(),p("span",{key:1,style:a({color:t.property.fields.marketPrice.color}),class:"ml-4px text-10px line-through"}," \uFFE5"+i(l.fenToYuan(e.marketPrice)),5)):n("",!0)]),f("div",U,[t.property.fields.salesCount.show?(o(),p("span",{key:0,style:a({color:t.property.fields.salesCount.color})}," \u5DF2\u5151"+i((e.pointTotalStock||0)-(e.pointStock||0))+"\u4EF6 ",5)):n("",!0),t.property.fields.stock.show?(o(),p("span",{key:1,style:a({color:t.property.fields.stock.color})}," \u5E93\u5B58"+i(e.pointTotalStock||0),5)):n("",!0)])],2),f("div",j,[t.property.btnBuy.type==="text"?(o(),p("span",{key:0,style:a({background:`linear-gradient(to right, ${t.property.btnBuy.bgBeginColor}, ${t.property.btnBuy.bgEndColor}`}),class:"rounded-full p-x-12px p-y-4px text-12px text-white"},i(t.property.btnBuy.text),5)):(o(),I(c,{key:1,src:t.property.btnBuy.imgUrl,class:"h-28px w-28px rounded-full",fit:"cover"},null,8,["src"]))])],4))),128))],512)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/components/DiyEditor/components/mobile/PromotionPoint/index.vue"]]);export{E as default};
