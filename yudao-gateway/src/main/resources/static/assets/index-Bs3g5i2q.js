import{d as S,D as U,g as L,r as u,f as Q,u as V,C as R,e2 as z,_ as B,X as E,o as f,c as I,k as e,w as r,Y as O,m as s,I as w,q as x,t as P,F as j,Z as A,L as K,z as Y,N as X,O as Z,A as G,B as H,y as J,P as M,Q as W,R as $}from"./index-BaY5TDP-.js";import{_ as ee}from"./index-avjYFQiD.js";import{_ as ae}from"./ContentWrap-DKQn7kZm.js";import{_ as te}from"./index-BAz6Gqim.js";import{d as le}from"./formatTime-Dr6TiYYc.js";import{d as re}from"./download-oWiM5xVU.js";import{f as oe,h as ie,i as ne}from"./index-6-r4wYJE.js";import se from"./BusinessForm-DKlvsT4o.js";import"./index-DrSdAlug.js";import"./Dialog-CZSXtzfQ.js";import"./index-n6shePIl.js";import"./index-h6ObHKtQ.js";import"./index-CuAlllbQ.js";import"./BusinessProductForm-FoZjzksq.js";import"./DictTag-QtcI9ZjC.js";import"./color-BN7ZL7BD.js";import"./index-D4G-Yxr7.js";const me=B(S({name:"CrmBusiness",__name:"index",setup(T,{expose:l}){l();const g=U(),{t:a}=L(),_=u(!0),v=u(0),h=u([]),m=Q({pageNo:1,pageSize:10,sceneType:"1",name:null}),y=u(),i=u(!1),n=u("1"),d=async()=>{_.value=!0;try{const t=await oe(m);h.value=t.list,v.value=t.total}finally{_.value=!1}},c=()=>{m.pageNo=1,d()},{push:p}=V(),C=u();R(()=>{d()});const b={message:g,t:a,loading:_,total:v,list:h,queryParams:m,queryFormRef:y,exportLoading:i,activeName:n,getList:d,handleQuery:c,resetQuery:()=>{y.value.resetFields(),c()},handleTabClick:t=>{m.sceneType=t.paneName,c()},push:p,openDetail:t=>{p({name:"CrmBusinessDetail",params:{id:t}})},openCustomerDetail:t=>{p({name:"CrmCustomerDetail",params:{id:t}})},formRef:C,openForm:(t,F)=>{C.value.open(t,F)},handleDelete:async t=>{try{await g.delConfirm(),await ie(t),g.success(a("common.delSuccess")),await d()}catch{}},handleExport:async()=>{try{await g.exportConfirm(),i.value=!0;const t=await ne(m);re.excel(t,"\u5546\u673A.xls")}catch{}finally{i.value=!1}},get dateFormatter(){return le},BusinessForm:se,get erpPriceTableColumnFormatter(){return z}};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}}),[["render",function(T,l,g,a,_,v){const h=te,m=A,y=K,i=Y,n=X,d=Z,c=ae,p=G,C=H,b=J,t=M,F=W,q=ee,k=E("hasPermi"),D=$;return f(),I(j,null,[e(h,{title:"\u3010\u5546\u673A\u3011\u5546\u673A\u7BA1\u7406\u3001\u5546\u673A\u72B6\u6001",url:"https://doc.iocoder.cn/crm/business/"}),e(h,{title:"\u3010\u901A\u7528\u3011\u6570\u636E\u6743\u9650",url:"https://doc.iocoder.cn/crm/permission/"}),e(c,null,{default:r(()=>[e(d,{ref:"queryFormRef",inline:!0,model:a.queryParams,class:"-mb-15px","label-width":"68px"},{default:r(()=>[e(y,{label:"\u5546\u673A\u540D\u79F0",prop:"name"},{default:r(()=>[e(m,{modelValue:a.queryParams.name,"onUpdate:modelValue":l[0]||(l[0]=o=>a.queryParams.name=o),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u5546\u673A\u540D\u79F0",onKeyup:O(a.handleQuery,["enter"])},null,8,["modelValue"])]),_:1}),e(y,null,{default:r(()=>[e(n,{onClick:a.handleQuery},{default:r(()=>[e(i,{class:"mr-5px",icon:"ep:search"}),l[5]||(l[5]=s(" \u641C\u7D22 "))]),_:1}),e(n,{onClick:a.resetQuery},{default:r(()=>[e(i,{class:"mr-5px",icon:"ep:refresh"}),l[6]||(l[6]=s(" \u91CD\u7F6E "))]),_:1}),w((f(),x(n,{type:"primary",onClick:l[1]||(l[1]=o=>a.openForm("create"))},{default:r(()=>[e(i,{class:"mr-5px",icon:"ep:plus"}),l[7]||(l[7]=s(" \u65B0\u589E "))]),_:1})),[[k,["crm:business:create"]]]),w((f(),x(n,{loading:a.exportLoading,plain:"",type:"success",onClick:a.handleExport},{default:r(()=>[e(i,{class:"mr-5px",icon:"ep:download"}),l[8]||(l[8]=s(" \u5BFC\u51FA "))]),_:1},8,["loading"])),[[k,["crm:business:export"]]])]),_:1})]),_:1},8,["model"])]),_:1}),e(c,null,{default:r(()=>[e(C,{modelValue:a.activeName,"onUpdate:modelValue":l[2]||(l[2]=o=>a.activeName=o),onTabClick:a.handleTabClick},{default:r(()=>[e(p,{label:"\u6211\u8D1F\u8D23\u7684",name:"1"}),e(p,{label:"\u6211\u53C2\u4E0E\u7684",name:"2"}),e(p,{label:"\u4E0B\u5C5E\u8D1F\u8D23\u7684",name:"3"})]),_:1},8,["modelValue"]),w((f(),x(F,{data:a.list,"show-overflow-tooltip":!0,stripe:!0},{default:r(()=>[e(t,{align:"center",fixed:"left",label:"\u5546\u673A\u540D\u79F0",prop:"name",width:"160"},{default:r(o=>[e(b,{underline:!1,type:"primary",onClick:N=>a.openDetail(o.row.id)},{default:r(()=>[s(P(o.row.name),1)]),_:2},1032,["onClick"])]),_:1}),e(t,{align:"center",fixed:"left",label:"\u5BA2\u6237\u540D\u79F0",prop:"customerName",width:"120"},{default:r(o=>[e(b,{underline:!1,type:"primary",onClick:N=>a.openCustomerDetail(o.row.customerId)},{default:r(()=>[s(P(o.row.customerName),1)]),_:2},1032,["onClick"])]),_:1}),e(t,{formatter:a.erpPriceTableColumnFormatter,align:"center",label:"\u5546\u673A\u91D1\u989D\uFF08\u5143\uFF09",prop:"totalPrice",width:"140"},null,8,["formatter"]),e(t,{formatter:a.dateFormatter,align:"center",label:"\u9884\u8BA1\u6210\u4EA4\u65E5\u671F",prop:"dealTime",width:"180px"},null,8,["formatter"]),e(t,{align:"center",label:"\u5907\u6CE8",prop:"remark",width:"200"}),e(t,{formatter:a.dateFormatter,align:"center",label:"\u4E0B\u6B21\u8054\u7CFB\u65F6\u95F4",prop:"contactNextTime",width:"180px"},null,8,["formatter"]),e(t,{align:"center",label:"\u8D1F\u8D23\u4EBA",prop:"ownerUserName",width:"100px"}),e(t,{align:"center",label:"\u6240\u5C5E\u90E8\u95E8",prop:"ownerUserDeptName",width:"100px"}),e(t,{formatter:a.dateFormatter,align:"center",label:"\u6700\u540E\u8DDF\u8FDB\u65F6\u95F4",prop:"contactLastTime",width:"180px"},null,8,["formatter"]),e(t,{formatter:a.dateFormatter,align:"center",label:"\u66F4\u65B0\u65F6\u95F4",prop:"updateTime",width:"180px"},null,8,["formatter"]),e(t,{formatter:a.dateFormatter,align:"center",label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime",width:"180px"},null,8,["formatter"]),e(t,{align:"center",label:"\u521B\u5EFA\u4EBA",prop:"creatorName",width:"100px"}),e(t,{align:"center",fixed:"right",label:"\u5546\u673A\u72B6\u6001\u7EC4",prop:"statusTypeName",width:"140"}),e(t,{align:"center",fixed:"right",label:"\u5546\u673A\u9636\u6BB5",prop:"statusName",width:"120"}),e(t,{align:"center",fixed:"right",label:"\u64CD\u4F5C",width:"130px"},{default:r(o=>[w((f(),x(n,{link:"",type:"primary",onClick:N=>a.openForm("update",o.row.id)},{default:r(()=>l[9]||(l[9]=[s(" \u7F16\u8F91 ")])),_:2},1032,["onClick"])),[[k,["crm:business:update"]]]),w((f(),x(n,{link:"",type:"danger",onClick:N=>a.handleDelete(o.row.id)},{default:r(()=>l[10]||(l[10]=[s(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[k,["crm:business:delete"]]])]),_:1})]),_:1},8,["data"])),[[D,a.loading]]),e(q,{limit:a.queryParams.pageSize,"onUpdate:limit":l[3]||(l[3]=o=>a.queryParams.pageSize=o),page:a.queryParams.pageNo,"onUpdate:page":l[4]||(l[4]=o=>a.queryParams.pageNo=o),total:a.total,onPagination:a.getList},null,8,["limit","page","total"])]),_:1}),e(a.BusinessForm,{ref:"formRef",onSuccess:a.getList},null,512)],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/crm/business/index.vue"]]);export{me as default};
