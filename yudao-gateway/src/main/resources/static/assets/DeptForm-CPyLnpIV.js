import{d as S,g as x,D as C,r as d,f as O,G as q,U as P,_ as R,o as n,q as h,w as r,k as o,m as T,I as N,c as w,F as k,n as F,L as j,Z as A,cf as B,J as M,K as Y,O as G,N as J,R as K}from"./index-BaY5TDP-.js";import{_ as Z}from"./Dialog-CZSXtzfQ.js";import{E as $}from"./el-tree-select-DphqCDCz.js";import{h as z,d as H}from"./tree-z7HkrWVC.js";import{a as Q,g as W,c as X,u as ee}from"./index-dK17nfjs.js";import{g as ae}from"./index-CuAlllbQ.js";import{C as E}from"./constants-CEEr2azc.js";const le=R(S({name:"SystemDeptForm",__name:"DeptForm",emits:["success"],setup(L,{expose:l,emit:y}){const{t:e}=x(),v=C(),g=d(!1),b=d(""),t=d(!1),u=d(""),m=d({id:void 0,title:"",parentId:void 0,name:void 0,sort:void 0,leaderUserId:void 0,phone:void 0,email:void 0,status:E.ENABLE}),V=O({parentId:[{required:!0,message:"\u4E0A\u7EA7\u90E8\u95E8\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],name:[{required:!0,message:"\u90E8\u95E8\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],sort:[{required:!0,message:"\u663E\u793A\u6392\u5E8F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],email:[{type:"email",message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u90AE\u7BB1\u5730\u5740",trigger:["blur","change"]}],phone:[{pattern:/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7\u7801",trigger:"blur"}],status:[{required:!0,message:"\u72B6\u6001\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),i=d(),p=d(),f=d([]),_=async(s,c)=>{if(g.value=!0,b.value=e("action."+s),u.value=s,a(),c){t.value=!0;try{m.value=await Q(c)}finally{t.value=!1}}f.value=await ae(),await I()};l({open:_});const D=y,a=()=>{var s;m.value={id:void 0,title:"",parentId:void 0,name:void 0,sort:void 0,leaderUserId:void 0,phone:void 0,email:void 0,status:E.ENABLE},(s=i.value)==null||s.resetFields()},I=async()=>{p.value=[];const s=await W();let c={id:0,name:"\u9876\u7EA7\u90E8\u95E8",children:[]};c.children=z(s),p.value.push(c)},U={t:e,message:v,dialogVisible:g,dialogTitle:b,formLoading:t,formType:u,formData:m,formRules:V,formRef:i,deptTree:p,userList:f,open:_,emit:D,submitForm:async()=>{if(i&&await i.value.validate()){t.value=!0;try{const s=m.value;u.value==="create"?(await X(s),v.success(e("common.createSuccess"))):(await ee(s),v.success(e("common.updateSuccess"))),g.value=!1,D("success")}finally{t.value=!1}}},resetForm:a,getTree:I,get DICT_TYPE(){return q},get getIntDictOptions(){return P},get defaultProps(){return H}};return Object.defineProperty(U,"__isScriptSetup",{enumerable:!1,value:!0}),U}}),[["render",function(L,l,y,e,v,g){const b=$,t=j,u=A,m=B,V=M,i=Y,p=G,f=J,_=Z,D=K;return n(),h(_,{modelValue:e.dialogVisible,"onUpdate:modelValue":l[8]||(l[8]=a=>e.dialogVisible=a),title:e.dialogTitle},{footer:r(()=>[o(f,{type:"primary",onClick:e.submitForm},{default:r(()=>l[9]||(l[9]=[T("\u786E \u5B9A")])),_:1}),o(f,{onClick:l[7]||(l[7]=a=>e.dialogVisible=!1)},{default:r(()=>l[10]||(l[10]=[T("\u53D6 \u6D88")])),_:1})]),default:r(()=>[N((n(),h(p,{ref:"formRef",model:e.formData,rules:e.formRules,"label-width":"80px"},{default:r(()=>[o(t,{label:"\u4E0A\u7EA7\u90E8\u95E8",prop:"parentId"},{default:r(()=>[o(b,{modelValue:e.formData.parentId,"onUpdate:modelValue":l[0]||(l[0]=a=>e.formData.parentId=a),data:e.deptTree,props:e.defaultProps,"check-strictly":"","default-expand-all":"",placeholder:"\u8BF7\u9009\u62E9\u4E0A\u7EA7\u90E8\u95E8","value-key":"deptId"},null,8,["modelValue","data","props"])]),_:1}),o(t,{label:"\u90E8\u95E8\u540D\u79F0",prop:"name"},{default:r(()=>[o(u,{modelValue:e.formData.name,"onUpdate:modelValue":l[1]||(l[1]=a=>e.formData.name=a),placeholder:"\u8BF7\u8F93\u5165\u90E8\u95E8\u540D\u79F0"},null,8,["modelValue"])]),_:1}),o(t,{label:"\u663E\u793A\u6392\u5E8F",prop:"sort"},{default:r(()=>[o(m,{modelValue:e.formData.sort,"onUpdate:modelValue":l[2]||(l[2]=a=>e.formData.sort=a),min:0,"controls-position":"right"},null,8,["modelValue"])]),_:1}),o(t,{label:"\u8D1F\u8D23\u4EBA",prop:"leaderUserId"},{default:r(()=>[o(i,{modelValue:e.formData.leaderUserId,"onUpdate:modelValue":l[3]||(l[3]=a=>e.formData.leaderUserId=a),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u8D1F\u8D23\u4EBA"},{default:r(()=>[(n(!0),w(k,null,F(e.userList,a=>(n(),h(V,{key:a.id,label:a.nickname,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(t,{label:"\u8054\u7CFB\u7535\u8BDD",prop:"phone"},{default:r(()=>[o(u,{modelValue:e.formData.phone,"onUpdate:modelValue":l[4]||(l[4]=a=>e.formData.phone=a),maxlength:"11",placeholder:"\u8BF7\u8F93\u5165\u8054\u7CFB\u7535\u8BDD"},null,8,["modelValue"])]),_:1}),o(t,{label:"\u90AE\u7BB1",prop:"email"},{default:r(()=>[o(u,{modelValue:e.formData.email,"onUpdate:modelValue":l[5]||(l[5]=a=>e.formData.email=a),maxlength:"50",placeholder:"\u8BF7\u8F93\u5165\u90AE\u7BB1"},null,8,["modelValue"])]),_:1}),o(t,{label:"\u72B6\u6001",prop:"status"},{default:r(()=>[o(i,{modelValue:e.formData.status,"onUpdate:modelValue":l[6]||(l[6]=a=>e.formData.status=a),clearable:"",placeholder:"\u8BF7\u9009\u62E9\u72B6\u6001"},{default:r(()=>[(n(!0),w(k,null,F(e.getIntDictOptions(e.DICT_TYPE.COMMON_STATUS),a=>(n(),h(V,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[D,e.formLoading]])]),_:1},8,["modelValue","title"])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/system/dept/DeptForm.vue"]]);export{le as default};
