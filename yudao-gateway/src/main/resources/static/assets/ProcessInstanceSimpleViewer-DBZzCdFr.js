import{d as O,r as _,au as y,at as E,_ as R,o as A,q as P,p as N,I as f,c as V,k as w,R as D}from"./index-BaY5TDP-.js";import{T as t}from"./index-ZFL2ufyC.js";import{N as o}from"./consts-vgsb8q48.js";import"./Dialog-CZSXtzfQ.js";import"./el-drawer-r3cMvY4i.js";import"./el-tree-select-DphqCDCz.js";import{_ as k}from"./simple-process-designer-DviJ9JIp.js";import"./el-space-B4pGZPiv.js";import{b}from"./utils-DQEYWnsS.js";import"./DictTag-QtcI9ZjC.js";import"./color-BN7ZL7BD.js";import"./formatTime-Dr6TiYYc.js";import"./tree-z7HkrWVC.js";import"./constants-CEEr2azc.js";import"./download-oWiM5xVU.js";import"./index-BCN8BzfC.js";const C=R(O({name:"SimpleProcessViewer",__name:"SimpleProcessViewer",props:{flowNode:{type:Object,required:!0},tasks:{type:Array,default:()=>[]},processInstance:{type:Object,default:()=>{}}},setup(l,{expose:u}){u();const i=l,e=_(i.tasks),r=_(i.processInstance),n=b(i);y(()=>i.tasks,p=>{e.value=p}),y(()=>i.processInstance,p=>{r.value=p}),E("tasks",e),E("processInstance",r);const a={props:i,approveTasks:e,currentProcessInstance:r,simpleModel:n};return Object.defineProperty(a,"__isScriptSetup",{enumerable:!1,value:!0}),a}}),[["render",function(l,u,i,e,r,n){const a=k;return A(),P(a,{"flow-node":e.simpleModel,readonly:!0},null,8,["flow-node"])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/components/SimpleProcessDesignerV2/src/SimpleProcessViewer.vue"]]),M=O({name:"BpmProcessInstanceSimpleViewer",__name:"ProcessInstanceSimpleViewer",props:{loading:N.bool.def(!1),modelView:N.object,simpleJson:N.string},setup(l,{expose:u}){u();const i=l,e=_({}),r=_([]),n=_();y(()=>i.modelView,async s=>{if(s){r.value=s.tasks,n.value=s.processInstance;const d=s.rejectedTaskActivityIds,m=s.unfinishedTaskActivityIds,S=s.finishedTaskActivityIds,c=s.finishedSequenceFlowActivityIds;a(s.simpleModel,s.processInstance.status,d,m,S,c),e.value=s.simpleModel}}),y(()=>i.simpleJson,async s=>{s&&(e.value=JSON.parse(s))});const a=(s,d,m,S,c,v)=>{var T;s&&(s.type!==o.END_EVENT_NODE?(s.type!==o.START_USER_NODE&&s.type!==o.USER_TASK_NODE||(s.activityStatus=t.NOT_START,m.includes(s.id)?s.activityStatus=t.REJECT:S.includes(s.id)?s.activityStatus=t.RUNNING:c.includes(s.id)&&(s.activityStatus=t.APPROVE)),s.type===o.COPY_TASK_NODE&&(c.includes(s.id)?s.activityStatus=t.APPROVE:s.activityStatus=t.NOT_START),s.type===o.DELAY_TIMER_NODE&&(c.includes(s.id)?s.activityStatus=t.APPROVE:s.activityStatus=t.NOT_START),s.type===o.TRIGGER_NODE&&(c.includes(s.id)?s.activityStatus=t.APPROVE:s.activityStatus=t.NOT_START),s.type===o.CONDITION_NODE&&(v.includes(s.id)?s.activityStatus=t.APPROVE:s.activityStatus=t.NOT_START),s.type!==o.CONDITION_BRANCH_NODE&&s.type!==o.PARALLEL_BRANCH_NODE&&s.type!==o.INCLUSIVE_BRANCH_NODE&&s.type!==o.ROUTER_BRANCH_NODE||(c.includes(s.id)?s.activityStatus=t.APPROVE:s.activityStatus=t.NOT_START,(T=s.conditionNodes)==null||T.forEach(I=>{a(I,d,m,S,c,v)})),a(s.childNode,d,m,S,c,v)):c.includes(s.id)?s.activityStatus=d:s.activityStatus=t.NOT_START)},p={props:i,simpleModel:e,tasks:r,processInstance:n,setSimpleModelNodeTaskStatus:a,get SimpleProcessViewer(){return C}};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}}),g={class:"process-viewer-container"},h=R(M,[["render",function(l,u,i,e,r,n){const a=D;return f((A(),V("div",g,[w(e.SimpleProcessViewer,{"flow-node":e.simpleModel,tasks:e.tasks,"process-instance":e.processInstance},null,8,["flow-node","tasks","process-instance"])])),[[a,i.loading]])}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/bpm/processInstance/detail/ProcessInstanceSimpleViewer.vue"]]);export{h as default};
