import{d as L,u as Y,r as m,f as F,au as N,C as A,a as Q,G as z,U as M,d$ as K,_ as H,X,o as u,c,k as t,w as r,F as v,n as f,q as d,ah as U,Y as j,I,ag as G,m as T,j as J,J as W,K as Z,L as $,M as B,Z as ee,z as ae,N as le,O as te,d6 as re,d7 as ue,d8 as oe,Q as de,R as ie}from"./index-BaY5TDP-.js";import{_ as se}from"./index-avjYFQiD.js";import{_ as pe}from"./ContentWrap-DKQn7kZm.js";import{_ as me}from"./index-BAz6Gqim.js";import ne from"./OrderDeliveryForm-qOqRbOq-.js";import ye from"./OrderUpdateRemarkForm-DFb8OYLH.js";import{e as ce}from"./index-B6VQ3j6W.js";import{a as ve}from"./index-BuoBEkWu.js";import{g as fe}from"./index-MboYiMOx.js";import{D as _e,T as be}from"./constants-CEEr2azc.js";import Pe from"./OrderTableColumn-B6ouW919.js";import"./index-DrSdAlug.js";import"./Dialog-CZSXtzfQ.js";import"./el-image-Bg-CwbDE.js";import"./DictTag-QtcI9ZjC.js";import"./color-BN7ZL7BD.js";import"./formatTime-Dr6TiYYc.js";const Te={class:"flex items-center justify-center"},qe=H(L({name:"TradeOrder",__name:"index",setup(O,{expose:l}){l();const{currentRoute:S,push:e}=Y(),C=m(!0),w=m(2),q=m([]),p=m(),o=m({pageNo:1,pageSize:10,status:void 0,payChannelCode:void 0,createTime:void 0,terminal:void 0,type:void 0,deliveryType:void 0,logisticsId:void 0,pickUpStoreId:void 0,pickUpVerifyCode:void 0}),i=F({queryParam:""}),V=m([{value:"no",label:"\u8BA2\u5355\u53F7"},{value:"userId",label:"\u7528\u6237UID"},{value:"userNickname",label:"\u7528\u6237\u6635\u79F0"},{value:"userMobile",label:"\u7528\u6237\u7535\u8BDD"}]),_=async()=>{C.value=!0;try{const s=await ce(Q(o));q.value=s.list,w.value=s.total}finally{C.value=!1}},n=async()=>{o.value.pageNo=1,await _()},b=m(),D=m();N(()=>S.value,()=>{_()});const g=m([]),k=m([]);A(async()=>{await _(),g.value=await ve(),k.value=await fe()});const E={currentRoute:S,push:e,loading:C,total:w,list:q,queryFormRef:p,queryParams:o,queryType:i,dynamicSearchList:V,inputChangeSelect:s=>{var P;(P=V.value.filter(y=>y.value!==s))==null||P.forEach(y=>{o.value.hasOwnProperty(y.value)&&delete o.value[y.value]})},getList:_,handleQuery:n,resetQuery:()=>{var s;(s=p.value)==null||s.resetFields(),o.value={pageNo:1,pageSize:10,status:void 0,payChannelCode:void 0,createTime:void 0,terminal:void 0,type:void 0,deliveryType:void 0,logisticsId:void 0,pickUpStoreId:void 0,pickUpVerifyCode:void 0},n()},openDetail:s=>{e({name:"TradeOrderDetail",params:{id:s}})},deliveryFormRef:b,updateRemarkForm:D,handleCommand:(s,P)=>{var y,h;switch(s){case"remark":(y=D.value)==null||y.open(P);break;case"delivery":(h=b.value)==null||h.open(P)}},pickUpStoreList:g,deliveryExpressList:k,OrderDeliveryForm:ne,OrderUpdateRemarkForm:ye,get DICT_TYPE(){return z},get getIntDictOptions(){return M},get getStrDictOptions(){return K},get DeliveryTypeEnum(){return _e},get TradeOrderStatusEnum(){return be},get OrderTableColumn(){return Pe}};return Object.defineProperty(E,"__isScriptSetup",{enumerable:!1,value:!0}),E}}),[["render",function(O,l,S,e,C,w){const q=me,p=W,o=Z,i=$,V=B,_=ee,n=ae,b=le,D=te,g=pe,k=re,E=ue,s=oe,P=de,y=se,h=X("hasPermi"),R=ie;return u(),c(v,null,[t(q,{title:"\u3010\u4EA4\u6613\u3011\u4EA4\u6613\u8BA2\u5355",url:"https://doc.iocoder.cn/mall/trade-order/"}),t(q,{title:"\u3010\u4EA4\u6613\u3011\u8D2D\u7269\u8F66",url:"https://doc.iocoder.cn/mall/trade-cart/"}),t(g,null,{default:r(()=>[t(D,{ref:"queryFormRef",inline:!0,model:e.queryParams,class:"-mb-15px","label-width":"68px"},{default:r(()=>[t(i,{label:"\u8BA2\u5355\u72B6\u6001",prop:"status"},{default:r(()=>[t(o,{modelValue:e.queryParams.status,"onUpdate:modelValue":l[0]||(l[0]=a=>e.queryParams.status=a),class:"!w-280px",clearable:"",placeholder:"\u5168\u90E8"},{default:r(()=>[(u(!0),c(v,null,f(e.getIntDictOptions(e.DICT_TYPE.TRADE_ORDER_STATUS),a=>(u(),d(p,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(i,{label:"\u652F\u4ED8\u65B9\u5F0F",prop:"payChannelCode"},{default:r(()=>[t(o,{modelValue:e.queryParams.payChannelCode,"onUpdate:modelValue":l[1]||(l[1]=a=>e.queryParams.payChannelCode=a),class:"!w-280px",clearable:"",placeholder:"\u5168\u90E8"},{default:r(()=>[(u(!0),c(v,null,f(e.getStrDictOptions(e.DICT_TYPE.PAY_CHANNEL_CODE),a=>(u(),d(p,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(i,{label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime"},{default:r(()=>[t(V,{modelValue:e.queryParams.createTime,"onUpdate:modelValue":l[2]||(l[2]=a=>e.queryParams.createTime=a),"default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],class:"!w-280px","end-placeholder":"\u81EA\u5B9A\u4E49\u65F6\u95F4","start-placeholder":"\u81EA\u5B9A\u4E49\u65F6\u95F4",type:"daterange","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue","default-time"])]),_:1}),t(i,{label:"\u8BA2\u5355\u6765\u6E90",prop:"terminal"},{default:r(()=>[t(o,{modelValue:e.queryParams.terminal,"onUpdate:modelValue":l[3]||(l[3]=a=>e.queryParams.terminal=a),class:"!w-280px",clearable:"",placeholder:"\u5168\u90E8"},{default:r(()=>[(u(!0),c(v,null,f(e.getIntDictOptions(e.DICT_TYPE.TERMINAL),a=>(u(),d(p,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(i,{label:"\u8BA2\u5355\u7C7B\u578B",prop:"type"},{default:r(()=>[t(o,{modelValue:e.queryParams.type,"onUpdate:modelValue":l[4]||(l[4]=a=>e.queryParams.type=a),class:"!w-280px",clearable:"",placeholder:"\u5168\u90E8"},{default:r(()=>[(u(!0),c(v,null,f(e.getIntDictOptions(e.DICT_TYPE.TRADE_ORDER_TYPE),a=>(u(),d(p,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(i,{label:"\u914D\u9001\u65B9\u5F0F",prop:"deliveryType"},{default:r(()=>[t(o,{modelValue:e.queryParams.deliveryType,"onUpdate:modelValue":l[5]||(l[5]=a=>e.queryParams.deliveryType=a),class:"!w-280px",clearable:"",placeholder:"\u5168\u90E8"},{default:r(()=>[(u(!0),c(v,null,f(e.getIntDictOptions(e.DICT_TYPE.TRADE_DELIVERY_TYPE),a=>(u(),d(p,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e.queryParams.deliveryType===e.DeliveryTypeEnum.EXPRESS.type?(u(),d(i,{key:0,label:"\u5FEB\u9012\u516C\u53F8",prop:"logisticsId"},{default:r(()=>[t(o,{modelValue:e.queryParams.logisticsId,"onUpdate:modelValue":l[6]||(l[6]=a=>e.queryParams.logisticsId=a),class:"!w-280px",clearable:"",placeholder:"\u5168\u90E8"},{default:r(()=>[(u(!0),c(v,null,f(e.deliveryExpressList,a=>(u(),d(p,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):U("",!0),e.queryParams.deliveryType===e.DeliveryTypeEnum.PICK_UP.type?(u(),d(i,{key:1,label:"\u81EA\u63D0\u95E8\u5E97",prop:"pickUpStoreId"},{default:r(()=>[t(o,{modelValue:e.queryParams.pickUpStoreId,"onUpdate:modelValue":l[7]||(l[7]=a=>e.queryParams.pickUpStoreId=a),class:"!w-280px",clearable:"",multiple:"",placeholder:"\u5168\u90E8"},{default:r(()=>[(u(!0),c(v,null,f(e.pickUpStoreList,a=>(u(),d(p,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):U("",!0),e.queryParams.deliveryType===e.DeliveryTypeEnum.PICK_UP.type?(u(),d(i,{key:2,label:"\u6838\u9500\u7801",prop:"pickUpVerifyCode"},{default:r(()=>[t(_,{modelValue:e.queryParams.pickUpVerifyCode,"onUpdate:modelValue":l[8]||(l[8]=a=>e.queryParams.pickUpVerifyCode=a),class:"!w-280px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u81EA\u63D0\u6838\u9500\u7801",onKeyup:j(e.handleQuery,["enter"])},null,8,["modelValue"])]),_:1})):U("",!0),t(i,{label:"\u805A\u5408\u641C\u7D22"},{default:r(()=>[I(t(_,{modelValue:e.queryParams[e.queryType.queryParam],"onUpdate:modelValue":l[10]||(l[10]=a=>e.queryParams[e.queryType.queryParam]=a),type:e.queryType.queryParam==="userId"?"number":"text",class:"!w-280px",clearable:"",placeholder:"\u8BF7\u8F93\u5165"},{prepend:r(()=>[t(o,{modelValue:e.queryType.queryParam,"onUpdate:modelValue":l[9]||(l[9]=a=>e.queryType.queryParam=a),class:"!w-110px",clearable:"",placeholder:"\u5168\u90E8",onChange:e.inputChangeSelect},{default:r(()=>[(u(!0),c(v,null,f(e.dynamicSearchList,a=>(u(),d(p,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["modelValue","type"]),[[G,!0]])]),_:1}),t(i,null,{default:r(()=>[t(b,{onClick:e.handleQuery},{default:r(()=>[t(n,{class:"mr-5px",icon:"ep:search"}),l[13]||(l[13]=T(" \u641C\u7D22 "))]),_:1}),t(b,{onClick:e.resetQuery},{default:r(()=>[t(n,{class:"mr-5px",icon:"ep:refresh"}),l[14]||(l[14]=T(" \u91CD\u7F6E "))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(g,null,{default:r(()=>[I((u(),d(P,{data:e.list,"row-key":"id"},{default:r(()=>[t(e.OrderTableColumn,{list:e.list,"pick-up-store-list":e.pickUpStoreList},{default:r(({row:a})=>[J("div",Te,[I((u(),d(b,{link:"",type:"primary",onClick:x=>e.openDetail(a.id)},{default:r(()=>[t(n,{icon:"ep:notification"}),l[15]||(l[15]=T(" \u8BE6\u60C5 "))]),_:2},1032,["onClick"])),[[h,["trade:order:query"]]]),I((u(),d(s,{onCommand:x=>e.handleCommand(x,a)},{dropdown:r(()=>[t(E,null,{default:r(()=>[a.deliveryType===e.DeliveryTypeEnum.EXPRESS.type&&a.status===e.TradeOrderStatusEnum.UNDELIVERED.status?(u(),d(k,{key:0,command:"delivery"},{default:r(()=>[t(n,{icon:"ep:takeaway-box"}),l[17]||(l[17]=T(" \u53D1\u8D27 "))]),_:1})):U("",!0),t(k,{command:"remark"},{default:r(()=>[t(n,{icon:"ep:chat-line-square"}),l[18]||(l[18]=T(" \u5907\u6CE8 "))]),_:1})]),_:2},1024)]),default:r(()=>[t(b,{link:"",type:"primary"},{default:r(()=>[t(n,{icon:"ep:d-arrow-right"}),l[16]||(l[16]=T(" \u66F4\u591A "))]),_:1})]),_:2},1032,["onCommand"])),[[h,["trade:order:update"]]])])]),_:1},8,["list","pick-up-store-list"])]),_:1},8,["data"])),[[R,e.loading]]),t(y,{limit:e.queryParams.pageSize,"onUpdate:limit":l[11]||(l[11]=a=>e.queryParams.pageSize=a),page:e.queryParams.pageNo,"onUpdate:page":l[12]||(l[12]=a=>e.queryParams.pageNo=a),total:e.total,onPagination:e.getList},null,8,["limit","page","total"])]),_:1}),t(e.OrderDeliveryForm,{ref:"deliveryFormRef",onSuccess:e.getList},null,512),t(e.OrderUpdateRemarkForm,{ref:"updateRemarkForm",onSuccess:e.getList},null,512)],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/mall/trade/order/index.vue"]]);export{qe as default};
