import{d as x,D as Y,g as L,r as _,f as R,C as M,G as A,U as Q,_ as z,X as B,o as s,c as D,k as a,w as r,F as E,n as q,q as c,m as g,I as h,j as K,t as H,Z as j,L as J,J as G,K as W,M as X,z as Z,N as $,O as ee,P as ae,ch as te,Q as le,R as oe}from"./index-BaY5TDP-.js";import{_ as re}from"./index-avjYFQiD.js";import{_ as ne}from"./DictTag-QtcI9ZjC.js";import{_ as ue}from"./ContentWrap-DKQn7kZm.js";import{_ as se}from"./index-BAz6Gqim.js";import{g as me,b as ie,d as pe}from"./couponTemplate-C5oFUT2R.js";import{C as w}from"./constants-CEEr2azc.js";import{d as de}from"./formatTime-Dr6TiYYc.js";import ce from"./CouponTemplateForm-BScO7oXP.js";import{d as fe,r as ye,t as _e,a as ge,v as Te}from"./formatter-DYGBdQzW.js";import"./index-DrSdAlug.js";import"./color-BN7ZL7BD.js";import"./Dialog-CZSXtzfQ.js";import"./SpuShowcase-DyUON5OE.js";import"./el-image-Bg-CwbDE.js";import"./spu-BVX48OKx.js";import"./SpuTableSelect-CD92PVLd.js";import"./el-tree-select-DphqCDCz.js";import"./tree-z7HkrWVC.js";import"./category-B7jjsMOS.js";import"./ProductCategorySelect-ClWAu1VZ.js";const Ce=z(x({name:"PromotionCouponTemplate",__name:"index",setup(I,{expose:l}){l();const i=Y(),{t:e}=L(),T=_(!0),b=_(0),C=_([]),f=R({pageNo:1,pageSize:10,name:null,status:null,discountType:null,type:null,createTime:[]}),u=_(),m=async()=>{T.value=!0;try{const o=await me(f);C.value=o.list,b.value=o.total}finally{T.value=!1}},y=()=>{f.pageNo=1,m()},v=_();M(()=>{m()});const p={message:i,t:e,loading:T,total:b,list:C,queryParams:f,queryFormRef:u,getList:m,handleQuery:y,resetQuery:()=>{var o;(o=u==null?void 0:u.value)==null||o.resetFields(),y()},formRef:v,openForm:(o,d)=>{v.value.open(o,d)},handleStatusChange:async o=>{let d=o.status===w.ENABLE?"\u542F\u7528":"\u505C\u7528";try{await i.confirm('\u786E\u8BA4\u8981"'+d+'""'+o.name+'"\u4F18\u60E0\u52B5\u5417?'),await ie(o.id,o.status),i.success(d+"\u6210\u529F")}catch{o.status=o.status===w.ENABLE?w.DISABLE:w.ENABLE}},handleDelete:async o=>{try{await i.confirm('\u662F\u5426\u786E\u8BA4\u5220\u9664\u4F18\u60E0\u52B5\u7F16\u53F7\u4E3A"'+o+'"\u7684\u6570\u636E\u9879?'),await pe(o),i.success(e("common.delSuccess")),await m()}catch{}},get DICT_TYPE(){return A},get getIntDictOptions(){return Q},get dateFormatter(){return de},CouponTemplateForm:ce,get discountFormat(){return fe},get remainedCountFormat(){return ye},get takeLimitCountFormat(){return _e},get totalCountFormat(){return ge},get validityTypeFormat(){return Te}};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}}),[["render",function(I,l,i,e,T,b){const C=se,f=j,u=J,m=G,y=W,v=X,p=Z,o=$,d=ee,k=ue,n=ae,O=ne,S=te,N=le,U=re,F=B("hasPermi"),V=oe;return s(),D(E,null,[a(C,{title:"\u3010\u8425\u9500\u3011\u4F18\u60E0\u52B5",url:"https://doc.iocoder.cn/mall/promotion-coupon/"}),a(k,null,{default:r(()=>[a(d,{ref:"queryFormRef",inline:!0,model:e.queryParams,class:"-mb-15px","label-width":"82px"},{default:r(()=>[a(u,{label:"\u4F18\u60E0\u5238\u540D\u79F0",prop:"name"},{default:r(()=>[a(f,{modelValue:e.queryParams.name,"onUpdate:modelValue":l[0]||(l[0]=t=>e.queryParams.name=t),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u4F18\u60E0\u52B5\u540D",onKeyup:e.handleQuery},null,8,["modelValue"])]),_:1}),a(u,{label:"\u4F18\u60E0\u7C7B\u578B",prop:"discountType"},{default:r(()=>[a(y,{modelValue:e.queryParams.discountType,"onUpdate:modelValue":l[1]||(l[1]=t=>e.queryParams.discountType=t),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u4F18\u60E0\u5238\u7C7B\u578B"},{default:r(()=>[(s(!0),D(E,null,q(e.getIntDictOptions(e.DICT_TYPE.PROMOTION_DISCOUNT_TYPE),t=>(s(),c(m,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(u,{label:"\u4F18\u60E0\u5238\u72B6\u6001",prop:"status"},{default:r(()=>[a(y,{modelValue:e.queryParams.status,"onUpdate:modelValue":l[2]||(l[2]=t=>e.queryParams.status=t),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u4F18\u60E0\u5238\u72B6\u6001"},{default:r(()=>[(s(!0),D(E,null,q(e.getIntDictOptions(e.DICT_TYPE.COMMON_STATUS),t=>(s(),c(m,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(u,{label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime"},{default:r(()=>[a(v,{modelValue:e.queryParams.createTime,"onUpdate:modelValue":l[3]||(l[3]=t=>e.queryParams.createTime=t),"default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],class:"!w-240px","end-placeholder":"\u7ED3\u675F\u65E5\u671F","start-placeholder":"\u5F00\u59CB\u65E5\u671F",type:"daterange","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue","default-time"])]),_:1}),a(u,null,{default:r(()=>[a(o,{onClick:e.handleQuery},{default:r(()=>[a(p,{class:"mr-5px",icon:"ep:search"}),l[7]||(l[7]=g(" \u641C\u7D22 "))]),_:1}),a(o,{onClick:e.resetQuery},{default:r(()=>[a(p,{class:"mr-5px",icon:"ep:refresh"}),l[8]||(l[8]=g(" \u91CD\u7F6E "))]),_:1}),h((s(),c(o,{plain:"",type:"primary",onClick:l[4]||(l[4]=t=>e.openForm("create"))},{default:r(()=>[a(p,{class:"mr-5px",icon:"ep:plus"}),l[9]||(l[9]=g(" \u65B0\u589E "))]),_:1})),[[F,["promotion:coupon-template:create"]]])]),_:1})]),_:1},8,["model"])]),_:1}),a(k,null,{default:r(()=>[h((s(),c(N,{data:e.list},{default:r(()=>[a(n,{label:"\u4F18\u60E0\u5238\u540D\u79F0","min-width":"140",prop:"name"}),a(n,{label:"\u7C7B\u578B","min-width":"130",prop:"productScope"},{default:r(t=>[a(O,{type:e.DICT_TYPE.PROMOTION_PRODUCT_SCOPE,value:t.row.productScope},null,8,["type","value"])]),_:1}),a(n,{label:"\u4F18\u60E0","min-width":"110",prop:"discount"},{default:r(t=>[a(O,{type:e.DICT_TYPE.PROMOTION_DISCOUNT_TYPE,value:t.row.discountType},null,8,["type","value"]),K("div",null,H(e.discountFormat(t.row)),1)]),_:1}),a(n,{label:"\u9886\u53D6\u65B9\u5F0F","min-width":"100",prop:"takeType"},{default:r(t=>[a(O,{type:e.DICT_TYPE.PROMOTION_COUPON_TAKE_TYPE,value:t.row.takeType},null,8,["type","value"])]),_:1}),a(n,{formatter:e.validityTypeFormat,align:"center",label:"\u4F7F\u7528\u65F6\u95F4",prop:"validityType",width:"185"},null,8,["formatter"]),a(n,{formatter:e.totalCountFormat,align:"center",label:"\u53D1\u653E\u6570\u91CF",prop:"totalCount"},null,8,["formatter"]),a(n,{formatter:e.remainedCountFormat,align:"center",label:"\u5269\u4F59\u6570\u91CF",prop:"totalCount"},null,8,["formatter"]),a(n,{formatter:e.takeLimitCountFormat,align:"center",label:"\u9886\u53D6\u4E0A\u9650",prop:"takeLimitCount"},null,8,["formatter"]),a(n,{align:"center",label:"\u72B6\u6001",prop:"status"},{default:r(t=>[a(S,{modelValue:t.row.status,"onUpdate:modelValue":P=>t.row.status=P,"active-value":0,"inactive-value":1,onChange:P=>e.handleStatusChange(t.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),a(n,{formatter:e.dateFormatter,align:"center",label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime",width:"180"},null,8,["formatter"]),a(n,{align:"center","class-name":"small-padding fixed-width",fixed:"right",label:"\u64CD\u4F5C",width:"120"},{default:r(t=>[h((s(),c(o,{link:"",type:"primary",onClick:P=>e.openForm("update",t.row.id)},{default:r(()=>l[10]||(l[10]=[g(" \u4FEE\u6539 ")])),_:2},1032,["onClick"])),[[F,["promotion:coupon-template:update"]]]),h((s(),c(o,{link:"",type:"danger",onClick:P=>e.handleDelete(t.row.id)},{default:r(()=>l[11]||(l[11]=[g(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[F,["promotion:coupon-template:delete"]]])]),_:1})]),_:1},8,["data"])),[[V,e.loading]]),a(U,{limit:e.queryParams.pageSize,"onUpdate:limit":l[5]||(l[5]=t=>e.queryParams.pageSize=t),page:e.queryParams.pageNo,"onUpdate:page":l[6]||(l[6]=t=>e.queryParams.pageNo=t),total:e.total,onPagination:e.getList},null,8,["limit","page","total"])]),_:1}),a(e.CouponTemplateForm,{ref:"formRef",onSuccess:e.getList},null,512)],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/mall/promotion/coupon/template/index.vue"]]);export{Ce as default};
