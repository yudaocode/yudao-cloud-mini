import{d as Q,D as Y,g as z,r as m,f as K,u as A,C as B,G as O,e4 as G,e2 as J,_ as M,X as Z,o as i,c as q,k as a,w as o,Y as D,F as L,n as j,q as c,m as n,I as f,t as b,J as W,K as X,L as H,Z as $,z as ee,N as ae,O as re,A as le,B as te,y as oe,P as ie,b8 as ne,Q as pe,R as ce}from"./index-BaY5TDP-.js";import{_ as me}from"./index-avjYFQiD.js";import{_ as se}from"./DictTag-QtcI9ZjC.js";import{_ as ue}from"./ContentWrap-DKQn7kZm.js";import{_ as de}from"./index-BAz6Gqim.js";import{d as fe,b as be}from"./formatTime-Dr6TiYYc.js";import{d as ye}from"./download-oWiM5xVU.js";import{e as ve,d as ge,h as we}from"./index-ndAUlMgd.js";import _e from"./ReceivablePlanForm-CXCxBqXI.js";import{g as he}from"./index-h6ObHKtQ.js";import xe from"./ReceivableForm-C0pIMqYw.js";import"./index-DrSdAlug.js";import"./color-BN7ZL7BD.js";import"./Dialog-CZSXtzfQ.js";import"./index-CuAlllbQ.js";import"./index-B97LdofC.js";import"./index-DcQDDeHJ.js";const Ce=M(Q({name:"ReceivablePlan",__name:"index",setup(V,{expose:t}){t();const y=Y(),{t:e}=z(),F=m(!0),N=m(0),v=m([]),s=K({pageNo:1,pageSize:10,sceneType:"1",customerId:void 0,contractNo:void 0}),P=m(),u=m(!1),R=m("1"),d=m([]),p=async()=>{F.value=!0;try{const l=await ve(s);v.value=l.list,N.value=l.total}finally{F.value=!1}},g=()=>{s.pageNo=1,p()},w=m(),_=m(),{push:h}=A();B(async()=>{await p(),d.value=await he()});const x={message:y,t:e,loading:F,total:N,list:v,queryParams:s,queryFormRef:P,exportLoading:u,activeName:R,customerList:d,handleTabClick:l=>{s.sceneType=l.paneName,g()},getList:p,handleQuery:g,resetQuery:()=>{P.value.resetFields(),g()},formRef:w,openForm:(l,I)=>{w.value.open(l,I)},receivableFormRef:_,openReceivableForm:l=>{_.value.open("create",void 0,l)},handleDelete:async l=>{try{await y.delConfirm(),await ge(l),y.success(e("common.delSuccess")),await p()}catch{}},handleExport:async()=>{try{await y.exportConfirm(),u.value=!0;const l=await we(s);ye.excel(l,"\u56DE\u6B3E\u8BA1\u5212.xls")}catch{}finally{u.value=!1}},push:h,openDetail:l=>{h({name:"CrmReceivablePlanDetail",params:{id:l}})},openCustomerDetail:l=>{h({name:"CrmCustomerDetail",params:{id:l}})},get DICT_TYPE(){return O},get dateFormatter(){return fe},get dateFormatter2(){return be},ReceivablePlanForm:_e,get erpPriceInputFormatter(){return G},get erpPriceTableColumnFormatter(){return J},ReceivableForm:xe};return Object.defineProperty(x,"__isScriptSetup",{enumerable:!1,value:!0}),x}}),[["render",function(V,t,y,e,F,N){const v=de,s=W,P=X,u=H,R=$,d=ee,p=ae,g=re,w=ue,_=le,h=te,x=oe,l=ie,I=se,k=ne,E=pe,S=me,C=Z("hasPermi"),U=ce;return i(),q(L,null,[a(v,{title:"\u3010\u56DE\u6B3E\u3011\u56DE\u6B3E\u7BA1\u7406\u3001\u56DE\u6B3E\u8BA1\u5212",url:"https://doc.iocoder.cn/crm/receivable/"}),a(v,{title:"\u3010\u901A\u7528\u3011\u6570\u636E\u6743\u9650",url:"https://doc.iocoder.cn/crm/permission/"}),a(w,null,{default:o(()=>[a(g,{ref:"queryFormRef",inline:!0,model:e.queryParams,class:"-mb-15px","label-width":"68px"},{default:o(()=>[a(u,{label:"\u5BA2\u6237\u540D\u79F0",prop:"customerId"},{default:o(()=>[a(P,{modelValue:e.queryParams.customerId,"onUpdate:modelValue":t[0]||(t[0]=r=>e.queryParams.customerId=r),class:"!w-240px",placeholder:"\u8BF7\u9009\u62E9\u5BA2\u6237",onKeyup:D(e.handleQuery,["enter"])},{default:o(()=>[(i(!0),q(L,null,j(e.customerList,r=>(i(),c(s,{key:r.id,label:r.name,value:r.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(u,{label:"\u5408\u540C\u7F16\u53F7",prop:"contractNo"},{default:o(()=>[a(R,{modelValue:e.queryParams.contractNo,"onUpdate:modelValue":t[1]||(t[1]=r=>e.queryParams.contractNo=r),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u5408\u540C\u7F16\u53F7",onKeyup:D(e.handleQuery,["enter"])},null,8,["modelValue"])]),_:1}),a(u,null,{default:o(()=>[a(p,{onClick:e.handleQuery},{default:o(()=>[a(d,{class:"mr-5px",icon:"ep:search"}),t[6]||(t[6]=n(" \u641C\u7D22 "))]),_:1}),a(p,{onClick:e.resetQuery},{default:o(()=>[a(d,{class:"mr-5px",icon:"ep:refresh"}),t[7]||(t[7]=n(" \u91CD\u7F6E "))]),_:1}),f((i(),c(p,{plain:"",type:"primary",onClick:t[2]||(t[2]=r=>e.openForm("create"))},{default:o(()=>[a(d,{class:"mr-5px",icon:"ep:plus"}),t[8]||(t[8]=n(" \u65B0\u589E "))]),_:1})),[[C,["crm:receivable-plan:create"]]]),f((i(),c(p,{loading:e.exportLoading,plain:"",type:"success",onClick:e.handleExport},{default:o(()=>[a(d,{class:"mr-5px",icon:"ep:download"}),t[9]||(t[9]=n(" \u5BFC\u51FA "))]),_:1},8,["loading"])),[[C,["crm:receivable-plan:export"]]])]),_:1})]),_:1},8,["model"])]),_:1}),a(w,null,{default:o(()=>[a(h,{modelValue:e.activeName,"onUpdate:modelValue":t[3]||(t[3]=r=>e.activeName=r),onTabClick:e.handleTabClick},{default:o(()=>[a(_,{label:"\u6211\u8D1F\u8D23\u7684",name:"1"}),a(_,{label:"\u4E0B\u5C5E\u8D1F\u8D23\u7684",name:"3"})]),_:1},8,["modelValue"]),f((i(),c(E,{data:e.list,"show-overflow-tooltip":!0,stripe:!0},{default:o(()=>[a(l,{align:"center",fixed:"left",label:"\u5BA2\u6237\u540D\u79F0",prop:"customerName",width:"150"},{default:o(r=>[a(x,{underline:!1,type:"primary",onClick:T=>e.openCustomerDetail(r.row.customerId)},{default:o(()=>[n(b(r.row.customerName),1)]),_:2},1032,["onClick"])]),_:1}),a(l,{align:"center",label:"\u5408\u540C\u7F16\u53F7",prop:"contractNo",width:"200px"}),a(l,{align:"center",label:"\u671F\u6570",prop:"period"},{default:o(r=>[a(x,{underline:!1,type:"primary",onClick:T=>e.openDetail(r.row.id)},{default:o(()=>[n(b(r.row.period),1)]),_:2},1032,["onClick"])]),_:1}),a(l,{align:"center",label:"\u8BA1\u5212\u56DE\u6B3E\u91D1\u989D\uFF08\u5143\uFF09",prop:"price",width:"160",formatter:e.erpPriceTableColumnFormatter},null,8,["formatter"]),a(l,{formatter:e.dateFormatter2,align:"center",label:"\u8BA1\u5212\u56DE\u6B3E\u65E5\u671F",prop:"returnTime",width:"180px"},null,8,["formatter"]),a(l,{align:"center",label:"\u63D0\u524D\u51E0\u5929\u63D0\u9192",prop:"remindDays",width:"150"}),a(l,{align:"center",label:"\u63D0\u9192\u65E5\u671F",prop:"remindTime",width:"180px",formatter:e.dateFormatter2},null,8,["formatter"]),a(l,{align:"center",label:"\u56DE\u6B3E\u65B9\u5F0F",prop:"returnType",width:"130px"},{default:o(r=>[a(I,{type:e.DICT_TYPE.CRM_RECEIVABLE_RETURN_TYPE,value:r.row.returnType},null,8,["type","value"])]),_:1}),a(l,{align:"center",label:"\u5907\u6CE8",prop:"remark"}),a(l,{label:"\u8D1F\u8D23\u4EBA",prop:"ownerUserName",width:"120"}),a(l,{align:"center",label:"\u5B9E\u9645\u56DE\u6B3E\u91D1\u989D\uFF08\u5143\uFF09",prop:"receivable.price",width:"160"},{default:o(r=>[r.row.receivable?(i(),c(k,{key:0},{default:o(()=>[n(b(e.erpPriceInputFormatter(r.row.receivable.price)),1)]),_:2},1024)):(i(),c(k,{key:1},{default:o(()=>[n(b(e.erpPriceInputFormatter(0)),1)]),_:1}))]),_:1}),a(l,{align:"center",label:"\u5B9E\u9645\u56DE\u6B3E\u65E5\u671F",prop:"receivable.returnTime",width:"180px",formatter:e.dateFormatter2},null,8,["formatter"]),a(l,{align:"center",label:"\u5B9E\u9645\u56DE\u6B3E\u91D1\u989D\uFF08\u5143\uFF09",prop:"receivable.price",width:"160"},{default:o(r=>[r.row.receivable?(i(),c(k,{key:0},{default:o(()=>[n(b(e.erpPriceInputFormatter(r.row.price-r.row.receivable.price)),1)]),_:2},1024)):(i(),c(k,{key:1},{default:o(()=>[n(b(e.erpPriceInputFormatter(r.row.price)),1)]),_:2},1024))]),_:1}),a(l,{formatter:e.dateFormatter,align:"center",label:"\u66F4\u65B0\u65F6\u95F4",prop:"updateTime",width:"180px"},null,8,["formatter"]),a(l,{formatter:e.dateFormatter,align:"center",label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime",width:"180px"},null,8,["formatter"]),a(l,{align:"center",label:"\u521B\u5EFA\u4EBA",prop:"creatorName",width:"100px"}),a(l,{align:"center",fixed:"right",label:"\u64CD\u4F5C",width:"180px"},{default:o(r=>[f((i(),c(p,{link:"",type:"success",onClick:T=>e.openReceivableForm(r.row),disabled:r.row.receivableId},{default:o(()=>t[10]||(t[10]=[n(" \u521B\u5EFA\u56DE\u6B3E ")])),_:2},1032,["onClick","disabled"])),[[C,["crm:receivable:create"]]]),f((i(),c(p,{link:"",type:"primary",onClick:T=>e.openForm("update",r.row.id)},{default:o(()=>t[11]||(t[11]=[n(" \u7F16\u8F91 ")])),_:2},1032,["onClick"])),[[C,["crm:receivable-plan:update"]]]),f((i(),c(p,{link:"",type:"danger",onClick:T=>e.handleDelete(r.row.id)},{default:o(()=>t[12]||(t[12]=[n(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[C,["crm:receivable-plan:delete"]]])]),_:1})]),_:1},8,["data"])),[[U,e.loading]]),a(S,{limit:e.queryParams.pageSize,"onUpdate:limit":t[4]||(t[4]=r=>e.queryParams.pageSize=r),page:e.queryParams.pageNo,"onUpdate:page":t[5]||(t[5]=r=>e.queryParams.pageNo=r),total:e.total,onPagination:e.getList},null,8,["limit","page","total"])]),_:1}),a(e.ReceivablePlanForm,{ref:"formRef",onSuccess:e.getList},null,512),a(e.ReceivableForm,{ref:"receivableFormRef",onSuccess:e.getList},null,512)],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/crm/receivable/plan/index.vue"]]);export{Ce as default};
