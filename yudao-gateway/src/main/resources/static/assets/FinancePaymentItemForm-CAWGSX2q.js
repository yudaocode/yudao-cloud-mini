import{d as L,D as k,r as P,f as z,au as F,e4 as w,ew as N,_ as S,o as R,c as A,I as C,q as x,w as t,k as e,m as I,ah as D,F as O,P as q,Z as $,L as j,cf as T,N as H,Q as B,O as Q,E as Z,R as G}from"./index-BaY5TDP-.js";import J from"./PurchaseInPaymentEnableList-DXUzmJAo.js";import K from"./PurchaseReturnRefundEnableList-V_0WQySV.js";import{E}from"./constants-CEEr2azc.js";import"./Dialog-CZSXtzfQ.js";import"./index-avjYFQiD.js";import"./index-DrSdAlug.js";import"./ContentWrap-DKQn7kZm.js";import"./formatTime-Dr6TiYYc.js";import"./index-CJwxK5Qx.js";import"./index-BVJ1S7eT.js";import"./index-AOA5K4qa.js";const M=S(L({__name:"FinancePaymentItemForm",props:{items:{type:null,required:!0},supplierId:{type:null,required:!0},disabled:{type:Boolean,required:!0}},setup(V,{expose:s}){const d=V,a=k(),g=P(!1),m=P([]),o=z({paymentPrice:[{required:!0,message:"\u672C\u6B21\u4ED8\u6B3E\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),u=P([]),p=P([]);F(()=>d.items,async n=>{m.value=n},{immediate:!0});const h=P(),c=P(),b=()=>u.value.validate();s({validate:b});const y={props:d,message:a,formLoading:g,formData:m,formRules:o,formRef:u,productList:p,getSummaries:n=>{const{columns:l,data:r}=n,i=[];return l.forEach((f,_)=>{if(_!==0)if(["totalPrice","paidPrice","paymentPrice"].includes(f.property)){const v=N(r.map(U=>Number(U[f.property])));i[_]=w(v)}else i[_]="";else i[_]="\u5408\u8BA1"}),i},purchaseInPaymentEnableListRef:h,handleOpenPurchaseIn:()=>{d.supplierId?h.value.open(d.supplierId):a.error("\u8BF7\u9009\u62E9\u4F9B\u5E94\u5546")},handleAddPurchaseIn:n=>{n.forEach(l=>{m.value.push({bizId:l.id,bizType:E.PURCHASE_IN,bizNo:l.no,totalPrice:l.totalPrice,paidPrice:l.paymentPrice,paymentPrice:l.totalPrice-l.paymentPrice})})},purchaseReturnRefundEnableListRef:c,handleOpenPurchaseReturn:()=>{d.supplierId?c.value.open(d.supplierId):a.error("\u8BF7\u9009\u62E9\u4F9B\u5E94\u5546")},handleAddPurchaseReturn:n=>{n.forEach(l=>{m.value.push({bizId:l.id,bizType:E.PURCHASE_RETURN,bizNo:l.no,totalPrice:-l.totalPrice,paidPrice:-l.refundPrice,paymentPrice:-l.totalPrice+l.refundPrice})})},handleDelete:n=>{m.value.splice(n,1)},validate:b,get erpPriceInputFormatter(){return w},PurchaseInPaymentEnableList:J,PurchaseReturnRefundEnableList:K};return Object.defineProperty(y,"__isScriptSetup",{enumerable:!1,value:!0}),y}}),[["render",function(V,s,d,a,g,m){const o=q,u=$,p=j,h=T,c=H,b=B,y=Q,n=Z,l=G;return R(),A(O,null,[C((R(),x(y,{ref:"formRef",model:a.formData,rules:a.formRules,"label-width":"0px","inline-message":!0,disabled:d.disabled},{default:t(()=>[e(b,{data:a.formData,"show-summary":"","summary-method":a.getSummaries,class:"-mt-10px"},{default:t(()=>[e(o,{label:"\u5E8F\u53F7",type:"index",align:"center",width:"60"}),e(o,{label:"\u91C7\u8D2D\u5355\u636E\u7F16\u53F7","min-width":"200"},{default:t(({row:r})=>[e(p,{class:"mb-0px!"},{default:t(()=>[e(u,{disabled:"",modelValue:r.bizNo,"onUpdate:modelValue":i=>r.bizNo=i},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:1}),e(o,{label:"\u5E94\u4ED8\u91D1\u989D",prop:"totalPrice",fixed:"right","min-width":"100"},{default:t(({row:r})=>[e(p,{class:"mb-0px!"},{default:t(()=>[e(u,{disabled:"",modelValue:r.totalPrice,"onUpdate:modelValue":i=>r.totalPrice=i,formatter:a.erpPriceInputFormatter},null,8,["modelValue","onUpdate:modelValue","formatter"])]),_:2},1024)]),_:1}),e(o,{label:"\u5DF2\u4ED8\u91D1\u989D",prop:"paidPrice",fixed:"right","min-width":"100"},{default:t(({row:r})=>[e(p,{class:"mb-0px!"},{default:t(()=>[e(u,{disabled:"",modelValue:r.paidPrice,"onUpdate:modelValue":i=>r.paidPrice=i,formatter:a.erpPriceInputFormatter},null,8,["modelValue","onUpdate:modelValue","formatter"])]),_:2},1024)]),_:1}),e(o,{label:"\u672C\u6B21\u4ED8\u6B3E",prop:"paymentPrice",fixed:"right","min-width":"115"},{default:t(({row:r,$index:i})=>[e(p,{prop:`${i}.paymentPrice`,class:"mb-0px!"},{default:t(()=>[e(h,{modelValue:r.paymentPrice,"onUpdate:modelValue":f=>r.paymentPrice=f,"controls-position":"right",precision:2,class:"!w-100%"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"])]),_:1}),e(o,{label:"\u5907\u6CE8","min-width":"150"},{default:t(({row:r,$index:i})=>[e(p,{prop:`${i}.remark`,class:"mb-0px!"},{default:t(()=>[e(u,{modelValue:r.remark,"onUpdate:modelValue":f=>r.remark=f,placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop"])]),_:1}),e(o,{align:"center",fixed:"right",label:"\u64CD\u4F5C",width:"60"},{default:t(({$index:r})=>[e(c,{onClick:i=>a.handleDelete(r),link:""},{default:t(()=>s[0]||(s[0]=[I("\u2014")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1},8,["model","rules","disabled"])),[[l,a.formLoading]]),d.disabled?D("",!0):(R(),x(n,{key:0,justify:"center",class:"mt-3"},{default:t(()=>[e(c,{onClick:a.handleOpenPurchaseIn,round:""},{default:t(()=>s[1]||(s[1]=[I("+ \u6DFB\u52A0\u91C7\u8D2D\u5165\u5E93\u5355")])),_:1}),e(c,{onClick:a.handleOpenPurchaseReturn,round:""},{default:t(()=>s[2]||(s[2]=[I("+ \u6DFB\u52A0\u91C7\u8D2D\u9000\u8D27\u5355")])),_:1})]),_:1})),e(a.PurchaseInPaymentEnableList,{ref:"purchaseInPaymentEnableListRef",onSuccess:a.handleAddPurchaseIn},null,512),e(a.PurchaseReturnRefundEnableList,{ref:"purchaseReturnRefundEnableListRef",onSuccess:a.handleAddPurchaseReturn},null,512)],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/erp/finance/payment/components/FinancePaymentItemForm.vue"]]);export{M as default};
