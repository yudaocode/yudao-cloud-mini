import{d as y,r as _,f as b,C as O,aB as C,G as v,aI as S,ew as w,eu as E,_ as R,o as L,c as x,k as t,w as r,I as T,q as I,F as M,v as q,E as D,l as U,P as W,Q as V,R as j}from"./index-BaY5TDP-.js";import{_ as z}from"./DictTag-QtcI9ZjC.js";import{E as A}from"./el-skeleton-item-BYAIkmCs.js";import{_ as Y}from"./Echart-BQxFkezy.js";import{S as k}from"./portrait-CXf55QaH.js";import"./color-BN7ZL7BD.js";import"./echarts-DpbyC_6K.js";const B=R(y({name:"PortraitCustomerLevel",__name:"PortraitCustomerLevel",props:{queryParams:{type:null,required:!0}},setup(h,{expose:g}){const p=h,o=_(!1),m=_([]),i=b({title:{text:"\u5168\u90E8\u5BA2\u6237",left:"center"},tooltip:{trigger:"item"},legend:{orient:"vertical",left:"left"},toolbox:{feature:{saveAsImage:{show:!0,name:"\u5168\u90E8\u5BA2\u6237"}}},series:[{name:"\u5168\u90E8\u5BA2\u6237",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:40,fontWeight:"bold"}},labelLine:{show:!1},data:[]}]}),s=b({title:{text:"\u6210\u4EA4\u5BA2\u6237",left:"center"},tooltip:{trigger:"item"},legend:{orient:"vertical",left:"left"},toolbox:{feature:{saveAsImage:{show:!0,name:"\u6210\u4EA4\u5BA2\u6237"}}},series:[{name:"\u6210\u4EA4\u5BA2\u6237",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:40,fontWeight:"bold"}},labelLine:{show:!1},data:[]}]}),n=async()=>{o.value=!0;const l=await k.getCustomerLevel(p.queryParams);i.series&&i.series[0]&&i.series[0].data&&(i.series[0].data=l.map(e=>({name:C(v.CRM_CUSTOMER_LEVEL,e.level),value:e.customerCount}))),s.series&&s.series[0]&&s.series[0].data&&(s.series[0].data=l.map(e=>({name:C(v.CRM_CUSTOMER_LEVEL,e.level),value:e.dealCount}))),d(l),m.value=l,o.value=!1};g({loadData:n});const d=l=>{if(S(l))return;const e=l,c=w(e.map(a=>a.customerCount)),f=w(e.map(a=>a.dealCount));e.forEach(a=>{a.levelPortion=a.customerCount===0?0:E(a.customerCount,c),a.dealPortion=a.dealCount===0?0:E(a.dealCount,f)})};O(()=>{n()});const u={props:p,loading:o,list:m,echartsOption:i,echartsOption2:s,loadData:n,calculateProportion:d,get DICT_TYPE(){return v}};return Object.defineProperty(u,"__isScriptSetup",{enumerable:!1,value:!0}),u}}),[["render",function(h,g,p,o,m,i){const s=Y,n=A,d=q,u=D,l=U,e=W,c=z,f=V,a=j;return L(),x(M,null,[t(l,{shadow:"never"},{default:r(()=>[t(u,{gutter:20},{default:r(()=>[t(d,{span:12},{default:r(()=>[t(n,{loading:o.loading,animated:""},{default:r(()=>[t(s,{height:500,options:o.echartsOption},null,8,["options"])]),_:1},8,["loading"])]),_:1}),t(d,{span:12},{default:r(()=>[t(n,{loading:o.loading,animated:""},{default:r(()=>[t(s,{height:500,options:o.echartsOption2},null,8,["options"])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1}),t(l,{class:"mt-16px",shadow:"never"},{default:r(()=>[T((L(),I(f,{data:o.list},{default:r(()=>[t(e,{align:"center",label:"\u5E8F\u53F7",type:"index",width:"80"}),t(e,{align:"center",label:"\u5BA2\u6237\u7EA7\u522B",prop:"level",width:"200"},{default:r(P=>[t(c,{type:o.DICT_TYPE.CRM_CUSTOMER_LEVEL,value:P.row.level},null,8,["type","value"])]),_:1}),t(e,{align:"center",label:"\u5BA2\u6237\u4E2A\u6570","min-width":"200",prop:"customerCount"}),t(e,{align:"center",label:"\u6210\u4EA4\u4E2A\u6570","min-width":"200",prop:"dealCount"}),t(e,{align:"center",label:"\u7EA7\u522B\u5360\u6BD4(%)","min-width":"200",prop:"levelPortion"}),t(e,{align:"center",label:"\u6210\u4EA4\u5360\u6BD4(%)","min-width":"200",prop:"dealPortion"})]),_:1},8,["data"])),[[a,o.loading]])]),_:1})],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/crm/statistics/portrait/components/PortraitCustomerLevel.vue"]]);export{B as default};
