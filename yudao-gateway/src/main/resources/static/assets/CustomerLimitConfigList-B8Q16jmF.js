import{d as w,D as k,g as I,r as C,f as N,C as P,G as S,_ as x,X as F,o as p,c as q,k as o,w as s,m as _,I as T,q as f,ah as E,F as R,z as U,N as D,P as O,Q,R as j}from"./index-BaY5TDP-.js";import{_ as z}from"./index-avjYFQiD.js";import{_ as A}from"./DictTag-QtcI9ZjC.js";import{d as M}from"./formatTime-Dr6TiYYc.js";import{g as Y,C as G,L as B,d as X}from"./CustomerLimitConfigForm-115g6Nbi.js";import"./index-DrSdAlug.js";import"./color-BN7ZL7BD.js";import"./Dialog-CZSXtzfQ.js";import"./el-tree-select-DphqCDCz.js";import"./index-dK17nfjs.js";import"./tree-z7HkrWVC.js";import"./index-CuAlllbQ.js";const H=x(w({name:"CustomerLimitConfigList",__name:"CustomerLimitConfigList",props:{confType:{type:Number,required:!0}},setup(L,{expose:t}){t();const m=k(),{t:e}=I(),d=C(!0),b=C(0),u=C([]),l=N({pageNo:1,pageSize:10,type:L.confType}),r=async()=>{d.value=!0;try{const n=await Y(l);u.value=n.list,b.value=n.total}finally{d.value=!1}},g=C();P(()=>{r()});const y={message:m,t:e,loading:d,total:b,list:u,queryParams:l,getList:r,formRef:g,openForm:(n,c)=>{g.value.open(n,L.confType,c)},handleDelete:async n=>{try{await m.delConfirm(),await X(n),m.success(e("common.delSuccess")),await r()}catch{}},handleQuery:()=>{l.pageNo=1,r()},get dateFormatter(){return M},CustomerLimitConfigForm:G,get DICT_TYPE(){return S},get LimitConfType(){return B}};return Object.defineProperty(y,"__isScriptSetup",{enumerable:!1,value:!0}),y}}),[["render",function(L,t,m,e,d,b){const u=U,l=D,r=O,g=A,y=Q,n=z,c=F("hasPermi"),v=j;return p(),q(R,null,[o(l,{plain:"",onClick:e.handleQuery},{default:s(()=>[o(u,{icon:"ep:refresh",class:"mr-5px"}),t[3]||(t[3]=_(" \u5237\u65B0 "))]),_:1}),T((p(),f(l,{type:"primary",plain:"",onClick:t[0]||(t[0]=a=>e.openForm("create"))},{default:s(()=>[o(u,{icon:"ep:plus",class:"mr-5px"}),t[4]||(t[4]=_(" \u65B0\u589E "))]),_:1})),[[c,["crm:customer-limit-config:create"]]]),T((p(),f(y,{data:e.list,stripe:!0,"show-overflow-tooltip":!0,class:"mt-4"},{default:s(()=>[o(r,{label:"\u7F16\u53F7",align:"center",prop:"id"}),o(r,{label:"\u89C4\u5219\u9002\u7528\u4EBA\u7FA4",align:"center",formatter:a=>{var i;return(i=a.users)==null?void 0:i.map(h=>h.nickname).join("\uFF0C")}},null,8,["formatter"]),o(r,{label:"\u89C4\u5219\u9002\u7528\u90E8\u95E8",align:"center",formatter:a=>{var i;return(i=a.depts)==null?void 0:i.map(h=>h.name).join("\uFF0C")}},null,8,["formatter"]),o(r,{label:m.confType===e.LimitConfType.CUSTOMER_QUANTITY_LIMIT?"\u62E5\u6709\u5BA2\u6237\u6570\u4E0A\u9650":"\u9501\u5B9A\u5BA2\u6237\u6570\u4E0A\u9650",align:"center",prop:"maxCount"},null,8,["label"]),m.confType===e.LimitConfType.CUSTOMER_QUANTITY_LIMIT?(p(),f(r,{key:0,label:"\u6210\u4EA4\u5BA2\u6237\u662F\u5426\u5360\u7528\u62E5\u6709\u5BA2\u6237\u6570",align:"center",prop:"dealCountEnabled","min-width":"100"},{default:s(a=>[o(g,{type:e.DICT_TYPE.INFRA_BOOLEAN_STRING,value:a.row.dealCountEnabled},null,8,["type","value"])]),_:1})):E("",!0),o(r,{label:"\u521B\u5EFA\u65F6\u95F4",align:"center",prop:"createTime",formatter:e.dateFormatter,width:"180px"},null,8,["formatter"]),o(r,{label:"\u64CD\u4F5C",align:"center","min-width":"110",fixed:"right"},{default:s(a=>[T((p(),f(l,{link:"",type:"primary",onClick:i=>e.openForm("update",a.row.id)},{default:s(()=>t[5]||(t[5]=[_(" \u7F16\u8F91 ")])),_:2},1032,["onClick"])),[[c,["crm:customer-limit-config:update"]]]),T((p(),f(l,{link:"",type:"danger",onClick:i=>e.handleDelete(a.row.id)},{default:s(()=>t[6]||(t[6]=[_(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[c,["crm:customer-limit-config:delete"]]])]),_:1})]),_:1},8,["data"])),[[v,e.loading]]),o(n,{total:e.total,page:e.queryParams.pageNo,"onUpdate:page":t[1]||(t[1]=a=>e.queryParams.pageNo=a),limit:e.queryParams.pageSize,"onUpdate:limit":t[2]||(t[2]=a=>e.queryParams.pageSize=a),onPagination:e.getList},null,8,["total","page","limit"]),o(e.CustomerLimitConfigForm,{ref:"formRef",onSuccess:e.getList},null,512)],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/crm/customer/limitConfig/CustomerLimitConfigList.vue"]]);export{H as default};
