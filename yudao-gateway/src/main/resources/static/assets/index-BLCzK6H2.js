import{d as F,D as V,g as z,r as u,f as Q,C as U,ez as R,_ as E,X as D,o as i,c as k,k as a,w as o,F as q,n as L,q as _,m as x,I as S,J as W,K as j,L as O,z as T,N as J,O as K,P as X,Q as A,R as B}from"./index-BaY5TDP-.js";import{_ as G}from"./index-avjYFQiD.js";import{_ as H}from"./ContentWrap-DKQn7kZm.js";import{_ as M}from"./index-BAz6Gqim.js";import{d as Y}from"./download-oWiM5xVU.js";import{S as C}from"./index-DMn3OXs3.js";import{P as Z}from"./index-CJwxK5Qx.js";import{W as $}from"./index-B0TWi7A6.js";import"./index-DrSdAlug.js";const ee=E(F({name:"ErpStock",__name:"index",setup(I,{expose:l}){l();const f=V(),{t:e}=z(),h=u(!0),P=u([]),w=u(0),n=Q({pageNo:1,pageSize:10,productId:void 0,warehouseId:void 0}),g=u(),p=u(!1),d=u([]),c=u([]),m=async()=>{h.value=!0;try{const t=await C.getStockPage(n);P.value=t.list,w.value=t.total}finally{h.value=!1}},y=()=>{n.pageNo=1,m()},s=u();U(async()=>{await m(),d.value=await Z.getProductSimpleList(),c.value=await $.getWarehouseSimpleList()});const b={message:f,t:e,loading:h,list:P,total:w,queryParams:n,queryFormRef:g,exportLoading:p,productList:d,warehouseList:c,getList:m,handleQuery:y,resetQuery:()=>{g.value.resetFields(),y()},formRef:s,openForm:(t,v)=>{s.value.open(t,v)},handleDelete:async t=>{try{await f.delConfirm(),await C.deleteStock(t),f.success(e("common.delSuccess")),await m()}catch{}},handleExport:async()=>{try{await f.exportConfirm(),p.value=!0;const t=await C.exportStock(n);Y.excel(t,"\u4EA7\u54C1\u5E93\u5B58.xls")}catch{}finally{p.value=!1}},get erpCountTableColumnFormatter(){return R}};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}}),[["render",function(I,l,f,e,h,P){const w=M,n=W,g=j,p=O,d=T,c=J,m=K,y=H,s=X,b=A,t=G,v=D("hasPermi"),N=B;return i(),k(q,null,[a(w,{title:"\u3010\u5E93\u5B58\u3011\u4EA7\u54C1\u5E93\u5B58\u3001\u5E93\u5B58\u660E\u7EC6",url:"https://doc.iocoder.cn/erp/stock/"}),a(y,null,{default:o(()=>[a(m,{class:"-mb-15px",model:e.queryParams,ref:"queryFormRef",inline:!0,"label-width":"68px"},{default:o(()=>[a(p,{label:"\u4EA7\u54C1",prop:"productId"},{default:o(()=>[a(g,{modelValue:e.queryParams.productId,"onUpdate:modelValue":l[0]||(l[0]=r=>e.queryParams.productId=r),clearable:"",filterable:"",placeholder:"\u8BF7\u9009\u62E9\u4EA7\u54C1",class:"!w-240px"},{default:o(()=>[(i(!0),k(q,null,L(e.productList,r=>(i(),_(n,{key:r.id,label:r.name,value:r.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(p,{label:"\u4ED3\u5E93",prop:"warehouseId"},{default:o(()=>[a(g,{modelValue:e.queryParams.warehouseId,"onUpdate:modelValue":l[1]||(l[1]=r=>e.queryParams.warehouseId=r),clearable:"",filterable:"",placeholder:"\u8BF7\u9009\u62E9\u4ED3\u5E93",class:"!w-240px"},{default:o(()=>[(i(!0),k(q,null,L(e.warehouseList,r=>(i(),_(n,{key:r.id,label:r.name,value:r.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(p,null,{default:o(()=>[a(c,{onClick:e.handleQuery},{default:o(()=>[a(d,{icon:"ep:search",class:"mr-5px"}),l[5]||(l[5]=x(" \u641C\u7D22"))]),_:1}),a(c,{onClick:e.resetQuery},{default:o(()=>[a(d,{icon:"ep:refresh",class:"mr-5px"}),l[6]||(l[6]=x(" \u91CD\u7F6E"))]),_:1}),S((i(),_(c,{type:"primary",plain:"",onClick:l[2]||(l[2]=r=>e.openForm("create"))},{default:o(()=>[a(d,{icon:"ep:plus",class:"mr-5px"}),l[7]||(l[7]=x(" \u65B0\u589E "))]),_:1})),[[v,["erp:stock:create"]]]),S((i(),_(c,{type:"success",plain:"",onClick:e.handleExport,loading:e.exportLoading},{default:o(()=>[a(d,{icon:"ep:download",class:"mr-5px"}),l[8]||(l[8]=x(" \u5BFC\u51FA "))]),_:1},8,["loading"])),[[v,["erp:stock:export"]]])]),_:1})]),_:1},8,["model"])]),_:1}),a(y,null,{default:o(()=>[S((i(),_(b,{data:e.list,stripe:!0,"show-overflow-tooltip":!0},{default:o(()=>[a(s,{label:"\u4EA7\u54C1\u540D\u79F0",align:"center",prop:"productName"}),a(s,{label:"\u4EA7\u54C1\u5355\u4F4D",align:"center",prop:"unitName"}),a(s,{label:"\u4EA7\u54C1\u5206\u7C7B",align:"center",prop:"categoryName"}),a(s,{label:"\u5E93\u5B58\u91CF",align:"center",prop:"count",formatter:e.erpCountTableColumnFormatter},null,8,["formatter"]),a(s,{label:"\u4ED3\u5E93",align:"center",prop:"warehouseName"})]),_:1},8,["data"])),[[N,e.loading]]),a(t,{total:e.total,page:e.queryParams.pageNo,"onUpdate:page":l[3]||(l[3]=r=>e.queryParams.pageNo=r),limit:e.queryParams.pageSize,"onUpdate:limit":l[4]||(l[4]=r=>e.queryParams.pageSize=r),onPagination:e.getList},null,8,["total","page","limit"])]),_:1})],64)}],["__file","/Users/steven/00/500_code/520_github/yudao-ui-admin-vue3/src/views/erp/stock/stock/index.vue"]]);export{ee as default};
